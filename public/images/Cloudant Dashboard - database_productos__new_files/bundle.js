(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{167:function(e,t){var n=null;window.PR_SHOULD_USE_CONTINUATION=!0,function(){function e(e,t,n,a){t&&(n(e={a:t,d:e}),a.push.apply(a,e.e))}function t(t,a){var r,o={};!function(){for(var e=t.concat(a),i=[],s={},c=0,l=e.length;c<l;++c){var u=e[c],d=u[3];if(d)for(var p=d.length;--p>=0;)o[d.charAt(p)]=u;d=""+(u=u[1]),s.hasOwnProperty(d)||(i.push(u),s[d]=n)}i.push(/[\S\s]/),r=function(e){function t(e){var t=e.charCodeAt(0);if(92!==t)return t;var n=e.charAt(1);return(t=d[n])?t:"0"<=n&&n<="7"?parseInt(e.substring(1),8):"u"===n||"x"===n?parseInt(e.substring(2),16):e.charCodeAt(1)}function n(e){return e<32?(e<16?"\\x0":"\\x")+e.toString(16):("\\"!==(e=String.fromCharCode(e))&&"-"!==e&&"["!==e&&"]"!==e||(e="\\"+e),e)}function a(e){for(var a=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),r=(e=[],[]),o="^"===a[0],i=o?1:0,s=a.length;i<s;++i){var c=a[i];if(/\\[bdsw]/i.test(c))e.push(c);else{var l;c=t(c);i+2<s&&"-"===a[i+1]?(l=t(a[i+2]),i+=2):l=c,r.push([c,l]),l<65||c>122||(l<65||c>90||r.push([32|Math.max(65,c),32|Math.min(l,90)]),l<97||c>122||r.push([-33&Math.max(97,c),-33&Math.min(l,122)]))}}for(r.sort((function(e,t){return e[0]-t[0]||t[1]-e[1]})),a=[],c=[NaN,NaN],i=0;i<r.length;++i)(s=r[i])[0]<=c[1]+1?c[1]=Math.max(c[1],s[1]):a.push(c=s);for(r=["["],o&&r.push("^"),r.push.apply(r,e),i=0;i<a.length;++i)s=a[i],r.push(n(s[0])),s[1]>s[0]&&(s[1]+1>s[0]&&r.push("-"),r.push(n(s[1])));return r.push("]"),r.join("")}function r(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),n=t.length,r=[],s=0,c=0;s<n;++s){var l=t[s];"("===l?++c:"\\"===l.charAt(0)&&(l=+l.substring(1))&&l<=c&&(r[l]=-1)}for(s=1;s<r.length;++s)-1===r[s]&&(r[s]=++o);for(c=s=0;s<n;++s)"("===(l=t[s])?void 0===r[++c]&&(t[s]="(?:"):"\\"===l.charAt(0)&&(l=+l.substring(1))&&l<=c&&(t[s]="\\"+r[c]);for(c=s=0;s<n;++s)"^"===t[s]&&"^"!==t[s+1]&&(t[s]="");if(e.ignoreCase&&i)for(s=0;s<n;++s)e=(l=t[s]).charAt(0),l.length>=2&&"["===e?t[s]=a(l):"\\"!==e&&(t[s]=l.replace(/[A-Za-z]/g,(function(e){return e=e.charCodeAt(0),"["+String.fromCharCode(-33&e,32|e)+"]"})));return t.join("")}for(var o=0,i=!1,s=!1,c=0,l=e.length;c<l;++c){var u=e[c];if(u.ignoreCase)s=!0;else if(/[a-z]/i.test(u.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){i=!0,s=!1;break}}var d={b:8,t:9,n:10,v:11,f:12,r:13},p=[];for(c=0,l=e.length;c<l;++c){if((u=e[c]).global||u.multiline)throw Error(""+u);p.push("(?:"+r(u)+")")}return RegExp(p.join("|"),s?"gi":"g")}(i)}();var s=a.length;return function t(n){for(var c=n.d,l=[c,"pln"],u=0,d=n.a.match(r)||[],p={},f=0,h=d.length;f<h;++f){var m,g=d[f],b=p[g],y=void 0;if("string"==typeof b)m=!1;else{var E=o[g.charAt(0)];if(E)y=g.match(E[1]),b=E[0];else{for(m=0;m<s;++m)if(E=a[m],y=g.match(E[1])){b=E[0];break}y||(b="pln")}!(m=b.length>=5&&"lang-"===b.substring(0,5))||y&&"string"==typeof y[1]||(m=!1,b="src"),m||(p[g]=b)}if(E=u,u+=g.length,m){m=y[1];var _=g.indexOf(m),v=_+m.length;y[2]&&(_=(v=g.length-y[2].length)-m.length),b=b.substring(5),e(c+E,g.substring(0,_),t,l),e(c+E+_,m,i(b,m),l),e(c+E+v,g.substring(v),t,l)}else l.push(c+E,b)}n.e=l}}function a(e){var a=[],r=[];e.tripleQuotedStrings?a.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,n,"'\""]):e.multiLineStrings?a.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,n,"'\"`"]):a.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,n,"\"'"]),e.verbatimStrings&&r.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,n]);var o=e.hashComments;return o&&(e.cStyleComments?(o>1?a.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,n,"#"]):a.push(["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,n,"#"]),r.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,n])):a.push(["com",/^#[^\n\r]*/,n,"#"])),e.cStyleComments&&(r.push(["com",/^\/\/[^\n\r]*/,n]),r.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,n])),e.regexLiterals&&r.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]),(o=e.types)&&r.push(["typ",o]),(e=(""+e.keywords).replace(/^ | $/g,"")).length&&r.push(["kwd",RegExp("^(?:"+e.replace(/[\s,]+/g,"|")+")\\b"),n]),a.push(["pln",/^\s+/,n," \r\n\t "]),r.push(["lit",/^@[$_a-z][\w$@]*/i,n],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,n],["pln",/^[$_a-z][\w$@]*/i,n],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,n,"0123456789"],["pln",/^\\[\S\s]?/,n],["pun",/^.[^\s\w"-$'./@\\`]*/,n]),t(a,r)}function r(e,t){function a(e){switch(e.nodeType){case 1:if(i.test(e.className))break;if("BR"===e.nodeName)r(e),e.parentNode&&e.parentNode.removeChild(e);else for(e=e.firstChild;e;e=e.nextSibling)a(e);break;case 3:case 4:if(l){var t=e.nodeValue,n=t.match(s);if(n){var o=t.substring(0,n.index);e.nodeValue=o,(t=t.substring(n.index+n[0].length))&&e.parentNode.insertBefore(c.createTextNode(t),e.nextSibling),r(e),o||e.parentNode.removeChild(e)}}}}function r(e){for(;!e.nextSibling;)if(!(e=e.parentNode))return;var t;for(e=function e(t,n){var a=n?t.cloneNode(!1):t;if(r=t.parentNode){var r=e(r,1),o=t.nextSibling;r.appendChild(a);for(var i=o;i;i=o)o=i.nextSibling,r.appendChild(i)}return a}(e.nextSibling,0);(t=e.parentNode)&&1===t.nodeType;)e=t;u.push(e)}var o,i=/(?:^|\s)nocode(?:\s|$)/,s=/\r\n?|\n/,c=e.ownerDocument;e.currentStyle?o=e.currentStyle.whiteSpace:window.getComputedStyle&&(o=c.defaultView.getComputedStyle(e,n).getPropertyValue("white-space"));var l=o&&"pre"===o.substring(0,3);for(o=c.createElement("LI");e.firstChild;)o.appendChild(e.firstChild);for(var u=[o],d=0;d<u.length;++d)a(u[d]);t===(0|t)&&u[0].setAttribute("value",t);var p=c.createElement("OL");p.className="linenums";for(var f=Math.max(0,t-1|0)||0,h=(d=0,u.length);d<h;++d)(o=u[d]).className="L"+(d+f)%10,o.firstChild||o.appendChild(c.createTextNode(" ")),p.appendChild(o);e.appendChild(p)}function o(e,t){for(var n=t.length;--n>=0;){var a=t[n];y.hasOwnProperty(a)?window.console&&console.warn("cannot override language handler %s",a):y[a]=e}}function i(e,t){return e&&y.hasOwnProperty(e)||(e=/^\s*</.test(t)?"default-markup":"default-code"),y[e]}function s(e){var t=e.g;try{var a=(u=function(e){var t,a=/(?:^|\s)nocode(?:\s|$)/,r=[],o=0,i=[],s=0;e.currentStyle?t=e.currentStyle.whiteSpace:window.getComputedStyle&&(t=document.defaultView.getComputedStyle(e,n).getPropertyValue("white-space"));var c=t&&"pre"===t.substring(0,3);return function e(t){switch(t.nodeType){case 1:if(a.test(t.className))break;for(var n=t.firstChild;n;n=n.nextSibling)e(n);"BR"!==(n=t.nodeName)&&"LI"!==n||(r[s]="\n",i[s<<1]=o++,i[s++<<1|1]=t);break;case 3:case 4:(n=t.nodeValue).length&&(n=c?n.replace(/\r\n?/g,"\n"):n.replace(/[\t\n\r ]+/g," "),r[s]=n,i[s<<1]=o,o+=n.length,i[s++<<1|1]=t)}}(e),{a:r.join("").replace(/\n$/,""),c:i}}(e.h)).a;e.a=a,e.c=u.c,e.d=0,i(t,a)(e);var r,o,s=/\bMSIE\b/.test(navigator.userAgent),c=(t=/\n/g,e.a),l=c.length,u=0,d=e.c,p=d.length,f=(a=0,e.e),h=f.length;e=0;for(f[h]=l,o=r=0;o<h;)f[o]!==f[o+2]?(f[r++]=f[o++],f[r++]=f[o++]):o+=2;for(h=r,o=r=0;o<h;){for(var m=f[o],g=f[o+1],b=o+2;b+2<=h&&f[b+1]===g;)b+=2;f[r++]=m,f[r++]=g,o=b}for(f.length=r;a<p;){var y,E=d[a+2]||l,_=f[e+2]||l,v=(b=Math.min(E,_),d[a+1]);if(1!==v.nodeType&&(y=c.substring(u,b))){s&&(y=y.replace(t,"\r")),v.nodeValue=y;var S=v.ownerDocument,N=S.createElement("SPAN");N.className=f[e+1];var D=v.parentNode;D.replaceChild(N,v),N.appendChild(v),u<E&&(d[a+1]=v=S.createTextNode(c.substring(b,E)),D.insertBefore(v,N.nextSibling))}(u=b)>=E&&(a+=2),u>=_&&(e+=2)}}catch(e){"console"in window&&console.log(e&&e.stack?e.stack:e)}}var c,l,u=[c=[[l=["break,continue,do,else,for,if,return,while"],"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],d=[c,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],p=[d,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],f=[l,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],h=[l,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],m=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,g=/\S/,b=a({keywords:[u,p,c=[c,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+f,h,l=[l,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"]],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),y={};o(b,["default-code"]),o(t([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]),o(t([["pln",/^\s+/,n," \t\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,n,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]),o(t([],[["atv",/^[\S\s]+/]]),["uq.val"]),o(a({keywords:u,hashComments:!0,cStyleComments:!0,types:m}),["c","cc","cpp","cxx","cyc","m"]),o(a({keywords:"null,true,false"}),["json"]),o(a({keywords:p,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:m}),["cs"]),o(a({keywords:d,cStyleComments:!0}),["java"]),o(a({keywords:l,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]),o(a({keywords:f,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]),o(a({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]),o(a({keywords:h,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]),o(a({keywords:c,cStyleComments:!0,regexLiterals:!0}),["js"]),o(a({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),o(t([],[["str",/^[\S\s]+/]]),["regex"]),window.prettyPrintOne=function(e,t,n){var a=document.createElement("PRE");return a.innerHTML=e,n&&r(a,n),s({g:t,i:n,h:a}),a.innerHTML},window.prettyPrint=function(e){for(var t=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],a=[],o=0;o<t.length;++o)for(var i=0,c=t[o].length;i<c;++i)a.push(t[o][i]);t=n;var l=Date;l.now||(l={now:function(){return+new Date}});var u=0,d=/\blang(?:uage)?-([\w.]+)(?!\S)/;!function t(){for(var n=window.PR_SHOULD_USE_CONTINUATION?l.now()+250:1/0;u<a.length&&l.now()<n;u++){var o=a[u];if((i=o.className).indexOf("prettyprint")>=0){var i,c,p;if(p=!(i=i.match(d))){for(var f=void 0,h=(p=o).firstChild;h;h=h.nextSibling){var m=h.nodeType;f=1===m?f?p:h:3===m&&g.test(h.nodeValue)?p:f}p=(c=f===p?void 0:f)&&"CODE"===c.tagName}for(p&&(i=c.className.match(d)),i&&(i=i[1]),p=!1,f=o.parentNode;f;f=f.parentNode)if(("pre"===f.tagName||"code"===f.tagName||"xmp"===f.tagName)&&f.className&&f.className.indexOf("prettyprint")>=0){p=!0;break}p||((p=!!(p=o.className.match(/\blinenums\b(?::(\d+))?/))&&(!p[1]||!p[1].length||+p[1]))&&r(o,p),s({g:i,h:o,i:p}))}}u<a.length?setTimeout(t,250):e&&e()}()},window.PR={createSimpleLexer:t,registerLangHandler:o,sourceDecorator:a,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}}()},178:function(e,t,n){"use strict";(function(e){var a=n(11),r=n.n(a),o=n(139),i=n.n(o);"browser"===e.title?r.a.tip=i.a:r.a.tip=i()(r.a);var s=r.a.tip().attr("class","monitoring__d3-tip"),c=function(){this.initialise.apply(this,arguments)};_.extend(c.prototype,{initialise:function(e){this.x=e.x,this.y=e.y,this._draw(e.svg),this.dragging=!1},dragStart:function(){this.dragging=!0},dragEnd:function(){this.dragging=!1},_appendTriangle:function(e,t){return e.append("path").attr("class","slider-triangle").attr("d",this.triangleSymbol).style("opacity",1e-6).attr("transform",this.currentPos("hide",t))},_draw:function(e){this.triangleSymbol=r.a.svg.symbol().type("triangle-up").size(64),this._triangle1=this._appendTriangle(e,"right"),this._triangle2=this._appendTriangle(e,"left")},currentPos:function(e,t){var n,a=this.y,r=90;return"left"===t?(r=-90,n="hide"===e?this.x-25:this.x-15):n="hide"===e?this.x+25:this.x+15," translate("+n+","+a+") rotate("+r+")"},xMoveTo:function(e){this.x=e,this._triangle1.attr("transform",this.currentPos()),this._triangle2.attr("transform",this.currentPos("show","left"))},show:function(){this._triangle1.style("opacity",1),this._triangle2.style("opacity",1)},hide:function(){this._triangle1.style("opacity",0),this._triangle2.style("opacity",0)}});var l={setToggleState:function(e){return this.toggleState=e,this},width:function(e){return 0===arguments.length?this._width:(this._width=e,this)},height:function(e){return 0===arguments.length?this._height:(this._height=e,this)},yAxisTickFormat:r.a.format(".2s"),setYAxisTickFormat:function(e){return this.yAxisTickFormat=e,this},yScaleDomain:function(e){var t=_.reduce(e,(function(e,t){return e.concat(t.points)}),[]);return[0,r.a.max(t,(function(e){return e.value}))]},setXAxisTickFormat:function(e){return this.xAxisTickFormat=e,this},setXAxis:function(e,t,n){t.tickFormat(this.xAxisTickFormat),e.select(".x.axis").attr("transform","translate(0,"+n+")").call(t)},setYDomain:function(e){return this.yScaleDomain=e,this},tickValues:function(e){var t=parseInt(e/6,10);return _.reduce(_.range(6),(function(e,n){return e.push(Math.floor(t/2)+t*n),e}),[])},setXScale:function(e,t,n){var a=t[0].points.map((function(e){return e.date}));e.range([0,n]).domain([a[0],a[a.length-1]])},legendEl:function(e){return 0===arguments.length?this._legendEl:(this._legendEl=e,this)},renderLegend:function(e,t,n){var a=n.toggleState,o=this.margin,i=this.w1,s=this.color,c=this.legendEl().append("svg").style("width","100%").append("g").attr("transform","translate(".concat(o.left,",").concat(o.top,")")),l=r.a.scale.ordinal().rangeRoundBands([0,2*i/3]).domain(_.range(0,e.length)),u=c.selectAll(".legend").data(e.map((function(e){return e.name}))),d=u.enter().append("g").attr("class",(function(t,n){var a="legend";return e[n].toggle&&(a+=" passive"),a})),p=l.rangeBand();p>88&&(p=88),u.on("click",(function(e){var n=r.a.select(this),o=n.select("rect"),i=n.select("text"),c=n.attr("class").indexOf("passive")>-1;c?(n.attr("class","legend"),o.style("fill-opacity",1),i.style("fill","#fff"),t.toggle("on",e)):(n.attr("class","legend passive"),o.style("fill-opacity",1e-6),i.style("fill",s(e)),t.toggle("off",e)),a&&a(c,i.text().toLowerCase())})),u.each((function(n,a){e[a].toggle&&t.toggle("off",e[a].name)})),d.append("rect").attr("x",(function(e,t){return l(0)+p/2*t+p*t})).attr("width",p).attr("height",30).attr("rx","5").attr("ry","5").style("fill",(function(e){return s(e)})).style("fill-opacity",(function(t,n){return e[n].toggle?1e-6:1})).style("stroke",(function(e){return s(e)})),d.append("text").attr("x",(function(e,t){return p/2+l(0)+p/2*t+p*t})).attr("y",20).attr("class",(function(e){return"text-"+e})).style("text-anchor","middle").style("letter-spacing","0.2em").style("fill",(function(t,n){return e[n].toggle?s(t):"#fff"})).text((function(e){return e.toUpperCase()}))},toggleAreaLine:function(e,t,n){var a=e.selectAll(".area-"+n),r=e.selectAll(".line-"+n);"on"===t?(a.style("fill-opacity",1e-6).transition().duration(500).style("fill-opacity",.7),r.style("stroke-opacity",1e-6).transition().duration(500).style("stroke-opacity",1)):(a.style("fill-opacity",1).transition().duration(500).style("fill-opacity",1e-6),r.style("stroke-opacity",1).transition().duration(500).style("stroke-opacity",1e-6))},httpColours:function(){var e={"5xx":"#c55c56","4xx":"#e85e38","3xx":"#19578a","2xx":"#2abf9e",GET:"#98cb32",POST:"#29be9d",PUT:"#19578a",COPY:"#e75d37",HEAD:"#72cdf4",DELETE:"#cc0033",default:"#99cc3f"},t=function(t){var n=e[t];return _.isUndefined(n)&&(n=e.default),n};return t.list=e,t},renderSlider:function(e,t,n,a,o){var i=r.a.format(".1f"),l=new c({svg:e,x:20,y:a/2}),u=parseInt(o/n[0].points.length,10),d=n[0].points.map((function(e,a){return{name:n[0].name,date:e.date,value:e.value,x:t(e.date),i:a,symbol:e.symbol||"",freeFormatted:e.freeFormatted}})),p=this.width();s.html((function(e){return e[0].freeFormatted?function(e){var t=r.a.time.format("%I:%M %p"),n=r.a.format(".0f"),a=e.map((function(e){return'<div class="monitoring__d3-tip-content dot-'.concat(e.name,'">\n            <span class="monitoring__d3-tip-name">').concat(e.name,'</span>\n            <span class="monitoring__d3-tip-value" style="padding-right: 15px;">').concat(n(e.value)," ").concat(e.symbol,'</span>\n          </div>\n          <div class="monitoring__d3-tip-content dot-').concat(e.name,'">\n            <span class="monitoring__d3-tip-name">Free</span>\n            <span class="monitoring__d3-tip-value">').concat(e.freeFormatted,"</span>\n          </div>")})).join("");return'<div class="monitoring__d3-tip-header"> '.concat(t(e[0].date),"</div>")+a}(e):function(e){var t=r.a.time.format("%I:%M %p"),n=e.map((function(e){return'<div class="monitoring__d3-tip-content dot-'.concat(e.name,'">\n            <span class="monitoring__d3-tip-name">').concat(e.name,'</span>\n            <span class="monitoring__d3-tip-value">').concat(e.value," ").concat(e.symbol,"</span>\n          </div>")})).join("");return'<div class="monitoring__d3-tip-header"> '.concat(t(e[0].date),"</div>")+n}(e)})),e.call(s);var f=e.append("line").attr("class","slider-line").attr("x1",20).attr("y1",a).attr("x2",20).attr("y2",0).attr("stroke-width",2).style("opacity",0),h=e.node().parentNode,m=function(){var e=r.a.mouse(this)[0],t=Math.max(0,Math.min(o,e));r.a.event.defaultPrevented||(f.style("opacity",1).attr("x1",t).attr("x2",t),l.show(),l.xMoveTo(t),function(e,t){var a=n.length;d[0].freeFormatted&&(a=2);var r="monitoring__d3-tip d3-tip-size-".concat(a);s.attr("class",r);var o=d.find((function(e){return Math.abs(e.x-t)<=u}));if(o){var c=n.map((function(e){return{name:e.name,value:i(e.points[o.i].value),date:o.date,x:o.x,i:o.i,symbol:o.symbol,freeFormatted:o.freeFormatted}}));s.show.call(e,c);var l=p/2,f=t-l;f+l/5>=l&&(f-=l/10),s.offset([-16,f])}}(h,t))};r.a.select(e.node()).append("rect").attr("x",0).attr("y",0).attr("width",p).attr("height",this.height()).style("opacity",0).on("mouseover",m).on("mousemove",m).on("mouseout",(function(){f.transition("duration",300).style("opacity",0),l.hide(),s.hide()}))}};t.a=l}).call(this,n(89))},181:function(e,t,n){var a;!function(){function n(e,t){"use strict";return new r(e,t).beautify()}function r(e,t){"use strict";var n,a,r,o,i,s,c,l,u,d,p,f,h,m,g,b,y,E,_,v,S,N,D,O,w,T,C="";function A(e,t){var n=0;return e&&(n=e.indentation_level,n+=e.var_line&&e.var_line_reindented?1:0,!k()&&e.line_indent_level>n&&(n=e.line_indent_level)),{mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,multiline_frame:!1,if_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:n,line_indent_level:e?e.line_indent_level:n,start_line_index:a.length,had_comment:!1,ternary_depth:0}}for(p="\n\r\t ".split(""),f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),b="0123456789".split(""),h="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::",h=(h+=" <%= <% %> <?= <? ?>").split(" "),g="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(","),w={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},O={TK_START_EXPR:function(){K();var e=w.Expression;if("["===r){if("TK_WORD"===i||")"===l.last_text)return X(l.last_text,g)&&(v=!0),B(e),M(),j(),void(T.space_in_paren&&(v=!0));e=w.ArrayLiteral,G(l.mode)&&("["!==l.last_text&&(","!==l.last_text||"]"!==s&&"}"!==s)||T.keep_array_indentation||x())}else"for"===l.last_text?e=w.ForInitializer:X(l.last_text,["if","while"])&&(e=w.Conditional);";"===l.last_text||"TK_START_BLOCK"===i?x():"TK_END_EXPR"===i||"TK_START_EXPR"===i||"TK_END_BLOCK"===i||"."===l.last_text?(L(E),_=!1):"TK_WORD"!==i&&"TK_OPERATOR"!==i?v=!0:"function"===l.last_word||"typeof"===l.last_word?T.jslint_happy&&(v=!0):(X(l.last_text,g)||"catch"===l.last_text)&&T.space_before_conditional&&(v=!0);"("===r&&("TK_EQUALS"!==i&&"TK_OPERATOR"!==i||F()||L());B(e),M(),T.space_in_paren&&(v=!0);j()},TK_END_EXPR:function(){for(;l.mode===w.Statement;)V();"]"===r&&G(l.mode)&&l.multiline_frame&&!T.keep_array_indentation&&x();l.multiline_frame&&L();T.space_in_paren&&("TK_START_EXPR"===i?(I(),v=!1):v=!0);"]"===r&&T.keep_array_indentation?(M(),V()):(V(),M());H(u),l.do_while&&u.mode===w.Conditional&&(u.mode=w.Expression,l.do_block=!1,l.do_while=!1)},TK_START_BLOCK:function(){B(w.BlockStatement);var e=function(e){var t=m,a=n.charAt(t);for(;X(a,p)&&a!==e;){if(++t>=S)return!1;a=n.charAt(t)}return a===e}("}")&&"function"===l.last_word&&"TK_END_EXPR"===i;"expand"===T.brace_style?"TK_OPERATOR"!==i&&(e||"TK_EQUALS"===i||W(l.last_text)&&"else"!==l.last_text)?v=!0:x():"TK_OPERATOR"!==i&&"TK_START_EXPR"!==i?"TK_START_BLOCK"===i?x():v=!0:G(u.mode)&&","===l.last_text&&("}"===s?v=!0:x());M(),j()},TK_END_BLOCK:function(){for(;l.mode===w.Statement;)V();var e="TK_START_BLOCK"===i;"expand"===T.brace_style?e||x():e||(G(l.mode)&&T.keep_array_indentation?(T.keep_array_indentation=!1,x(),T.keep_array_indentation=!0):x());V(),M()},TK_WORD:function(){K()||!E||q(l.mode)||"TK_OPERATOR"===i&&"--"!==l.last_text&&"++"!==l.last_text||"TK_EQUALS"===i||!T.preserve_newlines&&"var"===l.last_text||x();if(l.do_block&&!l.do_while){if("while"===r)return v=!0,M(),v=!0,void(l.do_while=!0);x(),l.do_block=!1}if(l.if_block&&"else"!==r){for(;l.mode===w.Statement;)V();l.if_block=!1}if("case"===r||"default"===r&&l.in_case_statement)return x(),(l.case_body||T.jslint_happy)&&(l.indentation_level>0&&(!l.parent||l.indentation_level>l.parent.indentation_level)&&(l.indentation_level-=1),l.case_body=!1),M(),l.in_case=!0,void(l.in_case_statement=!0);"function"===r&&(l.var_line&&"TK_EQUALS"!==i&&(l.var_line_reindented=!0),(X(l.last_text,["}",";"])||k()&&!X(l.last_text,["{",":","=",","]))&&(function(){if(k()){return 1===a.length||0===a[a.length-2].text.length}return!1}()||l.had_comment||(x(),x(!0))),"TK_WORD"===i?"get"===l.last_text||"set"===l.last_text||"new"===l.last_text||"return"===l.last_text?v=!0:x():"TK_OPERATOR"===i||"="===l.last_text?v=!0:q(l.mode)||x());"TK_COMMA"!==i&&"TK_START_EXPR"!==i&&"TK_EQUALS"!==i&&"TK_OPERATOR"!==i||F()||L();if("function"===r)return M(),void(l.last_word=r);y="NONE","TK_END_BLOCK"===i?X(r,["else","catch","finally"])?"expand"===T.brace_style||"end-expand"===T.brace_style?y="NEWLINE":(y="SPACE",v=!0):y="NEWLINE":"TK_SEMICOLON"===i&&l.mode===w.BlockStatement?y="NEWLINE":"TK_SEMICOLON"===i&&q(l.mode)?y="SPACE":"TK_STRING"===i?y="NEWLINE":"TK_WORD"===i?y="SPACE":"TK_START_BLOCK"===i?y="NEWLINE":"TK_END_EXPR"===i&&(v=!0,y="NEWLINE");X(r,g)&&")"!==l.last_text&&(y="else"===l.last_text?"SPACE":"NEWLINE");if(X(r,["else","catch","finally"]))if("TK_END_BLOCK"!==i||"expand"===T.brace_style||"end-expand"===T.brace_style)x();else{I(!0);var e=a[a.length-1];"}"!==e.text[e.text.length-1]&&x(),v=!0}else"NEWLINE"===y?W(l.last_text)?v=!0:"TK_END_EXPR"!==i?"TK_START_EXPR"===i&&"var"===r||":"===l.last_text||("if"===r&&"else"===l.last_word&&"{"!==l.last_text?v=!0:(l.var_line=!1,l.var_line_reindented=!1,x())):X(r,g)&&")"!==l.last_text&&(l.var_line=!1,l.var_line_reindented=!1,x()):G(l.mode)&&","===l.last_text&&"}"===s?x():"SPACE"===y&&(v=!0);M(),l.last_word=r,"var"===r&&(l.var_line=!0,l.var_line_reindented=!1,l.var_line_tainted=!1);"do"===r&&(l.do_block=!0);"if"===r&&(l.if_block=!0)},TK_SEMICOLON:function(){K()&&(v=!1);for(;l.mode===w.Statement&&!l.if_block&&!l.do_block;)V();M(),l.var_line=!1,l.var_line_reindented=!1,l.mode===w.ObjectLiteral&&(l.mode=w.BlockStatement)},TK_STRING:function(){K()?v=!0:"TK_WORD"===i?v=!0:"TK_COMMA"===i||"TK_START_EXPR"===i||"TK_EQUALS"===i||"TK_OPERATOR"===i?F()||L():x();M()},TK_EQUALS:function(){l.var_line&&(l.var_line_tainted=!0);v=!0,M(),v=!0},TK_OPERATOR:function(){var e=!0,t=!0;if(W(l.last_text))return v=!0,void M();if("*"===r&&"TK_DOT"===i&&!s.match(/^\d+$/))return void M();if(":"===r&&l.in_case)return l.case_body=!0,j(),M(),x(),void(l.in_case=!1);if("::"===r)return void M();!E||"--"!==r&&"++"!==r||x();X(r,["--","++","!"])||X(r,["-","+"])&&(X(i,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||X(l.last_text,g)||","===l.last_text)?(e=!1,t=!1,";"===l.last_text&&q(l.mode)&&(e=!0),"TK_WORD"===i&&X(l.last_text,g)&&(e=!0),l.mode!==w.BlockStatement&&l.mode!==w.Statement||"{"!==l.last_text&&";"!==l.last_text||x()):":"===r?0===l.ternary_depth?(l.mode===w.BlockStatement&&(l.mode=w.ObjectLiteral),e=!1):l.ternary_depth-=1:"?"===r&&(l.ternary_depth+=1);v=v||e,M(),v=t},TK_COMMA:function(){if(l.var_line)return(q(l.mode)||"TK_END_BLOCK"===i)&&(l.var_line_tainted=!1),l.var_line&&(l.var_line_reindented=!0),M(),void(l.var_line_tainted?(l.var_line_tainted=!1,x()):v=!0);"TK_END_BLOCK"===i&&l.mode!==w.Expression?(M(),l.mode===w.ObjectLiteral&&"}"===l.last_text?x():v=!0):l.mode===w.ObjectLiteral?(M(),x()):(M(),v=!0)},TK_BLOCK_COMMENT:function(){var e,t=function(e){e=e.replace(/\x0d/g,"");var t=[],n=e.indexOf("\n");for(;-1!==n;)t.push(e.substring(0,n)),e=e.substring(n+1),n=e.indexOf("\n");e.length&&t.push(e);return t}(r),n=!1;x(!1,!0),t.length>1&&function(e,t){for(var n=0;n<e.length;n++){if(R(e[n]).charAt(0)!==t)return!1}return!0}(t.slice(1),"*")&&(n=!0);for(M(t[0]),e=1;e<t.length;e++)x(!1,!0),n?M(" "+R(t[e])):a[a.length-1].text.push(t[e]);x(!1,!0)},TK_INLINE_COMMENT:function(){v=!0,M(),v=!0},TK_COMMENT:function(){E?x(!1,!0):I(!0);v=!0,M(),x(!1,!0)},TK_DOT:function(){W(l.last_text)?v=!0:L(")"===l.last_text&&T.break_chained_methods);M()},TK_UNKNOWN:function(){M(),"\n"===r[r.length-1]&&x()}},T={},void 0!==(t=t||{}).space_after_anon_function&&void 0===t.jslint_happy&&(t.jslint_happy=t.space_after_anon_function),void 0!==t.braces_on_own_line&&(T.brace_style=t.braces_on_own_line?"expand":"collapse"),T.brace_style=t.brace_style?t.brace_style:T.brace_style?T.brace_style:"collapse","expand-strict"===T.brace_style&&(T.brace_style="expand"),T.indent_size=t.indent_size?parseInt(t.indent_size,10):4,T.indent_char=t.indent_char?t.indent_char:" ",T.preserve_newlines=void 0===t.preserve_newlines||t.preserve_newlines,T.break_chained_methods=void 0!==t.break_chained_methods&&t.break_chained_methods,T.max_preserve_newlines=void 0===t.max_preserve_newlines?0:parseInt(t.max_preserve_newlines,10),T.space_in_paren=void 0!==t.space_in_paren&&t.space_in_paren,T.jslint_happy=void 0!==t.jslint_happy&&t.jslint_happy,T.keep_array_indentation=void 0!==t.keep_array_indentation&&t.keep_array_indentation,T.space_before_conditional=void 0===t.space_before_conditional||t.space_before_conditional,T.unescape_strings=void 0!==t.unescape_strings&&t.unescape_strings,T.wrap_line_length=void 0===t.wrap_line_length?0:parseInt(t.wrap_line_length,10),T.e4x=void 0!==t.e4x&&t.e4x,t.indent_with_tabs&&(T.indent_char="\t",T.indent_size=1),c="";T.indent_size>0;)c+=T.indent_char,T.indent_size-=1;for(;e&&(" "===e.charAt(0)||"\t"===e.charAt(0));)C+=e.charAt(0),e=e.substring(1);function I(e){if(e=void 0!==e&&e,a.length)for(P(a[a.length-1]);e&&a.length>1&&0===a[a.length-1].text.length;)a.pop(),P(a[a.length-1])}function P(e){for(;e.text.length&&(" "===e.text[e.text.length-1]||e.text[e.text.length-1]===c||e.text[e.text.length-1]===C);)e.text.pop()}function R(e){return e.replace(/^\s+|\s+$/g,"")}function k(){return 0===a[a.length-1].text.length}function L(e){if(e=void 0!==e&&e,T.wrap_line_length&&!e){var t=a[a.length-1];t.text.length>0&&t.text.join("").length+r.length+(v?1:0)>=T.wrap_line_length&&(e=!0)}(T.preserve_newlines&&E||e)&&!k()&&(x(!1,!0),G(l.mode)||q(l.mode)||(_=!0))}function x(e,t){if(_=!1,v=!1,!t&&";"!==l.last_text)for(;l.mode===w.Statement&&!l.if_block&&!l.do_block;)V();1===a.length&&k()||!e&&k()||(l.multiline_frame=!0,a.push({text:[]}))}function U(){if(k()){var e=a[a.length-1];if(T.keep_array_indentation&&G(l.mode)&&E){e.text.push("");for(var t=0;t<D.length;t+=1)e.text.push(D[t])}else C&&e.text.push(C),function(e){if(a.length>1){var t=a[a.length-1];l.line_indent_level=e;for(var n=0;n<e;n+=1)t.text.push(c)}}(l.indentation_level+(l.var_line&&l.var_line_reindented?1:0)+(_?1:0))}}function M(e){e=e||r,U(),_=!1,function(){var e=a[a.length-1];if(v&&e.text.length){var t=e.text[e.text.length-1];" "!==t&&t!==c&&e.text.push(" ")}}(),v=!1,a[a.length-1].text.push(e)}function j(){l.indentation_level+=1}function H(e){if(!e.multiline_frame)for(var t,n=e.start_line_index,r=0;n<a.length;)t=a[n],n++,0!==t.text.length&&(r=C&&t.text[0]===C?1:0,t.text[r]===c&&t.text.splice(r,1))}function B(e){l?(d.push(l),u=l):u=A(null,e),l=A(u,e)}function G(e){return e===w.ArrayLiteral}function q(e){return X(e,[w.Expression,w.ForInitializer,w.Conditional])}function V(){d.length>0&&(u=l,l=d.pop())}function F(){return l.mode===w.ObjectLiteral&&":"===l.last_text&&0===l.ternary_depth}function K(){return("do"===l.last_text||"else"===l.last_text&&"if"!==r||"TK_END_EXPR"===i&&(u.mode===w.ForInitializer||u.mode===w.Conditional))&&(L(X(r,["do","for","if","while"])),B(w.Statement),k()&&(j(),_=!1),!0)}function W(e){return X(e,["case","return","do","if","throw","else"])}function X(e,t){for(var n=0;n<t.length;n+=1)if(t[n]===e)return!0;return!1}function z(){var e;if(N=0,m>=S)return["","TK_EOF"];E=!1,D=[];var t=n.charAt(m);for(m+=1;X(t,p);){if("\n"===t?(N+=1,D=[]):N&&(t===c?D.push(c):"\r"!==t&&D.push(" ")),m>=S)return["","TK_EOF"];t=n.charAt(m),m+=1}if(X(t,f)){if(m<S)for(;X(n.charAt(m),f)&&(t+=n.charAt(m),(m+=1)!==S););if(m!==S&&t.match(/^[0-9]+[Ee]$/)&&("-"===n.charAt(m)||"+"===n.charAt(m))){var r=n.charAt(m);return m+=1,[t+=r+z()[0],"TK_WORD"]}return"in"===t?[t,"TK_OPERATOR"]:[t,"TK_WORD"]}if("("===t||"["===t)return[t,"TK_START_EXPR"];if(")"===t||"]"===t)return[t,"TK_END_EXPR"];if("{"===t)return[t,"TK_START_BLOCK"];if("}"===t)return[t,"TK_END_BLOCK"];if(";"===t)return[t,"TK_SEMICOLON"];if("/"===t){var o="",s=!0;if("*"===n.charAt(m)){if((m+=1)<S)for(;m<S&&("*"!==n.charAt(m)||!n.charAt(m+1)||"/"!==n.charAt(m+1))&&(o+=t=n.charAt(m),"\n"!==t&&"\r"!==t||(s=!1),!((m+=1)>=S)););return m+=2,s&&0===N?["/*"+o+"*/","TK_INLINE_COMMENT"]:["/*"+o+"*/","TK_BLOCK_COMMENT"]}if("/"===n.charAt(m)){for(o=t;"\r"!==n.charAt(m)&&"\n"!==n.charAt(m)&&(o+=n.charAt(m),!((m+=1)>=S)););return[o,"TK_COMMENT"]}}if("'"===t||'"'===t||("/"===t||T.e4x&&"<"===t&&n.slice(m-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&("TK_WORD"===i&&W(l.last_text)||"TK_END_EXPR"===i&&X(u.mode,[w.Conditional,w.ForInitializer])||X(i,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var d=t,g=!1,y=!1;if(e=t,m<S)if("/"===d){for(var _=!1;g||_||n.charAt(m)!==d;)if(e+=n.charAt(m),g?g=!1:(g="\\"===n.charAt(m),"["===n.charAt(m)?_=!0:"]"===n.charAt(m)&&(_=!1)),(m+=1)>=S)return[e,"TK_STRING"]}else if(T.e4x&&"<"===d){var v=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,O=n.slice(m-1),C=v.exec(O);if(C&&0===C.index){for(var A=C[2],I=0;C;){var P=!!C[1],k=C[2],L=!!C[C.length-1]||"![CDATA["===k.slice(0,8);if(k!==A||L||(P?--I:++I),I<=0)break;C=v.exec(O)}var x=C?C.index+C[0].length:O.length;return m+=x-1,[O.slice(0,x),"TK_STRING"]}}else for(;g||n.charAt(m)!==d;)if(e+=n.charAt(m),g?("x"!==n.charAt(m)&&"u"!==n.charAt(m)||(y=!0),g=!1):g="\\"===n.charAt(m),(m+=1)>=S)return[e,"TK_STRING"];if(m+=1,e+=d,y&&T.unescape_strings&&(e=function(e){for(var t,n=!1,a="",r=0,o="",i=0;n||r<e.length;)if(t=e.charAt(r),r++,n){if(n=!1,"x"===t)o=e.substr(r,2),r+=2;else{if("u"!==t){a+="\\"+t;continue}o=e.substr(r,4),r+=4}if(!o.match(/^[0123456789abcdefABCDEF]+$/))return e;if((i=parseInt(o,16))>=0&&i<32){a+="x"===t?"\\x"+o:"\\u"+o;continue}if(34===i||39===i||92===i)a+="\\"+String.fromCharCode(i);else{if("x"===t&&i>126&&i<=255)return e;a+=String.fromCharCode(i)}}else"\\"===t?n=!0:a+=t;return a}(e)),"/"===d)for(;m<S&&X(n.charAt(m),f);)e+=n.charAt(m),m+=1;return[e,"TK_STRING"]}if("#"===t){if(1===a.length&&0===a[0].text.length&&"!"===n.charAt(m)){for(e=t;m<S&&"\n"!==t;)e+=t=n.charAt(m),m+=1;return[R(e)+"\n","TK_UNKNOWN"]}var U="#";if(m<S&&X(n.charAt(m),b)){do{U+=t=n.charAt(m),m+=1}while(m<S&&"#"!==t&&"="!==t);return"#"===t||("["===n.charAt(m)&&"]"===n.charAt(m+1)?(U+="[]",m+=2):"{"===n.charAt(m)&&"}"===n.charAt(m+1)&&(U+="{}",m+=2)),[U,"TK_WORD"]}}if("<"===t&&"\x3c!--"===n.substring(m-1,m+3)){for(m+=3,t="\x3c!--";"\n"!==n.charAt(m)&&m<S;)t+=n.charAt(m),m++;return l.in_html_comment=!0,[t,"TK_COMMENT"]}if("-"===t&&l.in_html_comment&&"--\x3e"===n.substring(m-1,m+2))return l.in_html_comment=!1,m+=2,["--\x3e","TK_COMMENT"];if("."===t)return[t,"TK_DOT"];if(X(t,h)){for(;m<S&&X(t+n.charAt(m),h)&&(t+=n.charAt(m),!((m+=1)>=S)););return","===t?[t,"TK_COMMA"]:"="===t?[t,"TK_EQUALS"]:[t,"TK_OPERATOR"]}return[t,"TK_UNKNOWN"]}n=e,S=e.length,i="TK_START_BLOCK",s="",a=[{text:[]}],_=!1,v=!1,D=[],d=[],B(w.BlockStatement),m=0,this.beautify=function(){for(var e,t,n,c;e=z(),r=e[0],"TK_EOF"!==(o=e[1]);){if(n=T.keep_array_indentation&&G(l.mode),E=N>0,n)for(t=0;t<N;t+=1)x(t>0);else if(T.max_preserve_newlines&&N>T.max_preserve_newlines&&(N=T.max_preserve_newlines),T.preserve_newlines&&N>1)for(x(),t=1;t<N;t+=1)x(!0);O[o](),"TK_INLINE_COMMENT"!==o&&"TK_COMMENT"!==o&&"TK_BLOCK_COMMENT"!==o&&"TK_UNKNOWN"!==o&&(s=l.last_text,i=o,l.last_text=r),l.had_comment="TK_INLINE_COMMENT"===o||"TK_COMMENT"===o||"TK_BLOCK_COMMENT"===o}c=a[0].text.join("");for(var u=1;u<a.length;u++)c+="\n"+a[u].text.join("");return c=c.replace(/[\r\n ]+$/,"")}}void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()},184:function(e,t,n){e.exports=n.p+"dashboard.assets/img/logo-blue-no-title.png"},409:function(e,t,n){(function(e){var a,r,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o=function(){"use strict";var e,t,n=["webkit","Moz","ms","O"],a={};function r(e,t){var n,a=document.createElement(e||"div");for(n in t)a[n]=t[n];return a}function o(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function i(n,r,o,i){var s=["opacity",r,~~(100*n),o,i].join("-"),c=.01+o/i*100,l=Math.max(1-(1-n)/r*(100-c),n),u=e.substring(0,e.indexOf("Animation")).toLowerCase(),d=u&&"-"+u+"-"||"";return a[s]||(t.insertRule("@"+d+"keyframes "+s+"{0%{opacity:"+l+"}"+c+"%{opacity:"+n+"}"+(c+.01)+"%{opacity:1}"+(c+r)%100+"%{opacity:"+n+"}100%{opacity:"+l+"}}",t.cssRules.length),a[s]=1),s}function s(e,t){var a,r,o=e.style;if(void 0!==o[t=t.charAt(0).toUpperCase()+t.slice(1)])return t;for(r=0;r<n.length;r++)if(void 0!==o[a=n[r]+t])return a}function c(e,t){for(var n in t)e.style[s(e,n)||n]=t[n];return e}function l(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)void 0===e[a]&&(e[a]=n[a])}return e}function u(e,t){return"string"==typeof e?e:e[t%e.length]}var d,p={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};function f(e){this.opts=l(e||{},f.defaults,p)}if(f.defaults={},l(f.prototype,{spin:function(t){this.stop();var n=this,a=n.opts,o=n.el=r(null,{className:a.className});if(c(o,{position:a.position,width:0,zIndex:a.zIndex,left:a.left,top:a.top}),t&&t.insertBefore(o,t.firstChild||null),o.setAttribute("role","progressbar"),n.lines(o,n.opts),!e){var i,s=0,l=(a.lines-1)*(1-a.direction)/2,u=a.fps,d=u/a.speed,p=(1-a.opacity)/(d*a.trail/100),f=d/a.lines;!function e(){s++;for(var t=0;t<a.lines;t++)i=Math.max(1-(s+(a.lines-t)*f)%d*p,a.opacity),n.opacity(o,t*a.direction+l,i,a);n.timeout=n.el&&setTimeout(e,~~(1e3/u))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(t,n){var a,s=0,l=(n.lines-1)*(1-n.direction)/2;function d(e,t){return c(r(),{position:"absolute",width:n.scale*(n.length+n.width)+"px",height:n.scale*n.width+"px",background:e,boxShadow:t,transformOrigin:"left",transform:"rotate("+~~(360/n.lines*s+n.rotate)+"deg) translate("+n.scale*n.radius+"px,0)",borderRadius:(n.corners*n.scale*n.width>>1)+"px"})}for(;s<n.lines;s++)a=c(r(),{position:"absolute",top:1+~(n.scale*n.width/2)+"px",transform:n.hwaccel?"translate3d(0,0,0)":"",opacity:n.opacity,animation:e&&i(n.opacity,n.trail,l+s*n.direction,n.lines)+" "+1/n.speed+"s linear infinite"}),n.shadow&&o(a,c(d("#000","0 0 4px #000"),{top:"2px"})),o(t,o(a,d(u(n.color,s),"0 0 1px rgba(0,0,0,.1)")));return t},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),"undefined"!=typeof document){d=r("style",{type:"text/css"}),o(document.getElementsByTagName("head")[0],d),t=d.sheet||d.styleSheet;var h=c(r("group"),{behavior:"url(#default#VML)"});!s(h,"transform")&&h.adj?function(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}t.addRule(".spin-vml","behavior:url(#default#VML)"),f.prototype.lines=function(t,n){var a=n.scale*(n.length+n.width),r=2*n.scale*a;function i(){return c(e("group",{coordsize:r+" "+r,coordorigin:-a+" "+-a}),{width:r,height:r})}var s,l=-(n.width+n.length)*n.scale*2+"px",d=c(i(),{position:"absolute",top:l,left:l});function p(t,r,s){o(d,o(c(i(),{rotation:360/n.lines*t+"deg",left:~~r}),o(c(e("roundrect",{arcsize:n.corners}),{width:a,height:n.scale*n.width,left:n.scale*n.radius,top:-n.scale*n.width>>1,filter:s}),e("fill",{color:u(n.color,t),opacity:n.opacity}),e("stroke",{opacity:0}))))}if(n.shadow)for(s=1;s<=n.lines;s++)p(s,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(s=1;s<=n.lines;s++)p(s);return o(t,d)},f.prototype.opacity=function(e,t,n,a){var r=e.firstChild;a=a.shadow&&a.lines||0,r&&t+a<r.childNodes.length&&(r=(r=(r=r.childNodes[t+a])&&r.firstChild)&&r.firstChild)&&(r.opacity=n)}}():e=s(h,"animation")}return f},"object"==i(e)&&e.exports?e.exports=o():void 0===(r="function"==typeof(a=o)?a.call(t,n,t,e):a)||(e.exports=r)}).call(this,n(88)(e))},413:function(e,t,n){n(414),n(444),n(447),n(449),n(481),n(484),n(494),e.exports=n(845)},526:function(e,t,n){},527:function(e,t,n){},528:function(e,t,n){},695:function(e,t,n){},705:function(e,t,n){},706:function(e,t,n){},707:function(e,t,n){},725:function(e,t,n){},730:function(e,t,n){},731:function(e,t,n){},732:function(e,t,n){},733:function(e,t,n){},734:function(e,t,n){},735:function(e,t,n){},736:function(e,t,n){},741:function(e,t,n){},742:function(e,t,n){},743:function(e,t,n){},744:function(e,t,n){},745:function(e,t,n){},746:function(e,t,n){},747:function(e,t,n){},844:function(e,t,n){},845:function(e,t,n){"use strict";n.r(t);var a=n(19),r=n.n(a),o={root:"/",version:"1.0.dev",host:"/",i18n:{en_US:{"mango-descripton":"Cloudant Query is a JSON-query syntax for quickly finding documents. You must create indexes before you can run Cloudant Query.","all-mango-indexes":"All Query Indexes","new-mango-index":"Query Indexes","mango-help-title":"Cloudant Query","run-query-with-mango":"Query","mango-title-editor":"Cloudant Query","mango-descripton-index-editor":'The example in the editor shows how to index the field "foo" using the json type index. You can automatically index all the fields in all of your documents using a text type index with the syntax \'{ "index": {}, "type": "text" }\', Note that indexing all fields can be resource consuming on large data sets.<br/><br/>Created indexes are displayed on the right.',"mango-additional-indexes-heading":"Your Search Indexes","mango-find-heading":"Cloudant Query","mango-indexeditor-title":"Cloudant Query","cors-disable-cors-prompt":"Are you sure? Disabling CORS will overwrite your specific origin domains.","cors-notice":"Cross-Origin Resource Sharing (CORS) lets you connect to remote servers directly from the browser. Using CORS, you can host browser-based apps on static pages, and load data directly from Cloudant.","replication-password-modal-header":"Enter Local-Account Password","replication-password-modal-text":"Replication requires authentication on your local account.","replication-user-password-auth-label":"Cloudant Username or API Key","replication-username-input-placeholder":"Username or API Key","replication-password-input-placeholder":"Password","auth-missing-credentials":"Username or password cannot be blank.","auth-incorrect-credentials":"Name or password is incorrect.","auth-passwords-not-match":"Passwords do not match.","auth-logged-out":"You have been logged out.","create-db-partitioned-help":"A partitioned database requires a partition key for every document, where the document _id format is '&lt;partition_key&gt;:&lt;doc_key&gt;'. A partition is a logical grouping of documents. Use of partition queries can reduce the cost per query by up to 20X and significantly improve response times over global queries. See <a href='https://cloud.ibm.com/docs/services/Cloudant?topic=cloudant-database-partitioning' target='_blank'>guide</a> for more details."}}},i=n(9),s=n.n(i),c={MISC:{TRAY_TOGGLE_SPEED:250,DEFAULT_PAGE_SIZE:20},DATABASES:{DOCUMENT_LIMIT:100},EVENTS:{TRAY_OPENED:"tray:opened",NAVBAR_SIZE_CHANGED:"navbar:size_changed"},DOC_URLS:{GENERAL:"./docs/intro/api.html#documents",ALL_DBS:"./docs/api/server/common.html?highlight=all_dbs#get--_all_dbs",REPLICATION:"./docs/replication/replicator.html#basics",DESIGN_DOCS:"./docs/ddocs/ddocs.html#design-docs",DESIGN_DOC_METADATA:"./docs/api/ddoc/common.html#api-ddoc-view-index-info",VIEW_FUNCS:"./docs/ddocs/ddocs.html#view-functions",MAP_FUNCS:"./docs/ddocs/ddocs.html#map-functions",REDUCE_FUNCS:"./docs/ddocs/ddocs.html#reduce-and-rereduce-functions",API_REF:"./docs/http-api.html",DB_PERMISSION:"./docs/api/database/security.html#db-security",STATS:"./docs/api/server/common.html?highlight=stats#get--_stats",ACTIVE_TASKS:"./docs/api/server/common.html?highlight=stats#active-tasks",LOG:"./docs/api/server/common.html?highlight=stats#log",CONFIG:"./docs/config/index.html",VIEWS:"./docs/intro/overview.html#views",MANGO_INDEX:"./docs/intro/api.html#documents",MANGO_SEARCH:"./docs/intro/api.html#documents",CHANGES:"./docs/api/database/changes.html?highlight=changes#post--db-_changes",SETUP:"./docs/cluster/setup.html#the-cluster-setup-wizard",MEMBERSHIP:"./docs/cluster/nodes.html"}},l=n(258),u=n.n(l),d={getParams:function(e){e&&("?"===e.substring(0,1)?e=e.substring(1):e.indexOf("?")>-1&&(e=e.split("?")[1]));var t=window.location.hash.split("?")[1];e=e||t||window.location.search.substring(1);var n={},a=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(a," "))},i=e;if(e)for(var s;s=r.exec(i);)n[o(s[1])]=o(s[2]);return n},removeSpecialCharacters:function(e){return e.replace(/[^\w\s]/gi,"")},safeURLName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return encodeURIComponent(e)},queryParams:function(e){return u()(e)},queryString:function(e){return Object.keys(e).forEach((function(t){void 0===e[t]&&delete e[t]})),u()(e)},getDocTypeFromId:function(e){return e&&/^_design\//.test(e)?"design doc":"doc"},isSystemDatabase:function(e){return/^_/.test(e)},getSafeIdForDoc:function(e){if("design doc"===d.getDocTypeFromId(e)){var t=e.replace(/^_design\//,"");return"_design/"+d.safeURLName(t)}return d.safeURLName(e)},localStorageSet:function(e,t){(s.a.isObject(t)||s.a.isArray(t))&&(t=JSON.stringify(t));var n=!0;try{window.localStorage.setItem(e,t)}catch(e){n=!1}return n},localStorageGet:function(e){var t;if(s.a.has(window.localStorage,e)){t=window.localStorage[e];try{return JSON.parse(t)}catch(e){return t}}return t},stripHTML:function(e){if(!document)return e;var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText}},p=d,f=n(18),h=n.n(f),m=n(259),g=n.n(m),b=(n(150),n(393)),y=(n(512),new b.Subject),E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return fetch(e,Object(i.defaultsDeep)({},n,{method:t,credentials:"include",headers:{accept:"application/json","Content-Type":"application/json",Pragma:"no-cache"},cache:"no-cache"})).then((function(e){return y.next(e),n.raw?e:e.json()}))},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E(e,"GET",t)},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return E(e,"DELETE",t)},N=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==t&&(n.rawBody?n.body=t:n.body=JSON.stringify(t)),E(e,"POST",n)},D=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return void 0!==t&&(n.rawBody?n.body=t:n.body=JSON.stringify(t)),E(e,"PUT",n)},O=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return E(e,t,Object(i.defaultsDeep)({},n,{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}}))},w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t&&(n.body=t),O(e,"POST",n)},T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t&&(n.body=t),O(e,"DELETE",n)},C={};C.removeSpecialCharacters=p.removeSpecialCharacters,C.safeURL=p.safeURLName,C.imageUrl=function(e){return e},C.getDocUrl=function(e){return s.a.has(c.DOC_URLS,e)?c.DOC_URLS[e]:"#"},C.formatSize=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=512;if(e<n)return e+" bytes";for(var a=["KB","MB","GB","TB","PB","EB","ZB","YB"],r=0;e>=n&&r<a.length;)r+=1,e/=1024;return e.toFixed(t)+" "+a[r-1]},C.formatDate=function(e){return h()(e,"X").format("MMM Do, h:mm:ss a")},C.getDateFromNow=function(e){return h()(e,"X").fromNow()},C.escapeJQuerySelector=function(e){return e&&e.replace(/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~]/g,"\\$&")},C.getApiUrl=function(e){return o.host.endsWith("/")&&e.startsWith("/")&&(e=e.substr(1)),g.a.resolve(window.location.href,o.host+e)},C.getServerUrl=function(e){return o.host.endsWith("/")&&e.startsWith("/")&&(e=e.substr(1)),o.host+e},C.getRootUrl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,t=e.origin,n=e.pathname;return g.a.resolve(t+n,o.host)},C.getUUID=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=C.getServerUrl("/_uuids?count=".concat(e));return v(t)},C.isIE1X=function(){return 11==document.documentMode||10==document.documentMode};var A=C,I=n(26),P=n.n(I);function R(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var U={router:{navigate:function(){}},masterLayout:{},addHeaderLink:function(e){U.reduxDispatch({type:"ADD_NAVBAR_LINK",link:e})},showHeaderLinkBadge:function(e){U.reduxDispatch({type:"SHOW_NAVBAR_LINK_BADGE",link:e})},hideHeaderLinkBadge:function(e){U.reduxDispatch({type:"HIDE_NAVBAR_LINK_BADGE",link:e})},addNotification:function(e){e=x({msg:"Notification Event Triggered!",type:"info",escape:!0,clear:!1},e),U.reduxDispatch&&U.reduxDispatch({type:"ADD_NOTIFICATION",options:{info:e}})},showPermanentNotification:function(e){U.reduxDispatch({type:"SHOW_PERMANENT_NOTIFICATION",options:{msg:e}})},config:function(e){return s.a.extend(this,e)},Deferred:function(){return $.Deferred()},when:function(e){return e instanceof Array?$.when.apply(null,e):$.when(e)},addonExtensions:{initialize:function(){},RouteObjects:{},Views:{}},addon:function(e){return s.a.extend(s.a.clone(U.addonExtensions),e)}};U.View=P.a.View.extend({establish:function(){return null},loaderClassname:"loader",manage:!0,forceRender:function(){this.hasRendered=!1}});var M={fetchOnce:function(e){var t=s.a.extend({},e);return this._deferred&&"rejected"!==this._deferred.state()&&!t.forceFetch||(this._deferred=this.fetch()),this._deferred}};U.Model=P.a.Model.extend({}),U.Collection=P.a.Collection.extend({}),s.a.each([U.Model,U.Collection],(function(e){s.a.extend(e.prototype,M)}));var j=s.a.extend({},P.a.Events);U.registerExtension=function(e,t){j[e]||(j[e]=[]),j.trigger("add:"+e,t),j[e].push(t)},U.unRegisterExtension=function(e){var t=j[e];t&&(j.trigger("remove:"+e,t),delete j[e])},U.getExtensions=function(e){var t=j[e];return t||(t=[]),t},U.removeExtensionItem=function(e,t,n){var a=j[e];if(a){var r=arguments[arguments.length-1];s.a.isObject(t)&&!n&&(r=function(e){return s.a.isEqual(e,t)}),a=s.a.filter(a,(function(e){return!r(e)})),j[e]=a,j.trigger("removeItem:"+e,t)}},U.extensions=j,U.setSession=function(e){U.session=e},U.reducers={},U.addReducers=function(e){U.reducers=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(n,!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},U.reducers,{},e)},U.middlewares=[],U.addMiddleware=function(e){e&&"function"==typeof e&&U.middlewares.push(e)};var H=U,B=n(77),G=n.n(B),q=function(e,t){if(e.isAdminParty())return!0;if(e.matchesRoles(t))return!0;throw new Error("Unable to authenticate")},V=function(){var e=window.location.hash.replace("#","").replace("login?urlback=","");e&&H.navigate("/login?urlback=".concat(e),{replace:!0}),H.navigate("/login",{replace:!0})},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new G.a((function(t,n){return H.session.getSession().then((function(){q(H.session,e)?t():n()})).catch((function(e){n(e),V()}))}))},K={},W=P.a.Router.extend({routes:{},originalPageTitle:window.document.title,beforeUnload:function(e,t){K[e]=t},removeBeforeUnload:function(e){delete K[e]},navigate:function(e,t){var n=!0,a=s.a.find(s.a.map(K,(function(e){return e()})),(function(e){if(e)return!0}));if(a&&(n=window.confirm(a)),t&&t.redirect)return window.location=e;n&&(P.a.Router.prototype.navigate(e,t),this.updateWindowTitle(e))},updateWindowTitle:function(e){e.startsWith("#/")?window.document.title=this.originalPageTitle+" - "+e.substring(2):e.startsWith("/")||e.startsWith("#")?window.document.title=this.originalPageTitle+" - "+e.substring(1):window.document.title=this.originalPageTitle+" - "+e},addModuleRouteObject:function(e){var t=this,n=this;e.prototype.getRouteUrls().forEach((function(a){t.route(a,a.toString(),(function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var s=e.prototype.getRouteRoles(a);F(s).then((function(){n.activeRouteObject&&n.activeRouteObject.hasRoute(a)||(n.activeRouteObject=new e(a,o));var r=n.activeRouteObject.routeCallback(a,o);n.currentRouteOptions={selectedHeader:t.activeRouteObject.selectedHeader,component:r,roles:s,route:a.toString()},n.trigger("new-component",t.currentRouteOptions)}),(function(){}))}))}))},setModuleRoutes:function(e){var t=this;s.a.each(e,(function(e){e&&(e.initialize(),e.RouteObjects&&s.a.each(e.RouteObjects,t.addModuleRouteObject.bind(t)))}))},initialize:function(e){this.addons=e,this.setModuleRoutes(e),this.lastPages=[],P.a.history.on("route",(function(){this.lastPages.push(P.a.history.fragment),this.lastPages.length>5&&this.lastPages.shift()}),this)}}),X=n(10),z=n.n(X);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Q=function(e){this._options=e,this.reactComponents={},this._configure(e||{}),this.initialize.apply(this,arguments)};Q.extend=P.a.Model.extend;var J=["routes","roles"];s.a.extend(Q.prototype,{routes:{},route:function(){},roles:[],initialize:function(){}},{get:function(e){return s.a.isFunction(this[e])?this[e]():this[e]},_configure:function(e){var t=this;s.a.each(s.a.intersection(s.a.keys(e),J),(function(n){t[n]=e[n]}))},getRouteUrls:function(){return s.a.keys(this.get("routes"))},hasRoute:function(e){return!!this.get("routes")[e]},routeCallback:function(e,t){var n,a=this.get("routes")[e];return n="object"===Y(a)?this[a.route]:this[a],n.apply(this,t)},getRouteRoles:function(e){var t=this.get("routes")[e];return"object"===Y(t)&&t.roles?t.roles:this.roles}});var Z=Q,ee=function(){this.initialize.apply(this,arguments),s.a.bindAll(this)};ee.extend=P.a.Model.extend,s.a.extend(ee.prototype,P.a.Events,{triggerChange:function(){this.trigger("change")},initialize:function(){}});var te=ee,ne=[],ae=0,re={register:function(e){if("function"!=typeof e)throw new Error("Store dispatch method must be a function");return ae+=1,ne.push(e),e.dispatchId=ae,ae},dispatch:function(e){ne.forEach((function(t){t(e)}))},unregister:function(e){var t=Object(i.findIndex)(ne,(function(t){return t.dispatchId===e}));-1!==t&&ne.splice(t,1)}};function oe(){return(oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}P.a.$=r.a,P.a.ajax=function(){return P.a.$.ajax.apply(P.a.$,arguments)},oe(H,{Router:W,RouteObject:Z,utils:p,Store:te,dispatcher:re,Promise:G.a,Events:s.a.extend({},P.a.Events)}),H.constants=c,H.dispatch=re.dispatch,H.navigate=function(e,t){var n=s.a.extend({trigger:!0},t);H.router.navigate(e,n),n.trigger&&H.router.trigger("trigger-update")},H.beforeUnload=function(){H.router.beforeUnload.apply(H.router,arguments)},H.removeBeforeUnload=function(){H.router.removeBeforeUnload.apply(H.router,arguments)},H.addRoute=function(e){H.router.route(e.route,e.name,e.callback)};var ie={};H.registerUrls=function(e,t){ie[e]=t},H.url={encode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/[$+/]/g.test(e)?encodeURIComponent(e):e},decode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/[$+/]/g.test(e)?decodeURIComponent(e):e}},H.urls=function(e,t){var n,a=H.getExtensions("urls:interceptors"),r=arguments;return s.a.find(a,(function(e){var t=e.apply(null,r);return!!t&&(n=t,!0)})),s.a.isUndefined(n)?ie[e]?ie[e][t]?(r=Array.prototype.slice.call(arguments,2),n=ie[e][t].apply(null,r)):(console.error("could not find context ",t),""):(console.error("could not find name ",e),""):n},H.getIndexTypePropNames=function(){var e=H.getExtensions("IndexTypes:propNames");return e.push("views"),e};var se=H;n(526);function ce(){return(ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}s.a.isUndefined(console)&&(console={log:function(){},trace:function(){},debug:function(){}}),ce(o,{utils:p,getParams:se.utils.getParams,helpers:A}),se.config({addHeaderLink:function(e){se.reduxDispatch({type:"ADD_NAVBAR_LINK",link:e})},updateHeaderLink:function(e){se.reduxDispatch({type:"UPDATE_NAVBAR_LINK",link:e})},removeHeaderLink:function(e){se.reduxDispatch({type:"REMOVE_NAVBAR_LINK",link:e})},hideLogin:function(){se.reduxDispatch({type:"NAVBAR_SHOW_HIDE_LOGIN_LOGOUT_SECTION",visible:!1})},showLogout:function(){se.reduxDispatch({type:"NAVBAR_SHOW_LOGOUT_BUTTON"})},showLogin:function(){se.reduxDispatch({type:"NAVBAR_SHOW_LOGIN_BUTTON"})}});var le=o,ue=n(0),de=n.n(ue),pe={ADD_NAVBAR_LINK:"ADD_NAVBAR_LINK",TOGGLE_NAVBAR_MENU:"TOGGLE_NAVBAR_MENU",UPDATE_NAVBAR_LINK:"UPDATE_NAVBAR_LINK",REMOVE_NAVBAR_LINK:"REMOVE_NAVBAR_LINK",HIDE_NAVBAR_LINK_BADGE:"HIDE_NAVBAR_LINK_BADGE",SHOW_NAVBAR_LINK_BADGE:"SHOW_NAVBAR_LINK_BADGE",NAVBAR_SET_VERSION_INFO:"NAVBAR_SET_VERSION_INFO",NAVBAR_ACTIVE_LINK:"NAVBAR_ACTIVE_LINK",NAVBAR_HIDE:"NAVBAR_HIDE",NAVBAR_SHOW:"NAVBAR_SHOW",NAVBAR_SHOW_HIDE_LOGIN_LOGOUT_SECTION:"NAVBAR_SHOW_HIDE_LOGIN_LOGOUT_SECTION",NAVBAR_SHOW_LOGIN_BUTTON:"NAVBAR_SHOW_LOGIN_BUTTON",NAVBAR_SHOW_LOGOUT_BUTTON:"NAVBAR_SHOW_LOGOUT_BUTTON"};function fe(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(n,!0).forEach((function(t){me(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ge={isMinimized:!0,activeLink:null,version:null,navLinks:[],footerNavLinks:[],bottomNavLinks:[],navBarVisible:!0,loginSectionVisible:!1,loginVisibleInsteadOfLogout:!0};function be(e,t,n){var a=ye(e,t),r=a.links,o=a.sectionName,i=!1,s=r.map((function(e){return e.title===t.title?(i=!0,he({},e,{badge:n})):e}));if(!i)return e;var c=he({},e);return c[o]=s,c}function ye(e,t){var n=e.navLinks,a="navLinks";return t.bottomNav&&(n=e.bottomNavLinks,a="bottomNavLinks"),t.footerNav&&(n=e.footerNavLinks,a="footerNavLinks"),{links:n,sectionName:a}}var Ee={ADD_NOTIFICATION:"ADD_NOTIFICATION",SHOW_NOTIFICATION_CENTER:"SHOW_NOTIFICATION_CENTER",HIDE_NOTIFICATION_CENTER:"HIDE_NOTIFICATION_CENTER",CLEAR_SINGLE_NOTIFICATION:"CLEAR_SINGLE_NOTIFICATION",CLEAR_ALL_NOTIFICATIONS:"CLEAR_ALL_NOTIFICATIONS",SELECT_NOTIFICATION_FILTER:"SELECT_NOTIFICATION_FILTER",START_HIDING_NOTIFICATION:"START_HIDING_NOTIFICATION",HIDE_NOTIFICATION:"HIDE_NOTIFICATION",HIDE_ALL_NOTIFICATIONS:"HIDE_ALL_NOTIFICATIONS",SHOW_PERMANENT_NOTIFICATION:"SHOW_PERMANENT_NOTIFICATION",HIDE_PERMANENT_NOTIFICATION:"HIDE_PERMANENT_NOTIFICATION"};function _e(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(n,!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ne={notifications:[],notificationCenterVisible:!1,selectedNotificationFilter:"all",permanentNotificationVisible:!1,permanentNotificationMessage:""},De=0,Oe=["success","error","info"],we=["all","success","error","info"];function Te(e,t){var n=e.notifications,a=n.findIndex((function(e){return e.notificationId===t}));if(-1===a)return n;var r=[].concat(n);return r.splice(a,1),r}function Ce(e,t){var n=e.notifications,a=n.findIndex((function(e){return e.notificationId===t}));if(-1===a)return n;var r=[].concat(n);return r[a].isHiding=!0,r}function Ae(e,t){var n=e.notifications,a=n.findIndex((function(e){return e.notificationId===t}));if(-1===a)return n;var r=[].concat(n);return r[a].visible=!1,r[a].isHiding=!1,r}function Ie(e){var t=e.notifications,n=[].concat(t);return n.forEach((function(e){e.visible&&(e.isHiding=!0)})),n}n(527);var Pe=se.addon();Pe.initialize=function(){var e=new Pe.VersionInfo;e.fetch().then((function(){!function(e){se.reduxDispatch({type:pe.NAVBAR_SET_VERSION_INFO,version:e})}(e.get("version"))}))},Pe.VersionInfo=Backbone.Model.extend({url:function(){return le.host}}),se.addReducers({navigation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pe.ADD_NAVBAR_LINK:return function(e,t){var n=he({},e);return t.top&&!t.bottomNav?(n.navLinks=[].concat(n.navLinks),n.navLinks.unshift(t),n):t.top&&t.bottomNav?(n.bottomNavLinks=[].concat(n.bottomNavLinks),n.bottomNavLinks.unshift(t),n):t.bottomNav?(n.bottomNavLinks=[].concat(n.bottomNavLinks),n.bottomNavLinks.push(t),n):t.footerNav?(n.footerNavLinks=[].concat(n.footerNavLinks),n.footerNavLinks.push(t),n):(n.navLinks=[].concat(n.navLinks),n.navLinks.push(t),n)}(e,t.link);case pe.TOGGLE_NAVBAR_MENU:return he({},e,{isMinimized:!e.isMinimized});case pe.UPDATE_NAVBAR_LINK:return function(e,t){var n=ye(e,t),a=n.links,r=n.sectionName,o=!1,i=a.map((function(e){return e.id===t.id?(o=!0,he({},e,{title:t.title,href:t.href})):e}));if(!o)return e;var s=he({},e);return s[r]=i,s}(e,t.link);case pe.REMOVE_NAVBAR_LINK:return function(e,t){var n=ye(e,t),a=n.links,r=n.sectionName,o=a.filter((function(e){return e.id!==t.id}));if(o.length===a.length)return e;var i=he({},e);return i[r]=o,i}(e,t.link);case pe.SHOW_NAVBAR_LINK_BADGE:return be(e,t.link,!0);case pe.HIDE_NAVBAR_LINK_BADGE:return be(e,t.link,!1);case pe.NAVBAR_SET_VERSION_INFO:return he({},e,{version:t.version});case pe.NAVBAR_ACTIVE_LINK:return he({},e,{activeLink:t.name});case pe.NAVBAR_HIDE:return he({},e,{navBarVisible:!1});case pe.NAVBAR_SHOW:return he({},e,{navBarVisible:!0});case pe.NAVBAR_SHOW_HIDE_LOGIN_LOGOUT_SECTION:return he({},e,{loginSectionVisible:t.visible});case pe.NAVBAR_SHOW_LOGIN_BUTTON:return he({},e,{loginSectionVisible:!0,loginVisibleInsteadOfLogout:!0});case pe.NAVBAR_SHOW_LOGOUT_BUTTON:return he({},e,{loginSectionVisible:!0,loginVisibleInsteadOfLogout:!1});default:return e}},notifications:function(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,r=arguments.length>1?arguments[1]:void 0,o=r.options;switch(r.type){case Ee.ADD_NOTIFICATION:return-1===Oe.indexOf(o.info.type)?a:ve({},a,{notifications:(e=a,t=o.info,n=e.notifications.slice(),(t=ve({},t)).notificationId=++De,t.cleanMsg=le.utils.stripHTML(t.msg),t.time=h()(),!0!==t.escape&&!1!==t.escape&&(t.escape=!0),t.visible=!0,t.isHiding=!1,t.clear&&n.forEach((function(e){e.visible&&(e.isHiding=!0)})),n.unshift(t),n)});case Ee.CLEAR_ALL_NOTIFICATIONS:return ve({},a,{notifications:[]});case Ee.CLEAR_SINGLE_NOTIFICATION:return ve({},a,{notifications:Te(a,o.notificationId)});case Ee.START_HIDING_NOTIFICATION:return ve({},a,{notifications:Ce(a,o.notificationId)});case Ee.HIDE_NOTIFICATION:return ve({},a,{notifications:Ae(a,o.notificationId)});case Ee.HIDE_ALL_NOTIFICATIONS:return ve({},a,{notifications:Ie(a)});case Ee.SHOW_NOTIFICATION_CENTER:return ve({},a,{notificationCenterVisible:!0});case Ee.HIDE_NOTIFICATION_CENTER:return ve({},a,{notificationCenterVisible:!1});case Ee.SELECT_NOTIFICATION_FILTER:return-1===we.indexOf(o.filter)?a:ve({},a,{selectedNotificationFilter:o.filter});case Ee.SHOW_PERMANENT_NOTIFICATION:return ve({},a,{permanentNotificationVisible:!0,permanentNotificationMessage:o.msg});case Ee.HIDE_PERMANENT_NOTIFICATION:return ve({},a,{permanentNotificationVisible:!1});default:return a}}});var Re=Pe,ke=(n(528),{DATABASES_SETPAGE:"DATABASES_SETPAGE",DATABASES_SETLIMIT:"DATABASES_SETLIMIT",DATABASES_SET_PROMPT_VISIBLE:"DATABASES_SET_PROMPT_VISIBLE",DATABASES_STARTLOADING:"DATABASES_STARTLOADING",DATABASES_LOADCOMPLETE:"DATABASES_LOADCOMPLETE",DATABASES_UPDATE:"DATABASES_UPDATE",DATABASES_PARTITIONED_DB_AVAILABLE:"DATABASES_PARTITIONED_DB_AVAILABLE",DATABASES_FETCH_SELECTED_DB_METADATA:"DATABASES_FETCH_SELECTED_DB_METADATA",DATABASES_FETCH_SELECTED_DB_METADATA_SUCCESS:"DATABASES_FETCH_SELECTED_DB_METADATA_SUCCESS"}),Le=P.a.Collection.extend({constructor:function(){P.a.Collection.apply(this,arguments),this.configure.apply(this,arguments)},configure:function(e,t){var n=s.a.result(this,"url").split("?")[1]||"";this.paging=s.a.defaults(t.paging||{},{defaultParams:s.a.defaults({},t.params,this._parseQueryString(n)),hasNext:!1,hasPrevious:!1,params:{},pageSize:20,direction:void 0}),this.paging.params=s.a.clone(this.paging.defaultParams),this.updateUrlQuery(this.paging.defaultParams)},calculateParams:function(e,t,n){var a=s.a.clone(e);return a.skip=(parseInt(e.skip,10)||0)+t,this.paging.defaultParams.limit&&(a.limit=Math.min(this.paging.defaultParams.limit,a.limit)),a.limit=n+1,a.skip=Math.max(a.skip,0),a},pageSizeReset:function(e,t){var n=s.a.defaults(t||{},{fetch:!0});if(this.paging.direction=void 0,this.paging.pageSize=e,this.paging.params=this.paging.defaultParams,this.paging.params.limit=e,this.updateUrlQuery(this.paging.params),n.fetch)return this.fetch()},_parseQueryString:function(e){var t=decodeURI(e).split(/&/);return s.a.reduce(t,(function(e,t){var n=t.split(/=/);return 2===n.length&&(e[n[0]]=n[1]),e}),{})},_iterate:function(e,t){var n=s.a.defaults(t||{},{fetch:!0});if(this.paging.params=this.calculateParams(this.paging.params,e,this.paging.pageSize),this.updateUrlQuery(this.paging.params),n.fetch)return this.fetch({reset:!0})},next:function(e){return this.paging.direction="next",this._iterate(this.paging.pageSize,e)},previous:function(e){return this.paging.direction="previous",this._iterate(0-this.paging.pageSize,e)},shouldStringify:function(e){try{return JSON.parse(e),!1}catch(e){return!0}},updateUrlQuery:function(e){var t=this,n=s.a.result(this,"url").split("?")[0];s.a.each(["startkey","endkey","key"],(function(n){s.a.has(e,n)&&t.shouldStringify(e[n])&&(e[n]=JSON.stringify(e[n]))})),this.url=n+"?"+le.utils.queryParams(e)},fetch:function(){return!this.paging.direction&&this.paging.params.limit>0&&(this.paging.direction="fetch",this.paging.params.limit=this.paging.params.limit+1,this.updateUrlQuery(this.paging.params)),P.a.Collection.prototype.fetch.apply(this,arguments)},parse:function(e){var t=e.rows;return this.paging.hasNext=this.paging.hasPrevious=!1,this.viewMeta={total_rows:e.total_rows,offset:e.offset,update_seq:e.update_seq},this.paging.params.skip>0&&(this.paging.hasPrevious=!0),t.length===this.paging.pageSize+1&&(this.paging.hasNext=!0,t.pop(),this.viewMeta.total_rows=this.viewMeta.total_rows-1),t},hasNext:function(){return this.paging.hasNext},hasPrevious:function(){return this.paging.hasPrevious}});function xe(){return(xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Ue=se.addon();Ue.Doc=se.Model.extend({idAttribute:"_id",documentation:function(){return se.constants.DOC_URLS.GENERAL},url:function(e){void 0===e&&(e="server");var t=this.safeID();t||(t="");var n=this.fetchConflicts?"?conflicts=true":"";return se.urls("document",e,this.getDatabase().safeID(),t,n)},initialize:function(e,t){this.collection&&this.collection.database?this.database=this.collection.database:t.database&&(this.database=t.database),t.fetchConflicts&&(this.fetchConflicts=!0),this.partitionKey=t.partitionKey},getDatabase:function(){return this.database?this.database:this.collection.database},validate:function(e){if(this.id&&this.id!==e._id&&this.get("_rev"))return"Cannot change a documents id."},docType:function(){return le.utils.getDocTypeFromId(this.id)},isBulkDeletable:function(){return!!this.id&&!!this.get("_rev")},isDeletable:function(){return!!this.id},isFromView:function(){return!this.id},isMangoDoc:function(){return!!this.isDdoc()&&("query"===this.get("language")||!(!this.get("doc")||"query"!==this.get("doc").language))},isDdoc:function(){return"design doc"===this.docType()},setDDocPartitionedOption:function(e){if(!this.isDdoc())return!1;var t=this.get("options");return t||(t={}),t.partitioned=e,this.set({options:t}),!0},setDdocView:function(e,t,n){if(!this.isDdoc())return!1;var a=this.get("views");a||(a={},this.set({language:"javascript"}));var r=a[e]||{};return n?r.reduce=n:delete r.reduce,r.map=t,a[e]=r,this.set({views:a}),!0},removeDdocView:function(e){if(!this.isDdoc())return!1;var t=this.get("views");delete t[e],this.set({views:t})},dDocModel:function(){if(!this.isDdoc())return!1;var e=this.get("doc");return e?(e._rev=this.get("_rev"),new Ue.Doc(e,{database:this.database})):this},safeID:function(){return le.utils.getSafeIdForDoc(this.id)},destroy:function(){var e=this.url()+"?rev="+this.get("_rev");return S(e).then((function(e){if(e.error)throw new Error(e.reason||e.error);return e}))},parse:function(e){return e.rev&&(e._rev=e.rev,delete e.rev),e.id&&_.isUndefined(this.id)&&(e._id=e.id),e.ok&&(delete e.id,delete e.ok),e},prettyJSON:function(){var e=this.get("doc")?this.get("doc"):this.attributes;return JSON.stringify(e,null,"  ")},copy:function(e){var t=xe({},this.attributes,{_id:e});return delete t._rev,new this.constructor(t,{database:this.database}).save()},isNewDoc:function(){return!this.get("_rev")}}),Ue.AllDocs=Le.extend({model:Ue.Doc,documentation:function(){return se.constants.DOC_URLS.GENERAL},initialize:function(e,t){this.viewMeta=t.viewMeta,this.database=t.database,this.params=_.clone(t.params),this.on("remove",this.decrementTotalRows,this),this.perPageLimit=t.perPageLimit||20,this.params.limit||(this.params.limit=this.perPageLimit)},isEditable:function(){return!0},urlRef:function(e,t){var n="";return t?n=_.isEmpty(t)?"":"?"+le.utils.queryParams(t):this.params&&(n="?"+le.utils.queryParams(this.params)),_.isUndefined(e)&&(e="server"),se.urls("allDocs",e,this.database.safeID(),n)},url:function(){return this.urlRef.apply(this,arguments)},simple:function(){var e=this.map((function(e){return{_id:e.id,_rev:e.get("_rev")}}));return new Ue.AllDocs(e,{database:this.database,params:this.params})},totalRows:function(){return this.viewMeta.total_rows||"unknown"},decrementTotalRows:function(){this.viewMeta.total_rows&&(this.viewMeta.total_rows=this.viewMeta.total_rows-1,this.trigger("totalRows:decrement"))},updateSeq:function(){return this.viewMeta&&this.viewMeta.update_seq||!1},parse:function(e){var t=e.rows,n=_.filter(t,(function(e){return e.value}));return e.rows=_.map(n,(function(e){var t={_id:e.id,_rev:e.value.rev,value:e.value,key:e.key};return e.doc&&(t.doc=e.doc),t})),Le.prototype.parse.call(this,e)},clone:function(){return new this.constructor(this.models,{database:this.database,params:this.params,paging:this.paging})}});var Me,je=Ue;je.QueryParams=(Me=function(e,t){var n=_.clone(e);return _.each(["startkey","endkey","key"],(function(e){_.has(n,e)&&(n[e]=t(n[e]))})),n},{parse:function(e){return Me(e,JSON.parse)},stringify:function(e){return Me(e,JSON.stringify)}}),je.DdocInfo=se.Model.extend({idAttribute:"_id",documentation:function(){return se.constants.DOC_URLS.GENERAL},initialize:function(e,t){this.database=t.database},url:function(e){return e||(e="server"),se.urls("designDocs",e,this.database.safeID(),this.safeID())},safeID:function(){var e=this.id.replace(/^_design\//,"");return"_design/"+le.utils.safeURLName(e)}}),je.NewDoc=je.Doc.extend({fetch:function(){var e=this,t=this.partitionKey?this.partitionKey+":":"";return A.getUUID().then((function(n){return n.uuids?e.set("_id",t+n.uuids[0]):e.set("_id",t+"enter_document_id"),n})).catch((function(){e.set("_id",t+"enter_document_id")}))}}),je.BulkDeleteDoc=se.Model.extend({idAttribute:"_id"}),je.BulkDeleteDocCollection=se.Collection.extend({model:je.BulkDeleteDoc,sync:function(){},initialize:function(e,t){this.databaseId=t.databaseId},url:function(){return se.urls("bulk_docs","server",this.databaseId,"")},bulkDelete:function(){var e=this,t=this.createPayload(this.toJSON());return new se.Promise((function(n,a){N(e.url(),t).then((function(t){if(t.error)throw new Error(t.reason||t.error);e.handleResponse(t,n,a)})).catch((function(){var t=_.reduce(e.toArray(),(function(e,t){return e.push(t.id),e}),[]);e.trigger("error",t),a(t)}))}))},handleResponse:function(e,t,n){var a=_.reduce(e,(function(e,t){return t.error&&e.errorIds.push(t.id),t.error||e.successIds.push(t.id),e}),{errorIds:[],successIds:[]});this.removeDocuments(a.successIds),a.errorIds.length&&this.trigger("error",a.errorIds),_.isEmpty(a.successIds)?n(a.errorIds):t(a),this.trigger("updated")},removeDocuments:function(e){var t=this;_.each(e,(function(e){t.remove(t.get(e))})),this.trigger("removed",e)},createPayload:function(e){return{docs:e}}}),je.MangoBulkDeleteDocCollection=je.BulkDeleteDocCollection.extend({url:function(){return A.getServerUrl("/".concat(this.databaseId,"/_index/_bulk_delete"))},createPayload:function(e){return{docids:e.filter((function(e){return"_all_docs"!==e._id})).map((function(e){return e._id}))}}});var He=je,Be=se.addon();Be.DocLimit=100,Be.Model=se.Model.extend({partitioned:!1,setPartitioned:function(e){this.partitioned=e},documentation:function(){return se.constants.DOC_URLS.ALL_DBS},buildAllDocs:function(e){return this.allDocs=new He.AllDocs(null,{database:this,params:e}),this.allDocs},isNew:function(){return!1},isSystemDatabase:function(){return le.utils.isSystemDatabase(this.id)},url:function(e){return"index"===e?"/database/"+this.safeID()+"/_all_docs":"web-index"===e?"#/database/"+this.safeID()+"/_all_docs?limit="+Be.DocLimit:"apiurl"===e?A.getApiUrl("/database/"+this.safeID()+"/_all_docs"):"changes"===e?se.urls("changes","app",this.safeID(),"","?descending=true&limit=100&include_docs=true"):"changes-apiurl"===e?se.urls("changes","apiurl",this.safeID(),"?descending=true&limit=100&include_docs=true"):"app"===e?"/database/"+this.safeID():this.partitioned?A.getServerUrl("/"+this.safeID())+"?partitioned=true":A.getServerUrl("/"+this.safeID())},safeID:function(){return le.utils.safeURLName(this.id)},buildChanges:function(e){return e.limit||(e.limit=100),this.changes=new Be.Changes({database:this,params:e}),this.changes}}),Be.Changes=se.Collection.extend({initialize:function(e){this.database=e.database,this.params=e.params},documentation:function(){return se.constants.DOC_URLS.CHANGES},url:function(e){var t="";return this.params&&(t="?"+le.utils.queryParams(this.params)),e||(e="server"),se.urls("changes",e,this.database.safeID(),t)},parse:function(e){return this.last_seq=e.last_seq,e.results}});var Ge=Be;function qe(){return(qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Ve=Ge.Model,Fe=se.Store.extend({initialize:function(){this.reset()},reset:function(){var e;this._loading=!1,this._promptVisible=!1,this._page=1,this._limit=((e=le.utils.localStorageGet("fauxton:dbs_per_page"))||(e=se.constants.MISC.DEFAULT_PAGE_SIZE),e),this._dbList=[],this._databaseDetails=[],this._failedDbs=[],this._fullDbList=[],this._partitionedDatabasesAvailable=!1},getPage:function(){return this._page},getLimit:function(){return this._limit},setLimit:function(e){this._limit=e,le.utils.localStorageSet("fauxton:dbs_per_page",e)},isLoading:function(){return this._loading},setLoading:function(e){this._loading=e},isPromptVisible:function(){return this._promptVisible},setPromptVisible:function(e){this._promptVisible=e},obtainNewDatabaseModel:function(e,t){var n=new Ve({id:e,name:e});return n.setPartitioned(t),n},doesDatabaseExist:function(e){return-1!==this._dbList.indexOf(e)},getTotalAmountOfDatabases:function(){return this._fullDbList.length},getDbList:function(){var e=this;return this._dbList.map((function(t){var n=e._databaseDetails.filter((function(e){return e.db_name===t}));return qe({},{id:t,encodedId:encodeURIComponent(t),url:se.urls("allDocsSanitized","app",t),failed:-1!==e._failedDbs.indexOf(t)},e._getDetails(n[0]))}))},_getDetails:function(e){if(!e)return{};var t=e.sizes,n=t&&t.active||e.data_size||0;return{dataSize:A.formatSize(n),docCount:e.doc_count,docDelCount:e.doc_del_count,showTombstoneWarning:e.doc_del_count>e.doc_count,isPartitioned:e.props&&!0===e.props.partitioned}},isPartitionedDatabasesAvailable:function(){return this._partitionedDatabasesAvailable},dispatch:function(e){switch(e.type){case ke.DATABASES_SETPAGE:this._page=e.options.page;break;case ke.DATABASES_SETLIMIT:this.setLimit(e.options.limit);break;case ke.DATABASES_SET_PROMPT_VISIBLE:this.setPromptVisible(e.options.visible);break;case ke.DATABASES_STARTLOADING:this.setLoading(!0);break;case ke.DATABASES_LOADCOMPLETE:this.setLoading(!1);break;case ke.DATABASES_UPDATE:this._fullDbList=e.options.fullDbList,this._dbList=e.options.dbList,this._databaseDetails=e.options.databaseDetails,this._failedDbs=e.options.failedDbs,this.setLoading(!1);break;case ke.DATABASES_PARTITIONED_DB_AVAILABLE:this._partitionedDatabasesAvailable=e.options.available;break;default:return}this.triggerChange()}}),Ke=new Fe;Ke.dispatchToken=se.dispatcher.register(Ke.dispatch.bind(Ke));var We={databasesStore:Ke,DatabasesStoreConstructor:Fe},Xe=function(e){var t=se.urls("databaseBaseURL","server",e);return v(t)};function ze(e,t){var n=[],a=[],r=0;e.forEach((function(o){Ye(se.urls("databaseBaseURL","server",o)).then((function(e){n.push(e)})).catch((function(){a.push(o)})).then((function(){++r===e.length&&Ze({dbList:e,databaseDetails:n,failedDbs:a,fullDbList:t})}))}))}function Ye(e){return v(e).then((function(e){if(e.error)throw new Error(e.reason||e.error);return e}))}function Qe(){return Ye(se.urls("allDBs","server"))}function Je(e,t,n){var a=(t-1)*n,r=t*n;return e.slice(a,r)}function Ze(e){se.dispatch({type:ke.DATABASES_UPDATE,options:e})}var $e={getDatabaseList:Qe,paginate:Je,getDatabaseDetails:ze,fetch:Ye,updateDatabases:Ze,init:function(e){var t=this,n=e.page,a=e.limit;this.setStartLoading(),this.setPage(n),a&&this.setLimit(a),Qe().then((function(e){var r=Je(e,n,a);t.updateDatabases({dbList:r,databaseDetails:[],failedDbs:[],fullDbList:e}),ze(r,e)}))},setPage:function(e){se.dispatch({type:ke.DATABASES_SETPAGE,options:{page:e}})},setLimit:function(e){se.dispatch({type:ke.DATABASES_SETLIMIT,options:{limit:e}})},setStartLoading:function(){se.dispatch({type:ke.DATABASES_STARTLOADING})},setLoadComplete:function(){se.dispatch({type:ke.DATABASES_LOADCOMPLETE})},createNewDatabase:function(e,t){if(_.isNull(e)||0===e.trim().length)se.addNotification({msg:"Please enter a valid database name",type:"error",clear:!0});else{e=e.trim(),se.dispatch({type:ke.DATABASES_SET_PROMPT_VISIBLE,options:{visible:!1}});var n=We.databasesStore.obtainNewDatabaseModel(e,t);se.addNotification({msg:"Creating database."}),n.save().done((function(){se.addNotification({msg:"Database created successfully",type:"success",clear:!0});var t=se.urls("allDocs","app",le.utils.safeURLName(e));le.router.navigate(t,{trigger:!0})})).fail((function(e){var t=JSON.parse(e.responseText).reason;se.addNotification({msg:"Create database failed: "+t,type:"error",clear:!0})}))}},jumpToDatabase:function(e){if(!_.isNull(e)&&0!==e.trim().length){e=e.trim();var t=se.urls("allDocs","app",le.utils.safeURLName(e),"");return setTimeout((function(){se.navigate(t)}))}},fetchAllDbsWithKey:function(e,t){var n="?"+le.utils.queryParams({startkey:JSON.stringify(e),endkey:JSON.stringify(e+"香"),limit:30}),a=A.getServerUrl("/_all_dbs".concat(n));v(a).then((function(e){var n=e.map((function(e){return{value:e,label:e}}));t(null,{options:n})}))},setPartitionedDatabasesAvailable:function(e){var t={type:ke.DATABASES_PARTITIONED_DB_AVAILABLE,options:{available:e}};se.dispatch(t),se.reduxDispatch(t)},checkPartitionedQueriesIsAvailable:function(){var e=this,t=se.getExtensions(ri.PARTITONED_DB_CHECK_EXTENSION).map((function(e){return e()}));se.Promise.all(t).then((function(t){var n=t.every((function(e){return!0===e}));e.setPartitionedDatabasesAvailable(n)})).catch((function(){}))},fetchSelectedDatabaseInfo:function(e){se.reduxDispatch({type:ke.DATABASES_FETCH_SELECTED_DB_METADATA}),Xe(e).then((function(e){if(!e.db_name){var t=e.reason?e.reason:"";throw new Error("Failed to fetch database info. "+t)}se.reduxDispatch({type:ke.DATABASES_FETCH_SELECTED_DB_METADATA_SUCCESS,options:{metadata:e}})})).catch((function(e){se.addNotification({msg:e.message,type:"error",clear:!0})}))}},et=n(1),tt=n.n(et),nt=n(14);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ot(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ct,lt,ut,dt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ot(this,it(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e="fonticon fonticon-bell"+(this.props.visible?"":" hide");return de.a.createElement("div",{className:e,onClick:this.props.onClick})}}])&&rt(n.prototype,a),r&&rt(n,r),t}(de.a.Component);ct=dt,lt="propTypes",ut={onClick:tt.a.func.isRequired,visible:tt.a.bool.isRequired},lt in ct?Object.defineProperty(ct,lt,{value:ut,enumerable:!0,configurable:!0,writable:!0}):ct[lt]=ut;var pt=Object(nt.b)((function(e){return{visible:!e.notifications.notificationCenterVisible}}),(function(e){return{onClick:function(){e((function(e){e({type:Ee.SHOW_NOTIFICATION_CENTER})}))}}}))(dt),ft=function(e){var t=e.endpoint;return t?de.a.createElement("div",{className:"faux__jsonlink"},de.a.createElement("a",{"data-bypass":!0,className:"faux__jsonlink-link",href:t,target:"_blank",rel:"noopener noreferrer"},de.a.createElement("span",{className:"faux__jsonlink-link-brackets"},"{ }"),de.a.createElement("span",{className:"faux__jsonlink-link-label"},"JSON"))):null},ht=function(e){var t=e.docURL;return t?de.a.createElement("div",{className:"faux__doclink"},de.a.createElement("a",{"data-bypass":"true",href:t,target:"_blank",rel:"noopener noreferrer",className:"faux__doclink-link"},de.a.createElement("i",{className:"icon fonticon-bookmark"}))):null},mt=function(e){var t=e.crumbs;return de.a.createElement("div",{className:"faux-header__breadcrumbs"},function(e){var t=e.length-1;return e.map((function(e,n){var a=[de.a.createElement(gt,{key:n},e.name)];return e.link&&(a=[de.a.createElement(gt,{key:n},de.a.createElement("a",{className:"faux-header__breadcrumbs-link",href:"#/"+e.link},e.name))]),e.name?(n<t&&a.push(de.a.createElement(bt,{key:"divider_"+n})),a):a}))}(t))};mt.propTypes={crumbs:tt.a.array.isRequired};var gt=function(e){var t=e.children;return de.a.createElement("div",{className:"faux-header__breadcrumbs-element"},t)},bt=function(){return de.a.createElement("div",{className:"fonticon-right-open faux-header__breadcrumbs-divider"})};var yt=function(e){var t=e.docURL,n=e.endpoint;return de.a.createElement("div",{className:"faux__jsondoc-wrapper"},de.a.createElement(ft,{endpoint:n}),de.a.createElement(ht,{docURL:t}))},Et=function(e){var t=e.children;return de.a.createElement("div",{id:"dashboard",className:"one-pane "},t)},_t=function(e){var t=e.showApiUrl,n=e.docURL,a=e.endpoint,r=e.crumbs,o=e.children,i="right-header-flex";return A.isIE1X()&&(i+=" "+i+"--ie1X"),de.a.createElement("header",null,de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{id:"breadcrumbs",className:"flex-body"},de.a.createElement(mt,{crumbs:r})),de.a.createElement("div",{id:"right-header"},de.a.createElement("div",{className:i},o)),t?de.a.createElement(yt,{docURL:n,endpoint:a}):null,de.a.createElement("div",{id:"notification-center-btn"},de.a.createElement(pt,null))))};_t.defaultProps={showApiUrl:!0,crumbs:[]},_t.propTypes={docURL:tt.a.string,endpoint:tt.a.string,crumbs:tt.a.array};var vt=function(e){var t=e.children;return de.a.createElement("div",{className:"content-area container-fluid"},de.a.createElement("div",{id:"tabs"}),de.a.createElement("div",{id:"dashboard-content",className:"scrollable"},t))},St=function(e){var t=e.children;return de.a.createElement("div",{className:"faux__onepane-footer"},t)},Nt=function(e){var t=e.component,n=e.docURL,a=e.endpoint,r=e.crumbs;return de.a.createElement(Et,null,de.a.createElement(_t,{crumbs:r,endpoint:a,docURL:n}),de.a.createElement(vt,null,t),de.a.createElement(St,null))},Dt=function(e){var t=e.children;return de.a.createElement("div",{id:"dashboard-content"},t)},Ot=function(e){var t=e.component,n=e.docURL,a=e.endpoint,r=e.crumbs;return de.a.createElement("div",{id:"dashboard",className:"one-pane doc-editor-page"},de.a.createElement(_t,{crumbs:r,endpoint:a,docURL:n}),de.a.createElement(Dt,null,t))},wt=n(3),Tt=n.n(wt),Ct=n(8);function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pt(e){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xt=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Pt(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==At(r)&&"function"!=typeof r?Rt(a):r,Lt(Rt(n),"state",{open:!1}),Lt(Rt(n),"handleClick",(function(e){var t=!n.state.open;n.setState({open:t}),n.props.onClick({isOpen:t,event:e})})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.children,n=e.title,a=this.state.open?"fonticon-down-open":"fonticon-right-open",r=Tt()("faux--accordion__item-content","collapse",{in:this.state.open});return de.a.createElement("li",{className:"faux--accordion__item",onClick:this.handleClick},de.a.createElement("button",{type:"button",className:"faux--accordion__item-header",onClick:this.handleClick},de.a.createElement("i",{className:a}),de.a.createElement("span",null,n)),de.a.createElement(Ct.c,{in:this.state.open},de.a.createElement("div",{className:r},t)))}}])&&It(n.prototype,a),r&&It(n,r),t}(de.a.Component);function Ut(e){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ht(e,t,n){return t&&jt(e.prototype,t),n&&jt(e,n),e}function Bt(e,t){return!t||"object"!==Ut(t)&&"function"!=typeof t?qt(e):t}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Lt(xt,"propTypes",{title:tt.a.string.isRequired}),Lt(xt,"defaultProps",{onClick:function(){}});var Wt=function(e){function t(){var e,n;Mt(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Kt(qt(n=Bt(this,(e=Gt(t)).call.apply(e,[this].concat(r)))),"getBadges",(function(){return n.props.elements.map(function(e,t){return de.a.createElement(Xt,{label:this.props.getLabel(e),key:t,id:e,remove:this.removeBadge})}.bind(qt(n)))})),Kt(qt(n),"removeBadge",(function(e,t){n.props.removeBadge(e,t)})),n}return Vt(t,e),Ht(t,[{key:"render",value:function(){return de.a.createElement("ul",{className:"component-badgelist"},this.getBadges())}}]),t}(de.a.Component);Kt(Wt,"propTypes",{elements:tt.a.array.isRequired,removeBadge:tt.a.func.isRequired}),Kt(Wt,"defaultProps",{getLabel:function(e){return e},getId:function(e){return e}});var Xt=function(e){function t(){var e,n;Mt(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Kt(qt(n=Bt(this,(e=Gt(t)).call.apply(e,[this].concat(r)))),"remove",(function(e){e.preventDefault(),n.props.remove(n.props.label,n.props.id)})),n}return Vt(t,e),Ht(t,[{key:"render",value:function(){return de.a.createElement("li",{className:"component-badge"},de.a.createElement("span",{className:"label label-info"},this.props.label),de.a.createElement("a",{href:"#",className:"label label-info remove-filter",onClick:this.remove,"data-bypass":"true"},"×"))}}]),t}(de.a.Component);function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jt(e){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zt(e,t){return(Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Kt(Xt,"propTypes",{label:tt.a.string.isRequired,remove:tt.a.func.isRequired});var $t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qt(this,Jt(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.iconDefaultClass,n=e.fonticon,a=e.innerClasses,r=e.selected,o=e.containerClasses,i=e.title,s=e.disabled,c=e.text,l=e.toggleCallback,u=e.active,d=r||u?"js-headerbar-togglebutton-selected":"";return de.a.createElement("button",{title:i,disabled:s,onClick:l,className:"button ".concat(o," ").concat(d)},de.a.createElement("i",{className:"".concat(t," ").concat(n," ").concat(a)}),de.a.createElement("span",null,c))}}])&&Yt(n.prototype,a),r&&Yt(n,r),t}(de.a.Component);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function nn(e){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function an(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function on(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}($t,"defaultProps",{innerClasses:"",fonticon:"",containerClasses:"",selected:!1,title:"",disabled:!1,toggleCallback:null,text:"",iconDefaultClass:"icon"});var sn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=nn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==en(r)&&"function"!=typeof r?an(a):r,on(an(n),"getMultiSelectOptions",(function(){return n.props.hasSelectedItem?de.a.createElement("button",{onClick:n.props.removeItem,className:"fonticon "+n.props.bulkIcon,title:n.props.buttonTitle}):null})),on(an(n),"getPopupContent",(function(){return de.a.createElement("ul",{className:"bulk-action-component-popover-actions"},de.a.createElement("li",{onClick:n.selectAll},de.a.createElement("i",{className:"icon fonticon-cancel"})," ",n.props.dropdownContentText))})),on(an(n),"selectAll",(function(){n.bulkActionPopover.hide(),n.props.selectAll()})),on(an(n),"getOverlay",(function(){return de.a.createElement(Ct.i,{ref:function(e){return n.bulkActionPopover=e},trigger:"click",placement:"bottom",rootClose:!0,overlay:de.a.createElement(Ct.j,{id:"bulk-action-component-popover",title:n.props.title},n.getPopupContent())},de.a.createElement("div",{className:"arrow-button"},de.a.createElement("i",{className:"fonticon fonticon-play"})))})),on(an(n),"getMasterSelector",(function(){return de.a.createElement("div",{className:"bulk-action-component-panel"},de.a.createElement("input",{type:"checkbox",checked:n.props.isChecked,onChange:n.props.toggleSelect,disabled:n.props.disabled}),n.props.enableOverlay?de.a.createElement("div",{className:"separator"}):null,n.props.enableOverlay?n.getOverlay():null)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{className:"bulk-action-component"},de.a.createElement("div",{className:"bulk-action-component-selector-group"},this.getMasterSelector(),this.getMultiSelectOptions()))}}])&&tn(n.prototype,a),r&&tn(n,r),t}(de.a.Component);function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function un(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pn(e,t){return(pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}on(sn,"propTypes",{hasSelectedItem:tt.a.bool.isRequired,removeItem:tt.a.func.isRequired,selectAll:tt.a.func,toggleSelect:tt.a.func.isRequired,isChecked:tt.a.bool.isRequired,disabled:tt.a.bool}),on(sn,"defaultProps",{disabled:!1,title:"Select rows that can be...",bulkIcon:"fonticon-trash",buttonTitle:"Delete all selected",dropdownContentText:"Deleted",enableOverlay:!1});var fn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),un(this,dn(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pn(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{className:"styled-select"},de.a.createElement("label",{htmlFor:this.props.selectId},de.a.createElement("i",{className:"fonticon-down-dir styled-select-icon"}),de.a.createElement("i",{className:"fonticon-down-dir styled-select-hover-icon"}),de.a.createElement("select",{value:this.props.selectValue,id:this.props.selectId,className:this.props.selectValue,onChange:this.props.selectChange},this.props.selectContent)))}}])&&ln(n.prototype,a),r&&ln(n,r),t}(de.a.Component);!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(fn,"propTypes",{selectValue:tt.a.string.isRequired,selectId:tt.a.string.isRequired,selectChange:tt.a.func.isRequired});var hn=n(80),mn=n.n(hn),gn={CMPNTS_DATABASES_SHOWDELETE_MODAL:"CMPNTS_DATABASES_SHOWDELETE_MODAL"};var bn={deleteDatabase:function(e,t){var n=this,a=se.urls("databaseBaseURL","server",e,"");S(a).then((function(a){if(!a.ok){var r=a.reason||"";throw new Error(r)}n.showDeleteDatabaseModal({showModal:!0}),se.addNotification({msg:"The database <code>"+_.escape(e)+"</code> has been deleted.",clear:!0,escape:!1}),Backbone.history.loadUrl(se.urls("allDBs","app")),t&&t()})).catch((function(e){se.addNotification({msg:"Could not delete the database. "+e.message,type:"error",clear:!0})}))},showDeleteDatabaseModal:function(e){se.dispatch({type:gn.CMPNTS_DATABASES_SHOWDELETE_MODAL,options:e})}},yn=function(e,t){var n="#"+se.urls("databaseBaseURL","app",se.url.encode(e))+(t?"/_partition/"+encodeURIComponent(t):"");return{title:le.i18n.en_US["new-mango-index"],url:n+"/_index",icon:"fonticon-plus-circled"}},En=function(e){return"designDoc"===e.navItem&&"Views"===e.designDocSection&&e.indexName},_n=function(e,t){var n=t;return t&&e.options&&!1===e.options.partitioned&&(n=!1),n},vn={getSeqNum:function(e){return _.isArray(e)?e[1]:e},getNewButtonLinks:function(e,t){var n=se.getExtensions("sidebar:links"),a="#"+se.urls("databaseBaseURL","app",se.url.encode(e)),r="",o="";return t&&(r="/_partition/"+encodeURIComponent(t),o="?partitionKey="+encodeURIComponent(t)),[{title:"Add New",links:n.reduce((function(e,t){return e.push({title:t.title,url:a+r+"/"+t.url,icon:"fonticon-plus-circled"}),e}),[{title:"New Doc",url:a+"/_new"+o,icon:"fonticon-plus-circled"},{title:"New View",url:a+r+"/new_view",icon:"fonticon-plus-circled"},yn(e,t)])}]},getModifyDatabaseLinks:function(e){return[{title:"Replicate Database",icon:"fonticon-replicate",url:se.urls("replication","app",e)},{title:"Delete",icon:"fonticon-trash",onClick:bn.showDeleteDatabaseModal.bind(void 0,{showDeleteModal:!0,dbId:e})}]},getNewDocUrl:function(e,t){var n=encodeURIComponent(e),a=se.urls("new","newDocument",n);return t&&(a=a+"?partitionKey="+encodeURIComponent(t)),a},isDDocPartitioned:_n,parseJSON:function(e){return JSON.parse('"'+e+'"')},truncateDoc:function(e,t){var n=e.split("\n"),a=!1;return n.length>t&&(a=!0,e=(n=n.slice(0,t)).join("\n")),{isTruncated:a,content:e}},selectedViewContainsReduceFunction:function(e,t){if(!t)return!1;var n=!1;if(e&&En(t)){var a="_design/"+t.designDocName,r=e.find((function(e){return e._id===a}));n=void 0!==r&&r.views&&void 0!==r.views[t.indexName]&&void 0!==r.views[t.indexName].reduce}return n},selectedItemIsPartitionedView:function(e,t,n){if(!t)return!1;var a=!1;if(e&&En(t)){var r="_design/"+t.designDocName,o=e.find((function(e){return e._id===r}));o&&(a=_n(o,n))}return a},isViewSelected:En};function Sn(e){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dn(e){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function On(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(331),n(219),n(220);var Cn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Dn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Sn(r)&&"function"!=typeof r?On(a):r,Tn(On(n),"initAceEditor",(function(e){n.editor=mn.a.edit(e),n.editor.$blockScrolling=1/0,n.editor.setShowPrintMargin(!1),n.editor.setOption("highlightActiveLine",!0),n.editor.setTheme("ace/theme/idle_fingers");var t=vn.parseJSON(n.props.value);n.editor.setValue(t,-1)})),Tn(On(n),"closeModal",(function(){n.props.onClose()})),Tn(On(n),"save",(function(){n.props.onSave(n.editor.getValue())})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this;return de.a.createElement(Ct.g,{className:"string-editor-modal",show:this.props.visible,onHide:this.closeModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Edit Value ",de.a.createElement("span",{id:"string-edit-header"}))),de.a.createElement(Ct.g.Body,null,de.a.createElement("div",{id:"modal-error",className:"hide alert alert-error"}),de.a.createElement("div",{id:"string-editor-wrapper"},de.a.createElement("div",{id:"string-editor-container",ref:function(t){return e.initAceEditor(t)},className:"doc-code"}))),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{className:"cancel-link",onClick:this.closeModal},"Cancel"),de.a.createElement("button",{id:"string-edit-save-btn",onClick:this.save,className:"btn btn-primary save"},de.a.createElement("i",{className:"fonticon-circle-check"})," Modify Text")))}}])&&Nn(n.prototype,a),r&&Nn(n,r),t}(de.a.Component);Tn(Cn,"propTypes",{value:tt.a.string.isRequired,visible:tt.a.bool.isRequired,onClose:tt.a.func.isRequired,onSave:tt.a.func.isRequired}),Tn(Cn,"defaultProps",{visible:!1,onClose:function(){},onSave:function(){}});n(610);function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kn(e,t){return(kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ln(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(331),n(219),n(220);var xn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Pn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==An(r)&&"function"!=typeof r?Rn(a):r,Ln(Rn(n),"state",{originalCode:n.props.defaultCode,stringEditModalVisible:!1,stringEditIconVisible:!1,stringEditIconStyle:{},stringEditModalValue:""}),Ln(Rn(n),"hasChanged",(function(){return!_.isEqual(n.state.originalCode,n.getValue())})),Ln(Rn(n),"clearChanges",(function(){n.setState({originalCode:n.getValue()})})),Ln(Rn(n),"setupAce",(function(e,t){n.editor=mn.a.edit(n.ace),n.editor.commands.bindKeys({"Ctrl-L|Command-L":null,"Ctrl-Shift-L|Command-Shift-L":"gotoline"}),n.editor.$blockScrolling=1/0,t&&n.setValue(e.defaultCode),n.editor.setShowPrintMargin(e.showPrintMargin),n.editor.autoScrollEditorIntoView=e.autoScrollEditorIntoView,n.editor.setOption("highlightActiveLine",n.props.highlightActiveLine),n.props.setHeightToLineCount&&n.setHeightToLineCount(),n.props.ignorableErrors&&n.removeIgnorableAnnotations(),n.addCommands(),n.editor.getSession().setMode("ace/mode/"+e.mode),n.editor.setTheme("ace/theme/"+e.theme),n.editor.setFontSize(e.fontSize),n.editor.getSession().setTabSize(2),n.editor.getSession().setUseSoftTabs(!0),n.props.autoFocus&&n.editor.focus()})),Ln(Rn(n),"addCommands",(function(){_.each(n.props.editorCommands,(function(e){n.editor.commands.addCommand(e)}))})),Ln(Rn(n),"setupEvents",(function(){n.editor.on("blur",_.bind(n.onBlur,Rn(n))),n.editor.on("change",_.bind(n.onContentChange,Rn(n))),n.props.stringEditModalEnabled&&(n.editor.on("changeSelection",_.bind(n.showHideEditStringGutterIcon,Rn(n))),n.editor.getSession().on("changeBackMarker",_.bind(n.showHideEditStringGutterIcon,Rn(n))),n.editor.getSession().on("changeScrollTop",_.bind(n.updateEditStringGutterIconPosition,Rn(n)))),n.props.notifyUnsavedChanges&&(window.addEventListener("beforeunload",n.quitWarningMsg),se.beforeUnload("editor_"+n.props.id,n.quitWarningMsg))})),Ln(Rn(n),"onBlur",(function(){n.props.blur(n.getValue())})),Ln(Rn(n),"onContentChange",(function(){n.props.setHeightToLineCount&&n.setHeightToLineCount(),n.props.change(n.getValue())})),Ln(Rn(n),"quitWarningMsg",(function(){if(n.hasChanged())return"Your changes have not been saved. Click Cancel to return to the document, or OK to proceed."})),Ln(Rn(n),"removeEvents",(function(){n.props.notifyUnsavedChanges&&(window.removeEventListener("beforeunload",n.quitWarningMsg),se.removeBeforeUnload("editor_"+n.props.id))})),Ln(Rn(n),"setHeightToLineCount",(function(){var e=n.editor.getSession().getDocument().getLength(),t=e>n.props.maxLines?n.props.maxLines:e;n.editor.setOptions({maxLines:t,minLines:n.props.minLines})})),Ln(Rn(n),"getAnnotations",(function(){return n.editor.getSession().getAnnotations()})),Ln(Rn(n),"isIgnorableError",(function(e){return-1!==_.indexOf(n.props.ignorableErrors,e)})),Ln(Rn(n),"removeIgnorableAnnotations",(function(){var e=n.isIgnorableError;n.editor.getSession().on("changeAnnotation",function(){var t=this.editor.getSession().getAnnotations(),n=_.reduce(t,(function(t,n){return e(n.raw)||t.push(n),t}),[]);t.length!==n.length&&this.editor.getSession().setAnnotations(n)}.bind(Rn(n)))})),Ln(Rn(n),"showHideEditStringGutterIcon",(function(){return n.hasErrors()||!n.parseLineForStringMatch()?(n.setState({stringEditIconVisible:!1}),!1):(n.setState({stringEditIconVisible:!0,stringEditIconStyle:{top:n.getGutterIconPosition()}}),!0)})),Ln(Rn(n),"updateEditStringGutterIconPosition",(function(){n.state.stringEditIconVisible&&n.setState({stringEditIconStyle:{top:n.getGutterIconPosition()}})})),Ln(Rn(n),"getGutterIconPosition",(function(){var e=n.getRowHeight(),t=n.editor.session.getScrollTop();return e*n.documentToScreenRow(n.getSelectionStart().row)-t+"px"})),Ln(Rn(n),"parseLineForStringMatch",(function(){var e=n.getSelectionStart().row,t=n.getSelectionEnd().row;if(e>=0&&t>=0&&e===t&&n.isRowExpanded(e)){var a=n.getLine(e).match(/^([ \t]*)("[^"]*["][ \t]*:[ \t]*)?(["|'].*"[ \t]*,?[ \t]*)$/);if(a)return a}return!1})),Ln(Rn(n),"openStringEditModal",(function(){var e=n.parseLineForStringMatch()[3].trim();","===e.substring(e.length-1)&&(e=e.substring(0,e.length-1).trim()),e=e.substring(1,e.length-1),n.setState({stringEditModalVisible:!0,stringEditModalValue:e})})),Ln(Rn(n),"saveStringEditModal",(function(e){var t=n.parseLineForStringMatch(),a=t[1]||"",r=t[2]||"",o=t[3],i="";","===o.substring(o.length-1)&&(i=","),n.replaceCurrentLine(a+r+JSON.stringify(e)+i+"\n"),n.closeStringEditModal()})),Ln(Rn(n),"closeStringEditModal",(function(){n.setState({stringEditModalVisible:!1})})),Ln(Rn(n),"hasErrors",(function(){return!_.every(n.getAnnotations(),(function(e){return n.isIgnorableError(e.raw)}))})),Ln(Rn(n),"setReadOnly",(function(e){n.editor.setReadOnly(e)})),Ln(Rn(n),"setValue",(function(e,t){t=t||-1,n.editor.setValue(e,t)})),Ln(Rn(n),"getValue",(function(){return n.editor.getValue()})),Ln(Rn(n),"getEditor",(function(){return Rn(n)})),Ln(Rn(n),"getLine",(function(e){return n.editor.session.getLine(e)})),Ln(Rn(n),"getSelectionStart",(function(){return n.editor.getSelectionRange().start})),Ln(Rn(n),"getSelectionEnd",(function(){return n.editor.getSelectionRange().end})),Ln(Rn(n),"getRowHeight",(function(){return n.editor.renderer.layerConfig.lineHeight})),Ln(Rn(n),"isRowExpanded",(function(e){return!n.editor.getSession().isRowFolded(e)})),Ln(Rn(n),"documentToScreenRow",(function(e){return n.editor.getSession().documentToScreenRow(e,0)})),Ln(Rn(n),"replaceCurrentLine",(function(e){n.editor.getSelection().selectLine(),n.editor.insert(e),n.editor.getSelection().moveCursorUp()})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kn(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.setupAce(this.props,!0),this.setupEvents(),this.props.autoFocus&&this.editor.focus()}},{key:"componentWillUnmount",value:function(){this.removeEvents(),this.editor.destroy()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setupAce(e,!1)}},{key:"render",value:function(){var e=this;return de.a.createElement("div",null,de.a.createElement("div",{ref:function(t){return e.ace=t},className:"js-editor",id:this.props.id}),de.a.createElement("button",{ref:function(t){return e.stringEditIcon=t},className:"btn string-edit",title:"Edit string",disabled:!this.state.stringEditIconVisible,style:this.state.stringEditIconStyle,onClick:this.openStringEditModal},de.a.createElement("i",{className:"icon icon-edit"})),de.a.createElement(Cn,{ref:function(t){return e.stringEditModal=t},visible:this.state.stringEditModalVisible,value:this.state.stringEditModalValue,onSave:this.saveStringEditModal,onClose:this.closeStringEditModal}))}}])&&In(n.prototype,a),r&&In(n,r),t}(de.a.Component);Ln(xn,"defaultProps",{id:"code-editor",mode:"javascript",theme:"idle_fingers",fontSize:13,defaultCode:"",showGutter:!0,highlightActiveLine:!0,showPrintMargin:!1,autoScrollEditorIntoView:!0,autoFocus:!1,stringEditModalEnabled:!1,setHeightToLineCount:!1,maxLines:10,minLines:11,editorCommands:[],notifyUnsavedChanges:!1,ignorableErrors:[],change:function(){},blur:function(){}});var Un=n(181),Mn=n.n(Un);function jn(e){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qn(e,t){return(qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fn=Mn.a.js_beautify?Mn.a.js_beautify:Mn.a,Kn=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Bn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==jn(r)&&"function"!=typeof r?Gn(a):r,Vn(Gn(n),"noOfLines",(function(){return n.props.code.split(/\r\n|\r|\n/).length})),Vn(Gn(n),"canBeautify",(function(){return 1===n.noOfLines()})),Vn(Gn(n),"beautify",(function(e){e.preventDefault();var t=Fn(n.props.code);n.props.beautifiedCode(t)})),Vn(Gn(n),"getTooltip",(function(){return de.a.createElement(Ct.l,{id:"tooltip"},"Switch to editable code format.")})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qn(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){if(!this.canBeautify())return null;var e=this.getTooltip();return de.a.createElement(Ct.i,{placement:"right",overlay:e},de.a.createElement("button",{onClick:this.beautify,className:"beautify beautify_map btn btn-primary btn-small beautify-tooltip",type:"button"},"Format Code"))}}])&&Hn(n.prototype,a),r&&Hn(n,r),t}(de.a.Component);function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zn(e){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qn(e,t){return(Qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(611);var Zn={dark:"idle_fingers",light:"dawn"},$n=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=zn(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Wn(r)&&"function"!=typeof r?Yn(a):r,Jn(Yn(n),"getStoreState",(function(){return{theme:n.getZenTheme(),code:n.props.defaultCode}})),Jn(Yn(n),"getZenTheme",(function(){var e=le.utils.localStorageGet("zenTheme");return _.isUndefined(e)?"dark":e})),Jn(Yn(n),"onChange",(function(){n.setState(n.getStoreState())})),Jn(Yn(n),"exitZenMode",(function(){n.props.onExit(n.getValue())})),Jn(Yn(n),"getValue",(function(){return n.ace.getValue()})),Jn(Yn(n),"toggleTheme",(function(){var e="dark"===n.state.theme?"light":"dark";n.setState({theme:e,code:n.getValue()}),le.utils.localStorageSet("zenTheme",e)})),Jn(Yn(n),"setValue",(function(e,t){t=t||-1,n.editor.setValue(e,t)})),Jn(Yn(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qn(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this,t="full-page-editor-modal-wrapper zen-theme-"+this.state.theme,n=[{name:"close",bindKey:{win:"ESC",mac:"ESC"},exec:this.exitZenMode}],a=de.a.createElement(Ct.l,{id:"tooltip"},"Exit zen mode (`esc`)"),r=de.a.createElement(Ct.l,{id:"tooltip"},"Switch zen theme");return de.a.createElement("div",{className:t},de.a.createElement("div",{className:"zen-mode-controls"},de.a.createElement("ul",null,de.a.createElement("li",null,de.a.createElement(Ct.i,{placement:"left",overlay:a},de.a.createElement("span",{className:"fonticon fonticon-resize-small js-exit-zen-mode","data-container":".zen-mode-controls .tooltips",onClick:this.exitZenMode}))),de.a.createElement("li",null,de.a.createElement(Ct.i,{placement:"left",overlay:r},de.a.createElement("span",{className:"fonticon fonticon-picture js-toggle-theme","data-container":".zen-mode-controls .tooltips",title:"Switch zen theme",onClick:this.toggleTheme})))),de.a.createElement("div",{className:"tooltips"})),de.a.createElement(xn,{ref:function(t){return e.ace=t},autoFocus:!0,theme:Zn[this.state.theme],defaultCode:this.props.defaultCode,editorCommands:n,ignorableErrors:this.props.ignorableErrors,highlightActiveLine:this.props.highlightActiveLine}))}}])&&Xn(n.prototype,a),r&&Xn(n,r),t}(de.a.Component);function ea(e){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ta(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function na(e){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ra(e,t){return(ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Jn($n,"defaultProps",{mode:"javascript",defaultCode:"",ignorableErrors:[],onExit:null,highlightActiveLine:!1});var ia=["Missing name in function declaration.","['{a}'] is better written in dot notation."],sa=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=na(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ea(r)&&"function"!=typeof r?aa(a):r,oa(aa(n),"getStoreState",(function(){return{zenModeEnabled:!1,code:n.props.defaultCode}})),oa(aa(n),"getZenModeIcon",(function(){if(n.props.allowZenMode)return de.a.createElement("span",{className:"fonticon fonticon-resize-full zen-editor-icon",title:"Enter Zen mode",onClick:n.enterZenMode})})),oa(aa(n),"getDocIcon",(function(){if(n.props.docLink)return de.a.createElement("a",{className:"help-link","data-bypass":"true",href:n.props.docLink,target:"_blank",rel:"noopener noreferrer"},de.a.createElement("i",{className:"icon-question-sign"}))})),oa(aa(n),"getZenModeOverlay",(function(){if(n.state.zenModeEnabled)return de.a.createElement($n,{defaultCode:n.state.code,mode:n.props.mode,ignorableErrors:ia,onExit:n.exitZenMode})})),oa(aa(n),"enterZenMode",(function(){n.setState({zenModeEnabled:!0,code:n.codeEditor.getValue()})})),oa(aa(n),"exitZenMode",(function(e){n.setState({zenModeEnabled:!1}),n.getEditor().setValue(e)})),oa(aa(n),"getEditor",(function(){return n.codeEditor})),oa(aa(n),"getValue",(function(){return n.getEditor().getValue()})),oa(aa(n),"beautify",(function(e){n.setState({code:e}),n.getEditor().setValue(e)})),oa(aa(n),"update",(function(){n.getEditor().setValue(n.state.code)})),oa(aa(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.defaultCode!==this.props.defaultCode&&this.setState({code:e.defaultCode})}},{key:"render",value:function(){var e=this,t="control-group";return this.props.className&&(t+=" "+this.props.className),de.a.createElement("div",{className:t},de.a.createElement("label",null,de.a.createElement("span",null,this.props.title),this.getDocIcon(),this.getZenModeIcon()),de.a.createElement(xn,{id:this.props.id,ref:function(t){return e.codeEditor=t},mode:"javascript",defaultCode:this.state.code,showGutter:!0,ignorableErrors:ia,setHeightToLineCount:!0,maxLines:1e4,blur:this.props.blur}),de.a.createElement(Kn,{code:this.state.code,beautifiedCode:this.beautify}),this.getZenModeOverlay())}}])&&ta(n.prototype,a),r&&ta(n,r),t}(de.a.Component);function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function la(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ua(e,t){return!t||"object"!==ca(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function da(e){return(da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pa(e,t){return(pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}oa(sa,"defaultProps",{id:"code-editor",className:"",defaultCode:"",title:"",docLink:"",allowZenMode:!0,blur:function(){}});var fa=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ua(this,da(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pa(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{className:"bordered-box"},de.a.createElement("div",{className:"padded-box"},this.props.children))}}])&&la(n.prototype,a),r&&la(n,r),t}(de.a.Component),ha={LAYOUT_ORIENTATION:{TABLE:"LAYOUT_TABLE",METADATA:"LAYOUT_METADATA",JSON:"LAYOUT_JSON"},INDEX_RESULTS_DOC_TYPE:{MANGO_INDEX:"MangoIndex",MANGO_QUERY:"MangoQueryResult",VIEW:"view"},INDEX_RESULTS_STYLE:{TEXT_OVERFLOW_TRUNCATED:"truncated",TEXT_OVERFLOW_FULL:"full",FONT_SIZE_SMALL:"small-font",FONT_SIZE_LARGE:"large-font",FONT_SIZE_MEDIUM:"medium-font"}};function ma(e){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ba(e){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ya(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ea(e,t){return(Ea=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var va=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=ba(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ma(r)&&"function"!=typeof r?ya(a):r,_a(ya(n),"onChange",(function(e){e.preventDefault(),n.props.docChecked(n.props.doc.id,n.props.doc._rev)})),_a(ya(n),"getUrlFragment",(function(){return n.props.children?de.a.createElement("div",{className:"doc-edit-symbol pull-right",title:"Edit document"},n.props.children):""})),_a(ya(n),"getExtensionIcons",(function(){var e=se.getExtensions("DocList:icons");return _.map(e,(function(e,t){return de.a.createElement(e,{doc:n.props.doc,key:t})}))})),_a(ya(n),"getDocumentTypeIcon",(function(){return n.props.docType===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX?-1!==n.props.docContent.indexOf('"partitioned": true')?de.a.createElement("i",{className:"fonticon-documents",title:"Partitioned index"}):de.a.createElement("i",{className:"fonticon-document",title:"Global index"}):null})),_a(ya(n),"getCheckbox",(function(){return n.props.isDeletable?de.a.createElement("div",{className:"checkbox inline"},de.a.createElement("input",{id:"checkbox-"+n.props.docIdentifier,checked:n.props.checked,"data-checked":n.props.checked,type:"checkbox",onChange:n.onChange,className:"js-row-select"}),de.a.createElement("label",{onClick:n.onChange,className:"label-checkbox-doclist",htmlFor:"checkbox-"+n.props.docIdentifier})):de.a.createElement("div",{className:"checkbox-dummy"})})),_a(ya(n),"onClick",(function(e){n.props.onClick(n.props.docIdentifier,n.props.doc,e)})),_a(ya(n),"getDocContent",(function(){if(_.isEmpty(n.props.docContent))return null;var e=n.props.docContent,t=!1;if(n.props.truncate){var a=vn.truncateDoc(n.props.docContent,n.props.maxRows);t=a.isTruncated,e=a.content}var r=n.props.resultsStyle.fontSize,o=Tt()("prettyprint",{"prettyprint--small":r===ha.INDEX_RESULTS_STYLE.FONT_SIZE_SMALL,"prettyprint--large":r===ha.INDEX_RESULTS_STYLE.FONT_SIZE_LARGE});return de.a.createElement("div",{className:"doc-data"},de.a.createElement("pre",{className:o},e),t?de.a.createElement("div",{className:"doc-content-truncated"},"(truncated)"):null)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ea(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{"data-id":this.props.docIdentifier,className:"doc-row"},de.a.createElement("div",{className:"custom-inputs"},this.getCheckbox()),de.a.createElement("div",{className:"doc-item"},de.a.createElement("header",{onClick:this.onClick},de.a.createElement("span",{className:"header-keylabel"},this.getDocumentTypeIcon(),this.props.keylabel),de.a.createElement("span",{className:"header-doc-id"},this.props.header?'"'+this.props.header+'"':null),this.getUrlFragment(),de.a.createElement("div",{className:"doc-item-extension-icons pull-right"},this.getExtensionIcons())),this.getDocContent()),de.a.createElement("div",{className:"clearfix"}))}}])&&ga(n.prototype,a),r&&ga(n,r),t}(de.a.Component);_a(va,"propTypes",{docIdentifier:tt.a.string.isRequired,docType:tt.a.string,docChecked:tt.a.func.isRequired,truncate:tt.a.bool,maxRows:tt.a.number,resultsStyle:tt.a.object}),_a(va,"defaultProps",{truncate:!0,maxRows:500,resultsStyle:{fontSize:ha.INDEX_RESULTS_STYLE.FONT_SIZE_MEDIUM},docType:ha.INDEX_RESULTS_DOC_TYPE.VIEW});var Sa=function(){return de.a.createElement("div",{className:"loading-lines"},de.a.createElement("div",{id:"line1"}," "),de.a.createElement("div",{id:"line2"}," "),de.a.createElement("div",{id:"line3"}," "),de.a.createElement("div",{id:"line4"}," "))};function Na(e){return(Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Da(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oa(e){return(Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ta(e,t){return(Ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Aa=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Oa(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Na(r)&&"function"!=typeof r?wa(a):r,Ca(wa(n),"getIcon",(function(){return n.props.showIcon?de.a.createElement("i",{className:"icon "+n.props.customIcon}):null})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ta(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.buttonType,a=e.id,r=e.style,o=e.text,i=e.disabled;return de.a.createElement("button",{onClick:t,type:"submit",disabled:i,"data-id":this.props["data-id"],className:"btn save "+n,id:a,style:r},this.getIcon(),o)}}])&&Da(n.prototype,a),r&&Da(n,r),t}(de.a.Component);Ca(Aa,"propTypes",{showIcon:tt.a.bool,id:tt.a.string,customIcon:tt.a.string,style:tt.a.object,buttonType:tt.a.string,"data-id":tt.a.string,onClick:tt.a.func,disabled:tt.a.bool}),Ca(Aa,"defaultProps",{disabled:!1,showIcon:!0,customIcon:"fonticon-ok-circled",buttonType:"btn-primary",style:{},"data-id":null,onClick:function(){}});var Ia=n(136),Pa=n.n(Ia);function Ra(e){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ka(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function La(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xa(e,t,n){return t&&La(e.prototype,t),n&&La(e,n),e}function Ua(e,t){return!t||"object"!==Ra(t)&&"function"!=typeof t?ja(e):t}function Ma(e){return(Ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ja(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ha(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ba(e,t)}function Ba(e,t){return(Ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ga(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qa=function(e){function t(){var e,n;ka(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Ga(ja(n=Ua(this,(e=Ma(t)).call.apply(e,[this].concat(r)))),"createSectionLinks",(function(e){return e?e.map((function(e,t){return n.createEntry(e,t)})):null})),Ga(ja(n),"createEntry",(function(e,t){return de.a.createElement("li",{key:t},de.a.createElement("a",{className:Tt()("icon",e.icon,{"fonticon-placeholder":!e.icon}),"data-bypass":e.external?"true":"",href:e.url,onClick:e.onClick,target:e.external?"_blank":""},e.title))})),Ga(ja(n),"createSectionTitle",(function(e,t){return e?de.a.createElement("li",{key:t,className:"header-label"},e):null})),Ga(ja(n),"createSection",(function(){return n.props.links.map((function(e,t){return e.title&&e.links?[n.createSectionTitle(e.title,"title_"+t),n.createSectionLinks(e.links)]:n.createEntry(e,"el"+t)}))})),n}return Ha(t,e),xa(t,[{key:"render",value:function(){var e=this.createSection(),t=this.props.hideArrow?"":"arrow",n="button"===this.props.toggleType?Va:Fa;return de.a.createElement(Ct.d,{id:"dropdown-menu"},de.a.createElement(n,{bsRole:"toggle",icon:this.props.icon}),de.a.createElement(Ka,{bsRole:"menu",className:t},e))}}]),t}(de.a.Component);Ga(qa,"defaultProps",{icon:"fonticon-plus-circled",hideArrow:!1,toggleType:"link"}),Ga(qa,"propTypes",{icon:tt.a.string,hideArrow:tt.a.bool,links:tt.a.array.isRequired,toggleType:tt.a.string.isRequired});var Va=function(e){function t(e,n){var a;return ka(this,t),(a=Ua(this,Ma(t).call(this,e,n))).handleClick=a.handleClick.bind(ja(a)),a}return Ha(t,e),xa(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onClick(e)}},{key:"render",value:function(){return de.a.createElement(Ct.a,{onClick:this.handleClick},de.a.createElement("i",{className:"dropdown-toggle "+this.props.icon,style:{fontSize:"1rem",boxShadow:"0px 0px 0px"}}),this.props.children)}}]),t}(de.a.Component),Fa=function(e){function t(e,n){var a;return ka(this,t),(a=Ua(this,Ma(t).call(this,e,n))).handleClick=a.handleClick.bind(ja(a)),a}return Ha(t,e),xa(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onClick(e)}},{key:"render",value:function(){return de.a.createElement("a",{className:"dropdown-toggle icon "+this.props.icon,style:{fontSize:"1rem",boxShadow:"0px 0px 0px"},onClick:this.handleClick},this.props.children)}}]),t}(de.a.Component),Ka=function(e){function t(e,n){return ka(this,t),Ua(this,Ma(t).call(this,e,n))}return Ha(t,e),xa(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.open,a=e.onClose,r=e.className;return de.a.createElement(Pa.a,{disabled:!n,onRootClose:a},de.a.createElement("ul",{className:Tt()("dropdown-menu",r),role:"menu","aria-labelledby":"dLabel"},t))}}]),t}(de.a.Component),Wa=n(17);function Xa(e){return(Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function za(){return(za=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ya(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qa(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ja(e,t,n){return t&&Qa(e.prototype,t),n&&Qa(e,n),e}function Za(e,t){return!t||"object"!==Xa(t)&&"function"!=typeof t?er(e):t}function $a(e){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function er(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}function nr(e,t){return(nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ar(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rr=function(e){function t(e){var n;return Ya(this,t),ar(er(n=Za(this,$a(t).call(this,e))),"getChildren",(function(e){var t=e[0].style,a="tray show-tray "+n.props.className;return de.a.createElement("div",{key:"1",id:n.props.id,style:{opacity:t.opacity,top:t.top+"px"},className:a},n.props.children)})),ar(er(n),"willEnter",(function(){return{opacity:Object(Wa.spring)(1),top:Object(Wa.spring)(64)}})),ar(er(n),"willLeave",(function(){return{opacity:Object(Wa.spring)(0),top:Object(Wa.spring)(30)}})),ar(er(n),"getDefaultStyles",(function(){return[{key:"1",style:{opacity:0,top:30}}]})),ar(er(n),"getStyles",(function(e){return e?e.map((function(e){return{key:"1",style:e.style}})):[{key:"1",style:n.willEnter()}]})),e.container||(n.container=er(n)),n}return tr(t,e),Ja(t,[{key:"render",value:function(){return de.a.createElement(Ct.h,{show:this.props.contentVisible,onHide:this.props.closeTray,placement:"bottom",container:this.props.container,rootClose:!0,onEnter:this.props.onEnter},de.a.createElement(Wa.TransitionMotion,{defaultStyles:this.getDefaultStyles(),styles:this.getStyles(),willLeave:this.willLeave,willEnter:this.willEnter},this.getChildren))}}]),t}(de.a.Component);ar(rr,"propTypes",{contentVisible:tt.a.bool.isRequired,closeTray:tt.a.func.isRequired,onEnter:tt.a.func,container:tt.a.object}),ar(rr,"defaultProps",{onEnter:function(){}});var or=function(e){function t(){var e,n;Ya(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return ar(er(n=Za(this,(e=$a(t)).call.apply(e,[this].concat(r)))),"renderChildren",(function(){return de.a.Children.map(n.props.children,(function(e){var t={};return Object.keys(n.props).filter((function(e){return Object.prototype.hasOwnProperty.call(n.props,e)})).map((function(e){return t[e]=n.props[e]})),de.a.cloneElement(e,t)}))})),n}return tr(t,e),Ja(t,[{key:"render",value:function(){return de.a.createElement("div",null,this.renderChildren())}}]),t}(de.a.Component);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ar(or,"defaultProps",{className:""});var pr=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=cr(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==ir(r)&&"function"!=typeof r?lr(a):r,dr(lr(n),"state",{inputValue:"",disableSubmit:!0}),dr(lr(n),"close",(function(e){e&&e.preventDefault(),n.setState({inputValue:"",disableSubmit:!0}),n.props.showHide({showModal:!1})})),dr(lr(n),"open",(function(){n.props.showHide({showModal:!0})})),dr(lr(n),"getDatabaseName",(function(){return n.props.modalProps.dbId.trim()})),dr(lr(n),"onInputChange",(function(e){var t=e.target.value.trim();n.setState({inputValue:t}),n.setState({disableSubmit:t!==n.getDatabaseName()})})),dr(lr(n),"onDeleteClick",(function(e){e.preventDefault(),bn.deleteDatabase(n.getDatabaseName(),n.props.onSuccess)})),dr(lr(n),"onInputKeypress",(function(e){13===e.keyCode&&!0!==n.state.disableSubmit&&bn.deleteDatabase(n.getDatabaseName(),n.props.onSuccess)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props.modalProps.isSystemDatabase,t=this.props.modalProps.showDeleteModal,n=this.props.modalProps.dbId,a=e?de.a.createElement("p",{style:{color:"#d14"},className:"warning"},de.a.createElement("b",null,"You are about to delete a system database, be careful!")):null;return de.a.createElement(Ct.g,{dialogClassName:"delete-db-modal",show:t,onHide:this.close},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Confirm Deletion")),de.a.createElement(Ct.g.Body,null,a,de.a.createElement("p",null,"Warning: This action will permanently delete ",de.a.createElement("code",null,n),". To confirm the deletion of the database and all of the database's documents, you must enter the database's name."),de.a.createElement("input",{type:"text",className:"input-block-level",onKeyUp:this.onInputKeypress,onChange:this.onInputChange,autoFocus:!0})),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{href:"#",onClick:this.close,"data-bypass":"true",className:"cancel-link"},"Cancel"),de.a.createElement("button",{disabled:this.state.disableSubmit,onClick:this.onDeleteClick,className:"btn btn-danger delete"},de.a.createElement("i",{className:"icon icon-trash"})," Delete Database")))}}])&&sr(n.prototype,a),r&&sr(n,r),t}(de.a.Component);dr(pr,"propTypes",{showHide:tt.a.func.isRequired,modalProps:tt.a.object,onSuccess:tt.a.func});var fr=function(e){var t=e.selected,n=e.text,a=e.onChange,r=e.iconClass,o=e.badgeText,i=t?"tab-element-checked":"",s=null;return o&&(s=de.a.createElement("span",{className:"tab-element-badge"},o)),de.a.createElement("li",{className:"component-tab-element ".concat(i)},de.a.createElement("label",null,de.a.createElement("div",{className:"tab-element-indicator-wrapper"},de.a.createElement("div",{className:"tab-element-indicator"})),de.a.createElement("div",{className:"tab-element-content"},de.a.createElement("i",{className:r}),de.a.createElement("input",{type:"radio",value:n,checked:t,onChange:a}),n,s)))};fr.propTypes={selected:tt.a.bool.isRequired,text:tt.a.string.isRequired,onChange:tt.a.func.isRequired,iconClass:tt.a.string,badgeText:tt.a.string};var hr,mr=function(e){var t=e.children;return de.a.createElement("ul",{className:"component-tab-element-wrapper"},t)},gr=n(399),br=n.n(gr);function yr(e){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Er(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nr=function(){hr&&window.clearInterval(hr)},Dr=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=_r(t).call(this,e))||"object"!==yr(r)&&"function"!=typeof r?vr(a):r).state={value:n.props.startValue},n.updatePollingFreq=n.updatePollingFreq.bind(vr(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.setPollingCounter(this.state.value)}},{key:"componentWillUnmount",value:function(){Nr()}},{key:"setPollingCounter",value:function(e){var t,n,a=this.props,r=a.min,o=a.max,i=a.onPoll;this.setState({value:e}),0===e||e<r||e>o?Nr():(t=1e3*e,n=function(){return i()},Nr(),hr=window.setInterval(n,t))}},{key:"updatePollingFreq",value:function(e){this.setPollingCounter(parseInt(e.target.value,10))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.startValue!==e.startValue&&this.setPollingCounter(e.startValue)}},{key:"render",value:function(){var e=this.props,t=e.stepSize,n=e.min,a=e.max,r=e.valueUnits,o=this.state.value,i=function(e,t,n,a){var r=parseInt(e,10);if(0===r||r>n||r<a)return"off";if(r<60&&"minute"===t)return"".concat(r," seconds");var o=r;return"minute"===t&&(o=Math.floor(r/60)),"".concat(o," ").concat(1===o?t:"".concat(t,"s"))}(o,r,a,n),s="off"===i?"faux__polling-info-value--off":"faux__polling-info-value--active";return de.a.createElement("div",{className:"faux__polling"},de.a.createElement("div",{className:"faux__polling-info"},de.a.createElement("span",{className:"faux__polling-info-text"},"Polling Interval"),de.a.createElement("span",{className:"faux__polling-info-value faux__polling-info-value ".concat(s)},i)),de.a.createElement(br.a,{onChange:this.updatePollingFreq,className:"faux__polling-info-slider",type:"range",value:o,min:n,max:a+t,step:t}))}}])&&Er(n.prototype,a),r&&Er(n,r),t}(de.a.Component);Dr.defaultProps={startValue:0,min:0,valueUnits:"minute"},Dr.propTypes={startValue:tt.a.number,valueUnits:tt.a.string,min:tt.a.number,max:tt.a.number.isRequired,stepSize:tt.a.number.isRequired,onPoll:tt.a.func.isRequired};var Or=function(e){var t=e.refresh;return de.a.createElement("div",{className:"faux__refresh-btn"},de.a.createElement("a",{className:"faux__refresh-link",href:"#","data-bypass":"true",onClick:function(e){e.preventDefault(),t()}},de.a.createElement("i",{className:"faux__refresh-icon fonticon-arrows-cw"}),"Refresh"))};Or.propTypes={refresh:tt.a.func.isRequired};var wr,Tr=n(400),Cr=n.n(Tr);function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ir(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Pr(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rr(e){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kr(e,t){return(kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lr=function(e,t){(wr=new Cr.a("#copy-"+e)).on("success",(function(){t()}))},xr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pr(this,Rr(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kr(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){Lr(this.props.uniqueKey,this.props.onClipboardClick)}},{key:"componentWillUnmount",value:function(){wr.destroy()}},{key:"componentDidUpdate",value:function(){Lr(this.props.uniqueKey,this.props.onClipboardClick)}},{key:"getClipboardElement",value:function(){return"icon"===this.props.displayType?de.a.createElement("i",{"aria-hidden":"true",className:"fontawesome icon-paste"}):this.props.textDisplay}},{key:"getClipboardButton",value:function(){var e="input"===this.props.displayType?"btn copy-button":"copy clipboard-copy-element";return de.a.createElement("button",{"aria-label":"Copy to Clipboard",className:e,"data-clipboard-text":this.props.text,title:this.props.title,id:"copy-"+this.props.uniqueKey},this.getClipboardElement())}},{key:"render",value:function(){return"input"===this.props.displayType?de.a.createElement("p",null,de.a.createElement("input",{type:"text",className:"input-xxlarge text-field-to-copy",readOnly:!0,value:this.props.text}),this.getClipboardButton()):this.getClipboardButton()}}])&&Ir(n.prototype,a),r&&Ir(n,r),t}(de.a.Component);function Ur(e){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jr(e,t){return!t||"object"!==Ur(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hr(e){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}xr.defaultProps={displayType:"icon",textDisplay:"Copy",title:"Copy to clipboard",onClipboardClick:function(){}},xr.propTypes={text:tt.a.string.isRequired,displayType:tt.a.oneOf(["icon","text","input"]),uniqueKey:tt.a.string.isRequired,onClipboardClick:tt.a.func.isRequired};var Gr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jr(this,Hr(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Br(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.selectedTab,n=e.tabs,a=n.map((function(e,n){return de.a.createElement(fr,{key:n,selected:e.name===t,text:e.name,badgeText:e.badgeText,onChange:function(){se.navigate(e.route,{redirect:!0})},iconClass:""})})),r=n.reduce((function(e,n){return n.name===t?n:e}),{});return r.component?de.a.createElement("div",{className:"tab__wrapper"},de.a.createElement(mr,null,a),de.a.createElement("div",{className:"tab__container"},de.a.createElement(r.component,null))):null}}])&&Mr(n.prototype,a),r&&Mr(n,r),t}(de.a.Component);Gr.propTypes={tabs:tt.a.array.isRequired,selectedTab:tt.a.string.isRequired};var qr=n(34);function Vr(e){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fr(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Kr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Xr(e,t){return!t||"object"!==Vr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qr=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Xr(this,zr(t).call(this,e))).lastCall=void 0,n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(t,e),n=t,(a=[{key:"wrapThrottler",value:function(e){var t=this;return e?function(n,a){t.lastCall&&clearTimeout(t.lastCall),t.lastCall=setTimeout((function(){e(n,a)}),400)}:function(){}}},{key:"render",value:function(){var e=this.wrapThrottler(this.props.loadOptions).bind(this),t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fr(n,!0).forEach((function(t){Kr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fr(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.props,{loadOptions:e,onBlurResetsInput:!1});return de.a.createElement(qr.a.Async,t)}}])&&Wr(n.prototype,a),r&&Wr(n,r),t}(de.a.Component),Jr={Accordion:function(e){var t=e.children,n=e.className,a=e.style,r=Tt()("faux--accordion",n);return de.a.createElement("ul",{className:r,style:a},t)},AccordionItem:xt,BadgeList:Wt,Badge:Xt,BulkActionComponent:sn,ConfirmButton:Aa,ToggleHeaderButton:$t,StyledSelect:fn,CodeEditorPanel:sa,CodeEditor:xn,StringEditModal:Cn,ZenModeOverlay:$n,Beautify:Kn,PaddedBorderedBox:fa,Polling:Dr,Document:va,LoadLines:Sa,MenuDropDown:qa,TrayContents:rr,TrayWrapper:or,connectToStores:function(e,t,n){return function(a){function r(){var e,t;Ya(this,r);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return ar(er(t=Za(this,(e=$a(r)).call.apply(e,[this].concat(o)))),"state",n(t.props)),ar(er(t),"onChange",(function(){t.setState(n(t.props))})),ar(er(t),"handleStoresChanged",(function(){t.setState(n(t.props))})),t}return tr(r,a),Ja(r,[{key:"componentDidMount",value:function(){var e=this;t.forEach((function(t){t.on("change",e.onChange,e)}))}},{key:"componentWillUnmount",value:function(){t.forEach(function(e){e.off("change",this.onChange)}.bind(this))}},{key:"render",value:function(){return de.a.createElement(e,za({},this.state,this.props))}}]),r}(de.a.Component)},DeleteDatabaseModal:pr,TabElement:fr,TabElementWrapper:mr,RefreshBtn:Or,Copy:xr,TabWindowWrapper:Gr,ThrottledReactSelectAsync:Qr},Zr={};Zr.DeleteDbModalStore=se.Store.extend({initialize:function(){this.reset()},reset:function(){this._deleteModal={showDeleteModal:!1,dbId:"",isSystemDatabase:!1}},setDeleteModal:function(e){e.isSystemDatabase=le.utils.isSystemDatabase(e.dbId),this._deleteModal=e},getShowDeleteDatabaseModal:function(){return this._deleteModal},dispatch:function(e){switch(e.type){case gn.CMPNTS_DATABASES_SHOWDELETE_MODAL:this.setDeleteModal(e.options);break;default:return}this.triggerChange()}}),Zr.deleteDbModalStore=new Zr.DeleteDbModalStore,Zr.deleteDbModalStore.dispatchToken=se.dispatcher.register(Zr.deleteDbModalStore.dispatch.bind(Zr.deleteDbModalStore));var $r=Zr;function eo(e){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function to(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function no(e,t){return!t||"object"!==eo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ao(e){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ro(e,t){return(ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oo=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),no(this,ao(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ro(e,t)}(t,e),n=t,(a=[{key:"perPageChange",value:function(e){var t=parseInt(e.target.value,10);this.props.perPageChange(t)}},{key:"getOptions",value:function(){return _.map(this.props.options,(function(e){return de.a.createElement("option",{value:e,key:e},e)}))}},{key:"render",value:function(){return de.a.createElement("div",{id:"per-page"},de.a.createElement("label",{htmlFor:"select-per-page",className:"drop-down inline"},this.props.label,"  ",de.a.createElement("select",{id:"select-per-page",onChange:this.perPageChange.bind(this),value:this.props.perPage.toString(),className:"input-small"},this.getOptions())))}}])&&to(n.prototype,a),r&&to(n,r),t}(de.a.Component);function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function so(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function co(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lo(e,t,n){return t&&co(e.prototype,t),n&&co(e,n),e}function uo(e,t){return!t||"object"!==io(t)&&"function"!=typeof t?fo(e):t}function po(e){return(po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ho(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mo(e,t)}function mo(e,t){return(mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function go(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}oo.defaultProps={label:"Documents per page: ",options:[5,10,20,30,50,100]},oo.propTypes={perPage:tt.a.number.isRequired,perPageChange:tt.a.func.isRequired,label:tt.a.string,options:tt.a.array};var bo=function(e){function t(){var e,n;so(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return go(fo(n=uo(this,(e=po(t)).call.apply(e,[this].concat(r)))),"getClasses",(function(){var e={js:"lang-js"},t="prettyprint";return _.has(e,n.props.lang)&&(t+=" "+e[n.props.lang]),t})),n}return ho(t,e),lo(t,[{key:"componentDidMount",value:function(){prettyPrint()}},{key:"render",value:function(){var e=JSON.stringify(this.props.code,null," ");return de.a.createElement("div",null,de.a.createElement("pre",{className:this.getClasses()},e))}}]),t}(de.a.Component);go(bo,"defaultProps",{lang:"js"});var yo=function(e){function t(){var e,n;so(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return go(fo(n=uo(this,(e=po(t)).call.apply(e,[this].concat(r)))),"getVisiblePages",(function(e,t){var a,r;if(t<n.props.maxNavPages)a=1,r=t+1;else{var o=Math.floor(n.props.maxNavPages/2);r=e+o,(a=e-o)<=1&&(a=1,r=n.props.maxNavPages+1),r>t+1&&(a=t-(n.props.maxNavPages-1),r=t+1)}return{from:a,to:r}})),go(fo(n),"createItemsForPage",(function(e){return _.range(e.from,e.to).map((function(e){return de.a.createElement("li",{key:e,className:n.props.page===e?"active":null},n.getLink(e,e))}))})),go(fo(n),"getLink",(function(e,t){return n.props.onClick?de.a.createElement("a",{onClick:n.getOnPageClick(e),dangerouslySetInnerHTML:{__html:t}}):de.a.createElement("a",{href:n.props.urlPrefix+e+n.props.urlSuffix,dangerouslySetInnerHTML:{__html:t}})})),go(fo(n),"getTotalPages",(function(){return 0===n.props.total?1:Math.ceil(n.props.total/n.props.perPage)})),n}return ho(t,e),lo(t,[{key:"getOnPageClick",value:function(e){var t=this;return function(n){n&&n.preventDefault(),t.props.onClick(e)}}},{key:"render",value:function(){var e=this.getTotalPages(),t=this.getVisiblePages(this.props.page,e),n=this.createItemsForPage(t),a=Math.max(this.props.page-1,1),r=Math.min(this.props.page+1,e);return de.a.createElement("ul",{className:"pagination"},de.a.createElement("li",{className:1===this.props.page?"disabled":null},this.getLink(a,"&laquo;")),n,de.a.createElement("li",{className:this.props.page<e?null:"disabled"},this.getLink(r,"&raquo;")))}}]),t}(de.a.Component);go(yo,"defaultProps",{perPage:se.constants.MISC.DEFAULT_PAGE_SIZE,onClick:null,page:1,total:0,urlPrefix:"",urlSuffix:"",maxNavPages:10});var Eo=function(e){function t(){var e,n;so(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return go(fo(n=uo(this,(e=po(t)).call.apply(e,[this].concat(r)))),"close",(function(e){e&&e.preventDefault(),n.props.onClose()})),n}return ho(t,e),lo(t,[{key:"render",value:function(){var e=de.a.createElement("p",null,this.props.text);_.isString(this.props.text)||(e=this.props.text);var t="btn "+this.props.buttonClass;return de.a.createElement(Ct.g,{dialogClassName:"confirmation-modal",show:this.props.visible,onHide:this.close},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,this.props.title)),de.a.createElement(Ct.g.Body,null,e),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{href:"#","data-bypass":"true",className:"cancel-link",onClick:this.close},"Cancel"),de.a.createElement("button",{className:t,onClick:this.props.onSubmit},de.a.createElement("i",{className:"fonticon-ok-circled"})," ",this.props.successButtonLabel)))}}]),t}(de.a.Component);go(Eo,"propTypes",{visible:tt.a.bool.isRequired,text:tt.a.oneOfType([tt.a.string,tt.a.element]).isRequired,onClose:tt.a.func.isRequired,onSubmit:tt.a.func.isRequired}),go(Eo,"defaultProps",{visible:!1,title:"Please confirm",text:"",successButtonLabel:"Okay",buttonClass:"btn-primary",onClose:function(){},onSubmit:function(){}});var _o={CodeFormat:bo,Pagination:yo,ConfirmationModal:Eo};function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function So(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function No(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Do(e,t,n){return t&&No(e.prototype,t),n&&No(e,n),e}function Oo(e,t){return!t||"object"!==vo(t)&&"function"!=typeof t?To(e):t}function wo(e){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function To(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Co(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ao(e,t)}function Ao(e,t){return(Ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Io(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Po=We.databasesStore,Ro=$r.deleteDbModalStore,ko=Jr.Accordion,Lo=Jr.AccordionItem,xo=Jr.DeleteDatabaseModal,Uo=Jr.ToggleHeaderButton,Mo=Jr.TrayContents,jo=function(e){function t(e){var n;return So(this,t),Io(To(n=Oo(this,wo(t).call(this,e))),"getStoreState",(function(){return{dbList:Po.getDbList(),loading:Po.isLoading(),showDeleteDatabaseModal:Ro.getShowDeleteDatabaseModal(),showPartitionedColumn:Po.isPartitionedDatabasesAvailable(),page:Po.getPage(),limit:Po.getLimit()}})),Io(To(n),"onChange",(function(){n.setState(n.getStoreState())})),Io(To(n),"state",n.getStoreState()),n.reloadAfterDatabaseDeleted=n.reloadAfterDatabaseDeleted.bind(To(n)),n}return Co(t,e),Do(t,[{key:"componentDidMount",value:function(){Po.on("change",this.onChange,this),Ro.on("change",this.onChange,this),this.loadData()}},{key:"componentDidUpdate",value:function(e,t){t.page===this.state.page&&t.limit===this.state.limit||this.loadData()}},{key:"loadData",value:function(){$e.init({page:this.state.page,limit:this.state.limit})}},{key:"componentWillUnmount",value:function(){Po.off("change",this.onChange,this),Ro.off("change",this.onChange,this)}},{key:"reloadAfterDatabaseDeleted",value:function(){var e=this.state.page;e>1&&1===this.state.dbList.length&&(e-=1),$e.init({page:e,limit:this.state.limit})}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.dbList;return de.a.createElement(Ho,{showDeleteDatabaseModal:this.state.showDeleteDatabaseModal,dbList:n,loading:t,showPartitionedColumn:this.state.showPartitionedColumn,onDatabaseDeleted:this.reloadAfterDatabaseDeleted})}}]),t}(de.a.Component),Ho=function(e){function t(){var e,n;So(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Io(To(n=Oo(this,(e=wo(t)).call.apply(e,[this].concat(r)))),"createRows",(function(e){return e.map((function(e,t){return de.a.createElement(Bo,{item:e,key:t,showPartitionedColumn:n.props.showPartitionedColumn})}))})),Io(To(n),"getExtensionColumns",(function(){var e=se.getExtensions("DatabaseTable:head");return _.map(e,(function(e,t){return de.a.createElement(e,{key:t})}))})),Io(To(n),"showDeleteDatabaseModal",(function(){bn.showDeleteDatabaseModal({showDeleteModal:!n.props.showDeleteDatabaseModal.showDeleteModal})})),n}return Co(t,e),Do(t,[{key:"render",value:function(){if(this.props.loading)return de.a.createElement("div",{className:"view"},de.a.createElement(Jr.LoadLines,null));var e=this.createRows(this.props.dbList);return de.a.createElement("div",{className:"view"},de.a.createElement(xo,{showHide:this.showDeleteDatabaseModal,modalProps:this.props.showDeleteDatabaseModal,onSuccess:this.props.onDatabaseDeleted}),de.a.createElement("table",{className:"table table-striped fauxton-table-list databases"},de.a.createElement("thead",null,de.a.createElement("tr",null,de.a.createElement("th",null,"Name"),de.a.createElement("th",null,"Size"),de.a.createElement("th",null,"# of Docs"),this.props.showPartitionedColumn?de.a.createElement("th",null,"Partitioned"):null,this.getExtensionColumns(),de.a.createElement("th",null,"Actions"))),de.a.createElement("tbody",null,e)))}}]),t}(de.a.Component);Io(Ho,"propTypes",{dbList:tt.a.array.isRequired,showDeleteDatabaseModal:tt.a.object.isRequired,loading:tt.a.bool.isRequired,showPartitionedColumn:tt.a.bool.isRequired,onDatabaseDeleted:tt.a.func});var Bo=function(e){function t(){var e,n;So(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Io(To(n=Oo(this,(e=wo(t)).call.apply(e,[this].concat(r)))),"getExtensionColumns",(function(e){var t=se.getExtensions("DatabaseTable:databaseRow");return _.map(t,(function(t,n){return de.a.createElement(t,{row:e,key:n})}))})),Io(To(n),"showDeleteDatabaseModal",(function(e){bn.showDeleteDatabaseModal({showDeleteModal:!0,dbId:e})})),n}return Co(t,e),Do(t,[{key:"render",value:function(){var e=this.props.item,t=e.encodedId,n=e.id,a=e.url,r=e.dataSize,o=e.docCount,i=e.docDelCount,s=e.showTombstoneWarning,c=e.failed,l=e.isPartitioned,u=s?de.a.createElement(Go,{docCount:o,docDelCount:i}):null;if(c)return de.a.createElement("tr",null,de.a.createElement("td",{"data-name":"database-load-fail-name"},n),de.a.createElement("td",{colSpan:"4",className:"database-load-fail"},"This database failed to load."));var d=this.props.showPartitionedColumn?de.a.createElement("td",null,l?"Yes":"No"):null;return de.a.createElement("tr",null,de.a.createElement("td",null,de.a.createElement("a",{href:a},n)),de.a.createElement("td",null,r),de.a.createElement("td",null,o," ",u),d,this.getExtensionColumns(e),de.a.createElement("td",{className:"database-actions"},de.a.createElement("a",{className:"db-actions btn fonticon-replicate set-replication-start","aria-label":"Replicate ".concat(n),title:"Replicate "+name,href:"#/replication/_create/"+t}),de.a.createElement("a",{"aria-label":"Set permissions for ".concat(n),className:"db-actions btn icon-lock set-permissions",title:"Set permissions for "+name,href:"#/database/"+t+"/permissions"}),de.a.createElement("a",{"aria-label":"Delete ".concat(n),className:"db-actions btn icon-trash",onClick:this.showDeleteDatabaseModal.bind(this,n,t),title:"Delete "+n,"data-bypass":"true"})))}}]),t}(de.a.Component);Io(Bo,"propTypes",{item:tt.a.shape({id:tt.a.string.isRequired,encodedId:tt.a.string.isRequired,url:tt.a.string.isRequired,failed:tt.a.bool.isRequired,dataSize:tt.a.string,docCount:tt.a.number,docDelCount:tt.a.number,isPartitioned:tt.a.bool,showTombstoneWarning:tt.a.bool}).isRequired,showPartitionedColumn:tt.a.bool.isRequired});var Go=function(e){var t=e.docCount,n=e.docDelCount,a="This database has just ".concat(t," docs and ").concat(n," deleted docs"),r=de.a.createElement(Ct.l,{id:"graveyard-tooltip"},a);return de.a.createElement(Ct.i,{placement:"top",overlay:r},de.a.createElement("i",{className:"js-db-graveyard icon icon-exclamation-sign",title:a}))},qo=function(e){function t(e){var n;return So(this,t),(n=Oo(this,wo(t).call(this,e))).state=n.getStoreState(),n}return Co(t,e),Do(t,[{key:"getStoreState",value:function(){return{showPartitionedOption:Po.isPartitionedDatabasesAvailable()}}},{key:"componentDidMount",value:function(){Po.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){Po.off("change",this.onChange,this)}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"render",value:function(){return de.a.createElement("div",{className:"header-right right-db-header flex-layout flex-row"},de.a.createElement(Fo,{loadOptions:$e.fetchAllDbsWithKey}),de.a.createElement(Vo,{showPartitionedOption:this.state.showPartitionedOption,partitionedDbHelpText:this.props.partitionedDbHelpText}))}}]),t}(de.a.Component),Vo=function(e){function t(e){var n;return So(this,t),(n=Oo(this,wo(t).call(this,e))).state={isPromptVisible:!1,databaseName:"",partitionedSelected:void 0},n.onTrayToggle=n.onTrayToggle.bind(To(n)),n.closeTray=n.closeTray.bind(To(n)),n.focusInput=n.focusInput.bind(To(n)),n.onKeyUpInInput=n.onKeyUpInInput.bind(To(n)),n.onChange=n.onChange.bind(To(n)),n.onAddDatabase=n.onAddDatabase.bind(To(n)),n.onSetPartitioned=n.onSetPartitioned.bind(To(n)),n.onSetNotPartitioned=n.onSetNotPartitioned.bind(To(n)),n}return Co(t,e),Do(t,[{key:"getI18nText",value:function(e){return this.props.i18n?this.props.i18n[e]:""}},{key:"onTrayToggle",value:function(){this.setState({isPromptVisible:!this.state.isPromptVisible})}},{key:"closeTray",value:function(){this.setState({isPromptVisible:!1})}},{key:"focusInput",value:function(){this.newDbName.focus()}},{key:"onKeyUpInInput",value:function(e){13===e.which&&this.onAddDatabase()}},{key:"onChange",value:function(e){this.setState({databaseName:e.target.value})}},{key:"onAddDatabase",value:function(){if(this.props.showPartitionedOption&&void 0===this.state.partitionedSelected)se.addNotification({type:"error",msg:"Please select either Partitioned or Non-partitioned",clear:!0});else{var e=this.props.showPartitionedOption?this.state.partitionedSelected:void 0;$e.createNewDatabase(this.state.databaseName,e)}}},{key:"onSetNotPartitioned",value:function(){this.setState({partitionedSelected:!1})}},{key:"onSetPartitioned",value:function(){this.setState({partitionedSelected:!0})}},{key:"partitionedOption",value:function(){if(!this.props.showPartitionedOption)return null;var e=this.props.partitionedDbHelpText?de.a.createElement(ko,{className:"partitioned-db-help"},de.a.createElement(Lo,{title:"What is a Partitioned Database?"},de.a.createElement("p",{dangerouslySetInnerHTML:{__html:this.props.partitionedDbHelpText}}))):null;return de.a.createElement("div",{className:"partitioned-db-section"},de.a.createElement("label",{htmlFor:"partitioned-db",className:"partitioned-db-label"},"Partitioning"),de.a.createElement("div",{className:"partitioned-db-options"},de.a.createElement("input",{id:"partitioned-db",type:"radio",checked:!0===this.state.partitionedSelected,onChange:this.onSetPartitioned}),de.a.createElement("label",{htmlFor:"partitioned-db"},"Partitioned"),de.a.createElement("input",{id:"non-partitioned-db",type:"radio",checked:!1===this.state.partitionedSelected,onChange:this.onSetNotPartitioned}),de.a.createElement("label",{htmlFor:"non-partitioned-db"},"Non-partitioned")),e)}},{key:"render",value:function(){var e=this,t=Tt()("new-database-tray",{"new-database-tray--expanded":this.props.showPartitionedOption});return de.a.createElement("div",null,de.a.createElement(Uo,{selected:this.state.isPromptVisible,toggleCallback:this.onTrayToggle,containerClasses:"header-control-box add-new-database-btn",title:"Create Database",fonticon:"fonticon-new-database",text:"Create Database"}),de.a.createElement(Mo,{className:t,contentVisible:this.state.isPromptVisible,closeTray:this.closeTray,onEnter:this.focusInput},de.a.createElement("div",{className:"tray-contents"},de.a.createElement("div",{className:"tray-header"},de.a.createElement("h3",null,"Create Database")),de.a.createElement("div",{className:"tray-body"},de.a.createElement("label",{htmlFor:"js-new-database-name",className:"db-name-label"},"Database name"),de.a.createElement("input",{id:"js-new-database-name",ref:function(t){return e.newDbName=t},type:"text",value:this.state.databaseName,onChange:this.onChange,onKeyUp:this.onKeyUpInInput,className:"input-xxlarge",placeholder:"database-name"}),this.partitionedOption()),de.a.createElement("div",{className:"tray-footer"},de.a.createElement("a",{className:"btn btn-cancel",id:"js-cancel-create-database",onClick:this.closeTray},"Cancel"),de.a.createElement("a",{className:"btn btn-primary",id:"js-create-database",onClick:this.onAddDatabase},"Create")))))}}]),t}(de.a.Component);Io(Vo,"defaultProps",{showPartitionedOption:!1}),Io(Vo,"propTypes",{showPartitionedOption:tt.a.bool.isRequired,partitionedDbHelpText:tt.a.string});var Fo=function(e){var t=e.loadOptions;return de.a.createElement("div",{"data-name":"jump-to-db",className:"faux-header__searchboxwrapper"},de.a.createElement("div",{className:"faux-header__searchboxcontainer"},de.a.createElement(Jr.ThrottledReactSelectAsync,{placeholder:"Database name",loadOptions:t,clearable:!1,onChange:function(e){var t=e.value;$e.jumpToDatabase(t)}})))};Fo.propTypes={loadOptions:tt.a.func.isRequired};var Ko=function(e){function t(){var e,n;So(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return Io(To(n=Oo(this,(e=wo(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(e){var t=e.store;return{totalAmountOfDatabases:t.getTotalAmountOfDatabases(),page:t.getPage(),limit:t.getLimit()}})),Io(To(n),"onChange",(function(){n.setState(n.getStoreState(n.props))})),Io(To(n),"state",n.getStoreState(n.props)),n}return Co(t,e),Do(t,[{key:"componentDidMount",value:function(){this.props.store.on("change",this.onChange,this)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState(this.getStoreState(e)),this.props.store&&this.props.store.off("change",this.onChange,this),e.store.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){this.props.store.off("change",this.onChange,this)}},{key:"onPageLinkClick",value:function(e){var t="#/".concat(this.props.linkPath,"?page=").concat(e,"&limit=").concat(this.state.limit);se.navigate(t)}},{key:"onPerPageSelected",value:function(e){var t="#/".concat(this.props.linkPath,"?page=").concat(this.state.page,"&limit=").concat(e);se.navigate(t)}},{key:"render",value:function(){var e=this.state,t=e.limit,n=e.page,a=e.totalAmountOfDatabases,r=1+(n-1)*t,o=Math.min(a,n*t);return de.a.createElement("footer",{className:"all-db-footer pagination-footer"},de.a.createElement("div",{id:"database-pagination"},de.a.createElement(_o.Pagination,{page:n,total:a,perPage:t,onClick:this.onPageLinkClick.bind(this)})),de.a.createElement(oo,{label:"Databases per page",perPage:t,perPageChange:this.onPerPageSelected.bind(this)}),de.a.createElement("div",{className:"current-databases"},"Showing ",de.a.createElement("span",{className:"all-db-footer__range"},r,"–",o)," of ",de.a.createElement("span",{className:"all-db-footer__total-db-count"},a)," databases."))}}]),t}(de.a.Component);Io(Ko,"defaultProps",{linkPath:"_all_dbs",store:Po});var Wo={DatabasesController:jo,DatabaseTable:Ho,DatabaseRow:Bo,RightDatabasesHeader:qo,GraveyardInfo:Go,AddDatabaseWidget:Vo,JumpToDatabaseWidget:Fo,DatabasePagination:Ko},Xo=Wo.RightDatabasesHeader,zo=Wo.DatabasesController,Yo=Wo.DatabasePagination,Qo=function(){return de.a.createElement(Et,null,de.a.createElement(_t,{crumbs:[{name:"Databases"}],endpoint:se.urls("allDBs","apiurl"),docURL:se.constants.DOC_URLS.ALL_DBS},de.a.createElement(Xo,{partitionedDbHelpText:le.i18n.en_US["create-db-partitioned-help"]})),de.a.createElement(vt,null,de.a.createElement(zo,null)),de.a.createElement(St,null,de.a.createElement(Yo,null)))},Jo=se.RouteObject.extend({hideApiBar:!0,hideNotificationCenter:!0,routes:{"":"allDatabases","index.html":"allDatabases","_all_dbs(:extra)":"allDatabases"},roles:["fx_loggedIn"],selectedHeader:"Databases",allDatabases:function(e,t){var n=this.createParams(t),a=n.page,r=n.limit;return $e.setPage(a),r&&$e.setLimit(r),de.a.createElement(Qo,null)},createParams:function(e){var t=1,n=void 0;if(e){var a=le.getParams(e);isFinite(parseInt(a.page))&&(t=parseInt(a.page)),isFinite(parseInt(a.limit))&&(n=parseInt(a.limit))}return{page:t,limit:n}}});Ge.RouteObjects=[Jo];var Zo=Ge;function $o(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(n,!0).forEach((function(t){ti(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ni={partitionedDatabasesAvailable:!1,isLoadingDbInfo:!0,dbInfo:void 0,isDbPartitioned:!1};n(695);function ai(e){return e?"/_partition/".concat(e):""}Zo.initialize=function(){se.addHeaderLink({href:"#/_all_dbs",title:"Databases",icon:"fonticon-database",className:"databases"}),$e.checkPartitionedQueriesIsAvailable()},Zo.PARTITONED_DB_CHECK_EXTENSION="Databases:PartitionedDbCheck",se.registerExtension(Zo.PARTITONED_DB_CHECK_EXTENSION,(function(){return v(A.getServerUrl("/")).then((function(e){return!(!e.features||-1===e.features.indexOf("partitioned"))||!(!e.features_flags||-1===e.features_flags.indexOf("partitioned"))})).catch((function(){return!1}))})),se.addReducers({databases:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ni,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case ke.DATABASES_PARTITIONED_DB_AVAILABLE:return ei({},t,{partitionedDatabasesAvailable:n.options.available});case ke.DATABASES_FETCH_SELECTED_DB_METADATA:return ei({},t,{isLoadingDbInfo:!0,dbInfo:void 0,isDbPartitioned:!1});case ke.DATABASES_FETCH_SELECTED_DB_METADATA_SUCCESS:return ei({},t,{isLoadingDbInfo:!1,dbInfo:n.options.metadata,isDbPartitioned:(e=n.options.metadata,!(!e||!e.props||!0!==e.props.partitioned))});default:return t}}}),Zo.databaseUrl=function(e){var t=_.isObject(e)?e.id:e;return["/database/",le.utils.safeURLName(t),"/_all_docs?limit="+Zo.DocLimit].join("")},se.registerUrls("changes",{server:function(e,t){return A.getServerUrl("/"+e+"/_changes"+t)},app:function(e,t,n){return"/database/"+e+ai(t)+"/_changes"+n},apiurl:function(e,t){return A.getApiUrl("/"+e+"/_changes"+t)}}),se.registerUrls("allDBs",{server:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return A.getServerUrl("/_all_dbs".concat(e))},app:function(){return"_all_dbs"},apiurl:function(){return A.getApiUrl("/_all_dbs")}}),se.registerUrls("databaseBaseURL",{server:function(e){return A.getServerUrl("/"+le.utils.safeURLName(e))},apiurl:function(e){return A.getApiUrl("/"+le.utils.safeURLName(e))},app:function(e){return"/database/"+e}}),se.registerUrls("permissions",{server:function(e){return A.getServerUrl("/"+e+"/_security")},app:function(e,t){return"/database/"+e+ai(t)+"/permissions"},apiurl:function(e){return A.getApiUrl("/"+e+"/_security")}});var ri=Zo,oi={SIDEBAR_EXPAND_SELECTED_ITEM:"SIDEBAR_EXPAND_SELECTED_ITEM",SIDEBAR_NEW_OPTIONS:"SIDEBAR_NEW_OPTIONS",SIDEBAR_TOGGLE_CONTENT:"SIDEBAR_TOGGLE_CONTENT",SIDEBAR_FETCHING:"SIDEBAR_FETCHING",SIDEBAR_SHOW_DELETE_INDEX_MODAL:"SIDEBAR_SHOW_DELETE_INDEX_MODAL",SIDEBAR_HIDE_DELETE_INDEX_MODAL:"SIDEBAR_HIDE_DELETE_INDEX_MODAL",SIDEBAR_SHOW_CLONE_INDEX_MODAL:"SIDEBAR_SHOW_CLONE_INDEX_MODAL",SIDEBAR_HIDE_CLONE_INDEX_MODAL:"SIDEBAR_HIDE_CLONE_INDEX_MODAL",SIDEBAR_CLONE_MODAL_DESIGN_DOC_CHANGE:"SIDEBAR_CLONE_MODAL_DESIGN_DOC_CHANGE",SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_NAME_UPDATED:"SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_NAME_UPDATED",SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_PARTITIONED_UPDATED:"SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_PARTITIONED_UPDATED",SIDEBAR_CLONE_MODAL_UPDATE_INDEX_NAME:"SIDEBAR_CLONE_MODAL_UPDATE_INDEX_NAME",SIDEBAR_UPDATED_DESIGN_DOCS:"SIDEBAR_UPDATED_DESIGN_DOCS"},ii={dispatchNewOptions:function(e){var t,n;e.database.safeID()!==(t=se.reduxState(),!(n=t.sidebar)||n.loading?"":n.database.safeID())&&se.reduxDispatch({type:oi.SIDEBAR_FETCHING}),e.designDocs.fetch().then((function(){se.reduxDispatch({type:oi.SIDEBAR_NEW_OPTIONS,options:e})}),(function(t){var n="Unable to update the sidebar.";if(t.responseJSON&&"not_found"===t.responseJSON.error){var a=e.designDocs.database.safeID();n="The ".concat(a," database does not exist."),se.navigate("/",{trigger:!0})}se.addNotification({msg:n,type:"error",clear:!0})}))},dispatchUpdateDesignDocs:function(e){se.reduxDispatch({type:oi.SIDEBAR_FETCHING}),e.fetch().then((function(){se.reduxDispatch({type:oi.SIDEBAR_UPDATED_DESIGN_DOCS,options:{designDocs:e}})}))},toggleContent:function(e,t){return function(n){n({type:oi.SIDEBAR_TOGGLE_CONTENT,designDoc:e,indexGroup:t})}},showDeleteIndexModal:function(e,t,n,a){return function(r){r({type:oi.SIDEBAR_SHOW_DELETE_INDEX_MODAL,options:{indexName:e,indexLabel:n,designDocName:t,onDelete:a}})}},hideDeleteIndexModal:function(){return function(e){e({type:oi.SIDEBAR_HIDE_DELETE_INDEX_MODAL})}},dispatchHideDeleteIndexModal:function(){se.reduxDispatch({type:oi.SIDEBAR_HIDE_DELETE_INDEX_MODAL})},showCloneIndexModal:function(e,t,n,a){return function(r){r({type:oi.SIDEBAR_SHOW_CLONE_INDEX_MODAL,options:{sourceIndexName:e,sourceDesignDocName:t,onSubmit:a,indexLabel:n,cloneIndexModalTitle:"Clone "+n}})}},hideCloneIndexModal:function(){return function(e){e({type:oi.SIDEBAR_HIDE_CLONE_INDEX_MODAL})}},updateNewDesignDocName:function(e){return function(t){t({type:oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_NAME_UPDATED,options:{value:e}})}},updateNewDesignDocPartitioned:function(e){return function(t){t({type:oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_PARTITIONED_UPDATED,options:{value:e}})}},selectDesignDoc:function(e){return function(t){t({type:oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_CHANGE,options:{value:e}})}},setNewCloneIndexName:function(e){return function(t){t({type:oi.SIDEBAR_CLONE_MODAL_UPDATE_INDEX_NAME,options:{value:e}})}},dispatchExpandSelectedItem:function(e){se.reduxDispatch({type:oi.SIDEBAR_EXPAND_SELECTED_ITEM,options:{selectedNavItem:e}})}},si=se.RouteObject.extend({selectedHeader:"Databases",createDesignDocsCollection:function(){this.designDocs=new je.AllDocs(null,{database:this.database,paging:{pageSize:500},params:{startkey:"_design/",endkey:"_design0",include_docs:!0,limit:500}})},addSidebar:function(e){var t={designDocs:this.designDocs,database:this.database};e&&(t.selectedNavItem=e),ii.dispatchNewOptions(t)},getCrumbs:function(e){return[{type:"back",link:se.urls("allDBs","app")},{name:e.id}]},createParams:function(e){var t=le.getParams(e);return{urlParams:t,docParams:je.QueryParams.parse(t)}}});var ci=function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.navItem=t,n){var a=n.designDocName,r=n.designDocSection,o=n.indexName;this.designDocName=a||"",this.designDocSection=r||"",this.indexName=o||""}};function li(e){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ui(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function di(e){return(di=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fi(e,t){return(fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hi=Jr.StyledSelect,mi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=di(t).call(this,e))||"object"!==li(r)&&"function"!=typeof r?pi(a):r).onTogglePartitioned=n.onTogglePartitioned.bind(pi(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fi(e,t)}(t,e),n=t,(a=[{key:"validate",value:function(){return"new-doc"!==this.props.selectedDesignDocName||""!==this.props.newDesignDocName||(se.addNotification({msg:"Please name your design doc.",type:"error"}),this.newDesignDocInput.focus(),!1)}},{key:"getDocList",value:function(){return this.props.designDocList?this.props.designDocList.map((function(e){return de.a.createElement("option",{key:e,value:e},e)})):[]}},{key:"selectDesignDoc",value:function(e){this.props.onSelectDesignDoc(e.target.value)}},{key:"updateDesignDocName",value:function(e){this.props.onChangeNewDesignDocName(e.target.value)}},{key:"getNewDDocField",value:function(){var e=this;if("new-doc"===this.props.selectedDesignDocName)return de.a.createElement("div",{id:"new-ddoc-section",className:"span5"},de.a.createElement("label",{className:"control-label",htmlFor:"new-ddoc"},"_design/"),de.a.createElement("div",{className:"controls"},de.a.createElement("input",{type:"text",id:"new-ddoc",placeholder:"newDesignDoc",ref:function(t){e.newDesignDocInput=t},onChange:this.updateDesignDocName.bind(this)})))}},{key:"getDocLink",value:function(){return this.props.docLink?de.a.createElement("a",{className:"help-link","data-bypass":"true",href:this.props.docLink,target:"_blank",rel:"noopener noreferrer"},de.a.createElement("i",{className:"icon-question-sign"})):null}},{key:"onTogglePartitioned",value:function(){this.props.onChangeNewDesignDocPartitioned(!this.props.newDesignDocPartitioned)}},{key:"getPartitionedCheckbox",value:function(){if(!this.props.isDbPartitioned)return null;var e="new-doc"!==this.props.selectedDesignDocName,t=e?this.props.selectedDesignDocPartitioned:this.props.newDesignDocPartitioned,n=e?"check--disabled":"",a=e?this.props.selectedDesignDocPartitioned?"Design document is partitioned":"Design document is not partitioned":this.props.newDesignDocPartitioned?"New document will be partitioned":"New document will not be partitioned";return de.a.createElement("div",{className:"ddoc-selector-partitioned"},de.a.createElement("label",{className:n,title:a},de.a.createElement("input",{id:"js-ddoc-selector-partitioned",type:"checkbox",title:a,checked:t,onChange:this.onTogglePartitioned,style:{margin:"0px 10px 0px 0px"},disabled:e}),"Partitioned"))}},{key:"render",value:function(){var e=de.a.createElement("optgroup",{label:"Select a document"},de.a.createElement("option",{value:"new-doc"},"New document"),this.getDocList());return de.a.createElement("div",{className:"design-doc-group control-group"},de.a.createElement("div",{className:"span3"},de.a.createElement("label",{htmlFor:"ddoc"},this.props.designDocLabel,this.getDocLink()),de.a.createElement(hi,{selectChange:this.selectDesignDoc.bind(this),selectValue:this.props.selectedDesignDocName,selectId:"faux__edit-view__design-doc",selectContent:e})),this.getNewDDocField(),this.getPartitionedCheckbox())}}])&&ui(n.prototype,a),r&&ui(n,r),t}(ue.Component);function gi(e){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bi(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yi(e,t){return!t||"object"!==gi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ei(e){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}mi.defaultProps={designDocLabel:"Design Document",selectedDesignDocName:"",newDesignDocName:""},mi.propTypes={designDocList:tt.a.array.isRequired,onSelectDesignDoc:tt.a.func.isRequired,onChangeNewDesignDocName:tt.a.func.isRequired,selectedDesignDocName:tt.a.string.isRequired,selectedDesignDocPartitioned:tt.a.bool.isRequired,newDesignDocName:tt.a.string.isRequired,newDesignDocPartitioned:tt.a.bool.isRequired,designDocLabel:tt.a.string,docURL:tt.a.string};var vi=le.helpers.getDocUrl,Si=Jr.CodeEditorPanel,Ni=Jr.StyledSelect,Di=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yi(this,Ei(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(t,e),n=t,(a=[{key:"getOptionsList",value:function(){return this.props.reduceOptions.map((function(e,t){return de.a.createElement("option",{key:t,value:e},e)}))}},{key:"getReduceValue",value:function(){return this.props.hasReduce?this.props.hasCustomReduce?this.reduceEditor.getValue():this.props.reduce:null}},{key:"getEditor",value:function(){return this.reduceEditor.getEditor()}},{key:"updateReduceCode",value:function(e){this.props.updateReduceCode(e)}},{key:"selectChange",value:function(e){this.props.selectReduceChanged(e.target.value)}},{key:"render",value:function(){var e,t=this,n=this.getOptionsList();return this.props.hasCustomReduce&&this.props.customReducerSupported?e=de.a.createElement(Si,{ref:function(e){return t.reduceEditor=e},id:"reduce-function",title:"Custom Reduce function",defaultCode:this.props.reduce,allowZenMode:!1,blur:this.updateReduceCode.bind(this)}):this.props.customReducerSupported||(e=de.a.createElement("div",{className:"reduce-editor-warning"},de.a.createElement("label",null,"Partitioned views do not support custom reduce functions."))),de.a.createElement("div",null,de.a.createElement("div",{className:"control-group"},de.a.createElement("label",{htmlFor:"reduce-function-selector"},de.a.createElement("span",null,"Reduce (optional)"),de.a.createElement("a",{className:"help-link","data-bypass":"true",href:vi("REDUCE_FUNCS"),target:"_blank",rel:"noopener noreferrer"},de.a.createElement("i",{className:"icon-question-sign"}))),de.a.createElement(Ni,{selectContent:n,selectChange:this.selectChange.bind(this),selectId:"reduce-function-selector",selectValue:this.props.reduceSelectedOption})),e)}}])&&bi(n.prototype,a),r&&bi(n,r),t}(ue.Component);function Oi(e){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wi(){return(wi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ti(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ci(e){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ii(e,t){return(Ii=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Di.defaultProps={customReducerSupported:!0},Di.propTypes={reduceOptions:tt.a.array.isRequired,hasReduce:tt.a.bool.isRequired,hasCustomReduce:tt.a.bool.isRequired,customReducerSupported:tt.a.bool,reduce:tt.a.string,reduceSelectedOption:tt.a.string.isRequired,updateReduceCode:tt.a.func.isRequired,selectReduceChanged:tt.a.func.isRequired};var Pi=le.helpers.getDocUrl,Ri=Jr.CodeEditorPanel,ki=Jr.ConfirmButton,Li=Jr.LoadLines,xi=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=Ci(t).call(this,e))||"object"!==Oi(r)&&"function"!=typeof r?Ai(a):r).saveView=n.saveView.bind(Ai(n)),n.viewChange=n.viewChange.bind(Ai(n)),n.updateMapCode=n.updateMapCode.bind(Ai(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ii(e,t)}(t,e),n=t,(a=[{key:"componentDidUpdate",value:function(e){this.props.map!==e.map&&this.mapEditor&&this.mapEditor.update()}},{key:"isPartitionedView",value:function(){return"new-doc"===this.props.designDocId?this.props.newDesignDocPartitioned:this.props.designDocPartitioned}},{key:"isCustomReduceSupported",value:function(){return!(this.props.isDbPartitioned&&this.props.reduce&&!this.props.reduce.startsWith("_")&&("new-doc"===this.props.designDocId?this.props.newDesignDocPartitioned:this.props.designDocPartitioned))}},{key:"saveView",value:function(e){if(e.preventDefault(),this.designDocSelector.validate())if(this.isCustomReduceSupported()){var t=this.isPartitionedView()&&this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"",n=se.urls("view","showView",this.props.database.safeID(),t,this.props.saveDesignDoc.safeID(),encodeURIComponent(this.props.viewName));this.props.saveView({database:this.props.database,isNewView:this.props.isNewView,viewName:this.props.viewName,designDoc:this.props.saveDesignDoc,designDocId:this.props.designDocId,isNewDesignDoc:this.props.isNewDesignDoc,originalViewName:this.props.originalViewName,originalDesignDocName:this.props.originalDesignDocName,map:this.mapEditor.getValue(),reduce:this.reduceEditor.getReduceValue(),designDocs:this.props.designDocs},n)}else se.addNotification({msg:"Partitioned views do not support custom reduce functions.",type:"error",clear:!0})}},{key:"viewChange",value:function(e){this.props.changeViewName(e.target.value)}},{key:"updateMapCode",value:function(e){this.props.updateMapCode(e)}},{key:"getCancelLink",value:function(){var e=encodeURIComponent(this.props.database.id),t=this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"";if("new-doc"===this.props.designDocId||this.props.isNewView)return"#"+se.urls("allDocs","app",e,t);var n=this.props.designDocId.startsWith("_design/")?"_design/"+encodeURIComponent(this.props.designDocId.substring(8)):encodeURIComponent(this.props.designDocId),a=encodeURIComponent(this.props.viewName);return"#"+se.urls("view","showView",e,t,n,a)}},{key:"render",value:function(){var e=this;if(this.props.isLoading)return de.a.createElement("div",{className:"define-view"},de.a.createElement(Li,null));var t=this.props.isNewView?"New View":"Edit View",n=this.props.isNewView?"Create Document and then Build Index":"Save Document and then Build Index";return de.a.createElement("div",{className:"define-view"},de.a.createElement("form",{className:"form-horizontal view-query-save",onSubmit:this.saveView},de.a.createElement("h3",{className:"simple-header"},t),de.a.createElement("div",{className:"new-ddoc-section"},de.a.createElement(mi,{ref:function(t){e.designDocSelector=t},designDocList:this.props.designDocList,isDbPartitioned:this.props.isDbPartitioned,selectedDesignDocName:this.props.designDocId,selectedDesignDocPartitioned:this.props.designDocPartitioned,newDesignDocName:this.props.newDesignDocName,newDesignDocPartitioned:this.props.newDesignDocPartitioned,onSelectDesignDoc:this.props.selectDesignDoc,onChangeNewDesignDocName:this.props.updateNewDesignDocName,onChangeNewDesignDocPartitioned:this.props.updateNewDesignDocPartitioned,docLink:Pi("DESIGN_DOCS")})),de.a.createElement("div",{className:"control-group"},de.a.createElement("label",{htmlFor:"index-name"},de.a.createElement("span",null,"Index name"),de.a.createElement("a",{className:"help-link","data-bypass":"true",href:Pi("VIEW_FUNCS"),target:"_blank",rel:"noopener noreferrer"},de.a.createElement("i",{className:"icon-question-sign"}))),de.a.createElement("input",{type:"text",id:"index-name",value:this.props.viewName,onChange:this.viewChange,placeholder:"Index name"})),de.a.createElement(Ri,{id:"map-function",ref:function(t){e.mapEditor=t},title:"Map function",docLink:Pi("MAP_FUNCS"),blur:this.updateMapCode,allowZenMode:!1,defaultCode:this.props.map}),de.a.createElement(Di,wi({ref:function(t){e.reduceEditor=t},customReducerSupported:this.isCustomReduceSupported()},this.props)),de.a.createElement("div",{className:"padded-box"},de.a.createElement("div",{className:"control-group"},de.a.createElement(ki,{id:"save-view",text:n}),de.a.createElement("a",{href:this.getCancelLink(),className:"index-cancel-link"},"Cancel")))))}}])&&Ti(n.prototype,a),r&&Ti(n,r),t}(ue.Component);xi.propTypes={isLoading:tt.a.bool.isRequired,isNewView:tt.a.bool.isRequired,database:tt.a.object.isRequired,isDbPartitioned:tt.a.bool.isRequired,designDocId:tt.a.string.isRequired,newDesignDocName:tt.a.string.isRequired,viewName:tt.a.string.isRequired,isNewDesignDoc:tt.a.bool.isRequired,originalViewName:tt.a.string,originalDesignDocName:tt.a.string,designDocs:tt.a.object,saveDesignDoc:tt.a.object,partitionKey:tt.a.string,updateNewDesignDocName:tt.a.func.isRequired,changeViewName:tt.a.func.isRequired,updateMapCode:tt.a.func.isRequired};var Ui={CLEAR_INDEX:"CLEAR_INDEX",EDIT_INDEX:"EDIT_INDEX",EDIT_NEW_INDEX:"EDIT_NEW_INDEX",SELECT_REDUCE_CHANGE:"SELECT_REDUCE_CHANGE",VIEW_SAVED:"VIEW_SAVED",VIEW_CREATED:"VIEW_CREATED",DESIGN_DOC_CHANGE:"DESIGN_DOC_CHANGE",DESIGN_DOC_NEW_NAME_UPDATED:"DESIGN_DOC_NEW_NAME_UPDATED",DESIGN_DOC_NEW_PARTITIONED_UPDATED:"DESIGN_DOC_NEW_PARTITIONED_UPDATED",NEW_DESIGN_DOC:"NEW_DESIGN_DOC",VIEW_NAME_CHANGE:"VIEW_NAME_CHANGE",VIEW_ADD_DESIGN_DOC:"VIEW_ADD_DESIGN_DOC",VIEW_UPDATE_MAP_CODE:"VIEW_UPDATE_MAP_CODE",VIEW_UPDATE_REDUCE_CODE:"VIEW_UPDATE_REDUCE_CODE"},Mi=function(e){return function(t){t({type:Ui.EDIT_INDEX,options:e})}},ji=function(e){return!e.isNewView&&e.originalDesignDocName===e.designDocId&&e.originalViewName!==e.viewName},Hi=function(e){return function(t){t({type:Ui.VIEW_ADD_DESIGN_DOC,designDoc:e.toJSON()})}},Bi=function(e,t,n,a,r){var o=_.extend({onSuccess:function(){},onError:function(e){var t=JSON.parse(e.responseText).reason;se.addNotification({msg:"Delete failed: "+t,type:"error",clear:!0})}},r),i=e.get(n)||{};delete i[a];var s={};s[n]=i,e.set(s);var c,l=se.getIndexTypePropNames(),u=_.some(l,(function(t){return e.get(t)&&_.keys(e.get(t)).length>0})),d=!1;return u?c=e.save():(c=e.destroy(),d=!0),c.then((function(){d&&t.remove(e.id),o.onSuccess()}),o.onError)},Gi=function(e,t){return e.find((function(e){return e.id===t})).dDocModel()},qi=function(e,t,n,a,r,o){if("new-doc"===t){var i={_id:"_design/"+n,views:{},language:"javascript"},s=new He.Doc(i,{database:r});return o&&s.setDDocPartitionedOption(a),s}var c=e.find((function(e){return e.id===t}));return c?c.dDocModel():null},Vi={helpers:{findDesignDoc:Gi,getDesignDoc:qi},safeDeleteIndex:Bi,selectReduceChanged:function(e){return function(t){t({type:Ui.SELECT_REDUCE_CHANGE,reduceSelectedOption:e})}},changeViewName:function(e){return function(t){t({type:Ui.VIEW_NAME_CHANGE,name:e})}},editIndex:Mi,dispatchClearIndex:function(){se.reduxDispatch({type:Ui.CLEAR_INDEX})},dispatchFetchDesignDocsBeforeEdit:function(e){e.designDocs.fetch({reset:!0}).then((function(){Mi(e)(se.reduxDispatch)}),(function(t){var n="Error";if(t.responseJSON&&"not_found"===t.responseJSON.error){var a=e.designDocs.database.safeID();n="The ".concat(a," database does not exist"),se.navigate("/",{trigger:!0})}se.addNotification({msg:n,type:"error",clear:!0})}))},shouldRemoveDdocView:ji,saveView:function(e,t){return function(n){var a=e.designDoc;a.setDdocView(e.viewName,e.map,e.reduce),se.addNotification({msg:"Saving View...",type:"info",clear:!0}),ji(e)&&a.removeDdocView(e.originalViewName),a.save().then((function(){if(se.addNotification({msg:"View Saved.",type:"success",clear:!0}),!e.isNewView&&e.originalDesignDocName!==e.designDocId){var r=Gi(e.designDocs,e.originalDesignDocName);Bi(r,e.designDocs,"views",e.originalViewName,{onSuccess:function(){ii.dispatchUpdateDesignDocs(e.designDocs)}})}"new-doc"===e.designDocId&&Hi(a),ii.dispatchUpdateDesignDocs(e.designDocs),n({type:Ui.VIEW_SAVED}),se.navigate(t,{trigger:!0})}),(function(e){se.addNotification({msg:"Save failed. "+(e.responseJSON?"Reason: ".concat(e.responseJSON.reason):""),type:"error",clear:!0})}))}},addDesignDoc:Hi,deleteView:function(e){return Bi(e.designDoc,e.designDocs,"views",e.indexName,{onSuccess:function(){if(e.isOnIndex){var t=se.urls("allDocs","app",e.database.safeID());se.navigate(t)}ii.dispatchUpdateDesignDocs(e.designDocs),se.addNotification({msg:"The <code>"+_.escape(e.indexName)+"</code> view has been deleted.",type:"info",escape:!1,clear:!0}),ii.dispatchHideDeleteIndexModal()}})},cloneView:function(e){var t=qi(e.designDocs,e.targetDesignDocName,e.newDesignDocName,e.newDesignDocPartitioned,e.database,e.isDbPartitioned),n=t.get("views");if(n&&_.has(n,e.newIndexName))se.addNotification({msg:"That index name is already used in this design doc. Please enter a new name.",type:"error",clear:!0});else{n||(n={});var a=Gi(e.designDocs,"_design/"+e.sourceDesignDocName).toJSON();n[e.newIndexName]=a.views[e.sourceIndexName],t.set({views:n}),t.save().then((function(){e.onComplete(),se.addNotification({msg:"The index has been cloned.",type:"success",clear:!0}),ii.dispatchUpdateDesignDocs(e.designDocs)}),(function(t){e.onComplete();var n=JSON.parse(t.responseText).reason;se.addNotification({msg:"Clone failed: "+n,type:"error",clear:!0})}))}},gotoEditViewPage:function(e,t,n,a){se.navigate("#"+se.urls("view","edit",encodeURIComponent(e),t?encodeURIComponent(t):"",encodeURIComponent(n),encodeURIComponent(a)))},updateMapCode:function(e){return function(t){t({type:Ui.VIEW_UPDATE_MAP_CODE,code:e})}},updateReduceCode:function(e){return function(t){t({type:Ui.VIEW_UPDATE_REDUCE_CODE,code:e})}},selectDesignDoc:function(e){return function(t){t({type:Ui.DESIGN_DOC_CHANGE,options:{value:e}})}},updateNewDesignDocName:function(e){return function(t){t({type:Ui.DESIGN_DOC_NEW_NAME_UPDATED,options:{value:e}})}},updateNewDesignDocPartitioned:function(e){return function(t){t({type:Ui.DESIGN_DOC_NEW_PARTITIONED_UPDATED,options:{value:e}})}}};function Fi(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fi(n,!0).forEach((function(t){Wi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fi(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xi="function (doc) {\n  emit(doc._id, 1);\n}",zi="function (keys, values, rereduce) {\n  if (rereduce) {\n    return sum(values);\n  } else {\n    return values.length;\n  }\n}",Yi=["_sum","_count","_stats","_approx_count_distinct"],Qi=Yi.concat(["CUSTOM","NONE"]),Ji={designDocs:new Backbone.Collection,isLoading:!0,view:{reduce:"",map:Xi},database:{id:"0"},designDocId:"",isNewDesignDoc:!1,newDesignDocName:"",newDesignDocPartitioned:!0,isNewView:!1,viewName:"",originalViewName:"",originalDesignDocName:"",reduceOptions:Qi};function Zi(e,t){var n=Ki({},e,{isLoading:!1,newDesignDocName:"",isNewView:t.isNewView,viewName:t.viewName||"viewName",isNewDesignDoc:t.isNewDesignDoc||!1,designDocs:t.designDocs,designDocId:t.designDocId,originalDesignDocName:t.designDocId,database:t.database});return n.originalViewName=n.viewName,n.view=function(e){if(e.isNewView||e.isNewDesignDoc)return{reduce:"",map:Xi};return e.designDocs.find((function(t){return e.designDocId==t.id})).dDocModel().get("views")[e.viewName]}(n),n}function $i(e){return e.view.reduce?es(e)?"CUSTOM":e.view.reduce:"NONE"}function es(e){return!!e.view.reduce&&!(-1!==Yi.indexOf(e.view.reduce))}function ts(e,t){if("new-doc"===e.designDocId){var n={_id:"_design/"+e.newDesignDocName,views:{},language:"javascript"},a=new He.Doc(n,{database:e.database});return t&&a.setDDocPartitionedOption(e.newDesignDocPartitioned),a}if(!e.designDocs)return null;var r=e.designDocs.find((function(t){return t.id===e.designDocId}));return r?r.dDocModel():null}function ns(e){return e.designDocs?e.designDocs.filter((function(e){return!e.isMangoDoc()})).map((function(e){return e.id})):[]}var as=Object(nt.b)((function(e,t){var n,a,r,o=e.indexEditor,i=e.databases,s=(n=o,a=i.isDbPartitioned,!!(r=n.designDocs.find((function(e){return n.designDocId===e.id})))&&vn.isDDocPartitioned(r.get("doc"),a));return{database:o.database,isNewView:o.isNewView,viewName:o.viewName,designDocs:o.designDocs,designDocList:ns(o),originalViewName:o.originalViewName,originalDesignDocName:o.originalDesignDocName,isNewDesignDoc:o.isNewDesignDoc,designDocId:o.designDocId,designDocPartitioned:s,newDesignDocName:o.newDesignDocName,newDesignDocPartitioned:o.newDesignDocPartitioned,saveDesignDoc:ts(o,i.isDbPartitioned),map:o.view.map,isLoading:o.isLoading,reduce:o.view.reduce,reduceOptions:o.reduceOptions,reduceSelectedOption:$i(o),hasCustomReduce:es(o),hasReduce:!!o.view.reduce,isDbPartitioned:i.isDbPartitioned,partitionKey:t.partitionKey}}),(function(e){return{saveView:function(t,n){e(Vi.saveView(t,n))},changeViewName:function(t){e(Vi.changeViewName(t))},updateMapCode:function(t){e(Vi.updateMapCode(t))},selectDesignDoc:function(t){e(Vi.selectDesignDoc(t))},updateNewDesignDocName:function(t){e(Vi.updateNewDesignDocName(t))},updateNewDesignDocPartitioned:function(t){e(Vi.updateNewDesignDocPartitioned(t))},updateReduceCode:function(t){e(Vi.updateReduceCode(t))},selectReduceChanged:function(t){e(Vi.selectReduceChanged(t))}}}))(xi),rs=Jr.StyledSelect,os={IndexEditorContainer:as,IndexEditor:xi,ReduceEditor:Di,DesignDocSelector:mi,StyledSelect:rs};function is(e){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function cs(e){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ls(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function us(e,t){return(us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ds(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ps=os.DesignDocSelector,fs=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=cs(t).call(this,e),n=!r||"object"!==is(r)&&"function"!=typeof r?ls(a):r,ds(ls(n),"submit",(function(){n.designDocSelector.validate()&&(""!==n.props.newIndexName?n.props.submit():se.addNotification({msg:"Please enter the new index name.",type:"error",clear:!0}))})),ds(ls(n),"close",(function(e){e&&e.preventDefault(),n.props.close()})),ds(ls(n),"setNewIndexName",(function(e){n.props.setNewCloneIndexName(e.target.value)})),n.props.setNewCloneIndexName(""),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this;return de.a.createElement(Ct.g,{dialogClassName:"clone-index-modal",show:this.props.visible,onHide:this.close},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,this.props.title)),de.a.createElement(Ct.g.Body,null,de.a.createElement("form",{className:"form",method:"post",onSubmit:this.submit},de.a.createElement("p",null,"Select the design document where the cloned ",this.props.indexLabel," will be created, and then enter a name for the cloned ",this.props.indexLabel,"."),de.a.createElement("div",{className:"row"},de.a.createElement(ps,{ref:function(t){return e.designDocSelector=t},designDocList:this.props.designDocArray,isDbPartitioned:this.props.isDbPartitioned,selectedDesignDocName:this.props.selectedDesignDoc,selectedDesignDocPartitioned:this.props.selectedDesignDocPartitioned,newDesignDocName:this.props.newDesignDocName,newDesignDocPartitioned:this.props.newDesignDocPartitioned,onSelectDesignDoc:this.props.selectDesignDoc,onChangeNewDesignDocName:this.props.updateNewDesignDocName,onChangeNewDesignDocPartitioned:this.props.updateNewDesignDocPartitioned})),de.a.createElement("div",{className:"clone-index-name-row"},de.a.createElement("label",{className:"new-index-title-label",htmlFor:"new-index-name"},this.props.indexLabel," Name"),de.a.createElement("input",{type:"text",id:"new-index-name",value:this.props.newIndexName,onChange:this.setNewIndexName,placeholder:"New view name"})))),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{href:"#",className:"cancel-link",onClick:this.close,"data-bypass":"true"},"Cancel"),de.a.createElement("button",{onClick:this.submit,"data-bypass":"true",className:"btn btn-primary save"},de.a.createElement("i",{className:"icon fonticon-ok-circled"})," Clone ",this.props.indexLabel)))}}])&&ss(n.prototype,a),r&&ss(n,r),t}(de.a.Component);function hs(e){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ms(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gs(e){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Es(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ds(fs,"propTypes",{visible:tt.a.bool.isRequired,title:tt.a.string,close:tt.a.func.isRequired,submit:tt.a.func.isRequired,designDocArray:tt.a.array.isRequired,selectedDesignDoc:tt.a.string.isRequired,newDesignDocName:tt.a.string.isRequired,newIndexName:tt.a.string.isRequired,indexLabel:tt.a.string.isRequired,selectDesignDoc:tt.a.func.isRequired,updateNewDesignDocName:tt.a.func.isRequired,setNewCloneIndexName:tt.a.func.isRequired}),ds(fs,"defaultProps",{title:"Clone Index",visible:!1});var _s=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=gs(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==hs(r)&&"function"!=typeof r?bs(a):r,Es(bs(n),"state",{placement:"bottom"}),Es(bs(n),"setPlacement",(function(e){var t=document.getElementById(e).getBoundingClientRect().top+150>window.innerHeight?"top":"bottom";n.setState({placement:t})})),Es(bs(n),"createItems",(function(){var e=n.props.items.sort();return _.map(e,(function(e,t){var a=se.urls(n.props.urlNamespace,"app",encodeURIComponent(n.props.database.id),encodeURIComponent(n.props.designDocName));n.props.selectedPartitionKey&&(a=se.urls("partitioned_"+n.props.urlNamespace,"app",encodeURIComponent(n.props.database.id),encodeURIComponent(n.props.selectedPartitionKey),encodeURIComponent(n.props.designDocName)));var r=n.props.selectedIndex===e?"active":"";return de.a.createElement("li",{className:r,key:t},de.a.createElement("a",{id:n.props.designDocName+"_"+e,href:"#/"+a+encodeURIComponent(e),className:"toggle-view"},e),de.a.createElement(Ct.i,{trigger:"click",onEnter:n.setPlacement.bind(bs(n),n.props.designDocName+"_"+e),placement:n.state.placement,rootClose:!0,ref:function(e){return n.itemOverlay=e},overlay:de.a.createElement(Ct.j,{id:"index-menu-component-popover"},de.a.createElement("ul",null,de.a.createElement("li",{onClick:n.indexAction.bind(bs(n),"edit",{indexName:e,onEdit:n.props.onEdit})},de.a.createElement("span",{className:"fonticon fonticon-file-code-o"}),"Edit"),de.a.createElement("li",{onClick:n.indexAction.bind(bs(n),"clone",{indexName:e,onClone:n.props.onClone})},de.a.createElement("span",{className:"fonticon fonticon-files-o"}),"Clone"),de.a.createElement("li",{onClick:n.indexAction.bind(bs(n),"delete",{indexName:e,onDelete:n.props.onDelete})},de.a.createElement("span",{className:"fonticon fonticon-trash"}),"Delete")))},de.a.createElement("span",{className:"index-menu-toggle fonticon fonticon-wrench2"})))}))})),Es(bs(n),"indexAction",(function(e,t,a){switch(a.preventDefault(),n.itemOverlay.hide(),e){case"delete":n.props.showDeleteIndexModal(t.indexName,n.props.designDocName,n.props.indexLabel,t.onDelete);break;case"clone":n.props.showCloneIndexModal(t.indexName,n.props.designDocName,n.props.indexLabel,t.onClone);break;case"edit":t.onEdit(n.props.database.id,n.props.selectedPartitionKey,n.props.designDocName,t.indexName)}})),Es(bs(n),"toggle",(function(e){e.preventDefault(),n.props.toggle(n.props.designDocName,n.props.title)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){if(0===this.props.items.length)return null;var e="accordion-header index-group-header",t="index-list accordion-body collapse";this.props.isExpanded&&(e+=" down",t+=" in");var n=this.props.title,a="nav-design-function-"+this.props.designDocName+this.props.selector;return de.a.createElement("li",{id:a},de.a.createElement("a",{className:e,"data-toggle":"collapse",onClick:this.toggle},de.a.createElement("div",{className:"fonticon-play"}),n),de.a.createElement(Ct.c,{in:this.props.isExpanded},de.a.createElement("ul",{className:t},this.createItems())))}}])&&ms(n.prototype,a),r&&ms(n,r),t}(de.a.Component);function vs(e){return(vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ss(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ns(e){return(Ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ds(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Os(e,t){return(Os=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ws(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Es(_s,"propTypes",{urlNamespace:tt.a.string.isRequired,indexLabel:tt.a.string.isRequired,database:tt.a.object.isRequired,designDocName:tt.a.string.isRequired,items:tt.a.array.isRequired,isExpanded:tt.a.bool.isRequired,selectedIndex:tt.a.string.isRequired,onDelete:tt.a.func.isRequired,onClone:tt.a.func.isRequired,showDeleteIndexModal:tt.a.func.isRequired,showCloneIndexModal:tt.a.func.isRequired,isPartitioned:tt.a.bool.isRequired,selectedPartitionKey:tt.a.string});var Ts=Jr.MenuDropDown,Cs=function(e){function t(e){var n,a,r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Ns(t).call(this,e),n=!r||"object"!==vs(r)&&"function"!=typeof r?Ds(a):r,ws(Ds(n),"indexList",(function(){return _.map(n.state.updatedSidebarListTypes,(function(e,t){var a=_.has(n.props.toggledSections,e.name)&&n.props.toggledSections[e.name],r="";return n.props.selectedNavInfo.designDocSection===e.name&&(r=n.props.selectedNavInfo.indexName),de.a.createElement(_s,{icon:e.icon,isExpanded:a,urlNamespace:e.urlNamespace,indexLabel:e.indexLabel,onEdit:e.onEdit,onDelete:e.onDelete,onClone:e.onClone,selectedIndex:r,toggle:n.props.toggle,database:n.props.database,designDocName:n.props.designDocName,key:t,title:e.name,selector:e.selector,items:_.keys(n.props.designDoc[e.selector]),isPartitioned:n.props.isPartitioned,selectedPartitionKey:n.props.selectedPartitionKey,showDeleteIndexModal:n.props.showDeleteIndexModal,showCloneIndexModal:n.props.showCloneIndexModal})}))})),ws(Ds(n),"toggle",(function(e){e.preventDefault(),n.props.toggle(n.props.designDocName)})),ws(Ds(n),"getNewButtonLinks",(function(){var e=n.props.selectedPartitionKey?encodeURIComponent(n.props.selectedPartitionKey):"",t=se.urls("databaseBaseURL","app",encodeURIComponent(n.props.database.id))+(e?"/_partition/"+e:""),a=n.props.designDocName;return[{title:"Add New",links:se.getExtensions("sidebar:links").reduce((function(e,r){return n.props.isPartitioned&&!r.showForPartitionedDDocs||e.push({title:r.title,url:"#"+t+"/"+r.url+"/"+encodeURIComponent(a),icon:"fonticon-plus-circled"}),e}),[{title:"New View",url:"#"+se.urls("new","addView",encodeURIComponent(n.props.database.id),e,encodeURIComponent(a)),icon:"fonticon-plus-circled"}])}]})),n.state={updatedSidebarListTypes:n.props.sidebarListTypes},_.isEmpty(n.state.updatedSidebarListTypes)||_.has(n.state.updatedSidebarListTypes[0],"selector")&&"views"!==n.state.updatedSidebarListTypes[0].selector){var o=n.state.updatedSidebarListTypes;o.unshift({selector:"views",name:"Views",urlNamespace:"view",indexLabel:"view",onDelete:Vi.deleteView,onClone:Vi.cloneView,onEdit:Vi.gotoEditViewPage}),n.state={updatedSidebarListTypes:o}}return n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Os(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.getNewButtonLinks(),t="design-doc-section accordion-header",n="design-doc-body accordion-body collapse";this.props.isExpanded&&(t+=" down",n+=" in");var a=this.props.designDocName,r=this.props.selectedPartitionKey?encodeURIComponent(this.props.selectedPartitionKey):"",o=se.urls("designDocs","app",encodeURIComponent(this.props.database.id),r,a),i="metadata"===this.props.selectedNavInfo.designDocSection?"active":"",s=this.props.isPartitioned?"Partitioned design document":"Global design document",c=this.props.isPartitioned?"fonticon-documents":"fonticon-document";return de.a.createElement("li",{className:"nav-header"},de.a.createElement("div",{id:"sidebar-tab-"+a,className:t},de.a.createElement("div",{id:"nav-header-"+a,onClick:this.toggle,className:"accordion-list-item"},de.a.createElement("div",{className:"fonticon-play"}),de.a.createElement("p",{className:"design-doc-name"},de.a.createElement("span",{title:"_design/"+a},de.a.createElement("i",{className:c,title:s}),a))),de.a.createElement("div",{className:"new-button add-dropdown"},de.a.createElement(Ts,{links:e}))),de.a.createElement(Ct.c,{in:this.props.isExpanded},de.a.createElement("ul",{className:n,id:this.props.designDocName},de.a.createElement("li",{className:i},de.a.createElement("a",{href:"#/"+o,className:"toggle-view accordion-header"},"Metadata")),this.indexList())))}}])&&Ss(n.prototype,a),r&&Ss(n,r),t}(de.a.Component);function As(e){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Is(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ps(e){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ks(e,t){return(ks=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ls(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ws(Cs,"propTypes",{database:tt.a.object.isRequired,sidebarListTypes:tt.a.array.isRequired,isExpanded:tt.a.bool.isRequired,isPartitioned:tt.a.bool.isRequired,selectedPartitionKey:tt.a.string,selectedNavInfo:tt.a.object.isRequired,toggledSections:tt.a.object.isRequired,designDocName:tt.a.string.isRequired,showDeleteIndexModal:tt.a.func.isRequired,showCloneIndexModal:tt.a.func.isRequired});var xs=function(e){function t(e){var n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Ps(t).call(this,e),n=!r||"object"!==As(r)&&"function"!=typeof r?Rs(a):r,Ls(Rs(n),"designDocList",(function(){return _.map(n.props.designDocs,(function(e,t){var a=decodeURIComponent(e.safeId),r=vn.isDDocPartitioned(e,n.props.isDbPartitioned),o=!1,i={};_.has(n.props.toggledSections,a)&&(o=n.props.toggledSections[a].visible,i=n.props.toggledSections[a].indexGroups);var s={};return"designDoc"===n.props.selectedNav.navItem&&n.props.selectedNav.designDocName===a&&(s=n.props.selectedNav),de.a.createElement(Cs,{toggle:n.props.toggle,sidebarListTypes:n.sidebarListTypes,isExpanded:o,toggledSections:i,selectedNavInfo:s,selectedPartitionKey:n.props.selectedPartitionKey,isPartitioned:r,key:t,designDoc:e,designDocName:a,database:n.props.database,showDeleteIndexModal:n.props.showDeleteIndexModal,showCloneIndexModal:n.props.showCloneIndexModal})}))}));var o=se.getExtensions("sidebar:list");return n.sidebarListTypes=_.isUndefined(o)?[]:o,n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ks(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("ul",{className:"nav nav-list"},this.designDocList())}}])&&Is(n.prototype,a),r&&Is(n,r),t}(de.a.Component);function Us(e){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ms(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function js(e){return(js=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bs(e,t){return(Bs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ls(xs,"propTypes",{database:tt.a.object.isRequired,toggle:tt.a.func.isRequired,designDocs:tt.a.array,toggledSections:tt.a.object,selectedNav:tt.a.shape({designDocName:tt.a.string,designDocSection:tt.a.string,indexName:tt.a.string,navItem:tt.a.string}).isRequired,isDbPartitioned:tt.a.bool.isRequired,selectedPartitionKey:tt.a.string,showDeleteIndexModal:tt.a.func.isRequired,showCloneIndexModal:tt.a.func.isRequired});var qs=Jr.MenuDropDown,Vs=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=js(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Us(r)&&"function"!=typeof r?Hs(a):r,Gs(Hs(n),"getNewButtonLinks",(function(){return vn.getNewButtonLinks(n.props.databaseName,n.props.selectedPartitionKey)})),Gs(Hs(n),"buildDocLinks",(function(){var e=se.urls("base","app",n.props.databaseName);return se.getExtensions("docLinks").map((function(t){return de.a.createElement("li",{key:t.url,className:n.getNavItemClass(t.url)},de.a.createElement("a",{id:t.url,href:e+t.url},t.title))}))})),Gs(Hs(n),"getNavItemClass",(function(e){return e===n.props.selectedNavItem?"active":""})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bs(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.buildDocLinks(),t=se.url.encode(this.props.databaseName),n=this.props.selectedPartitionKey?encodeURIComponent(this.props.selectedPartitionKey):"",a="#"+se.urls("changes","app",t,n,""),r="#"+se.urls("permissions","app",t,n),o=se.urls("allDocs","app",t,n,""),i=se.urls("mango","query-app",t,n),s=le.i18n.en_US["run-query-with-mango"],c=this.getNewButtonLinks();return de.a.createElement("ul",{className:"nav nav-list"},de.a.createElement("li",{className:this.getNavItemClass("all-docs")},de.a.createElement("a",{id:"all-docs",href:"#/"+o,className:"toggle-view"},"All Documents"),de.a.createElement("div",{id:"new-all-docs-button",className:"add-dropdown"},de.a.createElement(qs,{links:c}))),de.a.createElement("li",{className:this.getNavItemClass("mango-query")},de.a.createElement("a",{id:"mango-query",href:"#"+i,className:"toggle-view"},s)),de.a.createElement("li",{className:this.getNavItemClass("permissions")},de.a.createElement("a",{id:"permissions",href:r},"Permissions")),de.a.createElement("li",{className:this.getNavItemClass("changes")},de.a.createElement("a",{id:"changes",href:a},"Changes")),e,de.a.createElement("li",{className:this.getNavItemClass("design-docs")},de.a.createElement("a",{id:"design-docs",href:"#/"+o+'?startkey="_design"&endkey="_design0"',className:"toggle-view"},"Design Documents"),de.a.createElement("div",{id:"new-design-docs-button",className:"add-dropdown"},de.a.createElement(qs,{links:c}))))}}])&&Ms(n.prototype,a),r&&Ms(n,r),t}(de.a.Component);function Fs(e){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ks(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ws(e){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zs(e,t){return(zs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ys(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Gs(Vs,"propTypes",{databaseName:tt.a.string.isRequired,selectedNavItem:tt.a.string.isRequired,selectedPartitionKey:tt.a.string});var Qs=Jr.DeleteDatabaseModal,Js=Jr.LoadLines,Zs=_o.ConfirmationModal,$s=$r.deleteDbModalStore,ec=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Ws(t).call(this,e),n=!r||"object"!==Fs(r)&&"function"!=typeof r?Xs(a):r,Ys(Xs(n),"onChange",(function(){var e=n.getDeleteDbStoreState();n.setState(e)})),Ys(Xs(n),"showDeleteDatabaseModal",(function(e){bn.showDeleteDatabaseModal(e)})),Ys(Xs(n),"deleteIndex",(function(){var e="designDoc"===n.props.selectedNav.navItem&&"_design/"+n.props.selectedNav.designDocName===n.props.deleteIndexModalDesignDoc.id&&n.props.selectedNav.indexName===n.props.deleteIndexModalIndexName;n.props.deleteIndexModalOnSubmit({isOnIndex:e,indexName:n.props.deleteIndexModalIndexName,designDoc:n.props.deleteIndexModalDesignDoc,designDocs:n.props.designDocs,database:n.props.database})})),Ys(Xs(n),"cloneIndex",(function(){n.props.cloneIndexModalOnSubmit({sourceIndexName:n.props.cloneIndexSourceIndexName,sourceDesignDocName:n.props.cloneIndexSourceDesignDocName,targetDesignDocName:n.props.cloneIndexModalSelectedDesignDoc,newDesignDocName:n.props.cloneIndexModalNewDesignDocName,newDesignDocPartitioned:n.props.cloneIndexModalNewDesignDocPartitioned,isDbPartitioned:n.props.isDbPartitioned,newIndexName:n.props.cloneIndexModalNewIndexName,designDocs:n.props.designDocs,database:n.props.database,onComplete:n.props.hideCloneIndexModal})})),n.state=n.getDeleteDbStoreState(),n.deleteIndex=n.deleteIndex.bind(Xs(n)),n.cloneIndex=n.cloneIndex.bind(Xs(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zs(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){$s.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){$s.off("change",this.onChange,this)}},{key:"getDeleteDbStoreState",value:function(){return{deleteDbModalProperties:$s.getShowDeleteDatabaseModal()}}},{key:"render",value:function(){return this.props.isLoading?de.a.createElement(Js,null):de.a.createElement("nav",{className:"sidenav"},de.a.createElement(Vs,{selectedNavItem:this.props.selectedNav.navItem,databaseName:this.props.database.id,selectedPartitionKey:this.props.selectedPartitionKey}),de.a.createElement(xs,{selectedNav:this.props.selectedNav,selectedPartitionKey:this.props.selectedPartitionKey,isDbPartitioned:this.props.isDbPartitioned,toggle:this.props.toggleContent,toggledSections:this.props.toggledSections,designDocs:this.props.designDocList,database:this.props.database,showDeleteIndexModal:this.props.showDeleteIndexModal,showCloneIndexModal:this.props.showCloneIndexModal}),de.a.createElement(Qs,{showHide:this.showDeleteDatabaseModal,modalProps:this.state.deleteDbModalProperties}),de.a.createElement(Zs,{title:"Confirm Deletion",visible:this.props.deleteIndexModalVisible,text:this.props.deleteIndexModalText,onClose:this.props.hideDeleteIndexModal,onSubmit:this.deleteIndex}),de.a.createElement(fs,{visible:this.props.cloneIndexModalVisible,title:this.props.cloneIndexModalTitle,close:this.props.hideCloneIndexModal,submit:this.cloneIndex,designDocArray:this.props.availableDesignDocIds,selectedDesignDoc:this.props.cloneIndexModalSelectedDesignDoc,selectedDesignDocPartitioned:this.props.cloneIndexModalSelectedDesignDocPartitioned,newDesignDocName:this.props.cloneIndexModalNewDesignDocName,newDesignDocPartitioned:this.props.cloneIndexModalNewDesignDocPartitioned,newIndexName:this.props.cloneIndexModalNewIndexName,indexLabel:this.props.cloneIndexModalIndexLabel,selectDesignDoc:this.props.selectDesignDoc,updateNewDesignDocName:this.props.updateNewDesignDocName,updateNewDesignDocPartitioned:this.props.updateNewDesignDocPartitioned,setNewCloneIndexName:this.props.setNewCloneIndexName,isDbPartitioned:this.props.isDbPartitioned}))}}])&&Ks(n.prototype,a),r&&Ks(n,r),t}(de.a.Component);Ys(ec,"propTypes",{selectedNav:tt.a.shape({designDocName:tt.a.string,designDocSection:tt.a.string,indexName:tt.a.string,navItem:tt.a.string}).isRequired});var tc={SidebarController:ec,DesignDoc:Cs,CloneIndexModal:fs};function nc(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function ac(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nc(n,!0).forEach((function(t){rc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nc(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oc={designDocs:new Backbone.Collection,designDocList:[],selected:{navItem:"all-docs",designDocName:"",designDocSection:"",indexName:""},loading:!0,toggledSections:{},deleteIndexModalVisible:!1,deleteIndexModalDesignDocName:"",deleteIndexModalText:"",deleteIndexModalIndexName:"",deleteIndexModalOnSubmit:function(){},cloneIndexModalVisible:!1,cloneIndexDesignDocProp:"",cloneIndexModalTitle:"",cloneIndexModalSelectedDesignDoc:"",cloneIndexModalNewDesignDocName:"",cloneIndexModalNewDesignDocPartitioned:!0,cloneIndexModalNewIndexName:"",cloneIndexModalSourceIndexName:"",cloneIndexModalSourceDesignDocName:"",cloneIndexModalIndexLabel:"",cloneIndexModalOnSubmit:function(){}};function ic(e){if(!e)return[];var t=e.toJSON();return(t=_.filter(t,(function(e){return!_.has(e.doc,"language")||"query"!==e.doc.language}))).map((function(e){return e.safeId=le.utils.safeURLName(e._id.replace(/^_design\//,"")),_.extend(e,e.doc)}))}function sc(e,t){var n=e.designDocs.find((function(t){return e.cloneIndexModalSelectedDesignDoc==t.id}));return!!n&&vn.isDDocPartitioned(n.get("doc"),t)}function cc(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function lc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var uc=function(e){var t=e.designDocs.filter((function(e){return!e.isMangoDoc()}));return _.map(t,(function(e){return e.id}))},dc=function(e){var t=e.designDocs.find((function(t){return"_design/"+e.deleteIndexModalDesignDocName===t.id}));return t?t.dDocModel():null},pc=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(n,!0).forEach((function(t){lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({designDocName:"",designDocSection:"",indexName:"",navItem:""},e)},fc=Object(nt.b)((function(e,t){var n,a=e.sidebar,r=e.databases;return{database:(n=a,n.loading?{}:n.database),selectedNav:pc(t.selectedNavItem),designDocs:a.designDocs,designDocList:a.designDocList,availableDesignDocIds:uc(a),toggledSections:a.toggledSections,isLoading:a.loading||r.isLoadingDbInfo,selectedPartitionKey:t.selectedPartitionKey,isDbPartitioned:r.isDbPartitioned,deleteIndexModalVisible:a.deleteIndexModalVisible,deleteIndexModalText:a.deleteIndexModalText,deleteIndexModalOnSubmit:a.deleteIndexModalOnSubmit,deleteIndexModalIndexName:a.deleteIndexModalIndexName,deleteIndexModalDesignDoc:dc(a),cloneIndexModalVisible:a.cloneIndexModalVisible,cloneIndexModalTitle:a.cloneIndexModalTitle,cloneIndexModalSelectedDesignDoc:a.cloneIndexModalSelectedDesignDoc,cloneIndexModalSelectedDesignDocPartitioned:sc(a,r.isDbPartitioned),cloneIndexModalNewDesignDocName:a.cloneIndexModalNewDesignDocName,cloneIndexModalNewDesignDocPartitioned:a.cloneIndexModalNewDesignDocPartitioned,cloneIndexModalOnSubmit:a.cloneIndexModalOnSubmit,cloneIndexDesignDocProp:a.cloneIndexDesignDocProp,cloneIndexModalNewIndexName:a.cloneIndexModalNewIndexName,cloneIndexSourceIndexName:a.cloneIndexModalSourceIndexName,cloneIndexSourceDesignDocName:a.cloneIndexModalSourceDesignDocName,cloneIndexModalIndexLabel:a.cloneIndexModalIndexLabel}}),(function(e){return{toggleContent:function(t,n){e(ii.toggleContent(t,n))},hideCloneIndexModal:function(){e(ii.hideCloneIndexModal())},hideDeleteIndexModal:function(){e(ii.hideDeleteIndexModal())},showDeleteIndexModal:function(t,n,a,r){e(ii.showDeleteIndexModal(t,n,a,r))},showCloneIndexModal:function(t,n,a,r){e(ii.showCloneIndexModal(t,n,a,r))},selectDesignDoc:function(t){e(ii.selectDesignDoc(t))},updateNewDesignDocName:function(t){e(ii.updateNewDesignDocName(t))},updateNewDesignDocPartitioned:function(t){e(ii.updateNewDesignDocPartitioned(t))},setNewCloneIndexName:function(t){e(ii.setNewCloneIndexName(t))}}}))(tc.SidebarController);function hc(e,t){var n=vn.getNewButtonLinks(e,t);return function(e){return vn.getModifyDatabaseLinks(e)}(e).concat(n)}var mc=function(e){var t=e.url,n=e.icon,a=e.onClick,r=e.children;return de.a.createElement("li",{role:"presentation"},de.a.createElement("a",{className:"faux-header__doc-header-dropdown-item",onClick:a,href:t},de.a.createElement("i",{className:n})," ",r))},gc=function(e){var t=e.dbName,n=function(e){return e.map((function(e,t){if(e.title&&e.links){var n=e.links.map((function(e){return de.a.createElement(mc,{key:e.title,onClick:e.onClick,icon:e.icon,url:e.url},e.title)}));return[de.a.createElement("li",{key:e.title,className:"header-label"},e.title),n]}return de.a.createElement(mc,{icon:e.icon,url:e.url,onClick:e.onClick,key:t},e.title)}))}(hc(t,e.partitionKey));return de.a.createElement("div",{className:"faux-header__doc-header-left"},de.a.createElement("button",{type:"button",className:"faux-header__doc-header-backlink",onClick:function(){se.navigate("#/_all_dbs")}},de.a.createElement("i",{className:"faux-header__doc-header-backlink__icon fonticon fonticon-left-open"})),de.a.createElement("div",{className:"faux-header__doc-header-title flex-fill",title:t},t),de.a.createElement(Ct.d,{id:"faux-header__doc-header-left-1"},de.a.createElement(Ct.d.Toggle,{noCaret:!0,className:"faux-header__doc-header-dropdown-toggle"},de.a.createElement("i",{className:"faux-header__doc-header-dropdown-toggle-icon fonticon-vertical-ellipsis"})),de.a.createElement(Ct.d.Menu,{className:"faux-header__doc-header-dropdown-itemwrapper"},n)))};gc.propTypes={dbName:tt.a.string.isRequired,partitionKey:tt.a.string};var bc=gc,yc=n(66),Ec=n.n(yc);n(167);function _c(e){return(_c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Sc(e,t){return!t||"object"!==_c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nc(e){return(Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dc(e,t){return(Dc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Sc(this,Nc(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dc(e,t)}(t,e),n=t,(a=[{key:"willEnter",value:function(){return{opacity:Object(Wa.spring)(1,Wa.presets.gentle),height:Object(Wa.spring)(160,Wa.presets.gentle)}}},{key:"willLeave",value:function(){return{opacity:Object(Wa.spring)(0,Wa.presets.gentle),height:Object(Wa.spring)(0,Wa.presets.gentle)}}},{key:"getStyles",value:function(e){return!e&&this.props.codeVisible?[{key:"1",style:this.willEnter()}]:e||this.props.codeVisible?e.map((function(e){return{key:"1",style:e.style}})):[{key:"1",style:this.willLeave()}]}},{key:"getChildren",value:function(e){var t=this,n=e.map((function(e){var n=e.style;return!1===t.props.codeVisible&&0===n.opacity?null:de.a.createElement("div",{key:"1",style:{opacity:n.opacity,height:n.height+"px"}},de.a.createElement(_o.CodeFormat,{code:t.props.code}))}));return de.a.createElement("span",null,n)}},{key:"render",value:function(){return de.a.createElement(Wa.TransitionMotion,{styles:this.getStyles(),willLeave:this.willLeave,willEnter:this.willEnter},this.getChildren.bind(this))}}])&&vc(n.prototype,a),r&&vc(n,r),t}(de.a.Component);function wc(e){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Cc(e,t){return!t||"object"!==wc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ac(e){return(Ac=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ic(e,t){return(Ic=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Oc.propTypes={code:tt.a.object.isRequired,codeVisible:tt.a.bool.isRequired};var Pc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Cc(this,Ac(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ic(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.deleted,n=e.id,a=e.databaseName;if(t)return de.a.createElement("span",{className:"js-doc-id"},n);var r="#"+se.urls("document","app",a,n);return de.a.createElement("a",{href:r,className:"js-doc-link"},n)}}])&&Tc(n.prototype,a),r&&Tc(n,r),t}(de.a.Component);function Rc(e){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Lc(e,t){return!t||"object"!==Rc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xc(e){return(xc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uc(e,t){return(Uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mc=Jr.Copy,jc=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Lc(this,xc(t).call(this,e))).state={codeVisible:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uc(e,t)}(t,e),n=t,(a=[{key:"toggleJSON",value:function(e){e.preventDefault(),this.setState({codeVisible:!this.state.codeVisible})}},{key:"getChangesCode",value:function(){return this.state.codeVisible?de.a.createElement(_o.CodeFormat,{key:"changesCodeSection",code:this.getChangeCode()}):null}},{key:"getChangeCode",value:function(){return{changes:this.props.change.changes,doc:this.props.change.doc}}},{key:"showCopiedMessage",value:function(e){var t="The document ID has been copied to your clipboard.";"seq"===e&&(t="The document seq number has been copied to your clipboard."),se.addNotification({msg:t,type:"info",clear:!0})}},{key:"render",value:function(){var e=this,t=this.state.codeVisible,n=this.props,a=n.change,r=n.databaseName,o="change-wrapper"+(a.isNew?" new-change-row":"");return de.a.createElement("div",{className:o},de.a.createElement("div",{className:"change-box","data-id":a.id},de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"span2"},"seq"),de.a.createElement("div",{className:"span8 change-sequence"},a.seq),de.a.createElement("div",{className:"span2 text-right"},de.a.createElement(Mc,{uniqueKey:Ec.a.v4(),text:a.seq.toString(),onClipboardClick:function(){return e.showCopiedMessage("seq")}}))),de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"span2"},"id"),de.a.createElement("div",{className:"span8"},de.a.createElement(Pc,{id:a.id,deleted:a.deleted,databaseName:r})),de.a.createElement("div",{className:"span2 text-right"},de.a.createElement(Mc,{uniqueKey:Ec.a.v4(),text:a.id,onClipboardClick:function(){return e.showCopiedMessage("id")}}))),de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"span2"},"deleted"),de.a.createElement("div",{className:"span10"},a.deleted?"True":"False")),de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"span2"},"changes"),de.a.createElement("div",{className:"span10"},de.a.createElement("button",{type:"button",className:"btn btn-small btn-secondary",onClick:this.toggleJSON.bind(this)},t?"Close JSON":"View JSON"))),de.a.createElement(Oc,{codeVisible:this.state.codeVisible,code:this.getChangeCode()})))}}])&&kc(n.prototype,a),r&&kc(n,r),t}(de.a.Component);function Hc(e){return(Hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gc(e,t){return!t||"object"!==Hc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qc(e){return(qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vc(e,t){return(Vc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}jc.propTypes={change:tt.a.object,databaseName:tt.a.string.isRequired};var Fc=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Gc(this,qc(t).call(this,e))).props.loadChanges(n.props.databaseName),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vc(e,t)}(t,e),n=t,(a=[{key:"showingSubsetMsg",value:function(){var e=this.props,t=e.isShowingSubset,n=e.changes,a="";if(t){var r=n.length;a=de.a.createElement("p",{className:"changes-result-limit"},"Limiting results to latest ",de.a.createElement("b",null,r)," changes.")}return a}},{key:"getRows",value:function(){var e=this.props,t=e.changes,n=e.loaded,a=e.databaseName;return!t.length&&n?de.a.createElement("p",{className:"no-doc-changes"},"There are no document changes to display."):t.map((function(e,t){return de.a.createElement(jc,{change:e,key:t,databaseName:a})}))}},{key:"render",value:function(){return de.a.createElement("div",null,de.a.createElement("div",{className:"js-changes-view"},this.showingSubsetMsg(),this.getRows()))}}])&&Bc(n.prototype,a),r&&Bc(n,r),t}(de.a.Component);Fc.propTypes={changes:tt.a.array.isRequired,loaded:tt.a.bool.isRequired,databaseName:tt.a.string.isRequired,isShowingSubset:tt.a.bool.isRequired,loadChanges:tt.a.func.isRequired};var Kc,Wc={UPDATE_CHANGES:"UPDATE_CHANGES",ADD_CHANGES_FILTER_ITEM:"ADD_CHANGES_FILTER_ITEM",REMOVE_CHANGES_FILTER_ITEM:"REMOVE_CHANGES_FILTER_ITEM",UPDATE_CHANGES_FILTER:"UPDATE_CHANGES_FILTER",TOGGLE_CHANGES_CODE_VISIBILITY:"TOGGLE_CHANGES_CODE_VISIBILITY"},Xc=function(e,t,n){var a={limit:100};Kc&&(a.since=n,a.timeout=6e4,a.feed="longpoll");var r=le.utils.queryParams(a),o=le.utils.safeURLName(t),i=se.urls("changes","server",o,"?"+r);v(i).then((function(t){if(t.error)throw new Error(t.reason||t.error);zc(t,e)})).catch((function(e){se.addNotification({msg:"Error loading list of changes. Reason: "+e.message,type:"error",clear:!0})}))},zc=function(e,t){var n=vn.getSeqNum(e.last_seq);t({type:Wc.UPDATE_CHANGES,changes:e.results,seqNum:n})},Yc=function(e){return function(t){t({type:Wc.ADD_CHANGES_FILTER_ITEM,filter:e})}},Qc=function(e){return function(t){t({type:Wc.REMOVE_CHANGES_FILTER_ITEM,filter:e})}},Jc=function(e){return function(t){Kc=null,Xc(t,e)}},Zc=Object(nt.b)((function(e,t){var n=e.changes;return{changes:n.filteredChanges,loaded:n.isLoaded,databaseName:t.databaseName,isShowingSubset:n.showingSubset}}),(function(e){return{loadChanges:function(t){e(Jc(t))}}}))(Fc);function $c(e){return($c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function el(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tl(e){return(tl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function al(e,t){return(al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rl=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=tl(t).call(this,e))||"object"!==$c(r)&&"function"!=typeof r?nl(a):r).state={filter:"",error:!1},n.submitForm=n.submitForm.bind(nl(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&al(e,t)}(t,e),n=t,(a=[{key:"submitForm",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.props.hasFilter(this.state.filter)){this.setState({error:!0});var t=this;setTimeout((function(){t.setState({error:!1})}),1e3)}else this.props.addFilter(this.state.filter),this.setState({filter:"",error:!1})}},{key:"componentDidMount",value:function(){this.focusFilterField()}},{key:"componentDidUpdate",value:function(){this.focusFilterField()}},{key:"focusFilterField",value:function(){this.addItem.focus()}},{key:"inputClassNames",value:function(){var e="js-changes-filter-field";return this.state.error&&(e+=" errorHighlight"),e}},{key:"render",value:function(){var e=this;return de.a.createElement("form",{className:"form-inline js-filter-form",onSubmit:this.submitForm},de.a.createElement("fieldset",null,de.a.createElement("i",{className:"fonticon-filter"}),de.a.createElement("input",{type:"text",ref:function(t){return e.addItem=t},className:this.inputClassNames(),placeholder:"Sequence or ID",onChange:function(t){return e.setState({filter:t.target.value})},value:this.state.filter}),de.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Filter"),de.a.createElement("div",{className:"help-block"})))}}])&&el(n.prototype,a),r&&el(n,r),t}(de.a.Component);function ol(e){return(ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function il(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function sl(e){return(sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ll(e,t){return(ll=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}rl.propTypes={addFilter:tt.a.func.isRequired,hasFilter:tt.a.func.isRequired,tooltips:tt.a.string},rl.defaultProps={tooltip:""};var ul=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=sl(t).call(this,e))||"object"!==ol(r)&&"function"!=typeof r?cl(a):r).addFilter=n.addFilter.bind(cl(n)),n.hasFilter=n.hasFilter.bind(cl(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ll(e,t)}(t,e),n=t,(a=[{key:"addFilter",value:function(e){_.isEmpty(e)||this.props.addFilter(e)}},{key:"hasFilter",value:function(e){return-1!==this.props.filters.indexOf(e)}},{key:"render",value:function(){var e=this;return de.a.createElement("div",{className:"changes-header"},de.a.createElement(rl,{filter:function(t){return e.props.removeFilter(t)},addFilter:this.addFilter,hasFilter:this.hasFilter}),de.a.createElement(Jr.BadgeList,{elements:this.props.filters,removeBadge:function(t){return e.props.removeFilter(t)}}))}}])&&il(n.prototype,a),r&&il(n,r),t}(de.a.Component);ul.propTypes={filters:tt.a.array.isRequired,addFilter:tt.a.func.isRequired,removeFilter:tt.a.func.isRequired};var dl=Object(nt.b)((function(e){return{filters:e.changes.filters}}),(function(e){return{addFilter:function(t){e(Yc(t))},removeFilter:function(t){e(Qc(t))}}}))(ul);function pl(e){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function hl(e){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ml(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gl(e,t){return(gl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bl=Jr.LoadLines,yl=Jr.Copy,El=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=!(r=hl(t).call(this,e))||"object"!==pl(r)&&"function"!=typeof r?ml(a):r,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(ml(n),"showCopiedMessage",(function(){se.addNotification({type:"success",msg:"The MD5 sha has been copied to your clipboard.",clear:!0})})),n.fetchDDocInfo(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gl(e,t)}(t,e),n=t,(a=[{key:"componentDidUpdate",value:function(e){this.props.designDocInfo!==e.designDocInfo&&this.fetchDDocInfo()}},{key:"componentWillUnmount",value:function(){this.props.stopRefresh()}},{key:"fetchDDocInfo",value:function(){this.props.fetchDesignDocInfo({designDocName:this.props.designDocName,designDocInfo:this.props.designDocInfo})}},{key:"render",value:function(){if(this.props.isLoading)return de.a.createElement(bl,null);var e=this.props.viewIndex,t=e.sizes,n=t.active?t.active.toLocaleString("en"):0,a=t.external?t.external.toLocaleString("en"):0;return de.a.createElement("div",{className:"metadata-page"},de.a.createElement("header",null,de.a.createElement("h2",null,"_design/",this.props.designDocName," Metadata")),de.a.createElement("section",{className:"container"},de.a.createElement("h3",null,"Index Information"),de.a.createElement("ul",null,de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Language:"),de.a.createElement("span",{className:"capitalize"},e.language)),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Currently being updated?"),e.updater_running?"Yes":"No"),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Currently running compaction?"),e.compact_running?"Yes":"No"),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Waiting for a commit?"),e.waiting_commit?"Yes":"No")),de.a.createElement("ul",null,de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Clients waiting for the index:"),e.waiting_clients),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Update sequence on DB:"),e.update_seq),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Processed purge sequence:"),e.purge_seq),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Actual data size (bytes):"),n),de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"Data size on disk (bytes):"),a)),de.a.createElement("ul",null,de.a.createElement("li",null,de.a.createElement("span",{className:"item-title"},"MD5 Signature:"),de.a.createElement(yl,{uniqueKey:Ec.a.v4(),text:e.signature,onClipboardClick:this.showCopiedMessage})))))}}])&&fl(n.prototype,a),r&&fl(n,r),t}(de.a.Component);El.propTypes={isLoading:tt.a.bool.isRequired,viewIndex:tt.a.object,designDocName:tt.a.string.isRequired,stopRefresh:tt.a.func.isRequired,fetchDesignDocInfo:tt.a.func.isRequired};var _l,vl={DESIGN_DOC_MONITOR:"DESIGN_DOC_MONITOR",DESIGN_FETCHING:"DESIGN_FETCHING",DESIGN_REFRESH:"DESIGN_REFRESH"},Sl=function(e,t){Dl(),_l=window.setInterval((function(){Nl(e.designDocInfo,t)}),5e3),t({type:vl.DESIGN_DOC_MONITOR,options:e})},Nl=function(e,t){e.fetch().then((function(){t({type:vl.DESIGN_REFRESH,designDocInfo:e})}))},Dl=function(){_l&&(window.clearInterval(_l),_l=void 0)},Ol={fetchDesignDocInfo:function(e){var t=e.designDocName,n=e.designDocInfo;return function(e){return e({type:vl.DESIGN_FETCHING}),n.fetch().then((function(){Sl({designDocName:t,designDocInfo:n},e)}))}},stopRefresh:Dl},wl=Object(nt.b)((function(e,t){var n=e.designDocInfo;return{isLoading:n.isLoading,viewIndex:n.viewIndex,designDocInfo:t.designDocInfo,designDocName:t.designDocName}}),(function(e){return{fetchDesignDocInfo:function(t){e(Ol.fetchDesignDocInfo(t))},stopRefresh:function(){Ol.stopRefresh()}}}))(El);function Tl(e){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Al(e){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Il(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pl(e,t){return(Pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rl=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=Al(t).call(this,e))||"object"!==Tl(r)&&"function"!=typeof r?Il(a):r).toggleStable=n.toggleStable.bind(Il(n)),n.onUpdateChange=n.onUpdateChange.bind(Il(n)),n.toggleIncludeDocs=n.toggleIncludeDocs.bind(Il(n)),n.updateOptions=[{value:"true",label:"true"},{value:"lazy",label:"lazy"},{value:"false",label:"false"}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pl(e,t)}(t,e),n=t,(a=[{key:"toggleIncludeDocs",value:function(){this.props.toggleIncludeDocs(this.props.includeDocs)}},{key:"onUpdateChange",value:function(e){this.props.changeUpdateField(e.target.value)}},{key:"groupLevelChange",value:function(e){this.props.updateGroupLevel(e.target.value)}},{key:"groupLevel",value:function(){return this.props.reduce?de.a.createElement("label",{className:"drop-down inline",id:"qoGroupLevelGroup"},"Group Level",de.a.createElement("select",{onChange:this.groupLevelChange.bind(this),id:"qoGroupLevel",value:this.props.groupLevel,name:"group_level",className:"input-small"},de.a.createElement("option",{value:"0"},"None"),de.a.createElement("option",{value:"1"},"1"),de.a.createElement("option",{value:"2"},"2"),de.a.createElement("option",{value:"3"},"3"),de.a.createElement("option",{value:"4"},"4"),de.a.createElement("option",{value:"5"},"5"),de.a.createElement("option",{value:"6"},"6"),de.a.createElement("option",{value:"7"},"7"),de.a.createElement("option",{value:"8"},"8"),de.a.createElement("option",{value:"9"},"9"),de.a.createElement("option",{value:"exact"},"Exact"))):null}},{key:"toggleReduce",value:function(){this.props.toggleReduce(this.props.reduce)}},{key:"toggleStable",value:function(){this.props.toggleStable(this.props.stable)}},{key:"includeDocsOption",value:function(){var e=this.props,t=e.includeDocs,n=e.reduce;return de.a.createElement("div",{className:"checkbox inline"},de.a.createElement("input",{disabled:n,onChange:this.toggleIncludeDocs,id:"qoIncludeDocs",name:"include_docs",type:"checkbox",checked:t}),de.a.createElement("label",{className:n?"disabled":"",htmlFor:"qoIncludeDocs",id:"qoIncludeDocsLabel"},"Include Docs"))}},{key:"reduceOption",value:function(){var e=this.props,t=e.showReduce,n=e.reduce;return t?de.a.createElement("span",null,de.a.createElement("div",{className:"checkbox inline"},de.a.createElement("input",{id:"qoReduce",name:"reduce",onChange:this.toggleReduce.bind(this),type:"checkbox",checked:n}),de.a.createElement("label",{htmlFor:"qoReduce"},"Reduce")),this.groupLevel()):null}},{key:"stableOption",value:function(){var e=this.props,t=e.enableStable,n=e.stable;return t||(n=!1),de.a.createElement("div",{className:"checkbox inline"},de.a.createElement("input",{onChange:this.toggleStable,id:"qoStable",name:"stable",type:"checkbox",checked:n,disabled:!t}),de.a.createElement("label",{className:t?"":"disabled",htmlFor:"qoStable",id:"qoStableLabel"},"Stable"))}},{key:"updateOption",value:function(){var e=this.props.update,t=this.updateOptions.map((function(e){return de.a.createElement("option",{key:e.value,value:e.value},e.label)}));return de.a.createElement("div",{className:"dropdown inline"},de.a.createElement("label",{className:"drop-down"},"Update",de.a.createElement("select",{className:"input-small",id:"qoUpdate",value:e,onChange:this.onUpdateChange},t)))}},{key:"render",value:function(){return de.a.createElement("div",{className:"query-group",id:"query-options-main-fields"},de.a.createElement("span",{className:"add-on"},"Query Options",de.a.createElement("a",{className:"help-link",href:this.props.docURL,target:"_blank",rel:"noopener noreferrer","data-bypass":"true"},de.a.createElement("i",{className:"icon-question-sign"}))),de.a.createElement("div",{className:"row-fluid fieldsets"},this.includeDocsOption(),this.reduceOption()),de.a.createElement("div",{className:"row-fluid fieldsets"},this.stableOption(),this.updateOption()))}}])&&Cl(n.prototype,a),r&&Cl(n,r),t}(de.a.Component);function kl(e){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ll(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xl(e,t){return!t||"object"!==kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ul(e){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ml(e,t){return(Ml=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Rl.propTypes={toggleIncludeDocs:tt.a.func.isRequired,includeDocs:tt.a.bool.isRequired,reduce:tt.a.bool.isRequired,toggleReduce:tt.a.func,updateGroupLevel:tt.a.func,docURL:tt.a.string.isRequired,stable:tt.a.bool.isRequired,toggleStable:tt.a.func.isRequired,update:tt.a.string.isRequired,changeUpdateField:tt.a.func.isRequired,showReduce:tt.a.bool.isRequired,enableStable:tt.a.bool.isRequired};var jl=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xl(this,Ul(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ml(e,t)}(t,e),n=t,(a=[{key:"toggleByKeys",value:function(){this.props.toggleByKeys()}},{key:"toggleBetweenKeys",value:function(){this.props.toggleBetweenKeys()}},{key:"updateBetweenKeys",value:function(){this.props.updateBetweenKeys({startkey:this.startkey.value,endkey:this.endkey.value,include:this.props.betweenKeys.include})}},{key:"updateInclusiveEnd",value:function(){this.props.updateBetweenKeys({include:!this.props.betweenKeys.include,startkey:this.props.betweenKeys.startkey,endkey:this.props.betweenKeys.endkey})}},{key:"updateByKeys",value:function(e){this.props.updateByKeys(e.target.value)}},{key:"render",value:function(){var e=this,t="controls-group well js-query-keys-wrapper ",n="row-fluid js-keys-section ",a=n,r="drop-down btn ",o=r;return this.props.showByKeys||this.props.showBetweenKeys||(t+="hide"),this.props.showByKeys?r+="active":n+="hide",this.props.showBetweenKeys?o+="active":a+="hide",de.a.createElement("div",{className:"query-group",id:"query-options-key-search"},de.a.createElement("div",{className:"add-on"},"Keys"),de.a.createElement("div",{className:"btn-group toggle-btns row-fluid"},de.a.createElement("label",{style:{width:"101px"},id:"byKeys",onClick:this.toggleByKeys.bind(this),className:r},"By Key(s)"),de.a.createElement("label",{style:{width:"101px"},id:"betweenKeys",onClick:this.toggleBetweenKeys.bind(this),className:o},"Between Keys")),de.a.createElement("div",{className:t},de.a.createElement("div",{className:n,id:"js-showKeys"},de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"keys-input",className:"drop-down"},"A key, or an array of keys."),de.a.createElement("textarea",{value:this.props.byKeys,onChange:this.updateByKeys.bind(this),id:"keys-input",className:"input-xxlarge",rows:"5",type:"text",placeholder:'Enter either a single key ["123"] or an array of keys ["123", "456"]. A key value is the first parameter emitted in a map function. For example emit("123", 1) the key is "123".'}),de.a.createElement("div",{id:"keys-error",className:"inline-block js-keys-error"}))),de.a.createElement("div",{className:a,id:"js-showStartEnd"},de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("div",null,de.a.createElement("label",{htmlFor:"startkey",className:"drop-down"},"Start key"),de.a.createElement("input",{id:"startkey",ref:function(t){return e.startkey=t},type:"text",onChange:this.updateBetweenKeys.bind(this),value:this.props.betweenKeys.startkey,placeholder:'e.g., "1234"'})),de.a.createElement("div",null,de.a.createElement("label",{htmlFor:"endkey",className:"drop-down"},"End key"),de.a.createElement("input",{id:"endkey",ref:function(t){return e.endkey=t},onChange:this.updateBetweenKeys.bind(this),value:this.props.betweenKeys.endkey,type:"text",placeholder:'e.g., "1234"'}),de.a.createElement("div",{className:"controls include-end-key-row checkbox controls-row inline"},de.a.createElement("input",{id:"qoIncludeEndKeyInResults",type:"checkbox",onChange:this.updateInclusiveEnd.bind(this),checked:this.props.betweenKeys.include}),de.a.createElement("label",{htmlFor:"qoIncludeEndKeyInResults"},"Include End Key in results")))))))}}])&&Ll(n.prototype,a),r&&Ll(n,r),t}(de.a.Component);function Hl(e){return(Hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gl(e,t){return!t||"object"!==Hl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ql(e){return(ql=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vl(e,t){return(Vl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Gl(this,ql(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vl(e,t)}(t,e),n=t,(a=[{key:"updateSkip",value:function(e){e.preventDefault();var t=e.target.value;/^\d*$/.test(t)||(se.addNotification({msg:"Skip can only be a number",type:"error"}),t=this.props.skip),this.props.updateSkip(t)}},{key:"updateLimit",value:function(e){e.preventDefault(),this.props.updateLimit(e.target.value)}},{key:"toggleDescending",value:function(){this.props.toggleDescending(this.props.descending)}},{key:"render",value:function(){return de.a.createElement("div",{className:"query-group",id:"query-options-additional-params"},de.a.createElement("div",{className:"add-on additionalParams"},"Additional Parameters"),de.a.createElement("div",{className:"row-fluid fieldsets"},de.a.createElement("div",{className:"dropdown inline"},de.a.createElement("label",{className:"drop-down"},"Limit",de.a.createElement("select",{id:"qoLimit",onChange:this.updateLimit.bind(this),name:"limit",value:this.props.limit,className:"input-small"},de.a.createElement("option",{value:"none"},"None"),de.a.createElement("option",{value:5},"5"),de.a.createElement("option",{value:10},"10"),de.a.createElement("option",{value:20},"20"),de.a.createElement("option",{value:30},"30"),de.a.createElement("option",{value:50},"50"),de.a.createElement("option",{value:100},"100"),de.a.createElement("option",{value:500},"500"))))),de.a.createElement("div",{className:"row-fluid fieldsets"},de.a.createElement("div",{className:"checkbox inline"},de.a.createElement("input",{id:"qoDescending",type:"checkbox",onChange:this.toggleDescending.bind(this),checked:this.props.descending}),de.a.createElement("label",{htmlFor:"qoDescending"},"Descending")),de.a.createElement("div",{className:"dropdown inline"},de.a.createElement("label",{htmlFor:"qoSkip",className:"drop-down"},"Skip",de.a.createElement("input",{value:this.props.skip,onChange:this.updateSkip.bind(this),className:"input-small",type:"number",id:"qoSkip",placeholder:"# of rows"})))))}}])&&Bl(n.prototype,a),r&&Bl(n,r),t}(de.a.Component);function Kl(e){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Xl(e,t){return!t||"object"!==Kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zl(e){return(zl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yl(e,t){return(Yl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ql=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xl(this,zl(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yl(e,t)}(t,e),n=t,(a=[{key:"hideTray",value:function(){this.props.onCancel()}},{key:"render",value:function(){return de.a.createElement("div",{className:"controls-group query-group"},de.a.createElement("div",{id:"button-options",className:"controls controls-row"},de.a.createElement("button",{type:"submit",className:"btn btn-secondary"},"Run Query"),de.a.createElement("a",{onClick:this.hideTray.bind(this),className:"btn btn-cancelDark"},"Cancel")))}}])&&Wl(n.prototype,a),r&&Wl(n,r),t}(de.a.Component);function Jl(e){return(Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $l(e,t){return!t||"object"!==Jl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eu(e){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tu(e,t){return(tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ql.propTypes={onCancel:tt.a.func.isRequired};var nu=Jr.ToggleHeaderButton,au=Jr.TrayContents,ru=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=$l(this,eu(t).call(this,e));var a=e.ddocsOnly,r=e.queryOptionsApplyFilterOnlyDdocs;return a&&r(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tu(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.ddocsOnly,a=t.queryOptionsApplyFilterOnlyDdocs,r=t.queryOptionsRemoveFilterOnlyDdocs;!n&&e.ddocsOnly?a():n&&!e.ddocsOnly&&r()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.ddocsOnly,n=e.queryOptionsRemoveFilterOnlyDdocs;t&&n()}},{key:"executeQuery",value:function(e){e&&e.preventDefault(),this.closeTray();var t=this.props,n=t.queryOptionsExecute,a=t.queryOptionsParams,r=t.perPage,o=t.resetPagination,i=t.selectedLayout,s=t.changeLayout;o(r);var c=i===ha.LAYOUT_ORIENTATION.METADATA;c&&a.include_docs?s(ha.LAYOUT_ORIENTATION.TABLE):c||a.include_docs||s(ha.LAYOUT_ORIENTATION.METADATA),n(a,r)}},{key:"toggleTrayVisibility",value:function(){this.props.queryOptionsToggleVisibility(!this.props.contentVisible)}},{key:"closeTray",value:function(){this.props.queryOptionsToggleVisibility(!1)}},{key:"getTray",value:function(){return de.a.createElement(au,{closeTray:this.closeTray.bind(this),contentVisible:this.props.contentVisible,className:"query-options",id:"query-options-tray",container:this},de.a.createElement("form",{onSubmit:this.executeQuery.bind(this),className:"js-view-query-update custom-inputs"},de.a.createElement(Rl,{includeDocs:this.props.includeDocs,toggleIncludeDocs:this.props.queryOptionsToggleIncludeDocs,showReduce:this.props.showReduce,reduce:this.props.reduce,toggleReduce:this.props.queryOptionsToggleReduce,groupLevel:this.props.groupLevel,updateGroupLevel:this.props.queryOptionsUpdateGroupLevel,docURL:se.constants.DOC_URLS.GENERAL,enableStable:this.props.enableStable,stable:this.props.stable,toggleStable:this.props.queryOptionsToggleStable,update:this.props.update,changeUpdateField:this.props.queryOptionsChangeUpdate}),de.a.createElement(jl,{key:1,showByKeys:this.props.showByKeys,showBetweenKeys:this.props.showBetweenKeys,toggleByKeys:this.props.queryOptionsToggleByKeys,toggleBetweenKeys:this.props.queryOptionsToggleBetweenKeys,betweenKeys:this.props.betweenKeys,updateBetweenKeys:this.props.queryOptionsUpdateBetweenKeys,byKeys:this.props.byKeys,updateByKeys:this.props.queryOptionsUpdateByKeys}),de.a.createElement(Fl,{descending:this.props.descending,toggleDescending:this.props.queryOptionsToggleDescending,skip:this.props.skip,updateSkip:this.props.queryOptionsUpdateSkip,updateLimit:this.props.queryOptionsUpdateLimit,limit:this.props.limit}),de.a.createElement(Ql,{onCancel:this.closeTray.bind(this)})))}},{key:"showAsActive",value:function(){var e=this.props,t=e.reduce,n=e.betweenKeys,a=e.byKeys,r=e.descending,o=e.skip,i=e.limit,s=e.stable,c=e.update;return!!(n&&n.startkey||a||i&&"none"!=i||o||t||r||s||"true"!==c)}},{key:"render",value:function(){return de.a.createElement("div",{id:"header-query-options"},de.a.createElement("div",{id:"query-options"},de.a.createElement("div",null,de.a.createElement(nu,{toggleCallback:this.toggleTrayVisibility.bind(this),containerClasses:"header-control-box control-toggle-queryoptions",title:"Query Options",fonticon:"fonticon-gears",text:"Options",active:this.showAsActive()}),this.getTray())))}}])&&Zl(n.prototype,a),r&&Zl(n,r),t}(de.a.Component);ru.propTypes={contentVisible:tt.a.bool.isRequired,queryOptionsApplyFilterOnlyDdocs:tt.a.func.isRequired,queryOptionsRemoveFilterOnlyDdocs:tt.a.func.isRequired,queryOptionsExecute:tt.a.func.isRequired,queryOptionsParams:tt.a.object.isRequired,perPage:tt.a.number.isRequired,resetPagination:tt.a.func.isRequired,selectedLayout:tt.a.string.isRequired,changeLayout:tt.a.func.isRequired,queryOptionsToggleVisibility:tt.a.func.isRequired,queryOptionsToggleStable:tt.a.func.isRequired,queryOptionsChangeUpdate:tt.a.func.isRequired,stable:tt.a.bool.isRequired,update:tt.a.string.isRequired};var ou={INDEX_RESULTS_NEW_RESULTS:"INDEX_RESULTS_NEW_RESULTS",INDEX_RESULTS_RESET:"INDEX_RESULTS_RESET",INDEX_RESULTS_SELECT_DOC:"INDEX_RESULTS_SELECT_DOC",INDEX_RESULTS_CLEAR_RESULTS:"INDEX_RESULTS_CLEAR_RESULTS",INDEX_RESULTS_TOOGLE_SELECT_ALL_DOCUMENTS:"INDEX_RESULTS_TOOGLE_SELECT_ALL_DOCUMENTS",INDEX_RESULTS_SELECT_NEW_FIELD_IN_TABLE:"INDEX_RESULTS_SELECT_NEW_FIELD_IN_TABLE",INDEX_RESULTS_CLEAR_SELECTED_ITEMS:"INDEX_RESULTS_CLEAR_SELECTED_ITEMS",INDEX_RESULTS_TOGGLE_PRIORITIZED_TABLE_VIEW:"INDEX_RESULTS_TOGGLE_PRIORITIZED_TABLE_VIEW",INDEX_RESULTS_REDUX_NEW_RESULTS:"INDEX_RESULTS_REDUX_NEW_RESULTS",INDEX_RESULTS_REDUX_IS_LOADING:"INDEX_RESULTS_REDUX_IS_LOADING",INDEX_RESULTS_REDUX_CHANGE_LAYOUT:"INDEX_RESULTS_REDUX_CHANGE_LAYOUT",INDEX_RESULTS_REDUX_TOGGLE_SHOW_ALL_COLUMNS:"INDEX_RESULTS_REDUX_TOGGLE_SHOW_ALL_COLUMNS",INDEX_RESULTS_REDUX_SET_PER_PAGE:"INDEX_RESULTS_REDUX_SET_PER_PAGE",INDEX_RESULTS_REDUX_PAGINATE_NEXT:"INDEX_RESULTS_REDUX_PAGINATE_NEXT",INDEX_RESULTS_REDUX_PAGINATE_PREVIOUS:"INDEX_RESULTS_REDUX_PAGINATE_PREVIOUS",INDEX_RESULTS_REDUX_NEW_SELECTED_DOCS:"INDEX_RESULTS_REDUX_NEW_SELECTED_DOCS",INDEX_RESULTS_REDUX_CHANGE_TABLE_HEADER_ATTRIBUTE:"INDEX_RESULTS_REDUX_CHANGE_TABLE_HEADER_ATTRIBUTE",INDEX_RESULTS_REDUX_RESET_STATE:"INDEX_RESULTS_REDUX_RESET_STATE",INDEX_RESULTS_REDUX_NEW_QUERY_OPTIONS:"INDEX_RESULTS_REDUX_NEW_QUERY_OPTIONS",INDEX_RESULTS_REDUX_PARTITION_PARAM_NOT_SUPPORTED:"INDEX_RESULTS_REDUX_PARTITION_PARAM_NOT_SUPPORTED",INDEX_RESULTS_REDUX_PARTITION_PARAM_MANDATORY:"INDEX_RESULTS_REDUX_PARTITION_PARAM_MANDATORY",INDEX_RESULTS_SET_STYLE:"INDEX_RESULTS_SET_STYLE"},iu=function(e,t,n){void 0===e&&(e="server");var a=le.utils.getSafeIdForDoc(t);a||(a="");var r=encodeURIComponent(n);return se.urls("document",e,r,a,"?conflicts=true")},su=function(e,t){if(e)return t!==ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX&&(!!Object.keys(e).length&&!!e._id)},cu=function(e,t){return t===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX?"special"!==e.type:!!((e._id||e.id)&&(e._rev||e.value&&e.value.rev))},lu=function(e,t){return!!e.find((function(e){return cu(e,t)}))},uu=function(){if(window.localStorage){var e=le.utils.localStorageGet("fauxton:perpageredux");if(e)return parseInt(e,10)}return se.constants.MISC.DEFAULT_PAGE_SIZE},du=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ha.INDEX_RESULTS_DOC_TYPE.VIEW;return t===ha.INDEX_RESULTS_DOC_TYPE.VIEW?e.id||e._id:t===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX?"special"===e.type?"_all_docs":e.ddoc:t===ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY?e._id:e.id||e._id},pu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ha.INDEX_RESULTS_DOC_TYPE.VIEW;return t===ha.INDEX_RESULTS_DOC_TYPE.VIEW?e.value?e.value.rev:e._rev:t!==ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX&&t===ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY?e._rev:void 0},fu=function(e){return"Reason: "+(e&&e.message||"n/a")},hu=function(){return{type:ou.INDEX_RESULTS_REDUX_RESET_STATE}},mu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:ou.INDEX_RESULTS_REDUX_NEW_SELECTED_DOCS,selectedDocs:e}},gu=function(e){return{type:ou.INDEX_RESULTS_REDUX_CHANGE_LAYOUT,layout:e}};n(368);function bu(){return(bu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function yu(){return(yu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Eu=function(e,t,n){var a=function(e,t){var n={},a=(t.skip||0)+t.limit;n.skip=Math.max(e.skip,t.skip||0),n.limit=e.limit,e.conflicts&&(n.conflicts=!0);var r=a-n.skip;return{params:yu({},t,n),totalDocsRemaining:r}}(t,n),r=a.params,o=a.totalDocsRemaining;return r.limit=Math.min(r.limit,1e4),function(t){return t({type:ou.INDEX_RESULTS_REDUX_IS_LOADING}),e(r).then((function(e){var n=e.docs,a=e.docType,i=e.executionStats,s=e.warning,c=e.layout,l=function(e,t,n){var a=!1;return t&&e.length>t?e.splice(t):e.length===n&&(e.splice(n-1),a=!0),{finalDocList:e,canShowNext:a}}(n,o,r.limit),u=l.finalDocList,d=l.canShowNext;c&&t(gu(c)),t(function(e,t,n,a,r,o){return{type:ou.INDEX_RESULTS_REDUX_NEW_RESULTS,docs:e,params:t,canShowNext:n,docType:a,executionStats:r,warning:o}}(u,r,d,a,i,s))})).catch((function(e){e&&-1!==e.message.indexOf("`partition` parameter is not supported")?t({type:ou.INDEX_RESULTS_REDUX_PARTITION_PARAM_NOT_SUPPORTED}):e&&-1!==e.message.indexOf("`partition` parameter is mandatory")?t({type:ou.INDEX_RESULTS_REDUX_PARTITION_PARAM_MANDATORY}):se.addNotification({msg:"Error running query. "+fu(e),type:"error",clear:!0}),t(hu())}))}},_u=function(e){var t="Failed to delete your document!";e&&(t="Failed to delete: "+e.join(", ")),se.addNotification({msg:t,type:"error",clear:!0})},vu=function(e,t,n,a,r,o,i){return!!function(e){var t=e.length,n=1===t?"Are you sure you want to delete this doc?":"Are you sure you want to delete these "+t+" docs?";return 0===t?(window.alert("Please select the document rows you want to delete."),!1):!!window.confirm(n)}(n)&&function(s){var c,l;if(i===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX)l={docids:n.map((function(e){return e._id}))},c=function(e,t){var n=se.urls("mango","index-server-bulk-delete",encodeURIComponent(e));return N(n,t)}(e,l);else{if(i!==ha.INDEX_RESULTS_DOC_TYPE.VIEW&&i!==ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY)throw new Error("Invalid document type: "+i);c=function(e,t){var n=se.urls("bulk_docs","server",e);return N(n,t)}(e,l={docs:n})}return c.then((function(e){e.error?_u():(Su(e,n,a,i),s(mu()),s(Eu(t,r,o)))}))}},Su=function(e,t,n,a){se.addNotification({msg:"Successfully deleted your docs",clear:!0});var r=[];a===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX?e.fail&&(r=e.fail.map((function(e){return e.id}))):r=e.filter((function(e){return!!e.error})).map((function(e){return e.id}));var o=!!t.map((function(e){return e._id})).find((function(e){return/_design/.test(e)}));r.length>0&&_u(r),n&&o&&ii.dispatchUpdateDesignDocs(n)};function Nu(){return(Nu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var Du=function(e){return{type:ou.INDEX_RESULTS_REDUX_SET_PER_PAGE,perPage:e}},Ou=function(e,t,n,a){return t=function(e,t,n){return Nu({},e,{limit:n+1,skip:t.skip||0})}(t,n,a),function(r){r(Du(a)),r(Eu(e,t,n))}},wu=function(e,t,n,a){return t=function(e,t){return Nu({},e,{skip:e.skip+t})}(t,a),function(a){a({type:ou.INDEX_RESULTS_REDUX_PAGINATE_NEXT}),a(Eu(e,t,n))}},Tu=function(e,t,n,a){return t=function(e,t){return Nu({},e,{skip:Math.max(e.skip-t,0)})}(t,a),function(a){a({type:ou.INDEX_RESULTS_REDUX_PAGINATE_PREVIOUS}),a(Eu(e,t,n))}},Cu=function(e){return{type:ou.INDEX_RESULTS_REDUX_NEW_QUERY_OPTIONS,options:e}},Au=function(e){return Cu({includeDocs:!e})};function Iu(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Pu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ru=function(e){var t,n=e.def,a=e.type,r=[];return(r=n.fields.reduce((function(e,t,n){return 0===n?e.push(a+": "+Object.keys(t)[0]):e.push(Object.keys(t)[0]),e}),[])).length||(r=(t=se.getExtensions("mango:additionalIndexes")[0])?t.createHeader({def:n,type:a}):[a+": "+(n.selector?JSON.stringify(n.selector):"{}")]),r.join(", ")},ku=function(e){return JSON.stringify(e,null,3)},Lu=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Iu(n,!0).forEach((function(t){Pu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iu(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return delete t.ddoc,delete t.name,JSON.stringify(t,null," ")},xu=function(e,t){var n=t.databaseName,a=t.docType,r=t.deleteEnabled,o=void 0===r||r,i=e.map((function(e){if("MangoIndex"===a)return{header:Ru(e),content:Lu(e),id:"special"===e.type?"_all_docs":e.ddoc,keylabel:"",url:e.id?iu("app",e.id,n):null,isDeletable:!!o&&"special"!==e.type,isEditable:!1};var t=du(e,a);return{header:t,content:JSON.stringify(e,null," "),id:t||e.key&&e.key.toString(),_rev:pu(e,a),keylabel:"id",url:t?iu("app",t,n):null,isDeletable:o,isEditable:!0}}));return{displayedFields:null,hasBulkDeletableDoc:lu(e,a),results:i}},Uu=function(e){var t=[];e.forEach((function(e){Object.keys(e).forEach((function(e){t.push(e)}))}));var n=(t=_.uniq(t)).indexOf("_id");return-1!==n&&(t.splice(n,1),t.unshift("_id")),t},Mu=function(e){return e.sort((function(e,t){return function e(t,n,a){return t[a]===n[a]?a<2?e(t,n,a+1):0:1===a?t[a]<n[a]?-1:1:t[a]<n[a]?1:-1}(e,t,0)}))},ju=function(e,t){var n,a=null,r=t.selectedFieldsTableView,o=t.showAllFieldsTableView,i=e.map((function(e){return e.doc||e}));n=Uu(i),r&&0===r.length&&(r=function(e,t){var n=e.reduce((function(e,t){return e=e.concat(Object.keys(t))}),[]);return delete(n=_.countBy(n,(function(e){return e}))).id,delete n._rev,n=Object.keys(n).reduce((function(e,t){return e.push([n[t],t]),e}),[]),(n=(n=Mu(n)).slice(0,t)).reduce((function(e,t){return e.push(t[1]),e}),[])}(i,5));var s,c,l=_.without(n,"_attachments");return s=r,c=l,a=_.without.bind(void 0,c).apply(void 0,s),o&&(a=null,r=l),{schema:n,normalizedDocs:i,selectedFieldsTableView:r,notSelectedFieldsTableView:a}},Hu=function(e,t){var n=ha.LAYOUT_ORIENTATION.METADATA===t.selectedLayout,a=n?function(e){var t=Uu(e);return{schema:t,normalizedDocs:e,selectedFieldsTableView:t,notSelectedFieldsTableView:null}}(e):ju(e,t),r=a.schema,o=a.normalizedDocs,i=a.selectedFieldsTableView,s=a.notSelectedFieldsTableView,c=o.map((function(e){return{content:e,id:du(e,t.docType),_rev:pu(e,t.docType),header:"",keylabel:"",url:e._id||e.id?iu("app",e._id||e.id,t.databaseName):null,isDeletable:!!t.deleteEnabled&&cu(e,t.docType),isEditable:su(e,t.docType)}}));return{notSelectedFields:s,selectedFields:i,hasBulkDeletableDoc:!!t.deleteEnabled&&lu(o,t.docType),schema:r,results:c,displayedFields:n?null:{shown:_.uniq(i).length,allFieldCount:_.without(r,"_attachments").length}}};function Bu(e){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gu(){return(Gu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function qu(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Vu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qu(n,!0).forEach((function(t){Fu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qu(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ku={noResultsWarning:"",docs:[],selectedDocs:[],isLoading:!1,tableView:{selectedFieldsTableView:[],showAllFieldsTableView:!1},isEditable:!0,selectedLayout:ha.LAYOUT_ORIENTATION.METADATA,textEmptyIndex:"No Documents Found",docType:ha.INDEX_RESULTS_DOC_TYPE.VIEW,resultsStyle:function(){var e=le.utils.localStorageGet("fauxton:results_style");e||(e={textOverflow:ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_TRUNCATED,fontSize:ha.INDEX_RESULTS_STYLE.FONT_SIZE_MEDIUM});return e}(),fetchParams:{limit:uu()+1,skip:0},pagination:{pageStart:1,currentPage:1,perPage:uu(),canShowNext:!1},queryOptionsPanel:{isVisible:!1,showByKeys:!1,showBetweenKeys:!1,includeDocs:!1,betweenKeys:{include:!0,startkey:"",endkey:""},byKeys:"",descending:!1,skip:"",limit:"none",reduce:!1,groupLevel:"exact",showReduce:!1,stable:!1,update:"true"}};var Wu=function(e){return"query"!==e.language},Xu=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=e.docs,r={databaseName:t,selectedLayout:e.selectedLayout,selectedFieldsTableView:e.tableView.selectedFieldsTableView,showAllFieldsTableView:e.tableView.showAllFieldsTableView,docType:e.docType,deleteEnabled:n},o=a.filter(Wu);return ha.LAYOUT_ORIENTATION.JSON===r.selectedLayout?xu(o,r):Hu(o,r)},zu=function(e){return e.selectedLayout===ha.LAYOUT_ORIENTATION.TABLE},Yu=function(e){return!!Qu(e)&&e.pagination.pageStart+e.docs.length-1},Qu=function(e){return!e.isLoading&&e.docs.length>0},Ju=function(e){if(0===e.docs.length||0===e.selectedDocs.length)return!1;for(var t=function(t){var n=e.docs[t];if(!cu(n,e.docType))return"continue";return e.selectedDocs.some((function(t){return du(n,e.docType)===t._id}))?void 0:{v:!1}},n=0;n<e.docs.length;n++){var a=t(n);switch(a){case"continue":continue;default:if("object"===Bu(a))return a.v}}return!0},Zu=function(e){return e.selectedDocs.length>0},$u=function(e){return e.selectedDocs.length},ed=function(e){return e.pagination.currentPage>1},td=function(e,t){return Xu(e,t).displayedFields||{}},nd=function(e){var t=e.queryOptionsPanel,n={};if(t.includeDocs&&(n.include_docs=t.includeDocs),t.showBetweenKeys){var a=t.betweenKeys;n.inclusive_end=a.include,a.startkey&&""!=a.startkey&&(n.start_key=a.startkey),a.endkey&&""!=a.endkey&&(n.end_key=a.endkey)}else t.showByKeys&&t.byKeys.trim()&&(n.keys=t.byKeys.replace(/\r?\n/g,""));return"none"!==t.limit&&(n.limit=parseInt(t.limit,10)),t.skip&&(n.skip=parseInt(t.skip,10)),t.descending&&(n.descending=t.descending),t.reduce&&(n.reduce=!0,"exact"===t.groupLevel?n.group=!0:n.group_level=t.groupLevel),void 0!==t.update&&"true"!==t.update&&(n.update=t.update),!0===t.stable&&(n.stable=t.stable),n},ad=function(e){return e.docs},rd=function(e){return e.selectedDocs},od=function(e){return e.isEditable},id=function(e){return e.selectedLayout},sd=function(e){return e.textEmptyIndex},cd=function(e){return e.docType},ld=function(e){return e.tableView.showAllFieldsTableView},ud=function(e){return e.pagination.canShowNext},dd=function(e){return e.pagination.perPage},pd=function(e){return e.fetchParams},fd=function(e){return e.resultsStyle},hd=function(e,t,n){return!vn.isViewSelected(t)||!vn.selectedItemIsPartitionedView(e,t,n)},md=Object(nt.b)((function(e,t){var n,a,r=e.indexResults,o=e.sidebar,i=e.databases,s=r.queryOptionsPanel;return{contentVisible:s.isVisible,includeDocs:s.includeDocs,showReduce:(n=o.designDocList,a=t.selectedNavItem,vn.selectedViewContainsReduceFunction(n,a)),reduce:s.reduce,groupLevel:s.groupLevel,showByKeys:s.showByKeys,showBetweenKeys:s.showBetweenKeys,betweenKeys:s.betweenKeys,byKeys:s.byKeys,descending:s.descending,skip:s.skip,limit:s.limit,enableStable:hd(o.designDocList,t.selectedNavItem,i.isDbPartitioned),stable:s.stable,update:s.update,fetchParams:pd(r),queryOptionsParams:nd(r),perPage:dd(r),selectedLayout:id(r),ddocsOnly:t.ddocsOnly}}),(function(e,t){return{resetPagination:function(t){e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se.constants.MISC.DEFAULT_PAGE_SIZE;return Du(e)}(t))},queryOptionsToggleReduce:function(t){e(function(e){return Cu(e?{reduce:!e}:{reduce:!e,includeDocs:!1})}(t))},queryOptionsUpdateGroupLevel:function(t){e(function(e){return Cu({groupLevel:e})}(t))},queryOptionsToggleByKeys:function(t){e(function(e){return Cu({showByKeys:!e,showBetweenKeys:!!e})}(t))},queryOptionsToggleBetweenKeys:function(t){e(function(e){return Cu({showBetweenKeys:!e,showByKeys:!!e})}(t))},queryOptionsUpdateBetweenKeys:function(t){e(function(e){return Cu({betweenKeys:e})}(t))},queryOptionsUpdateByKeys:function(t){e(function(e){return Cu({byKeys:e})}(t))},queryOptionsToggleDescending:function(t){e(function(e){return Cu({descending:!e})}(t))},queryOptionsUpdateSkip:function(t){e(function(e){return Cu({skip:e})}(t))},queryOptionsUpdateLimit:function(t){e(function(e){return Cu({limit:e})}(t))},queryOptionsToggleIncludeDocs:function(t){e(Au(t))},queryOptionsToggleVisibility:function(t){e(function(e){return Cu({isVisible:e})}(t))},queryOptionsExecute:function(n,a){e(function(e,t,n){var a=function(e){return{limit:e+1,skip:0}}(n);return Eu(e,a,t)}(t.queryDocs,n,a))},queryOptionsApplyFilterOnlyDdocs:function(){e(Cu({betweenKeys:{include:!1,startkey:'"_design"',endkey:'"_design0"'},showBetweenKeys:!0,showByKeys:!1}))},queryOptionsRemoveFilterOnlyDdocs:function(){e(Cu({betweenKeys:{},showBetweenKeys:!1,showByKeys:!1}))},queryOptionsToggleStable:function(t){e(function(e){return Cu({stable:!e})}(t))},queryOptionsChangeUpdate:function(t){e(function(e){return Cu({update:e.toString()})}(t))},changeLayout:function(t){e(gu(t))},resetState:function(){e(hu())}}}))(ru),gd=md;md.propTypes={queryDocs:tt.a.func.isRequired};var bd=function(e){var t=e.database,n=e.loadOptions;return de.a.createElement("div",null,de.a.createElement(Jr.ThrottledReactSelectAsync,{className:"jump-to-doc",name:"jump-to-doc",placeholder:"Document ID",loadOptions:n,clearable:!1,ignoreCase:!1,ignoreAccents:!1,cache:!1,onChange:function(e){var n=e.value,a=se.urls("document","app",le.utils.safeURLName(t.id),le.utils.safeURLName(n));setTimeout((function(){return se.navigate(a,{trigger:!0})}))}}))};bd.propTypes={database:tt.a.object.isRequired,loadOptions:tt.a.func.isRequired};var yd=bd,Ed=function(e,t){return function(n,a){var r="?"+le.utils.queryParams({startkey:JSON.stringify(n),endkey:JSON.stringify(n+"香"),limit:30}),o=t?se.urls("partitioned_allDocs","server",e.safeID(),encodeURIComponent(t),r):se.urls("allDocs","server",e.safeID(),r);v(o).then((function(e){var t=[];e.error||(t=e.rows.map((function(e){return{value:e.id,label:e.id}})));a(null,{options:t})}))}},_d=function(e){var t=e.database,n=e.hideQueryOptions,a=e.hideJumpToDoc,r=e.queryDocs,o=e.ddocsOnly,i=e.selectedNavItem,s=e.partitionKey;return de.a.createElement("div",{className:"header-right right-db-header flex-layout flex-row"},de.a.createElement("div",{className:"faux-header__searchboxwrapper"},de.a.createElement("div",{className:"faux-header__searchboxcontainer"},a?null:de.a.createElement(yd,{key:JSON.stringify(t+s),cache:!1,loadOptions:Ed(t,s),database:t}))),n?null:de.a.createElement(gd,{ddocsOnly:o,queryDocs:r,selectedNavItem:i}))};_d.propTypes={database:tt.a.object.isRequired,hideQueryOptions:tt.a.bool,isRedux:tt.a.bool,queryDocs:tt.a.func,selectedNavItem:tt.a.object,partitionKey:tt.a.string},_d.defaultProps={hideQueryOptions:!1};var vd=_d;function Sd(e){return(Sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nd(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dd(e,t){return!t||"object"!==Sd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Od(e){return(Od=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wd(e,t){return(wd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Td=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dd(this,Od(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wd(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e,t,n,a=this.props,r=a.selectedLayout,o=a.docType,i=a.queryOptionsParams,s=a.fetchUrl;if(o===ha.INDEX_RESULTS_DOC_TYPE.VIEW)e=de.a.createElement(Ct.a,{className:r===ha.LAYOUT_ORIENTATION.METADATA?"active":"",onClick:this.toggleLayout.bind(this,ha.LAYOUT_ORIENTATION.METADATA)},"Metadata");else if(o===ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX)return null;var c=s&&-1!==s.indexOf("/_all_docs"),l=o===ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY;return(c||l||!i.reduce)&&(n=de.a.createElement(Ct.a,{className:r===ha.LAYOUT_ORIENTATION.TABLE?"active":"",onClick:this.toggleLayout.bind(this,ha.LAYOUT_ORIENTATION.TABLE)},de.a.createElement("i",{className:"fonticon-table"})," Table"),t=de.a.createElement(Ct.a,{className:r===ha.LAYOUT_ORIENTATION.JSON?"active":"",onClick:this.toggleLayout.bind(this,ha.LAYOUT_ORIENTATION.JSON)},de.a.createElement("i",{className:"fonticon-json"})," JSON")),de.a.createElement("div",{className:"alternative-header"},de.a.createElement(Ct.b,{className:"two-sides-toggle-button"},n,e,t))}},{key:"toggleLayout",value:function(e){var t=this.props,n=t.changeLayout,a=t.selectedLayout,r=t.fetchDocs,o=t.fetchParams,i=t.queryOptionsParams,s=t.queryOptionsToggleIncludeDocs;if(e!==a)return n(e),i.include_docs=e!==ha.LAYOUT_ORIENTATION.METADATA,e===ha.LAYOUT_ORIENTATION.TABLE?o.conflicts=!0:delete o.conflicts,s(!i.include_docs),void r(o,i)}}])&&Nd(n.prototype,a),r&&Nd(n,r),t}(de.a.Component);function Cd(e){return(Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ad(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Id(e){return(Id=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rd(e,t){return(Rd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ld=Jr.MenuDropDown,xd=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=Id(t).call(this,e))||"object"!==Cd(r)&&"function"!=typeof r?Pd(a):r).toggleTextOverflow=n.toggleTextOverflow.bind(Pd(n)),n.setFontSize=n.setFontSize.bind(Pd(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rd(e,t)}(t,e),n=t,(a=[{key:"toggleTextOverflow",value:function(){this.props.resultsStyle.textOverflow===ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_FULL?this.props.updateStyle({textOverflow:ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_TRUNCATED}):this.props.updateStyle({textOverflow:ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_FULL})}},{key:"setFontSize",value:function(e){this.props.updateStyle({fontSize:e})}},{key:"getDensitySection",value:function(){var e="Show full values";return this.props.resultsStyle.textOverflow===ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_FULL&&(e="Truncate values"),{title:"Display density",links:[{title:e,onClick:this.toggleTextOverflow}]}}},{key:"getFontSizeSection",value:function(){var e=this;return{title:"Font size",links:[{title:"Small",onClick:function(){e.setFontSize(ha.INDEX_RESULTS_STYLE.FONT_SIZE_SMALL)},icon:this.props.resultsStyle.fontSize===ha.INDEX_RESULTS_STYLE.FONT_SIZE_SMALL?"fonticon-ok":""},{title:"Medium",onClick:function(){e.setFontSize(ha.INDEX_RESULTS_STYLE.FONT_SIZE_MEDIUM)},icon:this.props.resultsStyle.fontSize===ha.INDEX_RESULTS_STYLE.FONT_SIZE_MEDIUM?"fonticon-ok":""},{title:"Large",onClick:function(){e.setFontSize(ha.INDEX_RESULTS_STYLE.FONT_SIZE_LARGE)},icon:this.props.resultsStyle.fontSize===ha.INDEX_RESULTS_STYLE.FONT_SIZE_LARGE?"fonticon-ok":""}]}}},{key:"render",value:function(){var e=[];return this.props.showDensity&&e.push(this.getDensitySection()),this.props.showFontSize&&e.push(this.getFontSizeSection()),de.a.createElement("div",{className:"toolbar-dropdown"},de.a.createElement(Ld,{id:"result-style-menu",links:e,icon:"fonticon-mixer",hideArrow:!0,toggleType:"button"}))}}])&&Ad(n.prototype,a),r&&Ad(n,r),t}(de.a.Component);function Ud(e){return(Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Md(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jd(e,t){return!t||"object"!==Ud(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hd(e){return(Hd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bd(e,t){return(Bd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}kd(xd,"defaultProps",{showDensity:!0,showFontSize:!0}),kd(xd,"propTypes",{resultsStyle:tt.a.object.isRequired,updateStyle:tt.a.func.isRequired,showDensity:tt.a.bool,showFontSize:tt.a.bool});var Gd=Jr.BulkActionComponent,qd=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jd(this,Hd(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bd(e,t)}(t,e),n=t,(a=[{key:"shouldComponentUpdate",value:function(e){return null!=e.isListDeletable}},{key:"render",value:function(){var e=this.props,t=e.hasResults,n=e.isListDeletable,a=e.removeItem,r=e.allDocumentsSelected,o=e.hasSelectedItem,i=e.toggleSelectAll,s=e.isLoading,c=e.databaseName,l=e.partitionKey,u=null;(n&&t||s)&&(u=de.a.createElement(Gd,{removeItem:a,isChecked:r,hasSelectedItem:o,toggleSelect:i,disabled:s,title:"Select all docs that can be..."}));var d=null,p=this.props.selectedLayout!==ha.LAYOUT_ORIENTATION.JSON,f=null;(t||s)&&(d=de.a.createElement(Td,this.props),f=de.a.createElement(xd,{updateStyle:this.props.updateResultsStyle,resultsStyle:this.props.resultsStyle,showDensity:p}));var h=null;return c&&(h=de.a.createElement("div",{className:"document-result-screen__toolbar-flex-container"},de.a.createElement("a",{href:vn.getNewDocUrl(c,l),className:"btn save document-result-screen__toolbar-create-btn btn-primary"},"Create Document"))),de.a.createElement("div",{className:"document-result-screen__toolbar"},u,d,f,h)}}])&&Md(n.prototype,a),r&&Md(n,r),t}(de.a.Component);function Vd(e){var t=e.text,n=e.isWarning,a=de.a.createElement("div",{className:"no-results-screen-warning"},de.a.createElement("i",{className:"fonticon-attention-circled"}),t);return de.a.createElement("div",{className:"no-results-screen"},n?a:null,de.a.createElement("div",{className:"watermark-logo"}),n?null:de.a.createElement("h3",null,t))}function Fd(e){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kd(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wd(e,t){return!t||"object"!==Fd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xd(e){return(Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zd(e,t){return(zd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}qd.propTypes={removeItem:tt.a.func.isRequired,allDocumentsSelected:tt.a.bool.isRequired,hasSelectedItem:tt.a.bool.isRequired,toggleSelectAll:tt.a.func.isRequired,isLoading:tt.a.bool.isRequired,hasResults:tt.a.bool.isRequired,isListDeletable:tt.a.bool,partitionKey:tt.a.string,docType:tt.a.string,resultsStyle:tt.a.object.isRequired,updateResultsStyle:tt.a.func.isRequired},Vd.propTypes={text:tt.a.string.isRequired};var Yd=Jr.Copy,Qd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Wd(this,Xd(t).call(this,e))).state={checked:n.props.isSelected},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zd(e,t)}(t,e),n=t,(a=[{key:"onChange",value:function(){this.props.docChecked(this.props.el.id,this.props.el._rev)}},{key:"getRowContents",value:function(e,t){var n=e.content;return this.props.data.selectedFields.map(function(e,a){var r="tableview-data-cell-"+t+e+a+n[e],o=-1!==["object","boolean"].indexOf(Fd(n[e]))?JSON.stringify(n[e],null,"  "):n[e],i=Tt()({showall:this.props.textOverflow===ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_FULL,"small-font":this.props.fontSize===ha.INDEX_RESULTS_STYLE.FONT_SIZE_SMALL,"large-font":this.props.fontSize===ha.INDEX_RESULTS_STYLE.FONT_SIZE_LARGE});return de.a.createElement("td",{key:r,title:o,className:i,onClick:this.onClick.bind(this)},o)}.bind(this))}},{key:"maybeGetCheckboxCell",value:function(e,t){return de.a.createElement("td",{className:"tableview-checkbox-cell",key:"tableview-checkbox-cell-"+t},e.isDeletable?de.a.createElement("input",{id:"checkbox-"+this.props.docIdentifier,checked:this.props.isSelected,type:"checkbox",onChange:this.onChange.bind(this)}):null)}},{key:"getAdditionalInfoRow",value:function(e){var t=Object.keys(e._attachments||{}).length,n=null,a=null,r=Object.keys(e._conflicts||{}).length,o=null,i=null;return t&&(a=1===t?t+" Attachment":t+" Attachments",n=de.a.createElement("div",{style:{display:"inline",marginLeft:"5px"},title:a},de.a.createElement("i",{className:"icon fonticon-paperclip"}),t)),r&&(i=1===r?r+" Conflict":r+" Conflicts",o=de.a.createElement("div",{className:"tableview-conflict","data-conflicts-indicator":!0,style:{display:"inline"},title:i},de.a.createElement("i",{style:{fontSize:"17px"},className:"icon icon-code-fork"}),r)),de.a.createElement("td",{className:"tableview-el-last",onClick:this.onClick.bind(this)},o,n)}},{key:"getCopyButton",value:function(e){var t=JSON.stringify(e,null,"  ");return de.a.createElement("td",{title:t,className:"tableview-el-copy"},de.a.createElement(Yd,{title:t,text:t,uniqueKey:Ec.a.v4(),onClipboardClick:this.showCopiedMessage}))}},{key:"showCopiedMessage",value:function(){se.addNotification({msg:"The document content has been copied to the clipboard.",type:"success",clear:!0})}},{key:"onClick",value:function(e){this.props.onClick(this.props.el._id,this.props.el,e)}},{key:"render",value:function(){var e=this.props.index,t=this.props.el.content,n=this.props.el;return de.a.createElement("tr",{key:"tableview-content-row-"+e},this.maybeGetCheckboxCell(n,e),this.getCopyButton(t),this.getRowContents(n,e),this.getAdditionalInfoRow(t))}}])&&Kd(n.prototype,a),r&&Kd(n,r),t}(de.a.Component);function Jd(e){var t=e.selectedField,n=e.notSelectedFields,a=e.index,r=e.changeField,o=e.selectedFields,i=n.map((function(e){return{value:e,label:e}}));return de.a.createElement("div",{className:"table-container-autocomplete"},de.a.createElement("div",{className:"table-select-wrapper"},de.a.createElement(qr.a,{value:t,options:i,clearable:!1,onChange:function(e){r({newSelectedRow:e.value,index:a},o)}})))}function Zd(e){return(Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ep(e,t){return!t||"object"!==Zd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tp(e){return(tp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function np(e,t){return(np=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(Qd,"defaultProps",{textOverflow:ha.INDEX_RESULTS_STYLE.TEXT_OVERFLOW_TRUNCATED}),Qd.propTypes={docIdentifier:tt.a.string.isRequired,docChecked:tt.a.func.isRequired,isSelected:tt.a.bool.isRequired,index:tt.a.number.isRequired,data:tt.a.object.isRequired,onClick:tt.a.func.isRequired,textOverflow:tt.a.string};var ap=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ep(this,tp(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&np(e,t)}(t,e),n=t,(a=[{key:"getContentRows",value:function(){var e=this.props.data.results,t=this.props.resultsStyle,n=t.textOverflow,a=t.fontSize;return e.map(function(e,t){return de.a.createElement(Qd,{onClick:this.props.onClick,key:"tableview-row-component-"+t,index:t,el:e,docIdentifier:e.id||"tableview-row-component-"+t,docChecked:this.props.docChecked,isSelected:this.props.isSelected(e.id),data:this.props.data,textOverflow:n,fontSize:a})}.bind(this))}},{key:"getOptionFieldRows",value:function(e){return this.props.data.notSelectedFields?e.map(function(e,t){return de.a.createElement("th",{key:"header-el-"+t},this.getDropdown(e,this.props.data.schema,t,this.props.changeField,this.props.data.selectedFields))}.bind(this)):e.map((function(e,t){return de.a.createElement("th",{key:"header-el-"+t},e)}))}},{key:"getDropdown",value:function(e,t,n,a,r){return de.a.createElement(Jd,{selectedField:e,notSelectedFields:t,index:n,changeField:a,selectedFields:r})}},{key:"getHeader",value:function(){var e=this.props.data.selectedFields,t=this.getOptionFieldRows(e);return de.a.createElement("tr",{key:"tableview-content-row-header"},de.a.createElement("th",{className:"tableview-header-el-checkbox"}),de.a.createElement("th",{className:"tableview-el-copy"}),t,de.a.createElement("th",{className:"tableview-el-last"}))}},{key:"render",value:function(){return de.a.createElement("div",{className:"table-view-docs"},de.a.createElement("table",{className:"table table-striped"},de.a.createElement("thead",null,this.getHeader()),de.a.createElement("tbody",null,this.getContentRows())))}}])&&$d(n.prototype,a),r&&$d(n,r),t}(de.a.Component);function rp(e){return(rp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function op(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ip(e,t){return!t||"object"!==rp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sp(e){return(sp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cp(e,t){return(cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lp=Jr.LoadLines,up=Jr.Document,dp=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ip(this,sp(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cp(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){prettyPrint()}},{key:"componentDidUpdate",value:function(){prettyPrint()}},{key:"onClick",value:function(e,t){t.url&&se.navigate(t.url)}},{key:"getUrlFragment",value:function(e){return this.props.isEditable?de.a.createElement("a",{href:e},de.a.createElement("i",{className:"fonticon-pencil"})):null}},{key:"getDocumentList",value:function(){var e=this,t=function(){},n=this.props.results.results;return _.map(n,(function(n,a){return de.a.createElement(up,{key:n.id+a,doc:n,onClick:e.props.isEditable?e.onClick:t,keylabel:n.keylabel,docContent:n.content,docType:e.props.docType,checked:e.props.isSelected(n.id),header:n.header,docChecked:e.props.docChecked,isDeletable:n.isDeletable,docIdentifier:n.id,resultsStyle:e.props.resultsStyle},n.url?e.getUrlFragment("#".concat(n.url)):n.url)}))}},{key:"getDocumentStyleView",value:function(){var e="view";return this.props.isListDeletable&&(e="".concat(e," show-select")),de.a.createElement("div",{className:e},de.a.createElement("div",{id:"doc-list"},this.getDocumentList()))}},{key:"getTableStyleView",value:function(){return de.a.createElement("div",null,de.a.createElement(ap,{onClick:this.onClick,docChecked:this.props.docChecked,isSelected:this.props.isSelected,isListDeletable:this.props.isListDeletable,data:this.props.results,isLoading:this.props.isLoading,removeItem:this.props.removeItem,isChecked:this.props.allDocumentsSelected,hasSelectedItem:this.props.hasSelectedItem,toggleSelect:this.toggleSelectAll,changeField:this.props.changeTableHeaderAttribute,resultsStyle:this.props.resultsStyle,title:"Select all docs that can be..."}))}},{key:"getMainView",value:function(){return this.props.isLoading?de.a.createElement("div",{className:"loading-lines-wrapper"},de.a.createElement(lp,null)):!this.props.noResultsWarning&&this.props.hasResults?this.props.selectedLayout===ha.LAYOUT_ORIENTATION.JSON?this.getDocumentStyleView():this.getTableStyleView():void 0}},{key:"getNoResultScreen",value:function(){if(!this.props.isLoading){if(this.props.noResultsWarning)return de.a.createElement(Vd,{text:this.props.noResultsWarning,isWarning:!0});if(!this.props.hasResults)return de.a.createElement(Vd,{text:this.props.textEmptyIndex})}}},{key:"render",value:function(){return de.a.createElement("div",{className:"document-result-screen"},this.getNoResultScreen(),de.a.createElement(qd,this.props),this.getMainView())}}])&&op(n.prototype,a),r&&op(n,r),t}(de.a.Component);function pp(e){return(pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fp(){return(fp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function hp(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function mp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hp(n,!0).forEach((function(t){gp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hp(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yp(e,t){return!t||"object"!==pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ep(e){return(Ep=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _p(e,t){return(_p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vp=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yp(this,Ep(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_p(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchDocs,n=e.fetchParams,a=e.queryOptionsParams;e.fetchAtStartup&&t(n,a)}},{key:"UNSAFE_componentWillUpdate",value:function(e){var t=e.fetchDocs,n=e.fetchParams,a=e.queryOptionsParams,r=e.ddocsOnly,o=e.fetchUrl,i=e.resetState,s=e.partitionKey;this.props.ddocsOnly===r&&this.props.fetchUrl===o&&this.props.partitionKey===s||(i(),t(mp({},n,{skip:0}),mp({},a,{reduce:void 0,group:void 0,group_level:void 0})))}},{key:"componentWillUnmount",value:function(){(0,this.props.resetState)()}},{key:"deleteSelectedDocs",value:function(){var e=this.props,t=e.bulkDeleteDocs,n=e.fetchParams;t(e.selectedDocs,n,e.queryOptionsParams)}},{key:"isSelected",value:function(e){return this.props.selectedDocs.findIndex((function(t){return e===t._id}))>-1}},{key:"docChecked",value:function(e,t){if(e){var n=this.props;(0,n.selectDoc)({_id:e,_rev:t},n.selectedDocs)}}},{key:"toggleSelectAll",value:function(){var e=this.props,t=e.docs,n=e.selectedDocs,a=e.allDocumentsSelected;(0,e.bulkCheckOrUncheck)(t,n,a)}},{key:"render",value:function(){var e=this.props.results;return de.a.createElement(dp,fp({removeItem:this.deleteSelectedDocs.bind(this),isSelected:this.isSelected.bind(this),docChecked:this.docChecked.bind(this),isListDeletable:e.hasBulkDeletableDoc,toggleSelectAll:this.toggleSelectAll.bind(this)},this.props))}}])&&bp(n.prototype,a),r&&bp(n,r),t}(de.a.Component);vp.propTypes={fetchAtStartup:tt.a.bool.isRequired,fetchDocs:tt.a.func.isRequired};var Sp=Object(nt.b)((function(e,t){var n,a=e.indexResults;return{noResultsWarning:a.noResultsWarning,docs:ad(a),selectedDocs:rd(a),isLoading:(n=a,n.isLoading),hasResults:Qu(a),results:Xu(a,t.databaseName,t.deleteEnabled),isEditable:od(a),selectedLayout:id(a),allDocumentsSelected:Ju(a),hasSelectedItem:Zu(a),numDocsSelected:$u(a),textEmptyIndex:sd(a),docType:cd(a),fetchParams:pd(a),queryOptionsParams:nd(a),partitionKey:t.partitionKey,resultsStyle:fd(a)}}),(function(e,t){return{fetchDocs:function(n,a){e(Eu(t.queryDocs,n,a))},selectDoc:function(t,n){e(function(e,t){var n=t.findIndex((function(t){return t._id===e._id}));return n>-1?t.splice(n,1):(e._deleted=!0,t.push(e)),mu(t)}(t,n))},bulkDeleteDocs:function(n,a,r){e(vu(t.databaseName,t.queryDocs,n,t.designDocs,a,r,t.docType))},changeLayout:function(t){e(gu(t))},bulkCheckOrUncheck:function(n,a,r){e(function(e,t,n,a){return e.forEach((function(e){if(cu(e,a)){var r=t.findIndex((function(t){return du(e,a)===t._id}));n?t.splice(r,1):-1===r&&t.push({_id:du(e,a),_rev:pu(e,a),_deleted:!0})}})),mu(t)}(n,a,r,t.docType))},changeTableHeaderAttribute:function(t,n){e(function(e,t){return t[e.index]=e.newSelectedRow,{type:ou.INDEX_RESULTS_REDUX_CHANGE_TABLE_HEADER_ATTRIBUTE,selectedFieldsTableView:t}}(t,n))},resetState:function(){e(hu())},queryOptionsToggleIncludeDocs:function(t){e(Au(t))},updateResultsStyle:function(t){e(function(e){return{type:ou.INDEX_RESULTS_SET_STYLE,resultsStyle:e}}(t))}}}))(vp),Np=Sp;function Dp(e){var t=e.nextClicked,n=e.previousClicked,a="",r="";return e.canShowPrevious||(a="disabled"),e.canShowNext||(r="disabled"),de.a.createElement("div",{className:"documents-pagination"},de.a.createElement("ul",{className:"pagination"},de.a.createElement("li",{className:a},de.a.createElement("a",{id:"previous",onClick:n,className:"icon fonticon-left-open",href:"#","data-bypass":"true"})),de.a.createElement("li",{className:r},de.a.createElement("a",{id:"next",onClick:t,className:"icon fonticon-right-open",href:"#","data-bypass":"true"}))))}function Op(e){return(Op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tp(e,t){return!t||"object"!==Op(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cp(e){return(Cp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ap(e,t){return(Ap=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Sp.propTypes={queryDocs:tt.a.func.isRequired,docType:tt.a.string.isRequired},Dp.propTypes={nextClicked:tt.a.func.isRequired,previousClicked:tt.a.func.isRequired,canShowPrevious:tt.a.bool.isRequired,canShowNext:tt.a.bool.isRequired};var Ip=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tp(this,Cp(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ap(e,t)}(t,e),n=t,(a=[{key:"getAmountShownFields",value:function(){var e=this.props.displayedFields;return e.shown===e.allFieldCount?de.a.createElement("div",{className:"pull-left shown-fields"},"Showing ",e.shown," columns."):de.a.createElement("div",{className:"pull-left shown-fields"},"Showing ",e.shown," of ",e.allFieldCount," columns.")}},{key:"render",value:function(){var e=this.props,t=e.prioritizedEnabled,n=e.toggleShowAllColumns;return de.a.createElement("div",{className:"footer-table-control"},this.getAmountShownFields(),de.a.createElement("div",{className:"footer-doc-control-prioritized-wrapper pull-left"},de.a.createElement("label",{htmlFor:"footer-doc-control-prioritized"},de.a.createElement("input",{id:"footer-doc-control-prioritized",checked:t,onChange:n,type:"checkbox"}),"Show all columns.")))}}])&&wp(n.prototype,a),r&&wp(n,r),t}(de.a.Component);function Pp(e){return(Pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function kp(e,t){return!t||"object"!==Pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lp(e){return(Lp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xp(e,t){return(xp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ip.propTypes={prioritizedEnabled:tt.a.bool.isRequired,displayedFields:tt.a.object.isRequired,toggleShowAllColumns:tt.a.func.isRequired};var Up=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kp(this,Lp(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xp(e,t)}(t,e),n=t,(a=[{key:"getPageNumberText",value:function(){var e=this.props,t=e.docs,n=e.pageStart,a=e.pageEnd;return 0===t.length?de.a.createElement("span",null,"Showing 0 documents."):de.a.createElement("span",null,"Showing document ",n," - ",a,".")}},{key:"perPageChange",value:function(e){var t=this.props;(0,t.updatePerPageResults)(e,t.fetchParams,t.queryOptionsParams)}},{key:"nextClicked",value:function(e){e.preventDefault();var t=this.props,n=t.canShowNext,a=t.fetchParams,r=t.queryOptionsParams,o=t.paginateNext,i=t.perPage;n&&o(a,r,i)}},{key:"previousClicked",value:function(e){e.preventDefault();var t=this.props,n=t.canShowPrevious,a=t.fetchParams,r=t.queryOptionsParams,o=t.paginatePrevious,i=t.perPage;n&&o(a,r,i)}},{key:"render",value:function(){var e=this.props,t=e.showPrioritizedEnabled,n=e.hasResults,a=e.prioritizedEnabled,r=e.displayedFields,o=e.perPage,i=e.canShowNext,s=e.canShowPrevious,c=e.toggleShowAllColumns;return de.a.createElement("footer",{className:"index-pagination pagination-footer"},de.a.createElement(Dp,{nextClicked:this.nextClicked.bind(this),previousClicked:this.previousClicked.bind(this),canShowNext:i,canShowPrevious:s}),de.a.createElement("div",{className:"footer-controls"},de.a.createElement("div",{className:"page-controls"},t&&n?de.a.createElement(Ip,{prioritizedEnabled:a,displayedFields:r,toggleShowAllColumns:c}):null),de.a.createElement(oo,{perPageChange:this.perPageChange.bind(this),perPage:o}),de.a.createElement("div",{className:"current-docs"},this.getPageNumberText())))}}])&&Rp(n.prototype,a),r&&Rp(n,r),t}(de.a.Component),Mp=Object(nt.b)((function(e,t){var n,a=e.indexResults;return{docs:ad(a),selectedDocs:rd(a),hasResults:Qu(a),pageStart:(n=a,n.pagination.pageStart),pageEnd:Yu(a),perPage:dd(a),prioritizedEnabled:ld(a),showPrioritizedEnabled:zu(a),displayedFields:td(a,t.databaseName),canShowNext:ud(a),canShowPrevious:ed(a),fetchParams:pd(a),queryOptionsParams:nd(a)}}),(function(e,t){return{toggleShowAllColumns:function(){e({type:ou.INDEX_RESULTS_REDUX_TOGGLE_SHOW_ALL_COLUMNS})},updatePerPageResults:function(n,a,r){e(Ou(t.queryDocs,a,r,n))},paginateNext:function(n,a,r){e(wu(t.queryDocs,n,a,r))},paginatePrevious:function(n,a,r){e(Tu(t.queryDocs,n,a,r))}}}))(Up),jp=Mp;Mp.propTypes={queryDocs:tt.a.func.isRequired};var Hp=Object(nt.b)((function(e,t){var n=e.indexResults,a=t.docUrl,r=t.endpoint,o=t.endpointAddQueryOptions;if(a||(a=se.constants.DOC_URLS.GENERAL),r&&o){var i=le.utils.queryString(nd(n));i&&(r=-1==r.indexOf("?")?"".concat(r,"?").concat(i):"".concat(r,"&").concat(i))}return{docUrl:a,endpoint:r}}))(yt),Bp=Hp;function Gp(e){return(Gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qp(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vp(e){return(Vp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kp(e,t){return(Kp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Hp.propTypes={databaseName:tt.a.string,docUrl:tt.a.string,endpoint:tt.a.string,endpointAddQueryOptions:tt.a.bool};var Wp=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=Vp(t).call(this,e))||"object"!==Gp(r)&&"function"!=typeof r?Fp(a):r).state={editorValue:"",editMode:!1},n.onModeSwitchClick=n.onModeSwitchClick.bind(Fp(n)),n.onBlur=n.onBlur.bind(Fp(n)),n.startEdit=n.startEdit.bind(Fp(n)),n.onKeyPress=n.onKeyPress.bind(Fp(n)),n.onChange=n.onChange.bind(Fp(n)),n.props.checkDbPartitioned(n.props.databaseName),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kp(e,t)}(t,e),n=t,(a=[{key:"onModeSwitchClick",value:function(e){e&&e.preventDefault&&e.preventDefault(),!this.props.globalMode&&this.props.onGlobalModeSelected?this.props.onGlobalModeSelected():this.props.partitionKey?this.props.onPartitionKeySelected(this.state.editorValue):this.startEdit()}},{key:"startEdit",value:function(){var e=this;this.setState({editMode:!0,editorValue:this.props.partitionKey}),setTimeout((function(){return e.textInput.focus()}))}},{key:"updatePartitionKey",value:function(){this.setState({editMode:!1});var e=this.state.editorValue.trim();e?this.props.onPartitionKeySelected(e):this.props.onGlobalModeSelected()}},{key:"onBlur",value:function(e){e&&e.preventDefault&&e.preventDefault(),this.updatePartitionKey()}},{key:"onKeyPress",value:function(e){"Enter"===e.key&&this.updatePartitionKey()}},{key:"onChange",value:function(e){this.setState({editorValue:e.target.value})}},{key:"globalHeader",value:function(){return de.a.createElement("button",{onClick:this.onModeSwitchClick,title:"Partition Key Selector",className:"button partition-selector__switch"},de.a.createElement("i",{className:"fonticon-filter"}),"No partition selected")}},{key:"partitionHeader",value:function(){var e=this,t=de.a.createElement("input",{type:"text",style:{padding:2,fontSize:16,margin:0,display:this.state.editMode?"block":"none"},onKeyPress:this.onKeyPress,onChange:this.onChange,onBlur:this.onBlur,value:this.state.editorValue,ref:function(t){e.textInput=t}}),n="Click to select a partition",a="partition-selector__key";return""!==this.props.partitionKey&&(n=this.props.partitionKey,a+=" partition-selector__key--active"),de.a.createElement(de.a.Fragment,null,de.a.createElement("button",{onClick:this.onModeSwitchClick,title:"Partition Key Selector",className:"button partition-selector__switch button partition-selector__switch--active"},de.a.createElement("i",{className:"fonticon-filter"})),de.a.createElement("div",{className:a},de.a.createElement("span",{onClick:this.startEdit,style:{display:this.state.editMode?"none":"block"}},n),t))}},{key:"render",value:function(){if(!this.props.selectorVisible)return null;var e=this.props.globalMode&&!this.state.editMode;return de.a.createElement("div",{className:"partition-selector"},e?this.globalHeader():this.partitionHeader())}}])&&qp(n.prototype,a),r&&qp(n,r),t}(de.a.Component);Wp.defaultProps={partitionKey:"",globalMode:!0},Wp.propTypes={selectorVisible:tt.a.bool.isRequired,partitionKey:tt.a.string.isRequired,checkDbPartitioned:tt.a.func.isRequired,onPartitionKeySelected:tt.a.func.isRequired,onGlobalModeSelected:tt.a.func,globalMode:tt.a.bool};var Xp={PARTITON_KEY_SHOW_SELECTOR:"PARTITON_KEY_SHOW_SELECTOR",PARTITON_KEY_HIDE_SELECTOR:"PARTITON_KEY_HIDE_SELECTOR"},zp=Object(nt.b)((function(e,t){return{selectorVisible:e.partitionKey.selectorVisible,databaseName:t.databaseName,partitionKey:t.partitionKey,onPartitionKeySelected:t.onPartitionKeySelected,globalMode:t.globalMode}}),(function(e){return{checkDbPartitioned:function(t){e(function(e){return function(t){t({type:Xp.PARTITON_KEY_HIDE_SELECTOR}),Xe(e).then((function(e){e.props&&!0===e.props.partitioned&&t({type:Xp.PARTITON_KEY_SHOW_SELECTOR})}))}}(t))}}}))(Wp),Yp=zp;zp.propTypes={databaseName:tt.a.string.isRequired,partitionKey:tt.a.string.isRequired,onPartitionKeySelected:tt.a.func.isRequired,onGlobalModeSelected:tt.a.func.isRequired,globalMode:tt.a.bool};var Qp=function(e){var t=e.hideQueryOptions,n=e.hideJumpToDoc,a=e.database,r=e.dbName,o=e.dropDownLinks,i=e.docURL,s=e.endpoint,c=e.endpointAddQueryOptions,l=e.fetchUrl,u=e.ddocsOnly,d=e.queryDocs,p=e.selectedNavItem,f=e.showPartitionKeySelector,h=e.partitionKey,m=e.onPartitionKeySelected,g=e.onGlobalModeSelected,b=e.globalMode,y=null;return f&&(y=de.a.createElement(Yp,{databaseName:r,partitionKey:h,onPartitionKeySelected:m,onGlobalModeSelected:g,globalMode:b})),de.a.createElement("header",{className:"two-panel-header"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{id:"header-docs-left"},de.a.createElement(bc,{dbName:r,partitionKey:h,dropDownLinks:o})),de.a.createElement("div",{className:"right-header-wrapper flex-layout flex-row flex-body"},de.a.createElement("div",{style:{flex:1,padding:"18px 6px 12px 12px"}},y),de.a.createElement("div",{id:"right-header",className:"flex-fill"},de.a.createElement(vd,{hideQueryOptions:t,hideJumpToDoc:n,database:a,fetchUrl:l,ddocsOnly:u,queryDocs:d,partitionKey:h,selectedNavItem:p})),de.a.createElement(Bp,{docURL:i,endpoint:s,endpointAddQueryOptions:c}),de.a.createElement("div",{id:"notification-center-btn",className:"flex-fill"},de.a.createElement(pt,null)))))};Qp.propTypes={dbName:tt.a.string.isRequired,dropDownLinks:tt.a.array.isRequired,docURL:tt.a.string,endpoint:tt.a.string,showIncludeAllDocs:tt.a.bool,hideQueryOptions:tt.a.bool,hideJumpToDoc:tt.a.bool,database:tt.a.object.isRequired,queryDocs:tt.a.func,selectedNavItem:tt.a.object,showPartitionKeySelector:tt.a.bool.isRequired,partitionKey:tt.a.string,onPartitionKeySelected:tt.a.func,onGlobalModeSelected:tt.a.func,globalMode:tt.a.bool},Qp.defaultProps={hideHeaderBar:!1,showPartitionKeySelector:!1};var Jp=function(e){var t=e.hideFooter,n=e.lowerContent,a=e.upperContent,r=e.fetchUrl,o=e.databaseName,i=e.queryDocs,s=e.selectedNavItem,c=e.partitionKey;return de.a.createElement("div",{className:"with-sidebar tabs-with-sidebar content-area"},de.a.createElement("aside",{id:"sidebar-content",className:"scrollable"},de.a.createElement(fc,{selectedNavItem:s,selectedPartitionKey:c})),de.a.createElement("section",{id:"dashboard-content",className:"flex-layout flex-col"},de.a.createElement("div",{id:"dashboard-upper-content"},a),de.a.createElement("div",{id:"dashboard-lower-content",className:"flex-body"},n),de.a.createElement("div",{id:"footer"},t?null:de.a.createElement(jp,{databaseName:o,fetchUrl:r,queryDocs:i}))))};Jp.defaultProps={hideFooter:!1},Jp.propTypes={hideFooter:tt.a.bool,lowerContent:tt.a.object,upperContent:tt.a.object,selectedNavItem:tt.a.object};var Zp=function(e){var t=e.database,n=e.designDocs,a=e.docURL,r=e.endpoint,o=e.dbName,i=e.dropDownLinks,s=e.fetchUrl,c=e.ddocsOnly,l=e.deleteEnabled,u=void 0===l||l,d=e.selectedNavItem,p=e.partitionKey,f=e.onPartitionKeySelected,h=e.onGlobalModeSelected,m=e.globalMode,g=(d.navItem,function(e){return function(e,t,n){bu(n,{reduce:void 0,group:void 0,group_level:void 0});var a=le.utils.queryString(n),r="".concat(e).concat(-1!==e.indexOf("?")?"&":"?").concat(a);return v(r).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return{docs:e.rows,docType:ha.INDEX_RESULTS_DOC_TYPE.VIEW}}))}(s,0,e)});vn.isViewSelected(d)&&(g=function(e){return function(e,t){void 0===t.reduce&&(t.reduce=!1),t.include_docs&&t.reduce&&(t.reduce=!1,t.group=void 0,t.group_level=void 0),-1!==e.indexOf("/_partition/")&&(t.stable=void 0,t.conflicts=void 0);var n=le.utils.queryString(t),a="".concat(e).concat(-1!==e.indexOf("?")?"&":"?").concat(n);return v(a).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return{docs:e.rows,docType:ha.INDEX_RESULTS_DOC_TYPE.VIEW,layout:void 0}}))}(s,e)});var b=de.a.createElement(Np,{fetchUrl:s,designDocs:n,ddocsOnly:c,databaseName:o,fetchAtStartup:!0,queryDocs:g,docType:ha.INDEX_RESULTS_DOC_TYPE.VIEW,deleteEnabled:u,partitionKey:p});return de.a.createElement("div",{id:"dashboard",className:"with-sidebar"},de.a.createElement(Qp,{docURL:a,endpoint:r,endpointAddQueryOptions:!0,dbName:o,dropDownLinks:i,database:t,fetchUrl:s,ddocsOnly:c,queryDocs:g,selectedNavItem:d,showPartitionKeySelector:!c,partitionKey:p,onPartitionKeySelected:f,onGlobalModeSelected:h,globalMode:m}),de.a.createElement(Jp,{lowerContent:b,fetchUrl:s,databaseName:o,queryDocs:g,selectedNavItem:d,partitionKey:p}))},$p=function(e){var t=e.docURL,n=e.database,a=e.endpoint,r=e.dbName,o=e.dropDownLinks,i=e.selectedNavItem,s=e.partitionKey;return de.a.createElement("div",{id:"dashboard",className:"with-sidebar"},de.a.createElement(Qp,{docURL:t,endpoint:a,dbName:r,dropDownLinks:o,database:n,hideQueryOptions:!0}),de.a.createElement(Jp,{upperContent:de.a.createElement(dl,null),lowerContent:de.a.createElement(Zc,{databaseName:r}),hideFooter:!0,selectedNavItem:i,partitionKey:s}))},ef=function(e){var t=e.showEditView,n=e.database,a=e.docURL,r=e.endpoint,o=e.dbName,i=e.dropDownLinks,s=e.selectedNavItem,c=e.designDocInfo,l=e.partitionKey,u=t?de.a.createElement(os.IndexEditorContainer,{partitionKey:l}):de.a.createElement(wl,{designDocInfo:c,designDocName:s.designDocName});return de.a.createElement("div",{id:"dashboard",className:"with-sidebar"},de.a.createElement(Qp,{endpoint:r,docURL:a,dbName:o,dropDownLinks:i,database:n,partitionKey:l,queryDocs:function(){},hideQueryOptions:!0,hideJumpToDoc:!0}),de.a.createElement(Jp,{lowerContent:u,hideFooter:!0,selectedNavItem:s,partitionKey:l}))};ef.defaultProps={showEditView:!0},ef.propTypes={showEditView:tt.a.bool,docURL:tt.a.string.isRequired,endpoint:tt.a.string,dbName:tt.a.string.isRequired,dropDownLinks:tt.a.array.isRequired,designDocInfo:tt.a.object};var tf,nf=si.extend({routes:{"database/:database/_partition/:partitionkey/_all_docs":{route:"partitionedAllDocs",roles:["fx_loggedIn"]},"database/:database/_all_docs(:extra)":{route:"globalAllDocs",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_info":{route:"designDocMetadata",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_info":{route:"designDocMetadataNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionKey/_changes":{route:"changes",roles:["fx_loggedIn"]},"database/:database/_changes":{route:"changes",roles:["fx_loggedIn"]}},initialize:function(e,t){this.initViews(t[0])},initViews:function(e){this.databaseName=e,this.database=new ri.Model({id:this.databaseName}),this.createDesignDocsCollection(),this.addSidebar()},designDocMetadataNoPartition:function(e,t){return this.designDocMetadata(e,"",t)},designDocMetadata:function(e,t,n){var a=new He.DdocInfo({_id:"_design/"+n},{database:this.database}),r=new ci("designDoc",{designDocName:n,designDocSection:"metadata"});$e.fetchSelectedDatabaseInfo(e);var o=this.getCrumbs(this.database);return de.a.createElement(ef,{showEditView:!1,docURL:a.documentation(),endpoint:a.url("apiurl"),dbName:this.database.id,dropDownLinks:o,database:this.database,selectedNavItem:r,designDocInfo:a,partitionKey:t})},globalAllDocs:function(e,t){return this.allDocs(e,"",t)},partitionedAllDocs:function(e,t){return this.allDocs(e,t)},allDocs:function(e,t,n){var a=this.createParams(n).docParams,r=t?se.urls("partitioned_allDocs","server",encodeURIComponent(e),encodeURIComponent(t)):se.urls("allDocsSanitized","server",e);this.database.buildAllDocs(a);var o=!!(a.startkey&&a.startkey.indexOf("_design")>-1),i="all-docs";o&&(i="design-docs");var s=new ci(i);bn.showDeleteDatabaseModal({showDeleteModal:!1,dbId:""});var c=t?se.urls("partitioned_allDocs","apiurl",encodeURIComponent(e),encodeURIComponent(t)):this.database.allDocs.urlRef("apiurl",{}),l=se.constants.DOC_URLS.GENERAL,u=this.getCrumbs(this.database);return $e.fetchSelectedDatabaseInfo(e),de.a.createElement(Zp,{docURL:l,endpoint:c,dbName:this.database.id,dropDownLinks:u,database:this.database,designDocs:this.designDocs,fetchUrl:r,ddocsOnly:o,selectedNavItem:s,partitionKey:t,onPartitionKeySelected:function(t){var n=se.urls("partitioned_allDocs","app",encodeURIComponent(e),encodeURIComponent(t));se.navigate("#/"+n)},onGlobalModeSelected:function(){var t=se.urls("allDocs","app",encodeURIComponent(e));se.navigate("#/"+t)},globalMode:""===t})},changes:function(e,t){var n=new ci("changes");return $e.fetchSelectedDatabaseInfo(e),de.a.createElement($p,{endpoint:se.urls("changes","apiurl",this.database.id,""),docURL:this.database.documentation(),dbName:this.database.id,dropDownLinks:this.getCrumbs(this.database),database:this.database,selectedNavItem:n,partitionKey:t})}}),af={RESET_DOC:"RESET_DOC",DOC_LOADED:"DOC_LOADED",SHOW_CLONE_DOC_MODAL:"SHOW_CLONE_DOC_MODAL",HIDE_CLONE_DOC_MODAL:"HIDE_CLONE_DOC_MODAL",SHOW_DELETE_DOC_CONFIRMATION_MODAL:"SHOW_DELETE_DOC_CONFIRMATION_MODAL",HIDE_DELETE_DOC_CONFIRMATION_MODAL:"HIDE_DELETE_DOC_CONFIRMATION_MODAL",SHOW_UPLOAD_MODAL:"SHOW_UPLOAD_MODAL",HIDE_UPLOAD_MODAL:"HIDE_UPLOAD_MODAL",RESET_UPLOAD_MODAL:"RESET_UPLOAD_MODAL",SHOW_STRING_EDIT_MODAL:"SHOW_STRING_EDIT_MODAL",HIDE_STRING_EDIT_MODAL:"HIDE_STRING_EDIT_MODAL",FILE_UPLOAD_SUCCESS:"FILE_UPLOAD_SUCCESS",FILE_UPLOAD_ERROR:"FILE_UPLOAD_ERROR",START_FILE_UPLOAD:"START_FILE_UPLOAD",SET_FILE_UPLOAD_PERCENTAGE:"SET_FILE_UPLOAD_PERCENTAGE"},rf=function(e){return function(t){var n=e.doc;t({type:af.RESET_DOC}),n.fetch().then((function(){t({type:af.DOC_LOADED,options:{doc:n}}),e.onLoaded&&e.onLoaded()}),(function(t){404===t.status&&sf("The ".concat(n.id," document does not exist.")),se.navigate(se.urls("allDocs","app",e.database.id,""))}))}},of=function(){return function(e){e({type:af.HIDE_CLONE_DOC_MODAL})}};function sf(e){se.addNotification({msg:e,type:"error",clear:!0})}var cf=function(e){se.reduxDispatch(rf(e))},lf=function(e,t,n,a){t?(se.addNotification({msg:"Saving document.",clear:!0}),e.save().then((function(){n(e.prettyJSON()),a?se.navigate(a,{trigger:!0}):se.navigate("#/"+se.urls("allDocs","app",se.url.encode(e.database.id)),{trigger:!0})})).fail((function(e){se.addNotification({msg:"Save failed: "+JSON.parse(e.responseText).reason,type:"error",fade:!1,clear:!0})}))):e.validationError&&"Cannot change a documents id."===e.validationError?(sf("You cannot edit the _id of an existing document. Try this: Click 'Clone Document', then change the _id on the clone before saving."),delete e.validationError):sf("Please fix the JSON errors and try saving again.")},uf=function(){return function(e){e({type:af.SHOW_CLONE_DOC_MODAL})}},df=of,pf=function(e,t,n){of(),t.copy(n).then((function(){var t=se.urls("document","app",e.safeID(),encodeURIComponent(n));se.navigate(t,{trigger:!0}),se.addNotification({msg:"Document has been duplicated."})}),(function(e){var t="Could not duplicate document, reason: ".concat(e.responseText,".");se.addNotification({msg:t,type:"error"})}))},ff=function(){return function(e){e({type:af.SHOW_DELETE_DOC_CONFIRMATION_MODAL})}},hf=function(){return function(e){e({type:af.HIDE_DELETE_DOC_CONFIRMATION_MODAL})}},mf=function(e){var t=e.database.safeID(),n="?rev="+e.get("_rev"),a=se.urls("document","server",t,e.safeID(),n);S(a).then((function(e){if(e.error)throw new Error(e.reason||e.error);se.addNotification({msg:"Your document has been successfully deleted.",type:"success",clear:!0}),se.navigate(se.urls("allDocs","app",t,""))})).catch((function(e){se.addNotification({msg:"Failed to delete your document. Reason: "+e.message,type:"error",clear:!0})}))},gf=function(){return function(e){e({type:af.SHOW_UPLOAD_MODAL})}},bf=function(){return function(e){e({type:af.HIDE_UPLOAD_MODAL})}},yf=function(e){return function(t){if(0!==e.files.length){t({type:af.START_FILE_UPLOAD});var n="?rev="+e.rev,a=e.doc.getDatabase().safeID(),r=e.doc.safeID(),o=e.files[0],i=se.urls("document","attachment",a,r,encodeURIComponent(o.name),n),s=function(e){t({type:af.FILE_UPLOAD_ERROR,options:{error:e}})},c=new XMLHttpRequest;tf=c,c.withCredentials=!0,c.upload&&(c.upload.onprogress=function(e){if(e.lengthComputable){var n=e.loaded/e.total*100;t({type:af.SET_FILE_UPLOAD_PERCENTAGE,options:{percent:n}})}}),c.onloadend=function(){tf=void 0},c.onerror=function(){s("Error uploading file")},c.onload=function(n){if(c.status>=200&&c.status<300)o=e.doc,t(rf({doc:o,onLoaded:function(){t({type:af.FILE_UPLOAD_SUCCESS}),se.addNotification({msg:"Document saved successfully.",type:"success",clear:!0})}}));else{var a="Error uploading file. ";if(n.responseText)try{var r=JSON.parse(n.responseText);r.error&&(a+="Reason: "+(r.reason||r.error))}catch(e){}s(a)}var o},c.open("PUT",i),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-Type",o.type||"application/octet-stream"),c.setRequestHeader("Accept","application/json"),c.send(o)}else t({type:af.FILE_UPLOAD_ERROR,options:{error:"Please select a file to be uploaded."}})}},Ef=function(){tf&&tf.abort()},_f=function(){return function(e){e({type:af.RESET_UPLOAD_MODAL})}};function vf(e){return(vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Nf(e){return(Nf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Df(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Of(e,t){return(Of=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Tf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Nf(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==vf(r)&&"function"!=typeof r?Df(a):r,wf(Df(n),"getAttachmentList",(function(){var e=encodeURIComponent(n.props.doc.database.get("id")),t=encodeURIComponent(n.props.doc.get("_id"));return _.map(n.props.doc.get("_attachments"),(function(n,a){var r=se.urls("document","attachment",e,t,encodeURIComponent(a));return de.a.createElement(Ct.f,{key:a,href:r,target:"_blank","data-bypass":"true"},de.a.createElement("strong",null,a),de.a.createElement("span",{className:"attachment-delimiter"},"-"),de.a.createElement("span",null,n.content_type,n.content_type?", ":"",A.formatSize(n.length)))}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Of(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return!(this.props.isLoading||!this.props.doc.get("_attachments"))&&de.a.createElement("div",{className:"panel-section view-attachments-section btn-group"},de.a.createElement(Ct.d,{id:"view-attachments-menu"},de.a.createElement(Ct.d.Toggle,{noCaret:!0,className:"panel-button dropdown-toggle btn","data-bypass":"true"},de.a.createElement("i",{className:"icon icon-paper-clip"}),de.a.createElement("span",{className:"button-text"},"View Attachments"),de.a.createElement("span",{className:"caret"})),de.a.createElement(Ct.d.Menu,null,this.getAttachmentList())))}}])&&Sf(n.prototype,a),r&&Sf(n,r),t}(de.a.Component);function Cf(e){return(Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Af(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function If(e){return(If=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rf(e,t){return(Rf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}wf(Tf,"propTypes",{isLoading:tt.a.bool.isRequired,doc:tt.a.object}),wf(Tf,"defaultProps",{isLoading:!0,doc:{}});var Lf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=If(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Cf(r)&&"function"!=typeof r?Pf(a):r,kf(Pf(n),"state",{uuid:null}),kf(Pf(n),"cloneDoc",(function(){n.props.onSubmit&&n.props.onSubmit(),n.props.cloneDoc(n.props.database,n.props.doc,n.state.uuid)})),kf(Pf(n),"closeModal",(function(e){e&&e.preventDefault(),n.props.hideCloneDocModal()})),kf(Pf(n),"docIDChange",(function(e){n.setState({uuid:e.target.value})})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rf(e,t)}(t,e),n=t,(a=[{key:"componentDidUpdate",value:function(){var e=this;null===this.state.uuid&&A.getUUID().then((function(t){if(t.uuids){var n={uuid:t.uuids[0]},a=e.props.doc?e.props.doc.attributes._id.indexOf(":"):-1;if(a>=0){var r=e.props.doc.attributes._id.substring(0,a);n.uuid=r+":"+n.uuid}e.setState(n)}})).catch((function(){}))}},{key:"render",value:function(){var e=this;return null!==this.state.uuid&&de.a.createElement(Ct.g,{dialogClassName:"clone-doc-modal",show:this.props.visible,onHide:this.closeModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Clone Document")),de.a.createElement(Ct.g.Body,null,de.a.createElement("form",{className:"form",onSubmit:function(t){t.preventDefault(),e.cloneDoc()}},de.a.createElement("p",null,"Document cloning copies the saved version of the document. Unsaved document changes will be discarded."),de.a.createElement("p",null,"You can modify the following generated ID for your new document."),de.a.createElement("input",{ref:function(t){return e.newDocId=t},type:"text",autoFocus:!0,className:"input-block-level",onChange:this.docIDChange,value:this.state.uuid}))),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{href:"#","data-bypass":"true",className:"cancel-link",onClick:this.closeModal},"Cancel"),de.a.createElement("button",{className:"btn btn-primary save",onClick:this.cloneDoc},de.a.createElement("i",{className:"icon-repeat"})," Clone Document")))}}])&&Af(n.prototype,a),r&&Af(n,r),t}(de.a.Component);function xf(e){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Mf(e,t){return!t||"object"!==xf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jf(e){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hf(e,t){return(Hf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}kf(Lf,"propTypes",{visible:tt.a.bool.isRequired,doc:tt.a.object,database:tt.a.object.isRequired,onSubmit:tt.a.func.isRequired,hideCloneDocModal:tt.a.func.isRequired,cloneDoc:tt.a.func.isRequired});var Gf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Mf(this,jf(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hf(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e="icon "+this.props.iconClass;return de.a.createElement("div",{className:"panel-section"},de.a.createElement("button",{className:"panel-button ".concat(this.props.className),title:this.props.title,onClick:this.props.onClick},de.a.createElement("i",{className:e}),de.a.createElement("span",null,this.props.title)))}}])&&Uf(n.prototype,a),r&&Uf(n,r),t}(de.a.Component);function qf(e){return(qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vf(){return(Vf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ff(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Kf(e){return(Kf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xf(e,t){return(Xf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Bf(Gf,"propTypes",{title:tt.a.string.isRequired,onClick:tt.a.func.isRequired,className:tt.a.string}),Bf(Gf,"defaultProps",{title:"",iconClass:"",onClick:function(){},className:""});var Yf=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Kf(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==qf(r)&&"function"!=typeof r?Wf(a):r,zf(Wf(n),"closeModal",(function(e){e&&e.preventDefault(),n.props.inProgress&&n.props.cancelUpload(),n.props.hideUploadModal(),n.props.resetUploadModal()})),zf(Wf(n),"upload",(function(){n.props.uploadAttachment({doc:n.props.doc,rev:n.props.doc.get("_rev"),files:n.attachments.files})})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xf(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this,t="alert alert-error";""===this.props.errorMessage&&(t+=" hide");var n="progress progress-info",a={disabled:"disabled"};return this.props.inProgress||(n+=" hide",a={}),de.a.createElement(Ct.g,{dialogClassName:"upload-file-modal",show:this.props.visible,onHide:this.closeModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Upload Attachment")),de.a.createElement(Ct.g.Body,null,de.a.createElement("div",{className:t},this.props.errorMessage),de.a.createElement("div",null,de.a.createElement("form",{ref:function(t){return e.uploadForm=t},className:"form"},de.a.createElement("p",null,"Select a file to upload as an attachment to this document. Uploading a file saves the document as a new revision."),de.a.createElement("input",Vf({ref:function(t){return e.attachments=t},type:"file",name:"_attachments"},a)),de.a.createElement("br",null)),de.a.createElement("div",{className:n},de.a.createElement("div",{className:"bar",style:{width:this.props.uploadPercentage+"%"}})))),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{href:"#","data-bypass":"true",className:"cancel-link",onClick:this.closeModal},"Cancel"),de.a.createElement("button",Vf({href:"#",id:"upload-btn","data-bypass":"true",className:"btn btn-primary save",onClick:this.upload},a),de.a.createElement("i",{className:"icon icon-upload"})," Upload Attachment")))}}])&&Ff(n.prototype,a),r&&Ff(n,r),t}(de.a.Component);function Qf(e){return(Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jf(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Zf(e){return(Zf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eh(e,t){return(eh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function th(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}zf(Yf,"propTypes",{visible:tt.a.bool.isRequired,doc:tt.a.object,inProgress:tt.a.bool.isRequired,uploadPercentage:tt.a.number.isRequired,errorMessage:tt.a.string,cancelUpload:tt.a.func.isRequired,hideUploadModal:tt.a.func.isRequired,resetUploadModal:tt.a.func.isRequired,uploadAttachment:tt.a.func.isRequired});var nh=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Zf(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Qf(r)&&"function"!=typeof r?$f(a):r,th($f(n),"getCodeEditor",(function(){if(n.props.isLoading)return de.a.createElement(Jr.LoadLines,null);var e=n.props.doc.attributes;n.props.isDbPartitioned&&(-1!==e._id.indexOf(":")||e._id.startsWith("_design")||(e._id=":"+e._id));var t=JSON.stringify(e,null,"  "),a=[{name:"save",bindKey:{win:"Ctrl-S",mac:"Ctrl-S"},exec:n.saveDoc}];return de.a.createElement(Jr.CodeEditor,{id:"doc-editor",ref:function(e){return n.docEditor=e},defaultCode:t,mode:"json",autoFocus:!0,editorCommands:a,notifyUnsavedChanges:!0,stringEditModalEnabled:!0})})),th($f(n),"saveDoc",(function(){n.props.saveDoc(n.props.doc,n.checkDocIsValid(),n.onSaveComplete,n.props.previousUrl)})),th($f(n),"onSaveComplete",(function(){n.getEditor().clearChanges()})),th($f(n),"hideDeleteDocModal",(function(){n.props.hideDeleteDocModal()})),th($f(n),"deleteDoc",(function(){n.props.hideDeleteDocModal(),n.props.deleteDoc(n.props.doc)})),th($f(n),"getEditor",(function(){return n.docEditor?n.docEditor.getEditor():null})),th($f(n),"checkDocIsValid",(function(){if(n.getEditor().hasErrors())return!1;var e=JSON.parse(n.getEditor().getValue());return n.props.doc.clear().set(e,{validate:!0}),!n.props.doc.validationError})),th($f(n),"clearChanges",(function(){n.docEditor.clearChanges()})),th($f(n),"getExtensionIcons",(function(){var e=se.getExtensions("DocEditor:icons");return _.map(e,(function(e,t){return de.a.createElement(e,{doc:n.props.doc,key:t,database:n.props.database})}))})),th($f(n),"getButtonRow",(function(){return!n.props.isNewDoc&&de.a.createElement("div",null,de.a.createElement(Tf,{doc:n.props.doc,isLoading:n.props.isLoading}),de.a.createElement("div",{className:"doc-editor-extension-icons"},n.getExtensionIcons()),n.props.conflictCount?de.a.createElement(Gf,{title:"Conflicts (".concat(n.props.conflictCount,")"),iconClass:"icon-columns",className:"conflicts",onClick:function(){se.navigate(se.urls("revision-browser","app",n.props.database.safeID(),n.props.doc.id))}}):null,de.a.createElement(Gf,{className:"upload",title:"Upload Attachment",iconClass:"icon-circle-arrow-up",onClick:n.props.showUploadModal}),de.a.createElement(Gf,{title:"Clone Document",iconClass:"icon-repeat",onClick:n.props.showCloneDocModal}),de.a.createElement(Gf,{title:"Delete",iconClass:"icon-trash",onClick:n.props.showDeleteDocModal}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eh(e,t)}(t,e),n=t,(a=[{key:"UNSAFE_componentWillUpdate",value:function(e){(this.props.numFilesUploaded!==e.numFilesUploaded||this.props.doc&&this.props.doc.hasChanged()||this.props.doc&&e.doc&&this.props.doc.id!==e.doc.id)&&(this.getEditor().setValue(JSON.stringify(e.doc.attributes,null,"  ")),this.onSaveComplete())}},{key:"render",value:function(){var e=this,t=this.props.isNewDoc?"Create Document":"Save Changes",n=this.props.previousUrl?this.props.previousUrl:se.urls("allDocs","app",se.url.encode(this.props.database.id));return de.a.createElement("div",null,de.a.createElement("div",{id:"doc-editor-actions-panel"},de.a.createElement("div",{className:"doc-actions-left"},de.a.createElement("button",{className:"save-doc btn btn-primary save",type:"button",onClick:this.saveDoc},de.a.createElement("i",{className:"icon fonticon-ok-circled"})," ",t),de.a.createElement("div",null,de.a.createElement("a",{href:"#/".concat(n),className:"js-back cancel-button"},"Cancel"))),de.a.createElement("div",{className:"alignRight"},this.getButtonRow())),de.a.createElement("div",{className:"code-region"},de.a.createElement("div",{className:"bgEditorGutter"}),de.a.createElement("div",{id:"editor-container",className:"doc-code"},this.getCodeEditor())),de.a.createElement(Yf,{ref:function(t){return e.uploadModal=t},visible:this.props.isUploadModalVisible,doc:this.props.doc,inProgress:this.props.uploadInProgress,uploadPercentage:this.props.uploadPercentage,errorMessage:this.props.uploadErrorMessage,cancelUpload:this.props.cancelUpload,hideUploadModal:this.props.hideUploadModal,resetUploadModal:this.props.resetUploadModal,uploadAttachment:this.props.uploadAttachment}),de.a.createElement(Lf,{doc:this.props.doc,database:this.props.database,visible:this.props.isCloneDocModalVisible,onSubmit:this.clearChanges,hideCloneDocModal:this.props.hideCloneDocModal,cloneDoc:this.props.cloneDoc}),de.a.createElement("span",{id:"hey"},"bb"),de.a.createElement(_o.ConfirmationModal,{title:"Confirm Deletion",visible:this.props.isDeleteDocModalVisible,text:"Are you sure you want to delete this document?",onClose:this.hideDeleteDocModal,onSubmit:this.deleteDoc,successButtonLabel:"Delete Document"}))}}])&&Jf(n.prototype,a),r&&Jf(n,r),t}(de.a.Component);th(nh,"defaultProps",{database:{},isNewDoc:!1}),th(nh,"propTypes",{isLoading:tt.a.bool.isRequired,isNewDoc:tt.a.bool.isRequired,isDbPartitioned:tt.a.bool.isRequired,doc:tt.a.object,conflictCount:tt.a.number.isRequired,previousUrl:tt.a.string,saveDoc:tt.a.func.isRequired,isCloneDocModalVisible:tt.a.bool.isRequired,database:tt.a.object,showCloneDocModal:tt.a.func.isRequired,hideCloneDocModal:tt.a.func.isRequired,cloneDoc:tt.a.func.isRequired,isDeleteDocModalVisible:tt.a.bool.isRequired,showDeleteDocModal:tt.a.func.isRequired,hideDeleteDocModal:tt.a.func.isRequired,deleteDoc:tt.a.func.isRequired,isUploadModalVisible:tt.a.bool.isRequired,uploadInProgress:tt.a.bool.isRequired,uploadPercentage:tt.a.number.isRequired,uploadErrorMessage:tt.a.string,numFilesUploaded:tt.a.number.isRequired,showUploadModal:tt.a.func.isRequired,hideUploadModal:tt.a.func.isRequired,cancelUpload:tt.a.func.isRequired,resetUploadModal:tt.a.func.isRequired,uploadAttachment:tt.a.func.isRequired});var ah=Object(nt.b)((function(e,t){var n=e.docEditor,a=e.databases;return{isLoading:n.isLoading||a.isLoadingDbInfo,isNewDoc:t.isNewDoc,isDbPartitioned:a.isDbPartitioned,doc:n.doc,database:t.database,conflictCount:n.docConflictCount,previousUrl:t.previousUrl,isCloneDocModalVisible:n.cloneDocModalVisible,isDeleteDocModalVisible:n.deleteDocModalVisible,isUploadModalVisible:n.uploadModalVisible,uploadInProgress:n.uploadInProgress,uploadPercentage:n.uploadPercentage,uploadErrorMessage:n.uploadErrorMessage,numFilesUploaded:n.numFilesUploaded}}),(function(e){return{saveDoc:function(e,t,n,a){lf(e,t,n,a)},showCloneDocModal:function(){e(uf())},hideCloneDocModal:function(){e(df())},cloneDoc:function(e,t,n){pf(e,t,n)},showDeleteDocModal:function(){e(ff())},hideDeleteDocModal:function(){e(hf())},deleteDoc:function(e){mf(e)},showUploadModal:function(){e(gf())},hideUploadModal:function(){e(bf())},cancelUpload:function(){Ef()},resetUploadModal:function(){e(_f())},uploadAttachment:function(t){e(yf(t))}}}))(nh),rh=function(e){var t=e.onClick,n=e.forward?"fonticon-right-open":"fonticon-left-open";return de.a.createElement("div",{style:{height:"20px",width:"11px",marginTop:"7px"},className:n,onClick:t})};rh.propTypes={onClick:tt.a.func.isRequired};var oh=function(e){var t=e.options,n=e.selected,a=e.onRevisionClick,r=e.onBackwardClick,o=e.onForwardClick;return de.a.createElement("div",{className:"conflicting-revs-dropdown"},de.a.createElement(rh,{backward:!0,onClick:r}),de.a.createElement("div",{style:{width:"345px",margin:"0 5px"}},de.a.createElement(qr.a,{name:"form-field-name",value:n,options:t,clearable:!1,onChange:a})),de.a.createElement(rh,{forward:!0,onClick:o}))};oh.propTypes={options:tt.a.array.isRequired,selected:tt.a.string.isRequired,onRevisionClick:tt.a.func.isRequired,onBackwardClick:tt.a.func.isRequired,onForwardClick:tt.a.func.isRequired};var ih=oh;function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ch(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lh(e){return(lh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dh(e,t){return(dh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ph=Jr.ConfirmButton,fh=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=lh(t).call(this,e))||"object"!==sh(r)&&"function"!=typeof r?uh(a):r).state={checked:!1},n.close=n.close.bind(uh(n)),n.onDeleteConflicts=n.onDeleteConflicts.bind(uh(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dh(e,t)}(t,e),n=t,(a=[{key:"close",value:function(){this.props.toggleConfirmModal(!1,null)}},{key:"onDeleteConflicts",value:function(){var e=this.state.checked;this.props.onConfirm(this.props.docToWin,e)}},{key:"render",value:function(){var e=this;return de.a.createElement(Ct.g,{dialogClassName:"delete-conflicts-modal",show:this.props.show,onHide:this.close},de.a.createElement(Ct.g.Header,{closeButton:!1},de.a.createElement(Ct.g.Title,null,"Solve Conflicts")),de.a.createElement(Ct.g.Body,null,de.a.createElement("p",null,de.a.createElement("i",{className:"icon-warning-sign"})," Do you want to delete all conflicting revisions for this document?")),de.a.createElement(Ct.g.Footer,null,de.a.createElement("div",{style:{float:"left",marginTop:"10px"}},de.a.createElement("label",null,de.a.createElement("input",{style:{margin:"0 5px 3px 0"},onChange:function(){e.setState({checked:!e.state.checked})},type:"checkbox"}),"Do not show this warning message again")),de.a.createElement("a",{style:{marginRight:"10px",cursor:"pointer"},onClick:this.close,"data-bypass":"true"},"Cancel"),de.a.createElement(ph,{onClick:this.onDeleteConflicts,text:"Delete Revisions",buttonType:"btn-danger"})))}}])&&ch(n.prototype,a),r&&ch(n,r),t}(de.a.Component);function hh(e){return(hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mh(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gh(e){return(gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yh(e,t){return(yh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}fh.propTypes={onConfirm:tt.a.func.isRequired,toggleConfirmModal:tt.a.func.isRequired};var Eh=Jr.ConfirmButton,_h=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=gh(t).call(this,e))||"object"!==hh(r)&&"function"!=typeof r?bh(a):r).state={showModal:!1},n.selectAsWinner=n.selectAsWinner.bind(bh(n)),n.onSelectAsWinnerClickOurs=n.onSelectAsWinnerClick.bind(bh(n),n.props.ours),n.onSelectAsWinnerClickTheirs=n.onSelectAsWinnerClick.bind(bh(n),n.props.theirs),n.onRevisionClick=n.onRevisionClick.bind(bh(n)),n.onForwardClick=n.onForwardClick.bind(bh(n)),n.onBackwardClick=n.onBackwardClick.bind(bh(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yh(e,t)}(t,e),n=t,(a=[{key:"onRevisionClick",value:function(e){this.props.chooseLeaves(this.props.ours,e.value)}},{key:"onForwardClick",value:function(){var e=this.props.conflictingRevs,t=e.indexOf(this.props.theirs._rev),n=e[t+1];n&&this.props.chooseLeaves(this.props.ours,n)}},{key:"onBackwardClick",value:function(){var e=this.props.conflictingRevs,t=e.indexOf(this.props.theirs._rev),n=e[t-1];n&&this.props.chooseLeaves(this.props.ours,n)}},{key:"selectAsWinner",value:function(e,t){t&&le.utils.localStorageSet("deleteConflictsHideModal",!0),this.props.selectRevAsWinner(e._id,e._rev,this.props.tree)}},{key:"onSelectAsWinnerClick",value:function(e){!0===le.utils.localStorageGet("deleteConflictsHideModal")?this.selectAsWinner(e):this.props.toggleConfirmModal(!0,e)}},{key:"render",value:function(){var e=this.props.tree,t={paddingRight:"30px"};return de.a.createElement("div",{className:"revision-browser-controls"},de.a.createElement(fh,{toggleConfirmModal:this.props.toggleConfirmModal,onConfirm:this.selectAsWinner,docToWin:this.props.docToWin,show:this.props.showConfirmModal}),de.a.createElement("table",{style:{margin:"10px 60px",width:"100%"}},de.a.createElement("tbody",null,de.a.createElement("tr",{style:{height:"60px"}},de.a.createElement("td",{style:t},"Server-Selected Rev: "),de.a.createElement("td",{style:t},de.a.createElement("div",{style:{lineHeight:"36px",height:"36px",width:"337px",color:"#000",backgroundColor:"#ffbbbb"}},de.a.createElement("b",{style:{paddingLeft:"10px"}},e.winner))),de.a.createElement("td",null,de.a.createElement(Eh,{onClick:this.onSelectAsWinnerClickOurs,style:{marginRight:"10px",width:"220px"},text:"Delete Other Conflicts",buttonType:"btn-secondary",customIcon:"icon-trophy"}))),de.a.createElement("tr",{style:{height:"60px"}},de.a.createElement("td",{style:t},"Conflicting Revisions: "),de.a.createElement("td",{style:t},de.a.createElement(ih,{onRevisionClick:this.onRevisionClick,onForwardClick:this.onForwardClick,onBackwardClick:this.onBackwardClick,options:this.props.dropdownData,selected:this.props.theirs._rev})),de.a.createElement("td",null,de.a.createElement(Eh,{"data-id":"button-select-theirs",onClick:this.onSelectAsWinnerClickTheirs,style:{marginRight:"10px",width:"220px"},text:"Select as Winner",buttonType:"btn-secondary",customIcon:"icon-trophy"}))))))}}])&&mh(n.prototype,a),r&&mh(n,r),t}(de.a.Component);function vh(e){return(vh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sh(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Nh(e,t){return!t||"object"!==vh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dh(e){return(Dh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oh(e,t){return(Oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}_h.propTypes={tree:tt.a.object.isRequired,ours:tt.a.object.isRequired,conflictingRevs:tt.a.array.isRequired},n(698);var wh=mn.a.acequire("ace/ext/static_highlight");n(219);var Th=mn.a.acequire("ace/mode/json").Mode;n(220);var Ch=mn.a.acequire("ace/theme/idle_fingers"),Ah=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nh(this,Dh(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oh(e,t)}(t,e),n=t,(a=[{key:"componentDidUpdate",value:function(){this.hightlightAfterRender()}},{key:"componentDidMount",value:function(){this.hightlightAfterRender()}},{key:"hightlightAfterRender",value:function(){var e=function(e){return JSON.stringify(e,null,"  ")},t=new Th,n=this.revLeftOurs,a=this.revRightTheirs,r=wh.render(e(this.props.ours),t,Ch,0,!0);n.innerHTML=r.html;var o=wh.render(e(this.props.theirs),t,Ch,0,!0);a.innerHTML=o.html}},{key:"render",value:function(){var e=this,t=this.props,n=t.ours,a=t.theirs;return n&&a?de.a.createElement("div",{className:"revision-split-area"},de.a.createElement("div",{"data-id":"ours",style:{width:"50%"}},de.a.createElement("div",{style:{marginBottom:"20px"}},n._rev," (Server-Selected Rev)"),de.a.createElement("pre",{ref:function(t){return e.revLeftOurs=t}})),de.a.createElement("div",{"data-id":"theirs",style:{width:"50%"}},de.a.createElement("div",{style:{marginBottom:"20px"}},a._rev),de.a.createElement("pre",{ref:function(t){return e.revRightTheirs=t}}))):de.a.createElement("div",null)}}])&&Sh(n.prototype,a),r&&Sh(n,r),t}(de.a.Component),Ih=n(98),Ph=(n(700),function(e){var t=e.ours,n=e.theirs;if(!t||!n)return de.a.createElement("div",null);var a=Ih.diff(t,n),r=Ih.formatters.html.format(a,t);return de.a.createElement("div",{className:"revision-diff-area"},de.a.createElement("div",{style:{marginTop:"30px"},dangerouslySetInnerHTML:{__html:r}}))});Ph.propTypes={ours:tt.a.object,theirs:tt.a.object,currentRev:tt.a.string};var Rh=Ph;function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lh(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function xh(e){return(xh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mh(e,t){return(Mh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jh=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=xh(t).call(this,e))||"object"!==kh(r)&&"function"!=typeof r?Uh(a):r).toggleDiffViewFalse=n.toggleDiffView.bind(Uh(n),!1),n.toggleDiffViewTrue=n.toggleDiffView.bind(Uh(n),!0),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mh(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.props.toggleConfirmModal(!1,null),this.props.initDiffEditor()}},{key:"toggleDiffView",value:function(e){this.props.toggleDiffView(e)}},{key:"render",value:function(){var e=this.props,t=e.tree,n=e.ours,a=e.theirs,r=e.conflictingRevs,o=e.isDiffViewEnabled;return t.length||a?a&&r.length?de.a.createElement("div",{className:"revision-wrapper scrollable"},de.a.createElement(_h,this.props),de.a.createElement("div",{className:"revision-view-controls"},de.a.createElement(Ct.b,{className:"two-sides-toggle-button"},de.a.createElement(Ct.a,{style:{width:"120px"},className:o?"active":"",onClick:this.toggleDiffViewTrue},de.a.createElement("i",{className:"icon-columns"})," Diff"),de.a.createElement(Ct.a,{style:{width:"120px"},className:o?"":"active",onClick:this.toggleDiffViewFalse},de.a.createElement("i",{className:"icon-file-text"})," Document"))),o?de.a.createElement(Rh,{ours:n,theirs:a}):de.a.createElement(Ah,{ours:n,theirs:a})):de.a.createElement("div",{style:{textAlign:"center",color:"#fff"}},de.a.createElement("h2",null,"No conflicts")):de.a.createElement(Sa,null)}}])&&Lh(n.prototype,a),r&&Lh(n,r),t}(de.a.Component),Hh="REV_TREE_LOADED",Bh="REV_BROWSER_DIFF_DOCS_READY",Gh="REV_BROWSER_DIFF_ENABLE_DIFF_VIEW",qh="REV_BROWSER_SHOW_CONFIRM_MODAL";function Vh(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Fh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vh(n,!0).forEach((function(t){Kh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vh(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Wh,Xh={tree:[],doc:{},conflictDoc:!1,conflictingRevs:[],databaseName:"",ours:null,theirs:null,isDiffViewEnabled:!0,showConfirmModal:!1,docToWin:null},zh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xh,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.options;switch(n){case"REV_TREE_LOADED":var r=a.tree,o=a.doc,i=a.conflictDoc,s=a.conflictingRevs,c=a.databaseName;return Fh({},e,{tree:r,doc:o,conflictDoc:i,conflictingRevs:s,databaseName:c,theirs:i,ours:o});case"REV_BROWSER_DIFF_DOCS_READY":return Fh({},e,{theirs:a.theirs});case"REV_BROWSER_DIFF_ENABLE_DIFF_VIEW":return Fh({},e,{isDiffViewEnabled:a.enableDiff});case"REV_BROWSER_SHOW_CONFIRM_MODAL":return Fh({},e,{showConfirmModal:a.show,docToWin:a.docToWin});default:return e}},Yh=function(e){return e.doc},Qh=function(e){return e.conflictDoc},Jh=function(e){return e.conflictingRevs},Zh=function(e){return e.databaseName},$h=function(e){return e.ours},em=function(e){return e.theirs},tm=function(e){return e.showConfirmModal},nm=function(e){return e.conflictingRevs.map((function(e){return{value:e,label:e}}))},am=function(e){return e.isDiffViewEnabled},rm=function(e){return e.docToWin},om=n(402),im=n.n(om),sm=n(266),cm=n(404);function lm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}sm.a.plugin(cm.a);function um(e,t,n){return e.reduce((function(e,n){return n[0]!==t&&e.push(n[0]),e}),[]).filter((function(e){return-1===n.indexOf(e)}))}var dm=function(e,t,n,a,r){return{type:Hh,options:{tree:e,doc:t,conflictDoc:a,conflictingRevs:n,databaseName:r}}},pm=function(e,t){return{type:Bh,options:{theirs:t,ours:e}}},fm=function(e,t){return{type:qh,options:{show:e,docToWin:t}}};var hm=Object(nt.b)((function(e,t){var n,a=e.revisionBrowser;return{docId:t.docId,tree:(n=a,n.tree),doc:Yh(a),conflictDoc:Qh(a),conflictingRevs:Jh(a),databaseName:Zh(a),ours:$h(a),theirs:em(a),showConfirmModal:tm(a),dropdownData:nm(a),isDiffViewEnabled:am(a),docToWin:rm(a)}}),(function(e,t){return{toggleConfirmModal:function(t,n){e(fm(t,n))},initDiffEditor:function(){var n,a;e((n=t.databaseName,a=t.docId,function(e){var t=se.urls("databaseBaseURL","apiurl",n);Wh=Object(sm.a)(t),Promise.all([Wh.get(a),im()(Wh,a)]).then((function(t){var a=lm(t,2),r=a[0],o=a[1],i=um(o.paths,o.winner,Object.keys(o.deleted)),s=i[0];if(!s)return e(dm(o,r,i,null,n));Wh.get(r._id,{rev:s}).then((function(t){e(dm(o,r,i,t,n))}))}))}))},chooseLeaves:function(t,n){e(function(e,t){return function(n){Wh.get(e._id,{rev:t}).then((function(t){n(pm(e,t))}))}}(t,n))},selectRevAsWinner:function(n,a,r){var o,i,s,c;e((o=t.databaseName,i=n,s=r.paths,c=a,function(e){var t=um(s,c,[]),n=function(e,t){return{docs:t.map((function(t){return{_id:e,_rev:t,_deleted:!0}}))}}(i,t);N(se.urls("bulk_docs","server",o,""),n).then((function(t){if(t.error)return se.addNotification({msg:"Failed to delete clean up conflicts!",type:"error",clear:!0});se.addNotification({msg:"Conflicts successfully solved.",clear:!0}),e(fm(!1,null)),se.navigate(se.urls("allDocs","app",o,""))}))}))},toggleDiffView:function(t){e(function(e){return{type:Gh,options:{enableDiff:e}}}(t))}}}))(jh),mm={DocEditorRouteObject:se.RouteObject.extend({selectedHeader:"Databases",roles:["fx_loggedIn"],initialize:function(e,t){this.databaseName=t[0],this.docId=t[1],this.database=this.database||new ri.Model({id:this.databaseName}),this.doc=new He.NewDoc(null,{database:this.database})},routes:{"database/:database/:doc/conflicts":"revisionBrowser","database/:database/:doc/code_editor":"codeEditor","database/:database/_design/:ddoc/conflicts":"revBrowserForDesignDoc","database/:database/_design/:ddoc":"showDesignDoc","database/:database/_local/:doc":"showLocalDoc","database/:database/:doc":"codeEditor","database/:database/_new":"codeEditorNewDoc","database/:database/_new?(:extra)":"codeEditorNewDoc"},revisionBrowser:function(e,t){var n=se.urls("allDocs","app",se.url.encode(this.database.safeID())),a=se.urls("document","app",this.database.safeID(),this.docId),r=[{name:this.database.safeID(),link:n},{name:this.docId+" > Conflicts"}];return de.a.createElement(Ot,{crumbs:r,endpoint:this.doc.url("apiurl"),docURL:a,component:de.a.createElement(hm,{docId:t,databaseName:e})})},revBrowserForDesignDoc:function(e,t){return this.revisionBrowser(e,"_design/"+t)},codeEditorNewDoc:function(e,t){return this.codeEditor(e,null,t)},codeEditor:function(e,t,n){var a=le.getParams(n),r=[{name:e,link:se.urls("allDocs","app",se.url.encode(e))},{name:t||"New Document"}];if(this.database=new ri.Model({id:e}),t)this.doc=new He.Doc({_id:t},{database:this.database,fetchConflicts:!0});else{var o=a?a.partitionKey:void 0;this.doc=new He.NewDoc(null,{database:this.database,partitionKey:o})}$e.fetchSelectedDatabaseInfo(e),cf({doc:this.doc,database:this.database});var i=void 0,s=se.router.lastPages.filter((function(e){return-1!==e.indexOf("/_all_docs")||e.match(/_design\/(\S)*\/_/)||-1!==e.indexOf("/_find")}));return s.length>0&&(i=s[s.length-1]),de.a.createElement(Ot,{crumbs:r,endpoint:this.doc.url("apiurl"),docURL:this.doc.documentation(),partitionKey:a.partitionKey,component:de.a.createElement(ah,{database:this.database,isNewDoc:!t,previousUrl:i})})},showLocalDoc:function(e,t){return this.codeEditor(e,"_local/"+t)},showDesignDoc:function(e,t){return this.codeEditor(e,"_design/"+t)}})},gm=si.extend({routes:{"database/:database/_partition/:partitionkey/new_view":{route:"createView",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/new_view/:designDoc":{route:"createView",roles:["fx_loggedIn"]},"database/:database/new_view":{route:"createViewNoPartition",roles:["fx_loggedIn"]},"database/:database/new_view/:designDoc":{route:"createViewNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_view/:view":{route:"showPartitionedView",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_view/:view":{route:"showGlobalView",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_view/:view/edit":{route:"editView",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_view/:view/edit":{route:"editViewNoPartition",roles:["fx_loggedIn"]}},initialize:function(e,t){var n=t[0];this.databaseName=n,this.database=new ri.Model({id:n}),this.createDesignDocsCollection(),this.addSidebar()},showGlobalView:function(e,t,n){return this.showView(e,"",t,n)},showPartitionedView:function(e,t,n,a){return this.showView(e,t,n,a)},showView:function(e,t,n,a){a=a.replace(/\?.*$/,""),Vi.dispatchClearIndex(),Vi.dispatchFetchDesignDocsBeforeEdit({viewName:a,isNewView:!1,database:this.database,designDocs:this.designDocs,designDocId:"_design/"+n}),$e.fetchSelectedDatabaseInfo(e);var r=new ci("designDoc",{designDocName:n,designDocSection:"Views",indexName:a});ii.dispatchExpandSelectedItem(r);var o=t?encodeURIComponent(t):"",i=se.urls("view","server",encodeURIComponent(e),o,encodeURIComponent(n),encodeURIComponent(a)),s=se.urls("view","apiurl",encodeURIComponent(e),o,encodeURIComponent(n),encodeURIComponent(a)),c=se.constants.DOC_URLS.GENERAL,l=this.getCrumbs(this.database);return de.a.createElement(Zp,{docURL:c,endpoint:s,dbName:this.database.id,dropDownLinks:l,database:this.database,fetchUrl:i,ddocsOnly:!1,deleteEnabled:!1,selectedNavItem:r,partitionKey:t,onPartitionKeySelected:function(t){var r=se.urls("partitioned_view","app",encodeURIComponent(e),encodeURIComponent(t),encodeURIComponent(n));se.navigate("#/"+r+encodeURIComponent(a))},onGlobalModeSelected:function(){var t=se.urls("view","app",encodeURIComponent(e),encodeURIComponent(n));se.navigate("#/"+t+encodeURIComponent(a))},globalMode:""===t})},createViewNoPartition:function(e,t){return this.createView(e,"",t)},createView:function(e,t,n){var a=!0,r="new-doc";n&&(r="_design/"+n,a=!1),Vi.dispatchFetchDesignDocsBeforeEdit({viewName:"new-view",isNewView:!0,database:this.database,designDocs:this.designDocs,designDocId:r,isNewDesignDoc:a}),$e.fetchSelectedDatabaseInfo(e);var o=new ci(""),i=this.getCrumbs(this.database);return de.a.createElement(ef,{showIncludeAllDocs:!0,docURL:se.constants.DOC_URLS.GENERAL,dbName:this.database.id,dropDownLinks:i,database:this.database,selectedNavItem:o,partitionKey:t})},editViewNoPartition:function(e,t,n){return this.editView(e,"",t,n)},editView:function(e,t,n,a){Vi.dispatchFetchDesignDocsBeforeEdit({viewName:a,isNewView:!1,database:this.database,designDocs:this.designDocs,designDocId:"_design/"+n}),$e.fetchSelectedDatabaseInfo(e);var r=new ci("designDoc",{designDocName:n,designDocSection:"Views",indexName:a});ii.dispatchExpandSelectedItem(r);var o=se.constants.DOC_URLS.GENERAL,i=se.urls("view","apiurl",e,n,a),s=this.getCrumbs(this.database);return de.a.createElement(ef,{showIncludeAllDocs:!0,docURL:o,endpoint:i,dbName:this.database.id,dropDownLinks:s,database:this.database,selectedNavItem:r,partitionKey:t})}});function bm(e){return(bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ym(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Em(e,t){return!t||"object"!==bm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _m(e){return(_m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vm(e,t){return(vm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sm=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Em(this,_m(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vm(e,t)}(t,e),n=t,(a=[{key:"humanizeDuration",value:function(e){if(e<1e3)return Math.round(e)+" ms";var t=e/1e3;if(t<60)return Math.floor(t)+" seconds";var n=Math.floor(t/60);return[n," ",n>1?"minutes":"minute",", ",t=Math.floor(t-60*n)," ",t>1?"seconds":"second"].join("")}},{key:"getWarning",value:function(e){if(e){var t=e.split("\n").map((function(e,t){return de.a.createElement(de.a.Fragment,{key:t},e,de.a.createElement("br",null))}));return de.a.createElement("span",null,t)}}},{key:"warningPopupComponent",value:function(e){if(e)return de.a.createElement("div",{className:"warning"},de.a.createElement("i",{className:"fonticon-attention-circled"})," ",e)}},{key:"executionStatsLine",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=0!==t||n?"true":"false";return de.a.createElement("div",{"data-status":r},e+": ",de.a.createElement("span",{className:"value"},t.toLocaleString()," ",a))}},{key:"executionStatsPopupComponent",value:function(e){return e?de.a.createElement("div",{className:"execution-stats-popup-component"},this.executionStatsLine("documents examined",e.total_docs_examined),this.executionStatsLine("documents examined (quorum)",e.total_quorum_docs_examined),this.executionStatsLine("results returned",e.results_returned,!0),this.executionStatsLine("execution time",Math.round(e.execution_time_ms),!1,"ms")):null}},{key:"popup",value:function(e,t){return de.a.createElement(Ct.j,{id:"popover-execution-stats",title:"Execution Statistics"},de.a.createElement("div",{className:"execution-stats-popup"},this.executionStatsPopupComponent(e),this.warningPopupComponent(t)))}},{key:"render",value:function(){var e=this.props,t=e.executionStats,n=e.warning,a=this.getWarning(n),r=null;a&&(r=de.a.createElement("i",{className:"fonticon-attention-circled"}));var o=null;t?o=de.a.createElement("span",{className:"execution-stats-component"},"Executed in ",this.humanizeDuration(t.execution_time_ms)):a&&(o=de.a.createElement("span",{className:"execution-stats-component"},"Warning"));var i=this.popup(t,a);return de.a.createElement(Ct.i,{trigger:["hover","focus","click"],placement:"right",overlay:i},de.a.createElement("span",{className:"execution-stats"},r,o))}}])&&ym(n.prototype,a),r&&ym(n,r),t}(de.a.Component);function Nm(e){return(Nm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dm(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Om(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dm(n,!0).forEach((function(t){wm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dm(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tm(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Cm(e,t){return!t||"object"!==Nm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Am(e){return(Am=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Im(e,t){return(Im=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Sm.propTypes={executionStats:tt.a.object,warning:tt.a.string};var Pm=Jr.PaddedBorderedBox,Rm=Jr.CodeEditorPanel,km=le.helpers.getDocUrl,Lm=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Cm(this,Am(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Im(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;prettyPrint(),this.props.loadQueryHistory({databaseName:this.props.databaseName}),this.props.clearResults();var t=this.codeEditor.codeEditor.editor;t.commands.byName.runQuery||t.commands.addCommand({name:"runQuery",bindKey:{win:"Ctrl-Enter",mac:"Command-Option-Enter"},exec:function(){e.runQuery({preventDefault:function(){}})},readOnly:!0})}},{key:"componentDidUpdate",value:function(e){prettyPrint(),e.history!=this.props.history&&this.setEditorValue(this.props.history[0].value)}},{key:"setEditorValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.codeEditor.getEditor().setValue(e)}},{key:"getEditorValue",value:function(){return this.codeEditor.getValue()}},{key:"editorHasErrors",value:function(){return this.codeEditor.getEditor().hasErrors()}},{key:"onHistorySelected",value:function(e){this.setEditorValue(e.value)}},{key:"editor",value:function(){var e=this;return de.a.createElement("div",{className:"mango-editor-wrapper"},de.a.createElement("form",{className:"form-horizontal",onSubmit:function(t){e.runQuery(t)}},de.a.createElement("div",{className:"padded-box"},de.a.createElement(qr.a,{className:"mango-select",options:this.props.history,ref:function(t){return e.history=t},placeholder:"Query history",searchable:!1,clearable:!1,autosize:!1,onChange:function(t){e.onHistorySelected(t)}})),de.a.createElement(Pm,null,de.a.createElement(Rm,{id:"query-field",ref:function(t){return e.codeEditor=t},title:this.props.editorTitle,docLink:km("MANGO_SEARCH"),defaultCode:this.props.queryFindCode})),de.a.createElement("div",{className:"padded-box"},de.a.createElement("div",{className:"control-group"},de.a.createElement("button",{type:"submit",id:"create-index-btn",className:"btn btn-primary btn-space"},"Run Query"),de.a.createElement("button",{type:"button",id:"explain-btn",className:"btn btn-secondary btn-space",onClick:function(t){e.runExplain(t)}},"Explain"),de.a.createElement("a",{className:"edit-link",style:{},onClick:function(t){e.manageIndexes(t)}},"manage indexes")),de.a.createElement("div",null,de.a.createElement(Sm,this.props)))))}},{key:"render",value:function(){return this.props.isLoading?de.a.createElement("div",{className:"mango-editor-wrapper"},de.a.createElement(Jr.LoadLines,null)):this.editor()}},{key:"notifyOnQueryError",value:function(){return!!this.editorHasErrors()&&(se.addNotification({msg:"Please fix the Javascript errors and try again.",type:"error",clear:!0}),!0)}},{key:"manageIndexes",value:function(e){e.preventDefault(),this.props.manageIndexes();var t=this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"",n="#"+se.urls("mango","index-app",encodeURIComponent(this.props.databaseName),t);se.navigate(n)}},{key:"runExplain",value:function(e){e.preventDefault(),this.notifyOnQueryError()||this.props.runExplainQuery({databaseName:this.props.databaseName,partitionKey:this.props.partitionKey,queryCode:this.getEditorValue()})}},{key:"runQuery",value:function(e){e.preventDefault(),this.notifyOnQueryError()||(this.props.clearResults(),this.props.runQuery({databaseName:this.props.databaseName,partitionKey:this.props.partitionKey,queryCode:JSON.parse(this.getEditorValue()),fetchParams:Om({},this.props.fetchParams,{skip:0})}))}}])&&Tm(n.prototype,a),r&&Tm(n,r),t}(ue.Component);Lm.propTypes={description:tt.a.string.isRequired,editorTitle:tt.a.string.isRequired,queryFindCode:tt.a.string.isRequired,queryFindCodeChanged:tt.a.bool,databaseName:tt.a.string.isRequired,partitionKey:tt.a.string,runExplainQuery:tt.a.func.isRequired,runQuery:tt.a.func.isRequired,manageIndexes:tt.a.func.isRequired,loadQueryHistory:tt.a.func.isRequired,clearResults:tt.a.func.isRequired};var xm={MANGO_NEW_QUERY_FIND_CODE:"MANGO_NEW_QUERY_FIND_CODE",MANGO_LOAD_QUERY_HISTORY:"MANGO_LOAD_QUERY_HISTORY",MANGO_LOAD_INDEX_TEMPLATES:"MANGO_LOAD_INDEX_TEMPLATES",MANGO_NEW_QUERY_CREATE_INDEX_TEMPLATE:"MANGO_NEW_QUERY_CREATE_INDEX_TEMPLATE",MANGO_SAVE_INDEX_REQUEST:"MANGO_SAVE_INDEX_REQUEST",MANGO_SHOW_EXPLAIN_RESULTS:"MANGO_SHOW_EXPLAIN_RESULTS",MANGO_HIDE_EXPLAIN_RESULTS:"MANGO_HIDE_EXPLAIN_RESULTS"};function Um(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Mm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jm=function(e,t){var n=le.utils.queryString(t),a=se.urls("mango","index-server",le.utils.safeURLName(e));return a="".concat(a).concat(-1!==a.indexOf("?")?"&":"?").concat(n),v(a).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return{docs:e.indexes,docType:ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX,layout:ha.LAYOUT_ORIENTATION.JSON}}))},Hm=null,Bm=function(e,t){var n=t.limit,a=t.limit-1,r=(Math.floor(t.skip/a)+1)*a-e.limit;return r>=0&&(n=a-r),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Um(n,!0).forEach((function(t){Mm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Um(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{limit:n,skip:e.skip?t.skip+e.skip:t.skip})},Gm=function(e,t,n,a){var r=t?encodeURIComponent(t):"",o=se.urls("mango","query-server",encodeURIComponent(e),r),i=Bm(n,a);return N(o,i,{raw:!0})},qm=function(e,t,n,a){return function(e){return null===Hm?new se.Promise((function(t){Gm(e,"",{selector:{_id:{$gt:"a"}},execution_stats:!0},{limit:1}).then((function(e){Hm=200==e.status,t(Hm)}))})):Promise.resolve(Hm)}(e).then((function(r){return r&&(n.execution_stats=!0),Gm(e,t,n,a).then((function(e){return e.json()})).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return{docs:e.docs,docType:ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY,executionStats:e.execution_stats,warning:e.warning}}))}))},Vm={loadQueryHistory:function(e){return{type:xm.MANGO_LOAD_QUERY_HISTORY,options:e}},newQueryFindCode:function(e){return{type:xm.MANGO_NEW_QUERY_FIND_CODE,options:e}},showQueryExplain:function(e){return{type:xm.MANGO_SHOW_EXPLAIN_RESULTS,options:e}},hideQueryExplain:function(){return{type:xm.MANGO_HIDE_EXPLAIN_RESULTS}},newQueryCreateIndexTemplate:function(e){return{type:xm.MANGO_NEW_QUERY_CREATE_INDEX_TEMPLATE,options:e}},loadIndexTemplates:function(e){return{type:xm.MANGO_LOAD_INDEX_TEMPLATES,options:e}},requestSaveIndex:function(){return{type:xm.MANGO_SAVE_INDEX_REQUEST}},saveIndex:function(e){var t=this,n=e.databaseName,a=e.indexCode,r=e.fetchParams;return se.addNotification({msg:"Saving index for query...",type:"info",clear:!0}),function(e){return e(t.requestSaveIndex()),function(e,t){var n=se.urls("mango","index-server",le.utils.safeURLName(e));return N(n,t,{rawBody:!0}).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return e}))}(n,a).then((function(){var t="#"+se.urls("mango","query-app",le.utils.safeURLName(n),"");e(Eu((function(e){return jm(n,e)}),r,{})),se.addNotification({msg:'Index is ready for querying. <a href="'+t+'">Run a Query.</a>',type:"success",clear:!0,escape:!1})})).catch((function(e){se.addNotification({msg:"Failed to create index. "+t.errorReason(e),type:"error",clear:!0})}))}},errorReason:function(e){return"Reason: "+(e&&e.message||"n/a")},runExplainQuery:function(e){var t=this,n=e.databaseName,a=e.partitionKey,r=e.queryCode;return function(e){return function(e,t,n){var a=t?encodeURIComponent(t):"",r=se.urls("mango","explain-server",encodeURIComponent(e),a);return N(r,n,{rawBody:!0}).then((function(e){if(e.error)throw new Error("("+e.error+") "+e.reason);return e}))}(n,a,r).then((function(n){e(t.showQueryExplain({explainPlan:n}))})).catch((function(){se.addNotification({msg:"There was an error fetching the query plan.",type:"error",clear:!0})}))}}},Fm=function(e){var t=e.additionalIndexes;if(!t)return[];var n=se.getExtensions("mango:additionalIndexes")[0];return n?t.filter((function(e){return-1!==e.get("type").indexOf(n.type)})):void 0},Km=Object(nt.b)((function(e,t){var n,a,r=e.mangoQuery,o=e.indexResults;return{databaseName:t.databaseName,queryFindCode:ku(r.queryFindCode),queryFindCodeChanged:r.queryFindCodeChanged,availableIndexes:(n=r,a=n.availableIndexes,a?a.filter((function(e){var t=e.type;return-1!==["json","special"].indexOf(t)})):[]),additionalIndexes:Fm(r),isLoading:r.isLoading,history:r.history,description:t.description,editorTitle:t.editorTitle,additionalIndexesText:t.additionalIndexesText,fetchParams:o.fetchParams,executionStats:o.executionStats,warning:o.warning,partitionKey:t.partitionKey}}),(function(e){return{loadQueryHistory:function(t){e(Vm.loadQueryHistory(t))},runExplainQuery:function(t){e(Vm.runExplainQuery(t))},runQuery:function(t){e(Vm.hideQueryExplain()),e(Vm.newQueryFindCode(t)),e(Eu((function(e){return qm(t.databaseName,t.partitionKey,t.queryCode,e)}),t.fetchParams,{}))},clearResults:function(){e(hu())},manageIndexes:function(){e(Vm.hideQueryExplain())}}}))(Lm);function Wm(e){return(Wm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xm(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function zm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xm(n,!0).forEach((function(t){Ym(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xm(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ym(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qm(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Jm(e){return(Jm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $m(e,t){return($m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eg=Jr.PaddedBorderedBox,tg=Jr.CodeEditorPanel,ng=Jr.ConfirmButton,ag=Jr.LoadLines,rg=le.helpers.getDocUrl,og=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=Jm(t).call(this,e))||"object"!==Wm(r)&&"function"!=typeof r?Zm(a):r).state={partitionedSelected:!0},n.onTemplateSelected=n.onTemplateSelected.bind(Zm(n)),n.onTogglePartitioned=n.onTogglePartitioned.bind(Zm(n)),n.saveIndex=n.saveIndex.bind(Zm(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$m(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){prettyPrint(),this.props.loadIndexTemplates(),this.props.clearResults(),this.props.loadIndexList({fetchParams:zm({},this.props.fetchParams,{skip:0})})}},{key:"componentDidUpdate",value:function(e){prettyPrint(),e.templates!=this.props.templates&&this.setEditorValue(this.props.templates[0].value)}},{key:"setEditorValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.codeEditor)return this.codeEditor.getEditor().setValue(e)}},{key:"getEditorValue",value:function(){return this.codeEditor.getValue()}},{key:"editorHasErrors",value:function(){return this.codeEditor.getEditor().hasErrors()}},{key:"onTemplateSelected",value:function(e){this.setEditorValue(e.value)}},{key:"onTogglePartitioned",value:function(){this.setState({partitionedSelected:!this.state.partitionedSelected})}},{key:"partitionedCheckobx",value:function(){return this.props.isDbPartitioned?de.a.createElement("label",null,de.a.createElement("input",{id:"js-partitioned-index",type:"checkbox",checked:this.state.partitionedSelected,onChange:this.onTogglePartitioned,style:{margin:"0px 10px 0px 0px"}}),"Partitioned"):null}},{key:"editor",value:function(){var e=this,t=this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"",n="#"+se.urls("mango","query-app",encodeURIComponent(this.props.databaseName),t);return de.a.createElement("div",{className:"mango-editor-wrapper"},de.a.createElement("form",{className:"form-horizontal",onSubmit:this.saveIndex},de.a.createElement("div",{className:"padded-box"},de.a.createElement(qr.a,{className:"mango-select",options:this.props.templates,ref:function(t){return e.templates=t},placeholder:"Examples",searchable:!1,clearable:!1,autosize:!1,onChange:this.onTemplateSelected})),de.a.createElement(eg,null,de.a.createElement(tg,{id:"query-field",ref:function(t){return e.codeEditor=t},title:"Index",docLink:rg("MANGO_INDEX"),defaultCode:this.props.queryIndexCode}),this.partitionedCheckobx()),de.a.createElement("div",{className:"padded-box"},de.a.createElement("div",{className:"control-group"},de.a.createElement(ng,{text:"Create index",id:"create-index-btn",showIcon:!1}),de.a.createElement("a",{className:"edit-link",href:n},"edit query")))))}},{key:"render",value:function(){return this.props.isLoading?de.a.createElement(ag,null):this.editor()}},{key:"saveIndex",value:function(e){e.preventDefault();var t=function(){se.addNotification({msg:"Please fix the Javascript errors and try again.",type:"error",clear:!0})};if(this.editorHasErrors())t();else{var n=this.getEditorValue();if(this.props.isDbPartitioned)try{var a=JSON.parse(n);!0!==a.partitioned&&!1!==a.partitioned&&(a.partitioned=this.state.partitionedSelected),n=JSON.stringify(a)}catch(e){t()}this.props.saveIndex({databaseName:this.props.databaseName,indexCode:n,fetchParams:this.props.fetchParams})}}}])&&Qm(n.prototype,a),r&&Qm(n,r),t}(ue.Component);og.propTypes={isLoading:tt.a.bool.isRequired,databaseName:tt.a.string.isRequired,isDbPartitioned:tt.a.bool.isRequired,saveIndex:tt.a.func.isRequired,queryIndexCode:tt.a.string.isRequired,partitionKey:tt.a.string,loadIndexTemplates:tt.a.func.isRequired,clearResults:tt.a.func.isRequired,loadIndexList:tt.a.func.isRequired},og.defaultProps={isLoading:!0,isDbPartitioned:!1};var ig=Object(nt.b)((function(e,t){var n=e.mangoQuery,a=e.indexResults,r=e.databases;return{description:t.description,databaseName:t.databaseName,queryIndexCode:ku(n.queryIndexCode),templates:n.queryIndexTemplates,fetchParams:a.fetchParams,partitionKey:t.partitionKey,isLoading:r.isLoadingDbInfo,isDbPartitioned:r.isDbPartitioned}}),(function(e,t){return{saveIndex:function(t){e(Vm.saveIndex(t))},loadIndexList:function(n){e(Eu((function(e){return jm(t.databaseName,e)}),n.fetchParams,{}))},clearResults:function(){e(hu())},loadIndexTemplates:function(){e(Vm.loadIndexTemplates())}}}))(og);function sg(e){return(sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cg(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lg(e,t){return!t||"object"!==sg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ug(e){return(ug=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dg(e,t){return(dg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lg(this,ug(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dg(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){prettyPrint()}},{key:"componentDidUpdate",value:function(){prettyPrint()}},{key:"render",value:function(){return de.a.createElement("div",null,de.a.createElement("pre",{className:"prettyprint"},JSON.stringify(this.props.explainPlan,null," ")))}}])&&cg(n.prototype,a),r&&cg(n,r),t}(ue.Component);pg.propTypes={explainPlan:tt.a.object.isRequired};var fg={MangoIndexEditorContainer:ig,MangoQueryEditorContainer:Km,ExplainPage:pg};function hg(e){return(hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mg(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gg(e,t){return!t||"object"!==hg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bg(e){return(bg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yg(e,t){return(yg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Eg=function(e){var t=e.docURL,n=e.endpoint,a=e.databaseName,r=e.showPartitionKeySelector,o=e.partitionKey,i=e.onPartitionKeySelected,s=e.onGlobalModeSelected,c=e.globalMode,l=de.a.createElement(Bp,{docURL:t,endpoint:n,includeQueryOptionsParams:!1}),u=null;return r&&(u=de.a.createElement(Yp,{databaseName:a,partitionKey:o,onPartitionKeySelected:i,onGlobalModeSelected:s,globalMode:c})),de.a.createElement("div",{className:"right-header-wrapper flex-layout flex-row flex-body"},de.a.createElement("div",{style:{flex:1,padding:"18px 6px 12px 12px"}},u),de.a.createElement("div",{id:"right-header",className:"flex-body"}),l,de.a.createElement("div",{id:"notification-center-btn"},de.a.createElement(pt,null)))},_g=function(e){var t=e.databaseName,n=e.fetchUrl,a=e.queryDocs;return de.a.createElement("div",{id:"footer"},de.a.createElement(jp,{databaseName:t,fetchUrl:n,queryDocs:a}))},vg=function(e){var t=e.crumbs,n=e.docURL,a=e.endpoint,r=e.databaseName,o=e.partitionKey,i=e.showPartitionKeySelector,s=e.onPartitionKeySelected,c=e.onGlobalModeSelected,l=e.globalMode;return de.a.createElement("div",{className:"header-wrapper flex-layout flex-row"},de.a.createElement("div",{className:"flex-body faux__breadcrumbs-mango-header"},de.a.createElement(mt,{crumbs:t})),de.a.createElement(Eg,{docURL:n,endpoint:a,databaseName:r,showPartitionKeySelector:i,partitionKey:o,onPartitionKeySelected:s,onGlobalModeSelected:c,globalMode:l}))};vg.defaultProps={crumbs:[]};var Sg=function(e){var t=e.edit,n=e.designDocs,a=e.explainPlan,r=e.databaseName,o=e.fetchUrl,i=e.queryDocs,s=e.docType,c=e.partitionKey,l=t?de.a.createElement(fg.MangoIndexEditorContainer,{description:le.i18n.en_US["mango-descripton-index-editor"],databaseName:r,partitionKey:c}):de.a.createElement(fg.MangoQueryEditorContainer,{description:le.i18n.en_US["mango-descripton"],editorTitle:le.i18n.en_US["mango-title-editor"],additionalIndexesText:le.i18n.en_US["mango-additional-indexes-heading"],databaseName:r,partitionKey:c}),u=de.a.createElement(Np,{fetchUrl:o,designDocs:n,ddocsOnly:!1,databaseName:r,fetchAtStartup:!1,queryDocs:i,docType:s,partitionKey:c}),d=de.a.createElement(_g,{databaseName:r,fetchUrl:o,queryDocs:i});return a&&(u=de.a.createElement(fg.ExplainPage,{explainPlan:a}),d=null),de.a.createElement("div",{id:"two-pane-content",className:"flex-layout flex-row flex-body"},de.a.createElement("div",{id:"left-content",className:"flex-body"},l),de.a.createElement("div",{id:"right-content",className:"flex-body flex-layout flex-col"},de.a.createElement("div",{id:"dashboard-lower-content",className:"flex-body"},u),d))},Ng=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gg(this,bg(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yg(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.database,n=e.edit,a=e.docURL,r=e.crumbs,o=e.designDocs,i=e.fetchUrl,s=e.databaseName,c=e.queryFindCode,l=e.partitionKey,u=e.onPartitionKeySelected,d=e.onGlobalModeSelected,p=e.globalMode,f=this.props.endpoint;if(this.props.explainPlan){var h=l?encodeURIComponent(l):"";f=se.urls("mango","explain-apiurl",encodeURIComponent(t),h)}var m=function(e){return qm(s,l,c,e)},g=ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY;return n&&(m=function(e){return jm(s,e)},g=ha.INDEX_RESULTS_DOC_TYPE.MANGO_INDEX),de.a.createElement("div",{id:"dashboard",className:"two-pane flex-layout flex-col"},de.a.createElement(vg,{docURL:a,endpoint:f,crumbs:r,databaseName:s,partitionKey:l,showPartitionKeySelector:!n,onPartitionKeySelected:u,onGlobalModeSelected:d,globalMode:p}),de.a.createElement(Sg,{edit:n,designDocs:o,explainPlan:this.props.explainPlan,databaseName:s,fetchUrl:i,queryDocs:m,docType:g,partitionKey:l}))}}])&&mg(n.prototype,a),r&&mg(n,r),t}(ue.Component),Dg=Object(nt.b)((function(e,t){var n=e.mangoQuery;return{explainPlan:n.explainPlan,queryFindCode:n.queryFindCode,partitionKey:t.partitionKey,databaseName:t.databaseName,onPartitionKeySelected:t.onPartitionKeySelected,onGlobalModeSelected:t.onGlobalModeSelected,globalMode:t.globalMode}}))(Ng),Og={MangoIndexEditorAndQueryEditor:se.RouteObject.extend({selectedHeader:"Databases",hideApiBar:!0,hideNotificationCenter:!0,routes:{"database/:database/_partition/:partitionkey/_index":{route:"createIndex",roles:["fx_loggedIn"]},"database/:database/_index":{route:"createIndexNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_find":{route:"findUsingIndex",roles:["fx_loggedIn"]},"database/:database/_find":{route:"findUsingIndexNoPartition",roles:["fx_loggedIn"]}},initialize:function(e,t){var n=t[0];this.databaseName=n,this.database=new Ge.Model({id:n})},findUsingIndexNoPartition:function(e){return this.findUsingIndex(e,"")},findUsingIndex:function(e,t){var n=t?encodeURIComponent(t):"",a=se.urls("allDocs","app",encodeURIComponent(this.databaseName),n),r=t?"/".concat(n):"",o="/"+encodeURIComponent(this.databaseName)+r+"/_find",i=[{name:e,link:a},{name:le.i18n.en_US["mango-title-editor"]}],s=se.urls("mango","query-apiurl",encodeURIComponent(this.databaseName),n);return de.a.createElement(Dg,{database:e,crumbs:i,docURL:se.constants.DOC_URLS.MANGO_SEARCH,endpoint:s,edit:!1,databaseName:this.databaseName,fetchUrl:o,partitionKey:t,onPartitionKeySelected:function(t){var n=se.urls("mango","query-app",encodeURIComponent(e),encodeURIComponent(t));se.navigate("#/"+n)},onGlobalModeSelected:function(){var t=se.urls("mango","query-app",encodeURIComponent(e));se.navigate("#/"+t)},globalMode:""===t})},createIndexNoPartition:function(e){return this.createIndex(e,"")},createIndex:function(e,t){var n=new je.AllDocs(null,{database:this.database,paging:{pageSize:500},params:{startkey:"_design/",endkey:"_design0",include_docs:!0,limit:500}}),a=t?encodeURIComponent(t):"",r=se.urls("allDocs","app",encodeURIComponent(this.databaseName),a),o=se.urls("mango","index-apiurl",encodeURIComponent(this.databaseName),a),i=[{name:e,link:r},{name:le.i18n.en_US["mango-indexeditor-title"]}];return $e.fetchSelectedDatabaseInfo(e),de.a.createElement(Dg,{showIncludeAllDocs:!1,crumbs:i,docURL:se.constants.DOC_URLS.MANGO_INDEX,endpoint:o,edit:!0,designDocs:n,databaseName:this.databaseName,partitionKey:t})}})};je.RouteObjects=[mm.DocEditorRouteObject,nf,gm,Og.MangoIndexEditorAndQueryEditor];var wg=je;function Tg(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Cg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tg(n,!0).forEach((function(t){Ag(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tg(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ag(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ig={isLoading:!0,viewIndex:void 0};var Pg={INDEX_TEMPLATES:[{label:"Single field (json)",code:{index:{fields:["foo"]},name:"foo-json-index",type:"json"}},{label:"Multiple fields (json)",code:{index:{fields:["foo","bar"]},name:"foo-bar-json-index",type:"json"}}]};function Rg(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function kg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rg(n,!0).forEach((function(t){Lg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rg(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xg={selector:{_id:{$gt:null}}},Ug=function(e){var t="string"==typeof e?JSON.parse(e):e;return{label:JSON.stringify(t),value:ku(t),className:"mango-select-entry"}},Mg=function(){return[Ug(xg)]},jg=function(){return Pg.INDEX_TEMPLATES.map((function(e){var t=Ug(e.code);return t.label=e.label||t.label,t}))},Hg=function(){var e=se.getExtensions("mango:indexTemplates")[0];return e?e.filter((function(e){return!!e.code})).map((function(e){var t=Ug(e.code);return t.label=e.label||t.label,t})):jg()},Bg={queryFindCode:xg,queryIndexCode:{index:{fields:["_id"]},type:"json"},queryFindCodeChanged:!1,explainPlan:void 0,history:Mg(),historyKey:"default",queryIndexTemplates:jg()},Gg=function(e){var t=e+"_queryhistory",n=le.utils.localStorageGet(t);return n||((n=se.getExtensions("mango:queryHistory")[0])?n.filter((function(e){return!!e.code})).map((function(e){var t=Ug(e.code);return t.label=e.label||t.label,t})):Mg())},qg=function(e,t,n){var a=e.historyKey,r=e.history.slice(),o=Ug(t);o.label=n||o.label;var i=r.findIndex((function(e){return e.value===o.value}));return i>-1&&r.splice(i,1),r.unshift(o),r.length>5&&r.splice(5,1),le.utils.localStorageSet(a,r),r},Vg=function(e,t,n){var a=e.queryIndexTemplates.slice(),r=Ug(t);r.label=n||r.label,a.find((function(e){return e.value===r.value}))||a.push(r)};function Fg(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Kg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fg(n,!0).forEach((function(t){Wg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fg(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xg={selectorVisible:!1};function zg(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function Yg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zg(n,!0).forEach((function(t){Qg(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zg(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jg={doc:null,isLoading:!0,cloneDocModalVisible:!1,deleteDocModalVisible:!1,uploadModalVisible:!1,numFilesUploaded:0,uploadErrorMessage:"",uploadInProgress:!1,uploadPercentage:0,docConflictCount:0};function Zg(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function $g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zg(n,!0).forEach((function(t){eb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zg(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tb={isLoaded:!1,filters:[],changes:[],filteredChanges:[],maxChangesListed:100,showingSubset:!1,lastSequenceNum:null};function nb(e){e.showingSubset=!1;var t=0;e.filteredChanges=e.changes.filter((function(n){if(t>=e.maxChangesListed)return e.showingSubset=!0,!1;var a=JSON.stringify(n),r=e.filters.every((function(e){return new RegExp(e,"i").test(a)}));return r&&t++,r}))}n(705);function ab(e){return e||(e=""),e}function rb(e){return e?"/_partition/".concat(e):""}se.addReducers({indexResults:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ku,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case ou.INDEX_RESULTS_SET_STYLE:var a=Vu({},t.resultsStyle,{},n.resultsStyle);return e=a,le.utils.localStorageSet("fauxton:results_style",e),Vu({},t,{resultsStyle:a});case ou.INDEX_RESULTS_REDUX_RESET_STATE:return Vu({},Ku,{noResultsWarning:t.noResultsWarning,selectedLayout:t.selectedLayout,selectedDocs:[],fetchParams:{limit:uu()+1,skip:0},pagination:Gu({},Ku.pagination,{perPage:t.pagination.perPage}),queryOptionsPanel:Gu({},Ku.queryOptionsPanel,t.queryOptionsPanel,{reduce:!1,groupLevel:"exact",showReduce:!1}),isLoading:!1,resultsStyle:t.resultsStyle});case ou.INDEX_RESULTS_REDUX_IS_LOADING:return Vu({},t,{isLoading:!0});case ou.INDEX_RESULTS_REDUX_PARTITION_PARAM_NOT_SUPPORTED:return Gu({},t,{noResultsWarning:"The selected index does not support partitions. Switch back to global mode."});case ou.INDEX_RESULTS_REDUX_PARTITION_PARAM_MANDATORY:return Gu({},t,{noResultsWarning:"The selected index requires a partition key. Use the selector at the top to enter a partition key."});case ou.INDEX_RESULTS_REDUX_NEW_SELECTED_DOCS:return Vu({},t,{selectedDocs:n.selectedDocs});case ou.INDEX_RESULTS_REDUX_NEW_RESULTS:var r=t.selectedLayout;return n.docType===ha.INDEX_RESULTS_DOC_TYPE.MANGO_QUERY&&t.selectedLayout===ha.LAYOUT_ORIENTATION.METADATA&&(r=ha.LAYOUT_ORIENTATION.TABLE),Vu({},t,{docs:n.docs,isLoading:!1,noResultsWarning:"",isEditable:!0,fetchParams:Gu({},t.fetchParams,n.params),pagination:Gu({},t.pagination,{canShowNext:n.canShowNext}),docType:n.docType,selectedLayout:r,executionStats:n.executionStats,warning:n.warning});case ou.INDEX_RESULTS_REDUX_CHANGE_LAYOUT:return Vu({},t,{selectedLayout:n.layout});case ou.INDEX_RESULTS_REDUX_TOGGLE_SHOW_ALL_COLUMNS:return Vu({},t,{tableView:Gu({},t.tableView,{showAllFieldsTableView:!t.tableView.showAllFieldsTableView,cachedFieldsTableView:t.tableView.selectedFieldsTableView})});case ou.INDEX_RESULTS_REDUX_CHANGE_TABLE_HEADER_ATTRIBUTE:return Vu({},t,{tableView:Gu({},t.tableView,{selectedFieldsTableView:n.selectedFieldsTableView})});case ou.INDEX_RESULTS_REDUX_SET_PER_PAGE:return le.utils.localStorageSet("fauxton:perpageredux",n.perPage),Vu({},t,{pagination:Gu({},Ku.pagination,{perPage:n.perPage})});case ou.INDEX_RESULTS_REDUX_PAGINATE_NEXT:return Vu({},t,{pagination:Gu({},t.pagination,{pageStart:t.pagination.pageStart+t.pagination.perPage,currentPage:t.pagination.currentPage+1})});case ou.INDEX_RESULTS_REDUX_PAGINATE_PREVIOUS:return Vu({},t,{pagination:Gu({},t.pagination,{pageStart:t.pagination.pageStart-t.pagination.perPage,currentPage:t.pagination.currentPage-1})});case ou.INDEX_RESULTS_REDUX_NEW_QUERY_OPTIONS:return n.options.includeDocs&&n.options.reduce?n.options.reduce=!1:n.options.includeDocs&&t.queryOptionsPanel.reduce?n.options.reduce=!1:n.options.reduce&&t.queryOptionsPanel.includeDocs&&(n.options.includeDocs=!1),Vu({},t,{queryOptionsPanel:Gu({},t.queryOptionsPanel,n.options)});default:return t}},mangoQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bg,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case xm.MANGO_SET_DB:return kg({},e,{database:n.database,historyKey:n.database?n.database.id:"default"});case xm.MANGO_LOAD_QUERY_HISTORY:var a=Gg(n.databaseName);return kg({},e,{history:a,historyKey:n.databaseName+"_queryhistory",queryFindCode:JSON.parse(a[0].value)});case xm.MANGO_NEW_QUERY_FIND_CODE:return kg({},e,{queryFindCode:n.queryCode,history:qg(e,n.queryCode)});case xm.MANGO_RESET:return kg({},e,{getLoadingIndexes:n.isLoading});case xm.MANGO_LOAD_INDEX_TEMPLATES:var r=Hg();return kg({},e,{queryIndexTemplates:r,queryIndexCode:JSON.parse(r[0].value)});case xm.MANGO_NEW_QUERY_CREATE_INDEX_TEMPLATE:return kg({},e,{queryIndexCode:n.code,queryIndexTemplates:Vg(e,n.code,n.label)});case xm.MANGO_SHOW_EXPLAIN_RESULTS:return kg({},e,{explainPlan:n.explainPlan});case xm.MANGO_HIDE_EXPLAIN_RESULTS:return kg({},e,{explainPlan:!1});default:return e}},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oc,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case oi.SIDEBAR_EXPAND_SELECTED_ITEM:return function(e,t){var n=t.selectedNavItem,a=ac({},e);return n.designDocName&&(_.has(e.toggledSections,n.designDocName)||(a.toggledSections[n.designDocName]={visible:!0,indexGroups:{}}),a.toggledSections[n.designDocName].visible=!0,n.designDocSection&&(a.toggledSections[n.designDocName].indexGroups[n.designDocSection]=!0)),a}(e,n);case oi.SIDEBAR_NEW_OPTIONS:return function(e,t){var n=ac({},e,{database:t.database,designDocs:t.designDocs,designDocList:ic(t.designDocs),loading:!1});return t.selectedNavItem&&(n.selected={navItem:t.selectedNavItem,designDocName:"",designDocSection:"",indexName:""}),n}(e,n);case oi.SIDEBAR_TOGGLE_CONTENT:return function(e,t,n){var a=ac({},e);if(!e.toggledSections[t])return a.toggledSections[t]={visible:!0,indexGroups:{}},a;if(n){var r=e.toggledSections[t].indexGroups[n];return _.isUndefined(r)?a.toggledSections[t].indexGroups[n]=!0:a.toggledSections[t].indexGroups[n]=!r,a}return a.toggledSections[t].visible=!e.toggledSections[t].visible,a}(e,t.designDoc,t.indexGroup);case oi.SIDEBAR_FETCHING:return ac({},e,{loading:!0});case oi.SIDEBAR_SHOW_DELETE_INDEX_MODAL:return ac({},e,{deleteIndexModalIndexName:n.indexName,deleteIndexModalDesignDocName:n.designDocName,deleteIndexModalVisible:!0,deleteIndexModalText:de.a.createElement("div",null,"Are you sure you want to delete the ",de.a.createElement("code",null,n.indexName)," ",n.indexLabel,"?"),deleteIndexModalOnSubmit:n.onDelete});case oi.SIDEBAR_HIDE_DELETE_INDEX_MODAL:return ac({},e,{deleteIndexModalVisible:!1});case oi.SIDEBAR_SHOW_CLONE_INDEX_MODAL:return ac({},e,{cloneIndexModalIndexLabel:n.indexLabel,cloneIndexModalTitle:n.cloneIndexModalTitle,cloneIndexModalSourceIndexName:n.sourceIndexName,cloneIndexModalSourceDesignDocName:n.sourceDesignDocName,cloneIndexModalSelectedDesignDoc:"_design/"+n.sourceDesignDocName,cloneIndexDesignDocProp:"",cloneIndexModalVisible:!0,cloneIndexModalOnSubmit:n.onSubmit});case oi.SIDEBAR_HIDE_CLONE_INDEX_MODAL:return ac({},e,{cloneIndexModalVisible:!1});case oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_CHANGE:return ac({},e,{cloneIndexModalSelectedDesignDoc:n.value});case oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_NAME_UPDATED:return ac({},e,{cloneIndexModalNewDesignDocName:n.value});case oi.SIDEBAR_CLONE_MODAL_DESIGN_DOC_NEW_PARTITIONED_UPDATED:return ac({},e,{cloneIndexModalNewDesignDocPartitioned:n.value});case oi.SIDEBAR_CLONE_MODAL_UPDATE_INDEX_NAME:return ac({},e,{cloneIndexModalNewIndexName:n.value});case oi.SIDEBAR_UPDATED_DESIGN_DOCS:return ac({},e,{designDocs:n.designDocs,designDocList:ic(n.designDocs),loading:!1});default:return e}},revisionBrowser:zh,partitionKey:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xg;switch((arguments.length>1?arguments[1]:void 0).type){case Xp.PARTITON_KEY_SHOW_SELECTOR:return Kg({},e,{selectorVisible:!0});case Xp.PARTITON_KEY_HIDE_SELECTOR:return Kg({},e,{selectorVisible:!1});default:return e}},docEditor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jg,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case af.RESET_DOC:return Yg({},Jg);case af.DOC_LOADED:var a=n.doc.get("_conflicts")?n.doc.get("_conflicts").length:0;return n.doc.unset("_conflicts"),Yg({},e,{isLoading:!1,doc:n.doc,docConflictCount:a});case af.SHOW_CLONE_DOC_MODAL:return Yg({},e,{cloneDocModalVisible:!0});case af.HIDE_CLONE_DOC_MODAL:return Yg({},e,{cloneDocModalVisible:!1});case af.SHOW_DELETE_DOC_CONFIRMATION_MODAL:return Yg({},e,{deleteDocModalVisible:!0});case af.HIDE_DELETE_DOC_CONFIRMATION_MODAL:return Yg({},e,{deleteDocModalVisible:!1});case af.SHOW_UPLOAD_MODAL:return Yg({},e,{uploadModalVisible:!0});case af.HIDE_UPLOAD_MODAL:return Yg({},e,{uploadModalVisible:!1});case af.FILE_UPLOAD_SUCCESS:return Yg({},e,{numFilesUploaded:e.numFilesUploaded+1});case af.FILE_UPLOAD_ERROR:return Yg({},e,{uploadInProgress:!1,uploadPercentage:0,uploadErrorMessage:n.error});case af.RESET_UPLOAD_MODAL:return Yg({},e,{uploadInProgress:!1,uploadPercentage:0,uploadErrorMessage:""});case af.START_FILE_UPLOAD:return Yg({},e,{uploadInProgress:!0,uploadPercentage:0,fileUploadErrorMsg:""});case af.SET_FILE_UPLOAD_PERCENTAGE:return Yg({},e,{uploadPercentage:n.percent});default:return e}},changes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tb,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Wc.UPDATE_CHANGES:return e.lastSequenceNum!==t.seqNum?function(e,t,n){var a=$g({},e,{lastSequenceNum:t,isLoaded:!0}),r=0===a.changes.length;a.changes.forEach((function(e){e.isNew=!1}));var o=n.map((function(e){var t=vn.getSeqNum(e.seq);return{id:e.id,seq:t,deleted:!!_.has(e,"deleted")&&e.deleted,changes:e.changes,doc:e.doc,isNew:!r}}));return a.changes=o.concat(a.changes),nb(a),a}(e,t.seqNum,t.changes):e;case Wc.ADD_CHANGES_FILTER_ITEM:return function(e,t){var n=e.filters.slice();n.push(t);var a=$g({},e,{filters:n});return nb(a),a}(e,t.filter);case Wc.REMOVE_CHANGES_FILTER_ITEM:return function(e,t){var n=e.filters.slice(),a=n.indexOf(t);a>=0&&n.splice(a,1);var r=$g({},e,{filters:n});return nb(r),r}(e,t.filter);default:return e}},designDocInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ig,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case vl.DESIGN_FETCHING:return Cg({},e,{isLoading:!0});case vl.DESIGN_DOC_MONITOR:return Cg({},e,{isLoading:!1,viewIndex:n.designDocInfo.get("view_index")});case vl.DESIGN_DOC_REFRESH:return Cg({},e,{viewIndex:n.designDocInfo.get("view_index")});default:return e}},indexEditor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ji,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case Ui.CLEAR_INDEX:return Ki({},Ji);case Ui.EDIT_INDEX:case Ui.EDIT_NEW_INDEX:return Zi(e,n);case Ui.VIEW_NAME_CHANGE:return Ki({},e,{viewName:t.name});case Ui.SELECT_REDUCE_CHANGE:var a=t.reduceSelectedOption;return"NONE"===a&&(a=""),"CUSTOM"===a&&(a=zi),Ki({},e,{view:Ki({},e.view,{reduce:a})});case Ui.DESIGN_DOC_CHANGE:return Ki({},e,{designDocId:n.value});case Ui.VIEW_SAVED:case Ui.VIEW_CREATED:return e;case Ui.VIEW_ADD_DESIGN_DOC:return Ki({},e,{designDocId:t.designDoc._id});case Ui.VIEW_UPDATE_MAP_CODE:return Ki({},e,{view:Ki({},e.view,{map:t.code})});case Ui.VIEW_UPDATE_REDUCE_CODE:return Ki({},e,{view:Ki({},e.view,{reduce:t.code})});case Ui.DESIGN_DOC_NEW_NAME_UPDATED:return Ki({},e,{newDesignDocName:n.value});case Ui.DESIGN_DOC_NEW_PARTITIONED_UPDATED:return Ki({},e,{newDesignDocPartitioned:n.value});default:return e}}}),se.registerUrls("allDocs",{server:function(e,t){return A.getServerUrl("/"+e+"/_all_docs"+ab(t))},app:function(e,t,n){return"database/"+e+rb(t)+"/_all_docs"+ab(n)},apiurl:function(e,t){return A.getApiUrl("/"+e+"/_all_docs"+ab(t))}}),se.registerUrls("partitioned_allDocs",{app:function(e,t,n){return"database/"+e+"/_partition/"+t+"/_all_docs"+ab(n)},apiurl:function(e,t,n){return A.getApiUrl("/"+e+"/_partition/"+t+"/_all_docs"+ab(n))},server:function(e,t,n){return A.getServerUrl("/"+e+"/_partition/"+t+"/_all_docs"+ab(n))}}),se.registerUrls("allDocsSanitized",{server:function(e,t){return e=encodeURIComponent(e),A.getServerUrl("/"+e+"/_all_docs"+ab(t))},app:function(e,t){return"database/"+(e=encodeURIComponent(e))+"/_all_docs"+ab(t)},apiurl:function(e,t){return e=encodeURIComponent(e),A.getApiUrl("/"+e+"/_all_docs"+ab(t))}}),se.registerUrls("bulk_docs",{server:function(e,t){return A.getServerUrl("/"+encodeURIComponent(e)+"/_bulk_docs"+ab(t))},app:function(e,t){return"database/"+e+"/_bulk_docs"+ab(t)},apiurl:function(e,t){return A.getApiUrl("/"+e+"/_bulk_docs"+ab(t))}}),se.registerUrls("revision-browser",{app:function(e,t){return"database/"+e+"/"+t+"/conflicts"}}),se.registerUrls("designDocs",{server:function(e,t){return A.getServerUrl("/"+e+"/"+t+"/_info")},app:function(e,t,n){return"database/"+e+rb(t)+"/_design/"+le.utils.safeURLName(n)+"/_info"},apiurl:function(e,t){return A.getApiUrl("/"+e+"/"+t+"/_info")}}),se.registerUrls("view",{server:function(e,t,n,a){return A.getServerUrl("/"+e+rb(t)+"/_design/"+n+"/_view/"+a)},app:function(e,t){return"database/"+e+"/_design/"+t+"/_view/"},apiurl:function(e,t,n,a){return A.getApiUrl("/"+e+rb(t)+"/_design/"+n+"/_view/"+a)},edit:function(e,t,n,a){return"database/"+e+rb(t)+"/_design/"+n+"/_view/"+a+"/edit"},showView:function(e,t,n,a){return"/database/"+e+rb(t)+"/"+n+"/_view/"+a},fragment:function(e,t,n){return"database/"+e+t+"/_view/"+n}}),se.registerUrls("partitioned_view",{server:function(e,t,n,a){return A.getServerUrl("/"+e+"/_partition/"+t+"/_design/"+n+"/_view/"+a)},app:function(e,t,n){return"database/"+e+"/_partition/"+t+"/_design/"+n+"/_view/"},apiurl:function(e,t,n,a){return A.getApiUrl("/"+e+"/_partition/"+t+"/_design/"+n+"/_view/"+a)}}),se.registerUrls("document",{server:function(e,t,n){return _.isUndefined(n)&&(n=""),A.getServerUrl("/"+e+"/"+t+n)},attachment:function(e,t,n,a){return _.isUndefined(a)&&(a=""),A.getServerUrl("/"+e+"/"+t+"/"+n+a)},app:function(e,t){return"/database/"+e+"/"+t},apiurl:function(e,t){return t?A.getApiUrl("/"+e+"/"+t):A.getApiUrl("/"+e)},"web-index":function(e,t){return"/database/"+e+"/"+t}}),se.registerUrls("new",{newDocument:function(e){return"/database/"+e+"/_new"},newView:function(e,t){return"/database/"+e+rb(t)+"/new_view"},addView:function(e,t,n){return"/database/"+e+rb(t)+"/new_view/"+n}}),se.registerUrls("base",{server:function(e){return A.getServerUrl("/"+e+"/")},app:function(e){return"/database/"+e+"/"}}),se.registerUrls("mango",{"index-server":function(e,t){return t||(t=""),A.getServerUrl("/"+e+"/_index"+t)},"index-apiurl":function(e,t,n){return n||(n=""),A.getApiUrl("/"+e+rb(t)+"/_index"+n)},"index-app":function(e,t,n){return n||(n=""),"database/"+e+rb(t)+"/_index"+n},"index-server-bulk-delete":function(e){return A.getServerUrl("/"+e+"/_index/_bulk_delete")},"query-server":function(e,t,n){return n||(n=""),A.getServerUrl("/"+e+rb(t)+"/_find"+n)},"query-apiurl":function(e,t,n){return n||(n=""),A.getApiUrl("/"+e+rb(t)+"/_find"+n)},"query-app":function(e,t,n){return n||(n=""),"database/"+e+rb(t)+"/_find"+n},"explain-server":function(e,t){return A.getServerUrl("/"+e+rb(t)+"/_explain")},"explain-apiurl":function(e,t){return A.getApiUrl("/"+e+rb(t)+"/_explain")}});var ob=wg,ib={EDIT_CORS:"EDIT_CORS",CORS_SET_IS_LOADING:"CORS_SET_IS_LOADING",CORS_SHOW_DELETE_DOMAIN_MODAL:"CORS_SHOW_DELETE_DOMAIN_MODAL",CORS_HIDE_DELETE_DOMAIN_MODAL:"CORS_HIDE_DELETE_DOMAIN_MODAL"},sb=function(e,t,n,a){if(!t)throw new Error("node not set");return D(e+"/cors/"+n,a).then((function(e){if(e.error)throw new Error(e.reason);return e}))},cb=function(){return{type:ib.CORS_SET_IS_LOADING,isLoading:!1}},lb=function(e){return{type:ib.EDIT_CORS,options:e,isLoading:!1}},ub=function(){return{type:ib.CORS_HIDE_DELETE_DOMAIN_MODAL}},db=function(e){return"Reason: "+(e&&e.message||"n/a")},pb=function(e){return _.isEmpty(e)?"":e.join(",")},fb={fetchAndLoadCORSOptions:function(e,t){return function(n){var a=v(e+"/cors").then((function(e){if(e.error)throw new Error(e.reason);return{origins:e.origins?e.origins.split(","):[],methods:e.methods,credentials:e.credentials,headers:e.headers}})),r=function(e){return v(e+"/httpd").then((function(e){if(e.error)throw new Error(e.reason);return e}))}(e);se.Promise.join(a,r,(function(e,a){var r=lb({origins:e.origins,corsEnabled:"true"===a.enable_cors,node:t});n(r)})).catch((function(e){se.addNotification({msg:"Could not load CORS settings.  "+db(e),type:"error"})}))}},showLoadingBars:function(){return{type:ib.CORS_SET_IS_LOADING,isLoading:!0}},hideLoadingBars:cb,showDomainDeleteConfirmation:function(e){return{type:ib.CORS_SHOW_DELETE_DOMAIN_MODAL,domainToDelete:e}},hideDomainDeleteConfirmation:ub,loadCORSOptions:lb,sanitizeOrigins:pb,saveCors:function(e,t){return function(n){var a,r,o,i=[];return i.push(function(e,t,n){if(!t)throw new Error("node not set");return D(e+"/httpd/enable_cors",n.toString()).then((function(e){if(e.error)throw new Error(e.reason);return e}))}(e,t.node,t.corsEnabled)),t.corsEnabled&&(i.push((a=e,r=t.node,o=pb(t.origins),sb(a,r,"origins",o))),i.push(function(e,t){return sb(e,t,"credentials","true")}(e,t.node)),i.push(function(e,t){return sb(e,t,"headers","accept, authorization, content-type, origin, referer")}(e,t.node)),i.push(function(e,t){return sb(e,t,"methods","GET, PUT, POST, HEAD, DELETE")}(e,t.node))),se.Promise.all(i).then((function(){se.addNotification({msg:"CORS settings updated.",type:"success",clear:!0}),n(lb(t))})).catch((function(e){se.addNotification({msg:"Error! Could not save your CORS settings. Please try again. "+db(e),type:"error",clear:!0}),n(ub()),n(cb())}))}},overrideFetchAndLoadCORSOptions:function(e){fb.fetchAndLoadCORSOptions=e},overrideSaveCors:function(e){fb.saveCors=e}},hb=fb,mb=function(e){return"Reason: "+(e&&e.message||"n/a")};hb.overrideFetchAndLoadCORSOptions((function(){return function(e){fetch("/_api/v2/user/config/cors",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",method:"GET"}).then((function(e){return e.json()})).then((function(e){if(e.error)throw new Error("("+e.code+") "+e.error);return e})).then((function(t){var n=t.enable_cors,a=t.origins,r=hb.loadCORSOptions({origins:a,corsEnabled:n});e(r)})).catch((function(e){se.addNotification({msg:"Could not load CORS settings.  "+mb(e),type:"error"})}))}})),hb.overrideSaveCors((function(e,t){var n=t.origins,a=t.corsEnabled;return function(e){var t;(t={origins:n,enable_cors:a,allow_credentials:!0},fetch("/_api/v2/user/config/cors",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){if(e.error)throw new Error("("+e.code+") "+e.error);return e}))).then((function(){se.addNotification({msg:"CORS settings updated.",type:"success",clear:!0}),e(hb.loadCORSOptions({corsEnabled:a,origins:n}))})).catch((function(t){se.addNotification({msg:"Error! Could not save your CORS settings. Please try again. "+mb(t),type:"error",clear:!0}),e(hb.hideDomainDeleteConfirmation()),e(hb.hideLoadingBars())}))}}));var gb=hb;function bb(e){return(bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Eb(e,t){return!t||"object"!==bb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _b(e){return(_b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vb(e,t){return(vb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sb=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Eb(this,_b(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vb(e,t)}(t,e),n=t,(a=[{key:"onOriginChange",value:function(e){"all"===e.target.value&&this.props.isAllOrigins||("selected"!==e.target.value||this.props.isAllOrigins)&&this.props.originChange("all"===e.target.value)}},{key:"render",value:function(){return this.props.corsEnabled?de.a.createElement("div",null,de.a.createElement("p",null,de.a.createElement("strong",null," Origin Domains ")," "),de.a.createElement("p",null,"Databases will accept requests from these domains: "),de.a.createElement("label",{className:"radio"},de.a.createElement("input",{type:"radio",checked:this.props.isAllOrigins,value:"all",onChange:this.onOriginChange.bind(this),name:"all-domains"})," All domains ( * )"),de.a.createElement("label",{className:"radio"},de.a.createElement("input",{type:"radio",checked:!this.props.isAllOrigins,value:"selected",onChange:this.onOriginChange.bind(this),name:"selected-domains"})," Restrict to specific domains")):null}}])&&yb(n.prototype,a),r&&yb(n,r),t}(ue.Component);Sb.propTypes={corsEnabled:tt.a.bool,isAllOrigins:tt.a.bool,originChange:tt.a.func.isRequired};var Nb=function(e){return!!Db(e)||(se.addNotification({msg:"Please enter a valid domain, starting with http/https.",type:"error",clear:!0}),!1)},Db=function(e){return/^https?:\/\/(.+)(:\d{2,5})?$/.test(e)};function Ob(e){return(Ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tb(e,t){return!t||"object"!==Ob(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cb(e){return(Cb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ab(e,t){return(Ab=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ib=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Tb(this,Cb(t).call(this,e))).state={origin:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ab(e,t)}(t,e),n=t,(a=[{key:"onInputChange",value:function(e){this.setState({origin:e.target.value})}},{key:"addOrigin",value:function(e){if(e.preventDefault(),!Nb(this.state.origin))return!1;var t=function(e){var t=document.createElement("a");return t.href=e,/:/.test(e)?t.protocol+"//"+t.host:t.protocol+"//"+t.hostname}(this.state.origin);this.props.addOrigin(t),this.setState({origin:""})}},{key:"onKeyUp",value:function(e){if(13==e.keyCode)return this.addOrigin(e)}},{key:"render",value:function(){return this.props.isVisible?de.a.createElement("div",{id:"origin-domains-container"},de.a.createElement("div",{className:"origin-domains"},de.a.createElement("div",{className:"input-append"},de.a.createElement("input",{type:"text",name:"new_origin_domain",placeholder:"https://example.com",onChange:this.onInputChange.bind(this),value:this.state.origin}),de.a.createElement("button",{onClick:this.addOrigin.bind(this),className:"btn btn-secondary add-domain"},de.a.createElement("i",{className:"icon fonticon-ok-circled"})," Add Domain")))):null}}])&&wb(n.prototype,a),r&&wb(n,r),t}(ue.Component);function Pb(e){return(Pb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function kb(e,t){return!t||"object"!==Pb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lb(e){return(Lb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xb(e,t){return(xb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ib.propTypes={isVisible:tt.a.bool.isRequired,addOrigin:tt.a.func.isRequired};var Ub=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kb(this,Lb(t).call(this,e))).state={edit:!1,updatedOrigin:n.props.origin},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xb(e,t)}(t,e),n=t,(a=[{key:"editOrigin",value:function(e){e.preventDefault(),this.setState({edit:!this.state.edit})}},{key:"updateOrigin",value:function(e){e.preventDefault(),Nb(this.state.updatedOrigin)&&(this.state.updatedOrigin&&this.props.origin!==this.state.updatedOrigin&&this.props.updateOrigin(this.state.updatedOrigin,this.props.origin),this.setState({edit:!1}))}},{key:"deleteOrigin",value:function(e){e.preventDefault(),this.props.deleteOrigin(this.props.origin)}},{key:"onInputChange",value:function(e){this.setState({updatedOrigin:e.target.value})}},{key:"onKeyUp",value:function(e){if(13===e.keyCode)return this.updateOrigin(e)}},{key:"createOriginDisplay",value:function(){return this.state.edit?de.a.createElement("div",{className:"input-append edit-domain-section"},de.a.createElement("input",{type:"text",name:"update_origin_domain",onChange:this.onInputChange.bind(this),onKeyUp:this.onKeyUp.bind(this),value:this.state.updatedOrigin}),de.a.createElement("button",{onClick:this.updateOrigin.bind(this),className:"btn btn-primary update-origin"}," Update ")):de.a.createElement("div",{className:"js-url url-display"},this.props.origin)}},{key:"render",value:function(){var e=this.createOriginDisplay();return de.a.createElement("tr",null,de.a.createElement("td",null,e),de.a.createElement("td",{width:"30"},de.a.createElement("span",null,de.a.createElement("a",{className:"fonticon-pencil",onClick:this.editOrigin.bind(this),title:"Edit domain."}))),de.a.createElement("td",{width:"30"},de.a.createElement("span",null,de.a.createElement("a",{href:"#","data-bypass":"true",className:"fonticon-trash",onClick:this.deleteOrigin.bind(this),title:"Delete domain."}))))}}])&&Rb(n.prototype,a),r&&Rb(n,r),t}(ue.Component);function Mb(e){return(Mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Hb(e,t){return!t||"object"!==Mb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bb(e){return(Bb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gb(e,t){return(Gb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Ub.propTypes={origin:tt.a.string.isRequired,updateOrigin:tt.a.func.isRequired,deleteOrigin:tt.a.func.isRequired};var qb=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hb(this,Bb(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gb(e,t)}(t,e),n=t,(a=[{key:"createRows",value:function(){var e=this;return this.props.origins.map((function(t,n){return de.a.createElement(Ub,{updateOrigin:e.props.updateOrigin,deleteOrigin:e.props.deleteOrigin,key:n,origin:t})}))}},{key:"render",value:function(){var e=this.props,t=e.origins,n=e.isVisible;if(!t)return null;if(!n||0===t.length)return null;var a=this.createRows();return de.a.createElement("table",{id:"origin-domain-table",className:"table table-striped"},de.a.createElement("tbody",null,a))}}])&&jb(n.prototype,a),r&&jb(n,r),t}(ue.Component);function Vb(e){return(Vb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fb(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Kb(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wb(e,t){return!t||"object"!==Vb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xb(e){return(Xb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zb(e,t){return(zb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}qb.propTypes={isVisible:tt.a.bool.isRequired,origins:tt.a.arrayOf(tt.a.string),updateOrigin:tt.a.func.isRequired,deleteOrigin:tt.a.func.isRequired};var Yb=Jr.LoadLines,Qb=_o.ConfirmationModal,Jb=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wb(this,Xb(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zb(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.props.fetchAndLoadCORSOptions()}},{key:"enableCorsChange",value:function(){var e=this.props,t=e.corsEnabled,n=e.origins,a=e.node;(!t||_.isEmpty(n)||window.confirm(le.i18n.en_US["cors-disable-cors-prompt"]))&&this.props.saveCORS({corsEnabled:!t,origins:n,node:a})}},{key:"save",value:function(){this.props.saveCORS({corsEnabled:this.props.corsEnabled,origins:this.props.origins,node:this.props.node})}},{key:"originChange",value:function(e){(!e||_.isEmpty(this.props.origins)||window.confirm("Are you sure? Switching to all origin domains will overwrite your specific origin domains."))&&this.props.saveCORS({corsEnabled:this.props.corsEnabled,origins:e?["*"]:[],node:this.props.node})}},{key:"addOrigin",value:function(e){this.props.saveCORS({corsEnabled:this.props.corsEnabled,origins:this.props.origins.concat(e),node:this.props.node})}},{key:"updateOrigin",value:function(e,t){var n=this.props.origins.slice(),a=_.indexOf(n,t);-1!==a&&(n[a]=e,this.props.saveCORS({corsEnabled:this.props.corsEnabled,origins:n,node:this.props.node}))}},{key:"deleteOrigin",value:function(){var e=this.props,t=e.corsEnabled,n=e.origins,a=e.node,r=e.domainToDelete,o=this.props.origins.indexOf(r);if(-1!==o){var i=[].concat(Fb(n.slice(0,o)),Fb(n.slice(o+1)));this.props.saveCORS({corsEnabled:t,origins:i,node:a})}}},{key:"render",value:function(){var e=[this.props.corsEnabled,!this.props.isAllOrigins].every((function(e){return!0===e})),t=de.a.createElement("div",{id:this.props.corsEnabled?"collapsing-container":""},de.a.createElement(Sb,{corsEnabled:this.props.corsEnabled,originChange:this.originChange.bind(this),isAllOrigins:this.props.isAllOrigins}),de.a.createElement(qb,{updateOrigin:this.updateOrigin.bind(this),deleteOrigin:this.props.showDeleteDomainConfirmation,isVisible:e,origins:this.props.origins}),de.a.createElement(Ib,{addOrigin:this.addOrigin.bind(this),isVisible:e}));this.props.isLoading&&(t=de.a.createElement(Yb,null));var n=de.a.createElement("span",null,"Are you sure you want to delete ",de.a.createElement("code",null,_.escape(this.props.domainToDelete)),"?");return de.a.createElement("div",{className:"cors-page flex-body"},de.a.createElement("header",{id:"cors-header"},de.a.createElement("p",null,le.i18n.en_US["cors-notice"])),de.a.createElement("form",{id:"corsForm",onSubmit:this.save.bind(this)},de.a.createElement("div",{className:"cors-enable"},this.props.corsEnabled?"CORS is currently enabled.":"CORS is currently disabled.",de.a.createElement("br",null),de.a.createElement("button",{type:"button",className:"enable-disable btn btn-secondary",onClick:this.enableCorsChange.bind(this),disabled:this.props.isLoading?"disabled":null},this.props.corsEnabled?"Disable CORS":"Enable CORS")),t),de.a.createElement(Qb,{title:"Confirm Deletion",visible:this.props.deleteDomainModalVisible,text:n,buttonClass:"btn-danger",onClose:this.props.hideDeleteDomainConfirmation,onSubmit:this.deleteOrigin.bind(this),successButtonLabel:"Delete Domain"}))}}])&&Kb(n.prototype,a),r&&Kb(n,r),t}(ue.Component),Zb={CORSContainer:Object(nt.b)((function(e){var t=e.cors;return{node:t.node,corsEnabled:t.corsEnabled,isAllOrigins:t.isAllOrigins,isLoading:t.isLoading,origins:t.origins,deleteDomainModalVisible:t.deleteDomainModalVisible,domainToDelete:t.domainToDelete}}),(function(e,t){return{saveCORS:function(n){e(hb.showLoadingBars()),e(hb.saveCors(t.url,n))},fetchAndLoadCORSOptions:function(){e(hb.fetchAndLoadCORSOptions(t.url,t.node))},showDeleteDomainConfirmation:function(t){e(hb.showDomainDeleteConfirmation(t))},hideDeleteDomainConfirmation:function(){e(hb.hideDomainDeleteConfirmation())}}}))(Jb),CORSScreen:Jb,OriginInput:Ib,Origins:Sb,OriginTable:qb,OriginRow:Ub};n(706);function $b(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function ey(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$b(n,!0).forEach((function(t){ty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ny={corsEnabled:!1,origins:[],isAllOrigins:!1,configChanged:!1,shouldSaveChange:!1,node:"",isLoading:!0,deleteDomainModalVisible:!1,domainToDelete:""};var ay=se.addon();ay.initialize=function(){},se.addReducers({cors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ny,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ib.EDIT_CORS:var n=t.options;return ey({},e,{isLoading:!1,node:n.node,corsEnabled:n.corsEnabled,isAllOrigins:-1!==s.a.indexOf(n.origins,"*"),origins:n.origins,deleteDomainModalVisible:!1,domainToDelete:""});case ib.CORS_SHOW_DELETE_DOMAIN_MODAL:return ey({},e,{deleteDomainModalVisible:!0,domainToDelete:t.domainToDelete});case ib.CORS_HIDE_DELETE_DOMAIN_MODAL:return ey({},e,{deleteDomainModalVisible:!1,domainToDelete:""});case ib.CORS_SET_IS_LOADING:return ey({},e,{isLoading:t.isLoading});default:return e}}});var ry=ay,oy=(n(707),{});_.extend(oy,gb,ry),oy.Components=Zb;var iy=oy,sy={USER_AUTHENTICATED:"USER_AUTHENTICATED",ACCOUNTS_SELECT_PAGE:"ACCOUNTS_SELECT_PAGE",ACCOUNTS_SET_FIRST_NAME:"ACCOUNTS_SET_FIRST_NAME",ACCOUNTS_SET_LAST_NAME:"ACCOUNTS_SET_LAST_NAME",ACCOUNTS_SET_COMPANY:"ACCOUNTS_SET_COMPANY",ACCOUNTS_SET_EMAIL:"ACCOUNTS_SET_EMAIL",ACCOUNTS_SAVING_START:"ACCOUNTS_SAVING_START",ACCOUNTS_SAVING_END:"ACCOUNTS_SAVING_END",ACCOUNTS_SET_CURRENT_PWD:"ACCOUNTS_SET_CURRENT_PWD",ACCOUNTS_SET_NEW_PWD:"ACCOUNTS_SET_NEW_PWD",ACCOUNTS_SET_NEW_PWD_CONFIRMATION:"ACCOUNTS_SET_NEW_PWD_CONFIRMATION",ACCOUNTS_CLEAR_PWD_INFO:"ACCOUNTS_CLEAR_PWD_INFO",VIRTUAL_HOSTS_LOADED:"VIRTUAL_HOSTS_LOADED",ACCOUNTS_SET_NEW_HOSTNAME:"ACCOUNTS_SET_NEW_HOSTNAME",ACCOUNTS_SET_NEW_HOSTNAME_PATH:"ACCOUNTS_SET_NEW_HOSTNAME_PATH",ACCOUNTS_VIRTUAL_HOST_ADDED:"ACCOUNTS_VIRTUAL_HOST_ADDED",ACCOUNTS_SHOW_DELETE_VIRTUAL_HOST_MODAL:"ACCOUNTS_SHOW_DELETE_VIRTUAL_HOST_MODAL",ACCOUNTS_HIDE_DELETE_VIRTUAL_HOST_MODAL:"ACCOUNTS_HIDE_DELETE_VIRTUAL_HOST_MODAL",ACCOUNTS_VIRTUAL_HOST_DELETED:"ACCOUNTS_VIRTUAL_HOST_DELETED",ACCOUNTS_CLUSTER_LOCATION_LOADED:"ACCOUNTS_CLUSTER_LOCATION_LOADED",ACCOUNTS_CLUSTER_LOCATION_ERROR_LOADING:"ACCOUNTS_CLUSTER_LOCATION_ERROR_LOADING",ACCOUNTS_USAGE_RETURNED:"ACCOUNTS_USAGE_RETURNED",ACCOUNTS_USAGE_FETCHING:"ACCOUNTS_USAGE_FETCHING",ACCOUNTS_USAGE_ERROR:"ACCOUNTS_USAGE_ERROR",ACCOUNTS_SELECT_USAGE_TAB:"ACCOUNTS_SELECT_USAGE_TAB"},cy=n(11),ly=n.n(cy),uy=function(e,t){return function(e){return e.forEach((function(e){e.values.sort((function(e,t){return h()(e.date).isAfter(t.date)?1:h()(e.date).isSame(t.date)?0:-1}))})),e}(function(e,t,n){var a=n.reduce((function(e,t){return e[t]={name:t,values:[]},e}),{}),r=e.reduce((function(e,a){var r=t[a],o=h.a.utc(a).clone().startOf("day").format();return n.forEach((function(t){var n={value:parseInt(r[t],10),date:o,section:t};e[t].values.push(n)})),e}),a);return Object(i.values)(r)}((n=e,a=[],Object.keys(n).filter((function(e){var t=h.a.utc(e).get("date");return!Object(i.includes)(a,t)&&(a.push(t),!0)}))),e,t));var n,a},dy=[{unit:"B",pow2:1,pow10:1}];dy.push({unit:"kB",pow2:Math.pow(2,10),pow10:Math.pow(10,3)}),dy.push({unit:"MB",pow2:Math.pow(2,20),pow10:Math.pow(10,6)}),dy.push({unit:"GB",pow2:Math.pow(2,30),pow10:Math.pow(10,9)}),dy.push({unit:"TB",pow2:Math.pow(2,40),pow10:Math.pow(10,12)}),dy.push({unit:"PB",pow2:Math.pow(2,50),pow10:Math.pow(10,15)}),dy.push({unit:"EB",pow2:Math.pow(2,60),pow10:Math.pow(10,18)});var py=function(e){return 0===e||1===e?dy[0]:Object(i.last)(Object(i.filter)(dy,(function(t){return t.pow2<e})))};var fy=new(se.Store.extend({initialize:function(){this.reset()},reset:function(){this._currentPage=null,this._userAuthenticated=!1,this._isSaving=!1,this._username=null,this._firstName=null,this._lastName=null,this._email=null,this._company=null,this._accountCRN=null,this._currentPwd="",this._newPwd="",this._newPwdConfirmation="",this._virtualHosts=[],this._virtualHostsLoaded=!1,this._virtualHostsLoadError=!1,this._newHostname="",this._newHostnamePath="",this._deleteVirtualHostModalVisible=!1,this._virtualHostnameToDelete="",this._location="",this._dedicatedHwCRN="",this._domains=[],this._usageDataLoadError=!1,this._prices=null,this._dataVol=null,this._requests=null,this._bill=null,this._lightRequestData=[],this._heavyRequestData=[],this._dataVolumeData=[],this._isInPast=!1,this._freeLimit=0},isUserAuthenticated:function(){return this._userAuthenticated},isSaving:function(){return this._isSaving},setIsSaving:function(e){this._isSaving=e},isActivityLoaded:function(){return!!this.isUserAuthenticated()&&(null!==this._prices&&this._heavyRequestData.length>0&&null!==this._bill)},setUser:function(e){this._userAuthenticated=!0,this._username=e.username,this._firstName=e.firstName,this._lastName=e.lastName,this._email=e.email,this._company=e.company,e.domains?this._domains=e.domains:this._domains=[],e.partners&&e.partners.bluemix?(this._accountCRN=e.partners.bluemix.crn,this._legacyCredsEnabled=!e.partners.bluemix.iam_enabled||!0===e.partners.bluemix.legacy_credentials,e.partners.bluemix.dedicated_hardware_crn&&(this._dedicatedHwCRN=e.partners.bluemix.dedicated_hardware_crn)):(this._accountCRN=void 0,this._legacyCredsEnabled=!1);var t=e.cluster?e.cluster:"";this._location=function(e){return e.startsWith("bm-cc-bj")?"China":e.startsWith("bm-cc-dal")||e.startsWith("bm-cc-us-south")?"Dallas":e.startsWith("bm-cc-us-east")?"Washington DC":e.startsWith("bm-cc-eu-de")||e.startsWith("bm-cc-fra")?"Frankfurt":e.startsWith("bm-cc-eu-gb")||e.startsWith("bm-cc-uk")?"London":e.startsWith("bm-cc-jp-tok")?"Tokyo":e.startsWith("bm-cc-syd")?"Sydney":(e.startsWith("bm-cc-dedicated")||e.startsWith("bm-cc-profility"),"Dedicated Hardware Environment")}(t)},getUsername:function(){return this._username},getFirstName:function(){return this._firstName},getLastName:function(){return this._lastName},getCompany:function(){return this._company},getEmail:function(){return this._email},getDomains:function(){return this._domains},getAccountCRN:function(){return this._accountCRN},getLocation:function(){return this._location},getDedicatedHwCRN:function(){return this._dedicatedHwCRN},isLegacyCredsEnabled:function(){return this._legacyCredsEnabled},setPage:function(e){this._currentPage=e},getPage:function(){return this._currentPage},setFirstName:function(e){this._firstName=e},setLastName:function(e){this._lastName=e},setCompany:function(e){this._company=e},setEmail:function(e){this._email=e},getCurrentPwd:function(){return this._currentPwd},setCurrentPwd:function(e){this._currentPwd=e},getNewPwd:function(){return this._newPwd},setNewPwd:function(e){this._newPwd=e},getNewPwdConfirmation:function(){return this._newPwdConfirmation},setNewPwdConfirmation:function(e){this._newPwdConfirmation=e},clearPwdInfo:function(){this._currentPwd="",this._newPwd="",this._newPwdConfirmation=""},setVirtualHostInfo:function(e){this._virtualHostsLoaded=!0,this._virtualHostsLoadError=!e.success,e.success&&(this._virtualHosts=e.virtualHosts)},virtualHostsLoaded:function(){return this._virtualHostsLoaded},virtualHostsLoadError:function(){return this._virtualHostsLoadError},getVirtualHosts:function(){return this._virtualHosts},getNewHostname:function(){return this._newHostname},setNewHostname:function(e){this._newHostname=e},getNewHostnamePath:function(){return this._newHostnamePath},setNewHostnamePath:function(e){this._newHostnamePath=e},addVirtualHost:function(e){this._virtualHosts.push(e)},deleteVirtualHostModalVisible:function(){return this._deleteVirtualHostModalVisible},setDeleteVirtualHostModalVisibility:function(e){this._deleteVirtualHostModalVisible=e},getVirtualHostnameToDelete:function(){return this._virtualHostnameToDelete},deleteVirtualHost:function(e){this._virtualHosts=this._virtualHosts.filter((function(t){return t.host!==e}))},fetchingAccountUsageData:function(){return this._fetchingAccountUsageData},setAccountUsageData:function(e){this._isInPast=e.isInPast,this._freeLimit=e.freeLimit,this._fetchingAccountUsageData=!1,this._prices=e.prices,this._dataVol=e.dataVol,this._dataVolumeData=uy(e.dataVol.data_vol,["dbs","views","search","geo"]),this._bill=e.bill,e.requests&&(this._heavyRequestData=uy(e.requests.requests,["PUT","POST","COPY","DELETE"]),this._lightRequestData=uy(e.requests.requests,["GET","HEAD"]))},usageInPast:function(){return this._isInPast},usageFreeLimit:function(){return this._freeLimit},getLightRequestData:function(){return this._lightRequestData},getHeavyRequestData:function(){return this._heavyRequestData},getDataVolumeData:function(){return this._dataVolumeData},getFormattedStoragePrice:function(){if(null!==this._prices)return ly.a.format(".0f")(this._prices.gb_stored)},getDataVolume:function(){return this._dataVol},getHeavyPricePer100:function(){if(null!==this._prices)return ly.a.format(".3f")(100*this._prices.http_heavy)},getLightPricePer500:function(){if(null!==this._prices)return ly.a.format(".3f")(500*this._prices.http_light)},hasUsageDataLoadError:function(){return this._usageDataLoadError},getBill:function(){return this._bill},hasNoUsage:function(){return null===this._bill||"0"==this._bill.http_heavy.count&&"0"==this._bill.http_light.count&&"0"==this._bill.data_volume.count},dispatch:function(e){switch(e.type){case sy.USER_AUTHENTICATED:this.setUser(e.options);break;case sy.ACCOUNTS_SELECT_PAGE:this.setPage(e.options.page);break;case sy.ACCOUNTS_SET_FIRST_NAME:this.setFirstName(e.options.firstName);break;case sy.ACCOUNTS_SET_LAST_NAME:this.setLastName(e.options.lastName);break;case sy.ACCOUNTS_SET_COMPANY:this.setCompany(e.options.company);break;case sy.ACCOUNTS_SET_EMAIL:this.setEmail(e.options.email);break;case sy.ACCOUNTS_SAVING_START:this.setIsSaving(!0);break;case sy.ACCOUNTS_SAVING_END:this.setIsSaving(!1);break;case sy.ACCOUNTS_SET_CURRENT_PWD:this.setCurrentPwd(e.options.password);break;case sy.ACCOUNTS_SET_NEW_PWD:this.setNewPwd(e.options.password);break;case sy.ACCOUNTS_SET_NEW_PWD_CONFIRMATION:this.setNewPwdConfirmation(e.options.password);break;case sy.ACCOUNTS_CLEAR_PWD_INFO:this.clearPwdInfo();break;case sy.VIRTUAL_HOSTS_LOADED:this.setVirtualHostInfo(e.options);break;case sy.ACCOUNTS_SET_NEW_HOSTNAME:this.setNewHostname(e.options.hostname);break;case sy.ACCOUNTS_SET_NEW_HOSTNAME_PATH:this.setNewHostnamePath(e.options.path);break;case sy.ACCOUNTS_VIRTUAL_HOST_ADDED:this.addVirtualHost(e.options.virtualHost),this.setIsSaving(!1);break;case sy.ACCOUNTS_SHOW_DELETE_VIRTUAL_HOST_MODAL:this.setDeleteVirtualHostModalVisibility(!0),this._virtualHostnameToDelete=e.options.hostname;break;case sy.ACCOUNTS_HIDE_DELETE_VIRTUAL_HOST_MODAL:this.setDeleteVirtualHostModalVisibility(!1);break;case sy.ACCOUNTS_VIRTUAL_HOST_DELETED:this.deleteVirtualHost(e.options.hostname),this.setDeleteVirtualHostModalVisibility(!1);break;case sy.ACCOUNTS_USAGE_RETURNED:this.setAccountUsageData(e.options);break;case sy.ACCOUNTS_USAGE_FETCHING:this._fetchingAccountUsageData=!0;break;case sy.ACCOUNTS_USAGE_ERROR:this._usageDataLoadError=!0;break;default:return}this.triggerChange()}}));fy.dispatchToken=se.dispatcher.register(fy.dispatch.bind(fy));var hy={accountStore:fy},my={CCM_SHOW_PLAN_EXCEEDED_MODAL:"CCM_SHOW_PLAN_EXCEEDED_MODAL",CCM_HIDE_PLAN_EXCEEDED_MODAL:"CCM_HIDE_PLAN_EXCEEDED_MODAL",CCM_CHANGE_PLAN:"CCM_CHANGE_PLAN",CCM_SAVE_NEW_PLAN_SUCCESS:"CCM_SAVE_NEW_PLAN_SUCCESS",CCM_SAVE_NEW_PLAN_ERROR:"CCM_SAVE_NEW_PLAN_ERROR",CCM_SAVE_NEW_PLAN_STARTED:"CCM_SAVE_NEW_PLAN_STARTED",CCM_SHOW_PLAN_SAVE_CONFIRM_MODAL:"CCM_SHOW_PLAN_SAVE_CONFIRM_MODAL",CCM_HIDE_PLAN_SAVE_CONFIRM_MODAL:"CCM_HIDE_PLAN_SAVE_CONFIRM_MODAL",CCM_SHOW_REDIRECT_TO_BLUEMIX_MODAL:"CCM_SHOW_REDIRECT_TO_BLUEMIX_MODAL",CCM_HIDE_REDIRECT_TO_BLUEMIX_MODAL:"CCM_HIDE_REDIRECT_TO_BLUEMIX_MODAL",CCM_SET_LAST_PLAN_CHANGE_DATE:"CCM_SET_LAST_PLAN_CHANGE_DATE"},gy={PAGE_ANNOUNCEMENTS:"PAGE_ANNOUNCEMENTS",PAGE_PROFILE:"PAGE_PROFILE",PAGE_CORS:"PAGE_CORS",PAGE_PASSWORD:"PAGE_PASSWORD",PAGE_VIRTUAL_HOSTS:"PAGE_VIRTUAL_HOSTS",PAGE_USAGE:"PAGE_USAGE",PAGE_PLAN:"PAGE_PLAN",ANNOUNCEMENT_VERSION:14,MIN_PWD_SIZE:16,MIN_PWD_STRENGTH:4,PLANS:{"billing.tiered.standard.1":{reads:20,writes:10,queries:5,priceHour:0},"billing.tiered.standard.2":{reads:100,writes:50,queries:5,priceHour:.105},"billing.tiered.standard.3":{reads:1e3,writes:500,queries:50,priceHour:1.05},"billing.tiered.standard.4":{reads:5e3,writes:2500,queries:250,priceHour:5.25}},NEW_BLUEMIX_PLANS:{"billing.tiered.bluemix.lite":{reads:20,writes:10,queries:5,priceHour:0},"billing.tiered.bluemix.standard":{reads:100,writes:50,queries:5,priceHour:.105}},CUSTOM_PLANS:{"billing.tiered.bluemix.custom.hertz.20L10W3Q":{reads:2e4,writes:1e4,queries:3e3,priceHour:35},"billing.tiered.bluemix.custom.hertz.20L10W6Q":{reads:2e4,writes:1e4,queries:6e3,priceHour:56},"billing.tiered.bluemix.standard.fixed.200":{reads:2e4,writes:1e4,queries:1e3,priceHour:21}},USAGE_TABS:{HEAVY:"USAGE_TABS_HEAVY",LIGHT:"USAGE_TABS_LIGHT",DATA_VOLUME:"USAGE_TABS_DATA_VOLUME"}},by=new(se.Store.extend({initialize:function(){this.reset()},reset:function(){this._userAuthenticated=!1,this._plan=null,this._lastPlanChangeDate=null,this._planExceededModalVisible=!1,this._ccmPlanUpdateInProgress=!1,this._isConfirmPlanModalVisible=!1,this._isRedirectToBluemixModalVisible=!1},getSidebarItems:function(){var e=[{icon:"icon-bullhorn",title:"Announcements",pageName:gy.PAGE_ANNOUNCEMENTS,link:"account/announcements"},{icon:"cloudant-CORS",title:"CORS",pageName:gy.PAGE_CORS,link:"account/cors"}],t=Object.keys(gy.PLANS).concat(Object.keys(gy.NEW_BLUEMIX_PLANS));return this._plan&&-1!==t.indexOf(this._plan.id)&&e.push({icon:"fonticon-wrench2",title:"Provisioning",pageName:gy.PAGE_PLAN,link:"account/plan"}),e},getPlan:function(){return this._plan},getLastPlanChangeDate:function(){return this._lastPlanChangeDate},isPlanExceededModalVisible:function(){return this._planExceededModalVisible},showPlanExceededModal:function(){this._planExceededModalVisible=!0},hidePlanExceededModal:function(){this._planExceededModalVisible=!1},getIsOnLitePlan:function(){return!!this._preSelectedPlan&&("billing.tiered.standard.1"===this._preSelectedPlan.id||"billing.tiered.bluemix.lite"===this._preSelectedPlan.id)},getIsNewBluemixPlan:function(){return!!this._preSelectedPlan&&-1!==Object.keys(gy.NEW_BLUEMIX_PLANS).indexOf(this._preSelectedPlan.id)},getIsCustomPlan:function(){return!!this._preSelectedPlan&&!(-1!==Object.keys(gy.NEW_BLUEMIX_PLANS).indexOf(this._preSelectedPlan.id)||-1!==Object.keys(gy.PLANS).indexOf(this._preSelectedPlan.id))},getIsCcmUpdateInProgress:function(){return this._ccmPlanUpdateInProgress},getPreSelectedPlan:function(){return this._preSelectedPlan},getIsConfirmPlanModalVisible:function(){return this._isConfirmPlanModalVisible},getIsRedirectToBluemixModalVisible:function(){return this._isRedirectToBluemixModalVisible},dispatch:function(e){switch(e.type){case sy.USER_AUTHENTICATED:this._userAuthenticated=!0,this._plan={id:e.options.plan,multiple:e.options.plan_multiple},this._preSelectedPlan={id:e.options.plan,multiple:e.options.plan_multiple};break;case my.CCM_SHOW_PLAN_EXCEEDED_MODAL:this.showPlanExceededModal();break;case my.CCM_SHOW_PLAN_SAVE_CONFIRM_MODAL:this._isConfirmPlanModalVisible=!0;break;case my.CCM_HIDE_PLAN_EXCEEDED_MODAL:this.hidePlanExceededModal();break;case my.CCM_CHANGE_PLAN:this._plan=e.options.plan;break;case my.CCM_SET_LAST_PLAN_CHANGE_DATE:this._lastPlanChangeDate=e.options.lastPlanChangeDate;break;case my.CCM_SAVE_NEW_PLAN_SUCCESS:this._ccmPlanUpdateInProgress=!1,this._isConfirmPlanModalVisible=!1,this._preSelectedPlan=this._plan,this._lastPlanChangeDate=new Date;break;case my.CCM_SAVE_NEW_PLAN_ERROR:this._ccmPlanUpdateInProgress=!1,this._isConfirmPlanModalVisible=!1;break;case my.CCM_HIDE_PLAN_SAVE_CONFIRM_MODAL:this._isConfirmPlanModalVisible=!1;break;case my.CCM_SAVE_NEW_PLAN_STARTED:this._ccmPlanUpdateInProgress=!0;break;case my.CCM_SHOW_REDIRECT_TO_BLUEMIX_MODAL:this._isRedirectToBluemixModalVisible=!0;break;case my.CCM_HIDE_REDIRECT_TO_BLUEMIX_MODAL:this._isRedirectToBluemixModalVisible=!1;break;default:return}this.triggerChange()}}));by.dispatchToken=se.dispatcher.register(by.dispatch.bind(by));var yy={ccmStore:by};var Ey={hideConfirmPlanSelectionModal:function(){se.dispatch({type:my.CCM_HIDE_PLAN_SAVE_CONFIRM_MODAL})},showConfirmPlanSelectionModal:function(){se.dispatch({type:my.CCM_SHOW_PLAN_SAVE_CONFIRM_MODAL})},hideRedirectToBluemixModal:function(){se.dispatch({type:my.CCM_HIDE_REDIRECT_TO_BLUEMIX_MODAL})},showRedirectToBluemixModal:function(){se.dispatch({type:my.CCM_SHOW_REDIRECT_TO_BLUEMIX_MODAL})},saveNewPlan:function(e){se.dispatch({type:my.CCM_SAVE_NEW_PLAN_STARTED}),D("/_api/v2/user/plan",e).then((function(e){if(e.ok)return se.dispatch({type:my.CCM_SAVE_NEW_PLAN_SUCCESS}),void se.addNotification({msg:"Your plan has been updated.",type:"success",clear:!0});se.dispatch({type:my.CCM_SAVE_NEW_PLAN_ERROR});var t="";e.error&&(t=e.error),se.addNotification({msg:"There was an error updating your plan. ".concat(t),type:"error",clear:!0})}),(function(e){se.dispatch({type:my.CCM_SAVE_NEW_PLAN_ERROR});var t="";e.message&&(t=e.message),se.addNotification({msg:"There was an error updating your plan. "+t,type:"error",clear:!0})}))},changeCcmPlan:function(e){se.dispatch({type:my.CCM_CHANGE_PLAN,options:e})},showPlanExceededModal:function(){se.dispatch({type:my.CCM_SHOW_PLAN_EXCEEDED_MODAL})},hidePlanExceededModal:function(){se.dispatch({type:my.CCM_HIDE_PLAN_EXCEEDED_MODAL})},getLastPlanChangeDate:function(){v("/_api/v2/user/plan").then((function(e){if(!e.history)throw new Error(e.error?e.error:"");var t=null;if(e.history.length>0){var n=e.history[e.history.length-1][0];n.endsWith("Z")||(n+="Z"),t=new Date(n)}else t=new Date(0);se.dispatch({type:my.CCM_SET_LAST_PLAN_CHANGE_DATE,options:{lastPlanChangeDate:t}})})).catch((function(e){se.addNotification({msg:"Plan history could not be loaded. ".concat(e.message),type:"error",clear:!0})}))}},_y=function(e){if(!e)return"";var t=e+"";return(t=t.split("."))[1].length<2&&(t[1]=t[1]+"0"),t.join(".")},vy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=Math.pow(10,t),a=(Math.round(e*n)/n).toFixed(t);return Number(a).toLocaleString(void 0,{minimumFractionDigits:t})},Sy=function(){return de.a.createElement("div",null,de.a.createElement("div",{className:"c-accountplan__persecondheading"},de.a.createElement("div",{className:"c-accountplan__persecondelement"},"Reads"),de.a.createElement("div",{className:"c-accountplan__persecondelement"},"Writes"),de.a.createElement("div",{className:"c-accountplan__persecondelement"},"Global Queries")))},Ny=function(e){var t=e.l,n=e.w,a=e.q,r=e.selected,o=e.enabled,i=e.onChange,s=e.value,c=e.preselectedPlan,l="c-accountplan__selectplanelement";return l="".concat(l,o&&r?"--selected":o?"--deselected":"--disabled"),c&&(l="c-accountplan__selectplanelement--preselected"),de.a.createElement("label",{className:"c-accountplan__selectplanelement "+l},de.a.createElement("div",{className:"c-accountplan__selectplanelement__content"},de.a.createElement("input",{style:{display:"none"},type:"radio",value:s,checked:r,onChange:i}),de.a.createElement("div",{className:"c-accountplan__persecondelement c-accountplan__persecondelement--padded"},"".concat(t)),de.a.createElement("div",{className:"c-accountplan__persecondelement c-accountplan__persecondelement--padded"},"".concat(n)),de.a.createElement("div",{className:"c-accountplan__persecondelement c-accountplan__persecondelement--padded"},"".concat(a))))},Dy=function(e){var t=e.tooltip_content,n=de.a.createElement(Ct.l,{id:"graveyard-tooltip"},t);return de.a.createElement(Ct.i,{placement:"top",overlay:n},de.a.createElement("i",{className:"icon icon-info-sign c-accountplan__plan-elem-info-sign"}))};function Oy(e){return(Oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wy(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ty(e,t){return!t||"object"!==Oy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cy(e){return(Cy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ay(e,t){return(Ay=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Iy=gy.PLANS,Py=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ty(this,Cy(t).call(this,e))).disabledClass=e.enabled?"":"c-accountplan--disabled",n.linkColorClass=e.enabled?"":"c-accountplanlink-disabled",n.litePlan=Iy["billing.tiered.standard.1"],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ay(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{className:"c-accountplan__liteplan flex-fill "+this.disabledClass},de.a.createElement("h3",{className:"c-accountplan__heading"},"Lite Plan"),de.a.createElement("div",null,"The Lite plan is free, and includes a single level of provisioned throughput capacity for ",de.a.createElement("a",{className:this.linkColorClass,href:"#monitoring/usage"},"per-second operations")," and 1GB of data storage."),de.a.createElement("div",{style:{clear:"both"}},de.a.createElement("div",{className:"c-accountplan__planselector"},de.a.createElement("form",null,de.a.createElement(Sy,null),de.a.createElement(Ny,{onChange:function(){},preselectedPlan:this.props.enabled,enabled:this.enabled,selected:this.enabled,l:this.litePlan.reads,w:this.litePlan.writes,q:this.litePlan.queries}))),de.a.createElement("div",{className:"c-accountplan__plan-price-wrapper"},de.a.createElement("div",{className:"c-accountplan__persecondheading"},"Hourly"),de.a.createElement("div",{title:"$"+_y(this.litePlan.priceHour),className:"c-accountplan__pricetag"},"$",vy(Iy["billing.tiered.standard.1"].priceHour)))))}}])&&wy(n.prototype,a),r&&wy(n,r),t}(ue.Component);function Ry(e){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ky(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ly(e,t){return!t||"object"!==Ry(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xy(e){return(xy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uy(e,t){return(Uy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var My=gy.PLANS,jy=Object.keys(My).slice(1),Hy=Jr.ConfirmButton,By=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ly(this,xy(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uy(e,t)}(t,e),n=t,(a=[{key:"enableConfirmModal",value:function(e){e.preventDefault(),Ey.showConfirmPlanSelectionModal()}},{key:"disableConfirmModal",value:function(){Ey.hideConfirmPlanSelectionModal()}},{key:"onPlanSelectChange",value:function(e){e.preventDefault(),this.props.onPlanSelectChange({id:e.target.value})}},{key:"onPlanSaveClick",value:function(e){e.preventDefault(),this.props.onPlanSaveClick()}},{key:"render",value:function(){var e=this.props,t=e.enabled,n=e.preselectedPlan,a=e.selectedPlan,r=e.isCcmPlanUpdateInProgress,o=e.isConfirmPlanModalVisible,i=t?"c-accountplan--enabled":"c-accountplan--disabled",s=t?"":"c-accountplanlink-disabled",c=t?"c-accountplan-hover-item-icon--enabled":"c-accountplan-hover-item-icon--disabled",l=de.a.createElement(Ct.l,{id:"tooltip"},"The displayed hourly values are rounded to the nearest cent.");return de.a.createElement("div",{className:"c-accountplan__standardplan flex-fill "+i},de.a.createElement("h3",{className:"c-accountplan__heading"},"Standard Plan"),de.a.createElement("div",null,"The Standard plan allows selecting level of provisioned throughput capacity for your ",de.a.createElement("a",{className:s,href:"#monitoring/usage"},"per-second operations"),", and charges $0.0014/GB/hour for data storage over 20 GB."),de.a.createElement("div",{style:{clear:"both"}},de.a.createElement("div",{className:"c-accountplan__planselector"},de.a.createElement("form",null,de.a.createElement(Sy,null),de.a.createElement(Ny,{onChange:this.onPlanSelectChange.bind(this),value:jy[0],enabled:t,preselectedPlan:n===jy[0],selected:a===jy[0],l:My[jy[0]].reads,w:My[jy[0]].writes,q:My[jy[0]].queries}),de.a.createElement(Ny,{onChange:this.onPlanSelectChange.bind(this),value:jy[1],enabled:t,preselectedPlan:n===jy[1],selected:a===jy[1],l:My[jy[1]].reads,w:My[jy[1]].writes,q:My[jy[1]].queries}),de.a.createElement(Ny,{onChange:this.onPlanSelectChange.bind(this),value:jy[2],enabled:t,preselectedPlan:n===jy[2],selected:a===jy[2],l:My[jy[2]].reads,w:My[jy[2]].writes,q:My[jy[2]].queries}))),de.a.createElement("div",{className:"c-accountplan__plan-price-wrapper"},de.a.createElement("div",{className:"c-accountplan__persecondheading"},"Hourly",de.a.createElement(Ct.i,{placement:"top",overlay:l},de.a.createElement("div",{className:"c-accountplan-hover-item-wrapper"},de.a.createElement("div",{className:"c-accountplan-hover-item "+c},de.a.createElement("i",{className:"c-accountplan-hover-item-icon icon-asterisk"}))))),de.a.createElement("div",{title:"$"+_y(My[jy[0]].priceHour),className:"c-accountplan__pricetag"},"$",vy(My[jy[0]].priceHour)),de.a.createElement("div",{title:"$"+_y(My[jy[1]].priceHour),className:"c-accountplan__pricetag"},"$",vy(My[jy[1]].priceHour)),de.a.createElement("div",{title:"$"+_y(My[jy[2]].priceHour),className:"c-accountplan__pricetag"},"$",vy(My[jy[2]].priceHour))),de.a.createElement("br",null),t?de.a.createElement("div",{className:"c-accountplan__savearea"},de.a.createElement(Hy,{buttonType:"btn-primary",showIcon:!1,onClick:this.enableConfirmModal.bind(this),disabled:r||n===a,text:"Change Capacity"})):null,t&&My[n]?de.a.createElement(Vy,{currentCost:720*My[n].priceHour,newCost:720*My[a].priceHour}):null,t?de.a.createElement(Fy,null):null),de.a.createElement(Gy,{selectedPlan:My[a],preselectedPlan:My[n],onCancelClick:this.disableConfirmModal.bind(this),onPlanSaveClick:this.onPlanSaveClick.bind(this),isVisible:o,isCcmPlanUpdateInProgress:r}))}}])&&ky(n.prototype,a),r&&ky(n,r),t}(ue.Component),Gy=function(e){var t=e.onPlanSaveClick,n=e.isVisible,a=e.onCancelClick,r=e.selectedPlan,o=void 0===r?{}:r,i=e.preselectedPlan,s=void 0===i?{}:i,c=e.isCcmPlanUpdateInProgress;return de.a.createElement(Ct.g,{dialogClassName:"",show:n,onHide:a},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Verify Capacity Change")),de.a.createElement(Ct.g.Body,null,de.a.createElement("div",null,"You are changing your account’s capacity."),de.a.createElement("br",null),de.a.createElement("div",{className:"c-accountplan__modal-comparison"},de.a.createElement("div",{className:"c-accountplan__modal-comparison__left"},"Your ",de.a.createElement("b",null,"current")," capacity is:",de.a.createElement(qy,{planDetails:s})),de.a.createElement("div",{className:"c-accountplan__modal-comparison__right"},"Your ",de.a.createElement("b",null,"new")," capacity will be:",de.a.createElement(qy,{planDetails:o}))),de.a.createElement("br",null),de.a.createElement("div",null,"Provisioning changes can require up to 24 hours to complete.")),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{style:{marginRight:"20px"},onClick:a,"data-bypass":"true",className:""},"Cancel"),de.a.createElement(Hy,{onClick:t,disabled:c,text:c?"Processing...":"Change Capacity"})))},qy=function(e){var t=e.planDetails;return de.a.createElement("div",null,de.a.createElement("br",null),de.a.createElement("ul",null,de.a.createElement("li",null,t.reads," reads per second"),de.a.createElement("li",null,t.writes," writes per second"),de.a.createElement("li",null,t.queries," global queries per second")))},Vy=function(e){var t=e.currentCost,n=e.newCost,a=n!==t,r="";return a&&(r="c-accountplan__calculatorcellcurrent--crossed-out"),de.a.createElement("div",{className:"c-accountplan__costcalc"},"Monthly costs (excluding data):",de.a.createElement("table",null,de.a.createElement("tbody",null,de.a.createElement("tr",null,de.a.createElement("td",{className:"c-accountplan__calculatorcell c-accountplan__calculatorcellcurrent ".concat(r)},"$",vy(t)),de.a.createElement("td",{className:"c-accountplan__calculatorcell c-accountplan__calculatorcellnew"},a?"$"+vy(n):null)))))};Vy.propTypes={currentCost:tt.a.number};var Fy=function(){return de.a.createElement("div",{className:"c-accountplan__contact-us"},de.a.createElement("b",null,"Need more throughput capacity?"),de.a.createElement("br",null),"Contact us for provisioning plans.",de.a.createElement("br",null),de.a.createElement("br",null),de.a.createElement(Hy,{buttonType:"btn-primary",showIcon:!1,onClick:function(){se.navigate("#support")},text:"Contact Support"}))};function Ky(e){return(Ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wy(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Xy(e,t){return!t||"object"!==Ky(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zy(e){return(zy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yy(e,t){return(Yy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qy=gy.NEW_BLUEMIX_PLANS["billing.tiered.bluemix.lite"],Jy=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Xy(this,zy(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yy(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",null,de.a.createElement("div",{className:"c-accountplan__wrapper flex-fill ",style:{fontSize:"16px"}},de.a.createElement("div",{className:"c-accountplan__plan-title"},"Lite plan capacity"),de.a.createElement("div",{className:"c-accountplan__plan-details"},de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},Qy.reads.toLocaleString()),de.a.createElement("br",null),"Reads",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},Qy.writes.toLocaleString()),de.a.createElement("br",null),"Writes",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},Qy.queries.toLocaleString()),de.a.createElement("br",null),"Global Queries",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},"1",de.a.createElement("font",{style:{fontSize:"1rem",verticalAlign:"baseline"}},"GB")),de.a.createElement("br",null),"Storage",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"limit")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--noborder c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value c-accountplan__plan-elem-value--total"},de.a.createElement("span",{style:{fontWeight:"bold"}},"Free")),de.a.createElement("br",null),"Cost",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per month")))))}}])&&Wy(n.prototype,a),r&&Wy(n,r),t}(ue.Component),Zy=n(412);n(376);function $y(e){return($y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tE(e){return(tE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aE(e,t){return(aE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rE=Jr.ConfirmButton,oE=gy.NEW_BLUEMIX_PLANS["billing.tiered.bluemix.standard"],iE=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=tE(t).call(this,e))||"object"!==$y(r)&&"function"!=typeof r?nE(a):r).onSliderChange=n.onSliderChange.bind(nE(n)),n.onPlanUpdateClick=n.onPlanUpdateClick.bind(nE(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aE(e,t)}(t,e),n=t,(a=[{key:"onPlanUpdateClick",value:function(e){e.preventDefault(),this.props.onPlanUpdateClick()}},{key:"onSliderChange",value:function(e){this.props.onPlanCapacityChange({id:"billing.tiered.bluemix.standard",multiple:e})}},{key:"warningPlanRecentlyChanged",value:function(){var e=this.props.lastPlanChangeDate;if(e){var t=new Date(e.getTime()+36e5);return de.a.createElement("div",{className:"c-accountplan__warning-updates-disabled"},de.a.createElement("span",{className:"fonticon fonticon-info-circled"}),"Your capacity has changed recently. You can make changes again after ",t.toLocaleTimeString(),".")}return null}},{key:"render",value:function(){var e=this.props,t=e.preselectedPlan,n=e.selectedPlan,a=e.isCcmPlanUpdateInProgress,r=e.previewMode,o=e.bluemixDashboardUrl,i=e.lastPlanChangeDate,s=t.multiple>0?t.multiple:1,c=n.multiple>0?n.multiple:1,l=s+10,u=Date.now()-i>36e5,d="Update";s===c?d="Current Capacity":c>l&&(d="Limit exceeded");var p=de.a.createElement(Dy,{tooltip_content:"Additional storage: $.0014/GB/hr or approximately $1/GB/month"}),f=de.a.createElement("span",null,"Approximate monthly cost assuming 730 hours per month on average, billing is prorated hourly. See ",de.a.createElement("a",{href:"https://cloud.ibm.com/estimator/review",target:"_blank",rel:"noopener noreferrer"},"IBM Cloud pricing calculator")," for localized currency.",de.a.createElement("br",null),"https://cloud.ibm.com/estimator/review"),h=de.a.createElement(Dy,{tooltip_content:f}),m=de.a.createElement("span",null,"Billing is prorated hourly. See ",de.a.createElement("a",{href:"https://cloud.ibm.com/estimator/review",target:"_blank",rel:"noopener noreferrer"},"IBM Cloud pricing calculator")," for localized currency.",de.a.createElement("br",null),"https://cloud.ibm.com/estimator/review"),g=de.a.createElement(Dy,{tooltip_content:m}),b={1:"Min",100:"Max"};1!=s&&(b[s]={label:"current",style:{top:-45}}),l<100&&!r&&(b[l]={label:"change limit",style:{top:-45}});var y=(c*oE.reads).toLocaleString(),E=(c*oE.writes).toLocaleString(),_=(c*oE.queries).toLocaleString(),v=vy(c*oE.priceHour,3),S=vy(c*oE.priceHour*730),N=r?"Standard Plan Calculator":"Select your capacity",D=r?null:de.a.createElement("div",{className:"c-accountplan__lite-plan-switch"},"Visit the IBM Cloud Dashboard to ",de.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},"switch to the Lite plan"),"."),O="c-accountplan__capacity-bt"+(r?" c-accountplan__capacity-bt--hidden":""),w="c-accountplan__capacity-slider"+(r?" c-accountplan__capacity-slider--wide":""),T="c-accountplan__plan-elem-value"+(r?"":" c-accountplan__plan-elem-value--hourly"),C=r?"12px":"16px",A=r||u?null:this.warningPlanRecentlyChanged(),I=r?null:de.a.createElement(ue.Fragment,null,"Increases in capacity are limited to 10 units (1000 reads/sec, 500 writes/sec, 50 global queries/sec) per change and once per hour. Decreases in capacity are not limited in scope but are limited to once per hour.",de.a.createElement("br",null));return de.a.createElement("div",{className:"c-accountplan__wrapper flex-fill ",style:{fontSize:C}},de.a.createElement("div",{className:"c-accountplan__plan-title"},N),de.a.createElement("div",{className:"c-accountplan__plan-details"},de.a.createElement("div",{className:"c-accountplan__plan-element"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},y),de.a.createElement("br",null),"Reads",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},E),de.a.createElement("br",null),"Writes",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},_),de.a.createElement("br",null),"Global Queries",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},20,de.a.createElement("font",{style:{fontSize:"1rem",verticalAlign:"baseline"}},"GB")),de.a.createElement("br",null),"Storage",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"included"),p),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--last c-accountplan__plan-element--noborder"},de.a.createElement("span",{className:T},de.a.createElement("span",{style:{fontWeight:"bold"}},de.a.createElement("font",{style:{fontSize:"0.5em",verticalAlign:"super"}},"$"),v,de.a.createElement("span",{style:{fontSize:"0.35em"}}," /hour",g))),de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-value--monthly"},de.a.createElement("span",{style:{fontWeight:"bold"}},de.a.createElement("font",{style:{fontSize:"0.5em",verticalAlign:"super"}},"$"),S,de.a.createElement("span",{style:{fontSize:"0.5em"}}," /month",h))))),de.a.createElement("div",{className:"c-accountplan__capacity-changer"},de.a.createElement("div",{className:w},de.a.createElement(Zy.a,{min:1,max:100,defaultValue:c,onChange:this.onSliderChange,marks:b,trackStyle:{backgroundColor:"#163960"},railStyle:{backgroundColor:"#CECECE"},dotStyle:{borderColor:"#CECECE"},handleStyle:{border:"1px solid #CECECE",backgroundColor:"white",height:24,width:12,marginLeft:-6,marginTop:-10,borderRadius:"8px",boxShadow:"0 2px 4px 0"}}),de.a.createElement("br",null),"Throughput Capacity"),de.a.createElement("div",{className:O},de.a.createElement(rE,{buttonType:"btn-primary",showIcon:!1,style:{width:160,fontSize:"1em"},onClick:this.onPlanUpdateClick,disabled:a||s===c||c>l||!u,text:d}))),A,de.a.createElement("div",{className:"c-accountplan__support"},I,"Require more throughput capacity? ",de.a.createElement("a",{href:"#support"},"Contact support"),"."),D)}}])&&eE(n.prototype,a),r&&eE(n,r),t}(ue.Component);function sE(e){return(sE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lE(e,t){return!t||"object"!==sE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uE(e){return(uE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dE(e,t){return(dE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}iE.propTypes={preselectedPlan:tt.a.object.isRequired,selectedPlan:tt.a.object.isRequired,onPlanUpdateClick:tt.a.func.isRequired,onPlanCapacityChange:tt.a.func.isRequired,isCcmPlanUpdateInProgress:tt.a.bool,isConfirmPlanModalVisible:tt.a.bool,isRedirectToBluemixModalVisible:tt.a.bool,previewMode:tt.a.bool,bluemixDashboardUrl:tt.a.string.isRequired};var pE=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lE(this,uE(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dE(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props.plan,t=de.a.createElement(Dy,{tooltip_content:"Additional storage: $.0014/GB/hr or approximately $1/GB/month"}),n=de.a.createElement("span",null,"Approximate monthly cost, billing prorated hourly. See ",de.a.createElement("a",{href:"https://cloud.ibm.com/estimator/review",target:"_blank",rel:"noopener noreferrer"},"IBM Cloud pricing calculator")," for localized currency.",de.a.createElement("br",null),"https://cloud.ibm.com/estimator/review"),a=de.a.createElement(Dy,{tooltip_content:n}),r=gy.CUSTOM_PLANS[e.id],o="N/A",i="N/A",s="N/A",c="N/A";return r&&(o=r.reads.toLocaleString(),i=r.writes.toLocaleString(),s=r.queries.toLocaleString(),c=vy(720*r.priceHour)),de.a.createElement("div",null,de.a.createElement("div",{className:"c-accountplan__wrapper flex-fill ",style:{fontSize:"16px"}},de.a.createElement("div",{className:"c-accountplan__plan-title"},"Current capacity (custom)"),de.a.createElement("div",{className:"c-accountplan__plan-details"},de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},o),de.a.createElement("br",null),"Reads",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},i),de.a.createElement("br",null),"Writes",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--grow"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},s),de.a.createElement("br",null),"Global Queries",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per second")),de.a.createElement("div",{className:"c-accountplan__plan-element"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value"},20,de.a.createElement("font",{style:{fontSize:"1rem",verticalAlign:"baseline"}},"GB")),de.a.createElement("br",null),"Storage",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"included"),t),de.a.createElement("div",{className:"c-accountplan__plan-element c-accountplan__plan-element--last c-accountplan__plan-element--noborder"},de.a.createElement("span",{className:"c-accountplan__plan-elem-value c-accountplan__plan-elem-value--total"},de.a.createElement("span",{style:{fontWeight:"bold"}},de.a.createElement("font",{style:{fontSize:"0.5em",verticalAlign:"super"}},"$"),c)),de.a.createElement("br",null),"Cost",de.a.createElement("br",null),de.a.createElement("span",{className:"c-accountplan__plan-elem-unit"},"per month"),a)),de.a.createElement("div",{className:"c-accountplan__support"},de.a.createElement("a",{href:"#support"},"Contact support")," to change throughput capacity.")))}}])&&cE(n.prototype,a),r&&cE(n,r),t}(ue.Component),fE=Jr.ConfirmButton,hE=gy.NEW_BLUEMIX_PLANS["billing.tiered.bluemix.standard"],mE=function(e){var t=e.onContinueClick,n=e.isVisible,a=e.onCancelClick,r=de.a.createElement(Ct.g.Body,null,de.a.createElement("div",null,"Changes between Lite and Standard plans must be made via the IBM Cloud Dashboard."),de.a.createElement("div",null,"You will be redirected to a new browser tab where you can complete your plan change."));return de.a.createElement(EE,{title:"Note",modalBody:r,confirmButtonLabel:"Continue",onConfirmClick:t,cancelButtonLabel:"Cancel",onCancelClick:a,isVisible:n})};mE.propTypes={onContinueClick:tt.a.func.isRequired,onCancelClick:tt.a.func.isRequired,isVisible:tt.a.bool.isRequired};var gE=function(e){var t=e.newCapacity,n=e.preselectedCapacity,a=e.onPlanSaveClick,r=e.onCancelClick,o=e.isVisible,i=e.isPlanUpdateInProgress,s=bE(n,t);return de.a.createElement(EE,{title:"Verify Capacity Change",modalBody:s,confirmButtonLabel:i?"Processing...":"Continue",onConfirmClick:a,cancelButtonLabel:"Cancel",onCancelClick:r,isVisible:o,isOperationInProgress:i})};gE.propTypes={newCapacity:tt.a.number.isRequired,preselectedCapacity:tt.a.number.isRequired,onPlanSaveClick:tt.a.func.isRequired,onCancelClick:tt.a.func.isRequired,isVisible:tt.a.bool.isRequired,isPlanUpdateInProgress:tt.a.bool.isRequired};var bE=function(e,t){var n={reads:e*hE.reads,writes:e*hE.writes,queries:e*hE.queries},a={reads:t*hE.reads,writes:t*hE.writes,queries:t*hE.queries};return de.a.createElement(Ct.g.Body,null,de.a.createElement("div",null,"You are changing your account’s capacity."),de.a.createElement("br",null),de.a.createElement("div",{className:"c-accountplan__modal-comparison"},de.a.createElement("div",{className:"c-accountplan__modal-comparison__left"},"Your ",de.a.createElement("b",null,"current")," capacity is:",de.a.createElement(yE,{planDetails:n})),de.a.createElement("div",{className:"c-accountplan__modal-comparison__right"},"Your ",de.a.createElement("b",null,"new")," capacity will be:",de.a.createElement(yE,{planDetails:a}))),de.a.createElement("br",null),de.a.createElement("div",null,"Provisioning changes can require up to 24 hours to complete."))},yE=function(e){var t=e.planDetails;return de.a.createElement("div",null,de.a.createElement("br",null),de.a.createElement("ul",null,de.a.createElement("li",null,t.reads.toLocaleString()," reads per second"),de.a.createElement("li",null,t.writes.toLocaleString()," writes per second"),de.a.createElement("li",null,t.queries.toLocaleString()," global queries per second")))},EE=function(e){var t=e.title,n=e.modalBody,a=e.confirmButtonLabel,r=e.onConfirmClick,o=e.cancelButtonLabel,i=e.onCancelClick,s=e.isVisible,c=e.isOperationInProgress;return de.a.createElement(Ct.g,{dialogClassName:"",show:s,onHide:i},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,t)),n,de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{style:{marginRight:"20px"},onClick:i,"data-bypass":"true",className:""},o),de.a.createElement(fE,{onClick:r,disabled:c,text:a})))};function _E(e){return(_E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function SE(e){return(SE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DE(e,t){return(DE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var OE=Jr.ConfirmButton,wE=yy.ccmStore,TE=hy.accountStore,CE=Jr.LoadLines,AE=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=SE(t).call(this,e))||"object"!==_E(r)&&"function"!=typeof r?NE(a):r).state=n.getStoreState(),n.onPlanSelectChange=n.onPlanSelectChange.bind(NE(n)),n.onPlanSaveClick=n.onPlanSaveClick.bind(NE(n)),n.enableConfirmModal=n.enableConfirmModal.bind(NE(n)),n.showRedirectToBluemixModal=n.showRedirectToBluemixModal.bind(NE(n)),n.openBluemixDashboardInNewTab=n.openBluemixDashboardInNewTab.bind(NE(n)),n.disableRedirectToBluemixModal=n.disableRedirectToBluemixModal.bind(NE(n)),n.disableConfirmModal=n.disableConfirmModal.bind(NE(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DE(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){return{isConfirmPlanModalVisible:wE.getIsConfirmPlanModalVisible(),isRedirectToBluemixModalVisible:wE.getIsRedirectToBluemixModalVisible(),isAuthenticated:TE.isUserAuthenticated(),selectedPlan:wE.getPlan(),isCcmPlanUpdateInProgress:wE.getIsCcmUpdateInProgress(),isOnLitePlan:wE.getIsOnLitePlan(),isNewBluemixPlan:wE.getIsNewBluemixPlan(),isCustomPlan:wE.getIsCustomPlan(),preselectedPlan:wE.getPreSelectedPlan(),lastPlanChangeDate:wE.getLastPlanChangeDate()}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){wE.on("change",this.onChange,this),TE.on("change",this.onChange,this),Ey.getLastPlanChangeDate()}},{key:"componentWillUnmount",value:function(){wE.off("change",this.onChange),TE.off("change",this.onChange)}},{key:"onPlanSelectChange",value:function(e){Ey.changeCcmPlan({plan:e})}},{key:"onPlanSaveClick",value:function(){Ey.saveNewPlan({plan:this.state.selectedPlan.id,plan_multiple:this.state.selectedPlan.multiple})}},{key:"enableConfirmModal",value:function(){Ey.showConfirmPlanSelectionModal()}},{key:"disableConfirmModal",value:function(){Ey.hideConfirmPlanSelectionModal()}},{key:"showRedirectToBluemixModal",value:function(e){e.preventDefault(),Ey.showRedirectToBluemixModal()}},{key:"disableRedirectToBluemixModal",value:function(){Ey.hideRedirectToBluemixModal()}},{key:"openBluemixDashboardInNewTab",value:function(){Ey.hideRedirectToBluemixModal(),window.open("https://cloud.ibm.com/resources","_blank")}},{key:"getLiteAndStandardPlanBoxes",value:function(){var e=this.state,t=e.selectedPlan,n=e.isOnLitePlan,a=e.isCcmPlanUpdateInProgress,r=e.preselectedPlan,o=e.isConfirmPlanModalVisible,i="https://cloud.ibm.com/resources";return n?[de.a.createElement(Py,{key:"1",enabled:n}),de.a.createElement("div",{key:"2",style:{position:"relative"},className:"flex-fill"},de.a.createElement("div",{className:"c-accountplan__disabledcover"}),de.a.createElement(By,{preselectedPlan:r.id,isConfirmPlanModalVisible:o,isCcmPlanUpdateInProgress:a,onPlanSelectChange:this.onPlanSelectChange,onPlanSaveClick:this.onPlanSaveClick,selectedPlan:t.id,enabled:!n}),de.a.createElement("div",{className:"c-accountplan__changeinbluemix"},"Changes between ",de.a.createElement("b",null,"Lite")," and ",de.a.createElement("b",null,"Standard")," plans must be made in the ",de.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"IBM Cloud Dashboard.")))]:[de.a.createElement(By,{key:"1",preselectedPlan:r.id,isConfirmPlanModalVisible:o,isCcmPlanUpdateInProgress:a,onPlanSelectChange:this.onPlanSelectChange,onPlanSaveClick:this.onPlanSaveClick,selectedPlan:t.id,enabled:!n}),de.a.createElement("div",{key:"2",style:{position:"relative"},className:"flex-fill"},de.a.createElement("div",{className:"c-accountplan__disabledcover"}),de.a.createElement(Py,{enabled:n}),de.a.createElement("div",{className:"c-accountplan__changeinbluemix"},"Changes between ",de.a.createElement("b",null,"Lite")," and ",de.a.createElement("b",null,"Standard")," plans must be made in the ",de.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"IBM Cloud Dashboard.")))]}},{key:"getNewBluemixPlanBoxes",value:function(){var e=this.state,t=e.selectedPlan,n=e.isOnLitePlan,a=e.isCcmPlanUpdateInProgress,r=e.preselectedPlan,o=e.isConfirmPlanModalVisible,i=e.isRedirectToBluemixModalVisible,s=e.lastPlanChangeDate,c=t.multiple>0?t.multiple:1,l=r.multiple>0?r.multiple:1,u=de.a.createElement("div",{className:"c-accountplan-header__upgrade-bt"},de.a.createElement(OE,{buttonType:"btn-primary",showIcon:!1,style:{width:225,fontSize:"0.8em"},onClick:this.showRedirectToBluemixModal,text:"Upgrade to Standard"}));return de.a.createElement("div",null,de.a.createElement("div",{className:"c-accountplan-header"},de.a.createElement("div",null,"You are subscribed to the ",de.a.createElement("span",{className:"c-accountplan-header-plan"},n?"Lite":"Standard"," Plan")),n?u:null),n?de.a.createElement(Jy,null):null,de.a.createElement("div",{style:{margin:n?20:0}}," "),de.a.createElement(iE,{preselectedPlan:r,selectedPlan:t,lastPlanChangeDate:s,isCcmPlanUpdateInProgress:a,onPlanCapacityChange:this.onPlanSelectChange,onPlanUpdateClick:this.enableConfirmModal,previewMode:n,bluemixDashboardUrl:"https://cloud.ibm.com/resources"}),de.a.createElement(gE,{newCapacity:c,preselectedCapacity:l,onCancelClick:this.disableConfirmModal,onPlanSaveClick:this.onPlanSaveClick,isVisible:o,isPlanUpdateInProgress:a}),de.a.createElement(mE,{onContinueClick:this.openBluemixDashboardInNewTab,onCancelClick:this.disableRedirectToBluemixModal,isVisible:i}))}},{key:"getCustomPlanBoxes",value:function(){var e=this.state.preselectedPlan;return de.a.createElement("div",null,de.a.createElement("div",{className:"c-accountplan-header"},de.a.createElement("div",null,"You are subscribed to the ",de.a.createElement("span",{className:"c-accountplan-header-plan"},"Standard Plan"))),de.a.createElement(pE,{plan:e}))}},{key:"render",value:function(){var e=this.state,t=e.isNewBluemixPlan,n=e.isCustomPlan,a=e.lastPlanChangeDate;if(!this.state.isAuthenticated)return de.a.createElement(CE,null);if(t&&!a)return de.a.createElement(CE,null);var r=null;return r=n?this.getCustomPlanBoxes():t?this.getNewBluemixPlanBoxes():this.getLiteAndStandardPlanBoxes(),de.a.createElement("div",{className:"c-accountplan"},de.a.createElement("div",{className:"flex flex-layout"},r))}}])&&vE(n.prototype,a),r&&vE(n,r),t}(ue.Component);function IE(e){return(IE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function RE(e,t){return!t||"object"!==IE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kE(e){return(kE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LE(e,t){return(LE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xE=yy.ccmStore,UE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=RE(this,kE(t).call(this,e))).state=n.getStoreState(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LE(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){return{isVisible:xE.isPlanExceededModalVisible(),isOnLitePlan:xE.getIsOnLitePlan()}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){xE.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){xE.off("change",this.onChange)}},{key:"viewPlan",value:function(){Ey.hidePlanExceededModal(),se.navigate("account/plan")}},{key:"close",value:function(e){e.preventDefault(),Ey.hidePlanExceededModal()}},{key:"getMessageForStandard",value:function(){return de.a.createElement("p",null,"Your account is currently very busy, and at the maximum number of operations allowed for your service plan.  Please retry this operation in a few moments, or ",de.a.createElement("a",{onClick:Ey.hidePlanExceededModal,href:"#account/plans"},"increase to the next service tier"),". You can view operation activity on the ",de.a.createElement("a",{onClick:Ey.hidePlanExceededModal,href:"#monitoring/usage"},"Activity page"),".")}},{key:"getMessageForLite",value:function(){return de.a.createElement("p",null,"Your account is currently very busy, and at the maximum number of operations allowed for your service plan. Please retry this operation in a few moments, or change to a standard plan. You can view operation activity on the ",de.a.createElement("a",{onClick:Ey.hidePlanExceededModal,href:"#monitoring/usage"},"Activity page"),".")}},{key:"render",value:function(){var e=this.state,t=e.isOnLitePlan,n=e.isVisible;return de.a.createElement(Ct.g,{dialogClassName:"",show:n,onHide:Ey.hidePlanExceededModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Database Operations at Capacity")),de.a.createElement(Ct.g.Body,null,t?this.getMessageForLite():this.getMessageForStandard()),de.a.createElement(Ct.g.Footer,null,de.a.createElement("button",{onClick:this.viewPlan.bind(this),"data-bypass":"true",className:"btn btn-secondary"},"View Plan")))}}])&&PE(n.prototype,a),r&&PE(n,r),t}(ue.Component),ME={round:vy,AccountPlan:AE,AccountPlanExceededModal:UE};le.versionAPI="2",le.hostDash=A.getServerUrl("/_api/v"+le.versionAPI);var jE={};jE.dashformat=ly.a.time.format("%m-%d-%Y"),jE.humanDateFormat=ly.a.time.format("%b. %e %H:%M"),jE.User=se.Model.extend({url:function(){return le.hostDash+"/user"},newUser:function(){var e=new Date;return jE.dashformat(e)==jE.dashformat(this.getJoinDate())},noHistory:function(){var e=new Date;return this.underThirty()&&e.getMonth()==this.getJoinDate().getMonth()},getTrialEnd:function(){var e=new Date(this.get("date"));return e.setDate(e.getDate()+30),e},underThirty:function(){return new Date<this.getTrialEnd()},isNew:function(){return!1},adminClusters:function(){return this.get("admin_clusters")},isGlobalAdmin:function(){return!0===this.get("admin")},adminCluster:function(){var e=this.adminClusters();return _.isEmpty(e)?null:e[0]},backupsEnabled:function(){var e=this.get("features");return!_.isUndefined(e)&&_.has(e,"backup")},isInChina:function(){var e=this.get("features");return!_.isUndefined(e)&&_.has(e,"restricted_china")&&_.has(e.restricted_china,"in_china")&&!0===e.restricted_china.in_china},clusterType:function(){return this.get("cluster_type")},warehousingEnabled:function(){if("multitenant"===this.clusterType())return!0;var e=this.get("features");return!_.isUndefined(e)&&_.has(e,"dashdb")&&e.dashdb.enterprise},hasGold:function(){return"gold"===this.get("support_level")},lastPasswordChange:function(){return this.get("last_pw_change")},signupDate:function(){return this.get("date")},partnersCheck:function(){return this.get("partners")},getJoinDate:function(){return new Date(this.get("date"))},getPartnerBluemix:function(){var e=this.get("partners");return e&&e.bluemix?e.bluemix:{}},isIBMCloudAccount:function(){var e=this.get("partners");return!(!e||!e.bluemix)},isMeteredPlan:function(){return"metered"===this.get("plan")},isIAMEnabled:function(){var e=this.getPartnerBluemix();return!(!e||!0!==e.iam_enabled)}}),jE.dashformat=ly.a.time.format("%m-%d-%Y"),jE.humanDateFormat=ly.a.time.format("%b. %e %H:%M"),jE.Bill=se.Model.extend({url:function(){return this.get("month")&&this.get("year")?le.hostDash+"/bill/"+this.get("year")+"/"+this.get("month"):le.hostDash+"/bill"},range:function(){return this.get("month")&&this.get("year")?new Date(this.get("year")+"/"+this.get("month")):new Date}}),jE.Requests=se.Model.extend({url:function(){return this.get("month")&&this.get("year")?le.hostDash+"/usage/requests/"+this.get("year")+"/"+this.get("month"):le.hostDash+"/usage/requests"},range:function(){return this.get("month")&&this.get("year")?new Date(this.get("year")+"/"+this.get("month")):new Date},keys:function(e){var t={GET:0,HEAD:1,PUT:2,POST:4,DELETE:5,COPY:6},n=_.partial(_.includes,["GET","HEAD"]),a=n;return"light"!=e&&(a=function(e){return!n(e)}),_.chain(this.get("requests")).values().map(_.keys).flatten().uniq().filter(a).sortBy((function(e){return t[e]})).value()}}),jE.DataVolume=se.Model.extend({url:function(){return this.get("month")&&this.get("year")?le.hostDash+"/usage/data_volume/"+this.get("year")+"/"+this.get("month"):le.hostDash+"/usage/data_volume"},range:function(){return this.get("month")&&this.get("year")?new Date(this.get("year")+"/"+this.get("month")):new Date},keys:function(){var e={dbs:0,search:1,views:2};return _.chain(this.get("data_vol")).values().map(_.keys).flatten().uniq().sortBy((function(t){return e[t]})).value()}}),jE.Prices=se.Model.extend({url:le.hostDash+"/prices"}),jE.getIcon=function(){return"fonticon-profile"},jE.hasNewAnnouncement=function(){return parseInt(le.utils.localStorageGet("announceBadge"),10)!==gy.ANNOUNCEMENT_VERSION};var HE=jE;function BE(){return(BE=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var GE={initAccountActivity:function(e,t,n){var a=new HE.Prices,r=new HE.DataVolume(e),o=new HE.Requests(e),i=new HE.Bill(e);se.dispatch({type:sy.ACCOUNTS_USAGE_FETCHING});var s=[a.fetchOnce(),r.fetchOnce(),o.fetchOnce(),i.fetchOnce()];se.when(s).then((function(e,a,r,o){se.dispatch({type:sy.ACCOUNTS_USAGE_RETURNED,options:{prices:e[0].mt_prices,dataVol:a[0],requests:r[0],bill:o[0],isInPast:t,freeLimit:n}})}),(function(){se.dispatch({type:sy.ACCOUNTS_USAGE_ERROR})}))},initUsageGraph:function(){var e=new HE.DataVolume(null);se.dispatch({type:sy.ACCOUNTS_USAGE_FETCHING}),e.fetchOnce().then((function(e){se.dispatch({type:sy.ACCOUNTS_USAGE_RETURNED,options:{dataVol:e}})}),(function(){se.dispatch({type:sy.ACCOUNTS_USAGE_ERROR})}))},fetchUser:function(){se.cloudantUser.fetchOnce()},userAuthenticated:function(e){se.dispatch({type:sy.USER_AUTHENTICATED,options:{username:e.get("username"),firstName:e.get("first_name"),lastName:e.get("last_name"),date:e.get("date"),email:e.get("email"),company:e.get("company"),cluster:e.get("cluster"),plan:e.get("plan"),plan_multiple:e.get("plan_multiple"),supportLevel:e.get("support_level"),isInChina:e.isInChina(),partners:BE({bluemix:{iam_enabled:!1}},e.get("partners")),domains:e.get("domains")}})},selectPage:function(e){se.dispatch({type:sy.ACCOUNTS_SELECT_PAGE,options:{page:e}})},saveProfile:function(e){se.dispatch({type:sy.ACCOUNTS_SAVING_START}),r.a.ajax({type:"PUT",url:"/_api/v2/user",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(e),success:function(){se.dispatch({type:sy.ACCOUNTS_SAVING_END}),se.addNotification({msg:"Your profile has been updated.",type:"success",clear:!0})},error:function(){se.dispatch({type:sy.ACCOUNTS_SAVING_END}),se.addNotification({msg:"There was an error updating your profile.",type:"error",clear:!0})}})},setFirstName:function(e){se.dispatch({type:sy.ACCOUNTS_SET_FIRST_NAME,options:{firstName:e}})},setLastName:function(e){se.dispatch({type:sy.ACCOUNTS_SET_LAST_NAME,options:{lastName:e}})},setCompany:function(e){se.dispatch({type:sy.ACCOUNTS_SET_COMPANY,options:{company:e}})},setEmail:function(e){se.dispatch({type:sy.ACCOUNTS_SET_EMAIL,options:{email:e}})},setCurrentPwd:function(e){se.dispatch({type:sy.ACCOUNTS_SET_CURRENT_PWD,options:{password:e}})},setNewPwd:function(e){se.dispatch({type:sy.ACCOUNTS_SET_NEW_PWD,options:{password:e}})},setNewPwdConfirmation:function(e){se.dispatch({type:sy.ACCOUNTS_SET_NEW_PWD_CONFIRMATION,options:{password:e}})},savePassword:function(e){se.dispatch({type:sy.ACCOUNTS_SAVING_START}),r.a.ajax({type:"PUT",url:"/_api/v2/user",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(e),success:function(){se.dispatch({type:sy.ACCOUNTS_SAVING_END}),se.dispatch({type:sy.ACCOUNTS_CLEAR_PWD_INFO}),se.addNotification({msg:"Your password has been updated.",type:"success",clear:!0})},error:function(){se.dispatch({type:sy.ACCOUNTS_SAVING_END}),se.dispatch({type:sy.ACCOUNTS_CLEAR_PWD_INFO}),se.addNotification({msg:"There was an error updating your password.",type:"error",clear:!0})}})},loadVirtualHosts:function(){r.a.ajax({type:"GET",url:le.hostDash+"/user/virtual_hosts",dataType:"json",success:function(e){var t=e.virtual_hosts.map((function(e){return{host:e[0],path:e[1]}}));se.dispatch({type:sy.VIRTUAL_HOSTS_LOADED,options:{success:!0,virtualHosts:t}})},error:function(){se.dispatch({type:sy.VIRTUAL_HOSTS_LOADED,options:{success:!1}})}})},setNewHostname:function(e){se.dispatch({type:sy.ACCOUNTS_SET_NEW_HOSTNAME,options:{hostname:e}})},setNewHostnamePath:function(e){se.dispatch({type:sy.ACCOUNTS_SET_NEW_HOSTNAME_PATH,options:{path:e}})},addVirtualHost:function(e){se.dispatch({type:sy.ACCOUNTS_SAVING_START}),r.a.ajax({type:"POST",url:le.hostDash+"/user/virtual_hosts",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(e),success:function(){se.dispatch({type:sy.ACCOUNTS_VIRTUAL_HOST_ADDED,options:{virtualHost:e}}),se.addNotification({msg:"The virtual host has been added.",type:"success",clear:!0})},error:function(){se.dispatch({type:sy.ACCOUNTS_SAVING_END}),se.addNotification({msg:"There was an error adding the virtual host.",type:"error",clear:!0})}})},showDeleteVirtualHostModal:function(e){se.dispatch({type:sy.ACCOUNTS_SHOW_DELETE_VIRTUAL_HOST_MODAL,options:{hostname:e}})},hideDeleteVirtualHostModal:function(){se.dispatch({type:sy.ACCOUNTS_HIDE_DELETE_VIRTUAL_HOST_MODAL})},deleteVirtualHost:function(e){r.a.ajax({type:"DELETE",url:le.hostDash+"/user/virtual_hosts",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({host:e}),success:function(){se.dispatch({type:sy.ACCOUNTS_VIRTUAL_HOST_DELETED,options:{hostname:e}}),se.addNotification({msg:"The virtual host has been deleted.",type:"success",clear:!0})},error:function(){se.dispatch({type:sy.ACCOUNTS_HIDE_DELETE_VIRTUAL_HOST_MODAL}),se.addNotification({msg:"There was an error deleting the virtual host.",type:"error",clear:!0})}})},selectUsageTab:function(e){se.dispatch({type:sy.ACCOUNTS_SELECT_USAGE_TAB,options:{tab:e}})}},qE=new(se.Store.extend({initialize:function(){this.reset()},reset:function(){this._isSavingLocation=!1,this._isSavingPaymentInfo=!1,this._paymentInfoLoaded=!1,this._originalDataLocation=null,this._plan=null,this._planExceededModalVisible=!1,this._newDataLocation=null,this._paymentInfo=null,this._paymentInfoLoadError=!1,this._ccName="",this._ccNum="",this._ccExpiryMonth="",this._ccExpiryYear="",this._ccCVC="",this._ccFormVisible=!1,this._selectedUsageTab=gy.USAGE_TABS.HEAVY},isSavingLocation:function(){return this._isSavingLocation},isSavingPaymentInfo:function(){return this._isSavingPaymentInfo},setIsSavingLocation:function(e){this._isSavingLocation=e},setUser:function(e){this._originalDataLocation=e.cluster},getDataLocation:function(){return this._newDataLocation?this._newDataLocation:this._originalDataLocation},getOriginalDataLocation:function(){return this._originalDataLocation},setNewDataLocation:function(e){this._newDataLocation=e},paymentInfoLoaded:function(){return this._paymentInfoLoaded},setPaymentInfoLoaded:function(e){this._paymentInfoLoaded=e},setPaymentInfo:function(e){this.setPaymentInfoLoaded(!0),this._paymentInfoLoadError=!e.success,e.success&&(this._paymentInfo=e.activeCard)},getPaymentInfo:function(){return this._paymentInfo},paymentLoadError:function(){return this._paymentInfoLoadError},getCCName:function(){return this._ccName},getCCNum:function(){return this._ccNum},getExpiryMonth:function(){return this._ccExpiryMonth},getExpiryYear:function(){return this._ccExpiryYear},getCVC:function(){return this._ccCVC},ccFormVisible:function(){return this._ccFormVisible},setPaymentField:function(e,t){var n={name:"_ccName",num:"_ccNum",expiryMonth:"_ccExpiryMonth",expiryYear:"_ccExpiryYear",cvc:"_ccCVC"};_.has(n,e)?this[n[e]]=t:console.error("invalid field name passed to setPaymentField()")},setIsSavingPaymentInfo:function(e){this._isSavingPaymentInfo=e},toggleCCFormVisibility:function(){this._ccFormVisible=!this._ccFormVisible},getSidebarItems:function(){var e=[{icon:"icon-bullhorn",title:"Announcements",pageName:gy.PAGE_ANNOUNCEMENTS,link:"account/announcements"},{icon:"fonticon-profile",title:"Profile",pageName:gy.PAGE_PROFILE,link:"account/info"},{icon:"icon-lock",title:"Password",pageName:gy.PAGE_PASSWORD,link:"account/password"},{icon:"cloudant-CORS",title:"CORS",pageName:gy.PAGE_CORS,link:"account/cors"}];return e.push({icon:"icon-credit-card",title:"Credit Card",pageName:gy.PAGE_PAYMENT,link:"account/payment"}),e.push({icon:"icon-map-marker",title:"Location for your Data",pageName:gy.PAGE_DATA_LOCATION,link:"account/data-location"}),e},getSelectedUsageTab:function(){return this._selectedUsageTab},selectedUsageTab:function(e){this._selectedUsageTab=e},dispatch:function(e){switch(e.type){case sy.USER_AUTHENTICATED:this.setUser(e.options);break;case sy.ACCOUNTMT_SET_NEW_DATA_LOCATION:this.setNewDataLocation(e.options.location);break;case sy.ACCOUNTMT_LOCATION_CHANGE_REQUEST_START:this.setIsSavingLocation(!0);break;case sy.ACCOUNTMT_LOCATION_CHANGE_REQUEST_COMPLETE:this.setIsSavingLocation(!1);break;case sy.ACCOUNTMT_PAYMENT_INFO_REQUEST_START:this.setPaymentInfoLoaded(!1);break;case sy.ACCOUNTMT_PAYMENT_INFO_REQUEST_COMPLETE:this.setPaymentInfo(e.options);break;case sy.ACCOUNTMT_UPDATE_PAYMENT_FIELD:this.setPaymentField(e.options.field,e.options.value);break;case sy.ACCOUNTMT_SAVE_PAYMENT_INFO_START:this.setIsSavingPaymentInfo(!0);break;case sy.ACCOUNTMT_SAVE_PAYMENT_INFO_COMPLETE:this.setIsSavingPaymentInfo(!1);break;case sy.ACCOUNTMT_TOGGLE_CC_FORM_VISIBILITY:this.toggleCCFormVisibility();break;case sy.ACCOUNTMT_SELECT_USAGE_TAB:this.selectedUsageTab(e.options.tab);break;default:return}this.triggerChange()}}));qE.dispatchToken=se.dispatcher.register(qE.dispatch.bind(qE));var VE={accountMTStore:qE},FE=function(e){var t=e.ccOnFile,n=e.isCurrentlyFree,a=e.freeLimit,r=e.underThirty,o=e.trialEnd;if(r){var i=h()(o).format("MMM D");return de.a.createElement("div",{className:"alert alert-info"},de.a.createElement("p",null,"Lucky you! Your first 30 days are free. We won’t start charging you for usage until ",i,". ",de.a.createElement("a",{href:"#account/payment"},"Add a credit card.")))}return n?de.a.createElement("div",{className:"alert alert-info"},"We’ll not charge you for this month if your usage remains below $",a,"."):de.a.createElement("div",{className:"alert"},"Your usage this month has exceeded ",de.a.createElement("b",null,"$",a),". At the end of this billing period (end of the month), we will charge you for your usage. ",t?null:de.a.createElement("a",{href:"#account/payment"},"Add a credit card."))};FE.propTypes={underThirty:tt.a.bool.isRequired,freeLimit:tt.a.number.isRequired,isCurrentlyFree:tt.a.bool.isRequired,ccOnFile:tt.a.bool,trialEnd:tt.a.object};var KE=FE;function WE(e){return(WE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XE(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zE(e,t){return!t||"object"!==WE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YE(e){return(YE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QE(e,t){return(QE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JE=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zE(this,YE(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QE(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=(this.props.isInPast?h()().subtract(1,"months"):h()()).endOf("month").format("MMM D");return de.a.createElement("div",null,"For period ending ",de.a.createElement("strong",null,e),de.a.createElement("span",{className:"cost green"},de.a.createElement("span",{className:"super"},"$"),this.props.total))}}])&&XE(n.prototype,a),r&&XE(n,r),t}(de.a.Component);function ZE(e){return(ZE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $E(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function e_(e,t){return!t||"object"!==ZE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function t_(e){return(t_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n_(e,t){return(n_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(JE,"propTypes",{total:tt.a.string.isRequired,isInPast:tt.a.bool.isRequired});var a_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e_(this,t_(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n_(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props.selectedTab,t="span3"+(e===gy.USAGE_TABS.HEAVY?" active":""),n="span3"+(e===gy.USAGE_TABS.LIGHT?" active":""),a="span3"+(e===gy.USAGE_TABS.DATA_VOLUME?" active":"");return de.a.createElement("div",{id:"bill",className:"row-fluid"},de.a.createElement("ul",{className:"nav nav-tabs"},de.a.createElement("li",{className:t,style:{marginLeft:0},onClick:function(){return GE.selectUsageTab(gy.USAGE_TABS.HEAVY)}},de.a.createElement("div",{className:"indicator-wrapper"},de.a.createElement("div",{className:"indicator"}),de.a.createElement("div",{className:"content"},de.a.createElement("p",null,"Heavy HTTP"),de.a.createElement("span",{className:"cost"},de.a.createElement("span",{className:"super"},"$"),this.props.bill.http_heavy.cost),de.a.createElement("div",{className:"operator"},"+")))),de.a.createElement("li",{className:n,onClick:function(){return GE.selectUsageTab(gy.USAGE_TABS.LIGHT)}},de.a.createElement("div",{className:"indicator-wrapper"},de.a.createElement("div",{className:"indicator"}),de.a.createElement("div",{className:"content"},de.a.createElement("p",null,"Light HTTP"),de.a.createElement("span",{className:"cost"},de.a.createElement("span",{className:"super"},"$"),this.props.bill.http_light.cost),de.a.createElement("div",{className:"operator"},"+")))),de.a.createElement("li",{className:a,onClick:function(){return GE.selectUsageTab(gy.USAGE_TABS.DATA_VOLUME)}},de.a.createElement("div",{className:"indicator-wrapper"},de.a.createElement("div",{className:"indicator"}),de.a.createElement("div",{className:"content"},de.a.createElement("p",null,"Data Storage"),de.a.createElement("span",{className:"cost"},de.a.createElement("span",{className:"super"},"$"),this.props.bill.data_volume.cost),de.a.createElement("div",{className:"operator"}," = ")))),de.a.createElement("li",{className:"span3 total"},de.a.createElement("div",{id:"bill-summary"},de.a.createElement(JE,{isInPast:this.props.isInPast,total:this.props.bill.total})),de.a.createElement("div",{id:"bill-message"}),de.a.createElement("div",{className:"learn-more"},de.a.createElement("a",{href:"https://cloudant.com/pricing/"},"Learn about Cloudant pricing")))))}}])&&$E(n.prototype,a),r&&$E(n,r),t}(de.a.Component);!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(a_,"propTypes",{selectedTab:tt.a.string.isRequired,bill:tt.a.object.isRequired,isInPast:tt.a.bool.isRequired});var r_={isCcmPlan:function(e){return/^billing\.tiered\./.test(e)},inPast:function(e,t){return void 0!==e&&void 0!==t},getFreeLimit:function(e){var t;return e&&e.month&&e.year?(e.month=+e.month-1,t=new Date(e.year,e.month)):t=new Date,t.getFullYear()<2015?5:50},bytesToGb:function(e){return ly.a.format(",.3f")(9.3132e-10*e)}};function o_(e){return(o_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s_(e,t){return!t||"object"!==o_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c_(e){return(c_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l_(e,t){return(l_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s_(this,c_(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l_(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.count,n=e.label,a=e.costString,r=e.cost,o=e.isInPast,i=this.props.numberFormatter(t),s=o?"last month":"so far this month";return de.a.createElement("p",null,i," ",n," ",s," @ ",a," = $",r)}}])&&i_(n.prototype,a),r&&i_(n,r),t}(de.a.Component);u_(d_,"propTypes",{count:tt.a.number.isRequired,label:tt.a.string.isRequired,costString:tt.a.string.isRequired,cost:tt.a.string.isRequired,numberFormatter:tt.a.func}),u_(d_,"defaultProps",{numberFormatter:ly.a.format(".2s")});var p_=n(139),f_=n.n(p_),h_=function(e){var t=e.el,n=e.data,a=e.height,r=e.width,o=e.label,s=e.yFormat,c=void 0===s?ly.a.format("s"):s,l=ly.a.scale.category20().range(["#1f77b4","#aec7e8","#04BA8F","#ffbb78"]),u=40,d=60,p=r-d-25,f=a-u-30,m=ly.a.time.scale().range([0,p]),g=ly.a.scale.linear().range([f,0]),b=p>768?10:5;l.domain(n.map((function(e){return e.name})));var y=function(e){return e.reduce((function(e,t){return t.values.map((function(t,n){return e[n]?t.value+e[n]:t.value}))}),[])},E=y(n),_=ly.a.max(E);m.domain(function(e){var t=h.a.utc(e[0].values[0].date);return[t.clone().startOf("month"),t.endOf("month").startOf("day")]}(n)),g.domain([0,1.1*_]);var v=ly.a.svg.axis().scale(m).ticks(b).tickValues(function(e,t,n){var a=parseInt(t/e,10);return Object(i.range)(e).map((function(e,r){return e===length-1?n.invert(t):n.invert(a*r)}))}(b,p,m)).tickFormat((function(e){return h.a.utc(e).format("M/DD")})).orient("bottom"),S=E.filter((function(e){return 0!==e})).length,N=ly.a.svg.axis().scale(g).orient("left").ticks(S>1?6:3).tickSize(-p).tickFormat((function(e){return c(e,_)})),D=ly.a.svg.area().x((function(e){return m(h.a.parseZone(e.date))})).y0((function(e){return g(e.y0)})).y1((function(e){return g(e.y0+e.y)})),O=ly.a.layout.stack().values((function(e){return e.values})).y((function(e){return e.isHidden?0:e.value})).x((function(e){return h.a.parseZone(e.date)})),w=ly.a.select(t).append("svg").attr("class","billing-graph").attr("width",r).attr("height",a),T=w.append("g").attr("transform","translate(".concat(d,", ").concat(u,")")),C=function(e,t){return e.forEach((function(e){return e.isHidden=t}))};!function(e){var t=e.svg,n=e.colors,a=e.data,r=e.x,o=e.y,s=e.width,c=e.onClick,l=s/4,u=ly.a.scale.ordinal().rangeRoundBands([r,r-l*a.length*2],.1).domain(Object(i.range)(0,a.length)),d=u.rangeBand(),p=t.append("g").attr("class","legend pointer").selectAll(".legend").data(a),f=function(e){e=e.split(" ").join(".");var t=ly.a.select(".rl.".concat(e)),a=ly.a.select(".tl.".concat(e));if(.7==t.style("fill-opacity"))return t.style("fill-opacity",0).style("stroke",n(e)),a.style("fill",n(e)),void(c&&c("off",e));t.style("fill",(function(e){return n(e)})).style("fill-opacity",.7),a.style("fill","#fff"),c&&c("on",e)},h=p.enter();h.append("rect").attr("class",(function(e){return e+" rl cursor-pointer"})).attr("width",d).attr("height",28).attr("y",o).attr("x",(function(e,t){return u(t)})).style("fill",(function(e){return n(e)})).style("fill-opacity",.7).attr("rx","2").attr("ry","2").on("click",(function(e){return f(e)})),h.append("text").attr("class",(function(e){return e+" tl cursor-pointer"})).attr("x",(function(e,t){return d/2+u(t)})).attr("y",20).style("text-anchor","middle").style("fill","#fff").text((function(e){return e.toUpperCase()})).on("click",(function(e){return f(e)}))}({svg:w,colors:l,data:n.map((function(e){return e.name})),y:0,x:r,width:Math.abs(p/2),onClick:function(e,t){var a=n.find((function(e){var n=t.split(".").join(" ");return e.name===n}));"off"===e?(a.isHidden=!0,C(a.values,!0)):(a.isHidden=!1,C(a.values,!1)),P(n)}}),T.append("g").attr("class","x axis").attr("transform","translate(0,"+f+")").call(v).append("text").attr("y",25).attr("x",p/2).attr("dy",".32em").style("text-anchor","middle").attr("class","stroke-gray").text(o.x),T.append("g").attr("class","y axis").call(N).append("text").attr("transform","rotate(-90)").attr("y",-54).attr("x",-f/2).attr("dy",".32em").style("text-anchor","middle").text(o.y);var A=f_()().attr("class","d3-tip");T.call(A);var I=T.selectAll(".stacked-area").data(O(n));I.exit().remove(),I.enter().append("path").attr("class",(function(e){return"".concat(e.name," stacked-area opacity-7 no-stroke")}));var P=function(e){I.data(O(e)).transition().duration(200).attr("d",(function(e){return D(e.values)})).style("fill",(function(e){return l(e.name)})),function(e){T.selectAll("rect.tips").remove();var t,n=T.selectAll(".tips").data(y(e.filter((function(e){return!e.isHidden}))));n.enter().append("rect").attr("class","tips").attr("width",20).attr("height",(function(e){return g(0)-g(e)})).attr("x",(function(t,n){return m(h.a.parseZone(e[0].values[n].date))-10})).attr("y",(function(e){return g(e)})).attr("fill","red").style("opacity",0).on("mouseover",(function(){for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];t=a[1],A.attr("class","d3-tip d3-tip-billing-size-".concat(e.length)),A.show.apply(this,a)})).on("mouseout",(function(){for(var e=this,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];var o=a[1];setTimeout((function(){o===t&&A.hide.apply(e,a)}),300)})),A.html((function(t,n){var a=e.reduce((function(e,t){return e+'<li style="color:'.concat(l(t.name),'">').concat(t.name.toUpperCase(),": ").concat(c(t.values[n].value,_),"</li>")}),"");return'<ul class="no-list-style center no-margin-left no-padding-left">'.concat(a,"</ul>")}))}(O(e))};P(n)};n(725);function m_(e){return(m_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function b_(e){return(b_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E_(e,t){return(E_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function __(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v_=Jr.LoadLines,S_=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return a=this,r=(e=b_(t)).call.apply(e,[this].concat(s)),n=!r||"object"!==m_(r)&&"function"!=typeof r?y_(a):r,__(y_(n),"chartWidth",0),__(y_(n),"getEl",(function(){return n.rootNode})),__(y_(n),"removeChart",(function(){ly.a.select(n.getEl()).selectAll("svg").remove()})),__(y_(n),"getElWidth",(function(){return n.getEl().getBoundingClientRect().width})),__(y_(n),"renderChart",(function(e){var t=e.data,a=e.fudgeUnits,r=e.yLabel,o=e.yFormat,i=void 0===o?function(e){return ly.a.format(".3s")(ly.a.round(e))}:o;a&&(i=function(e,t){var n=py(t);return ly.a.round(e/n.pow2,1)+""+n.unit}),n.chartWidth=n.getElWidth(),h_({el:n.getEl(),data:t,height:230,width:n.chartWidth<10?700:n.chartWidth,label:{x:"",y:r},yFormat:i})})),__(y_(n),"resizeHandler",(function(){Object(i.debounce)((function(){n.removeChart(),n.renderChart(n.props)}),250)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E_(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.removeChart(),this.props.fetching||this.renderChart(this.props),window.addEventListener("resize",this.resizeHandler)}},{key:"shouldComponentUpdate",value:function(e){return!e.fetching&&(this.props.fetching&&!e.fetching&&(ly.a.select(this.getEl()).select(".loading-lines").remove(),this.removeChart()),(this.props.shouldUpdate(e,this.props)||this.chartWidth!==this.getElWidth())&&(this.removeChart(),this.renderChart(e)),!1)}},{key:"componentWillUnmount",value:function(){this.removeChart(),window.removeEventListener("resize",this.resizeHandler)}},{key:"render",value:function(){var e=this;return de.a.createElement("div",{ref:function(t){return e.rootNode=t}},this.props.fetching?de.a.createElement(v_,null):"",de.a.createElement("div",{className:"billing-chart"}))}}])&&g_(n.prototype,a),r&&g_(n,r),t}(de.a.Component);__(S_,"defaultProps",{fudgeUnits:!0,yLabel:""}),__(S_,"propTypes",{data:tt.a.array.isRequired,fetching:tt.a.bool.isRequired,shouldUpdate:tt.a.func.isRequired});var N_=S_;function D_(e){return(D_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w_(e,t){return!t||"object"!==D_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T_(e){return(T_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C_(e,t){return(C_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),w_(this,T_(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C_(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.hasError,n=e.storagePrice,a=e.heavyPricePer100,r=e.lightPricePer500,o=e.bill,i=o.http_heavy,s=o.http_light,c=o.data_volume,l=e.lightRequestData,u=e.heavyRequestData,d=e.dataVolumeData,p=e.selectedTab,f=e.fetchingAccountUsageData,h=e.isInPast;if(t)return de.a.createElement("div",{id:"usage"},de.a.createElement("div",{className:"results tab-content"},de.a.createElement("div",{id:"heavy-tab",className:"tab-pane active"},"Sorry, something has gone wrong. :("),de.a.createElement("div",{id:"light-tab",className:"tab-pane"},"Sorry, something has gone wrong. :("),de.a.createElement("div",{id:"data-tab",className:"tab-pane"},"Sorry, something has gone wrong. :(")));var m="$".concat(a,"/100 requests"),g="$".concat(r,"/500 requests"),b="$".concat(n,"/GB/month"),y="tab-pane"+(p===gy.USAGE_TABS.HEAVY?" active":""),E="tab-pane"+(p===gy.USAGE_TABS.LIGHT?" active":""),_="tab-pane"+(p===gy.USAGE_TABS.DATA_VOLUME?" active":"");function v(e,t){return e.data[0].values[0].date!==t.data[0].values[0].date}return de.a.createElement("div",{id:"usage"},de.a.createElement("div",{className:"results tab-content"},de.a.createElement("div",{id:"heavy-tab",className:y},de.a.createElement("p",null,"Heavy HTTP requests are more processing-intensive than light HTTP requests."),de.a.createElement("div",{id:"heavy",className:"graph"},de.a.createElement(N_,{shouldUpdate:v,fetching:f,data:u,fudgeUnits:!1,yLabel:"Requests"})),de.a.createElement(d_,{isInPast:h,cost:i.cost,count:i.count,label:"heavy requests",costString:m})),de.a.createElement("div",{id:"light-tab",className:E},de.a.createElement("p",null,"Light HTTP requests require less processing than heavy HTTP requests."),de.a.createElement("div",{id:"light",className:"graph"},de.a.createElement(N_,{shouldUpdate:v,fetching:f,data:l,fudgeUnits:!1,yLabel:"Requests"})),de.a.createElement(d_,{isInPast:h,cost:s.cost,count:s.count,label:"light requests",costString:g})),de.a.createElement("div",{id:"data-tab",className:_,onClick:function(){return GE.selectUsageTab(gy.USAGE_TABS.DATA_VOLUME)}},de.a.createElement("p",null,"The graph reflects database, search index, geospatial index and view index storage, based on hourly snapshots of your account."),de.a.createElement("div",{id:"data",className:"graph"},de.a.createElement(N_,{shouldUpdate:v,fetching:f,data:d,fudgeUnits:!0,yLabel:"Data Storage"})),de.a.createElement(d_,{isInPast:h,cost:c.cost,count:c.count,label:"GB stored",costString:b,numberFormatter:r_.bytesToGb}),de.a.createElement("p",null,"Storing 1GB for a month costs $",n,". Your data cost is calculated pro rata, based on hourly snapshots of the data in your account."))))}}])&&O_(n.prototype,a),r&&O_(n,r),t}(de.a.Component);function I_(e){return(I_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function R_(e){return(R_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L_(e,t){return(L_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(A_,"propTypes",{hasError:tt.a.bool.isRequired,selectedTab:tt.a.string.isRequired,storagePrice:tt.a.string.isRequired,heavyPricePer100:tt.a.string.isRequired,lightPricePer500:tt.a.string.isRequired,bill:tt.a.object.isRequired,lightRequestData:tt.a.array.isRequired,heavyRequestData:tt.a.array.isRequired,dataVolumeData:tt.a.array.isRequired,fetchingAccountUsageData:tt.a.bool.isRequired,isInPast:tt.a.bool.isRequired});var U_=hy.accountStore,M_=VE.accountMTStore,j_=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=R_(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==I_(r)&&"function"!=typeof r?k_(a):r,x_(k_(n),"getStoreState",(function(){return{isLoaded:U_.isActivityLoaded(),hasError:U_.hasUsageDataLoadError(),bill:U_.getBill(),storagePrice:U_.getFormattedStoragePrice(),heavyPricePer100:U_.getHeavyPricePer100(),lightPricePer500:U_.getLightPricePer500(),selectedUsageTab:M_.getSelectedUsageTab(),noUsage:U_.hasNoUsage(),dataVolume:U_.getDataVolume(),dataVolumeData:U_.getDataVolumeData(),heavyRequestData:U_.getHeavyRequestData(),lightRequestData:U_.getLightRequestData(),fetchingAccountUsageData:U_.fetchingAccountUsageData(),user:se.cloudantUser,isInPast:U_.usageInPast(),freeLimit:U_.usageFreeLimit()}})),x_(k_(n),"onChange",(function(){n.setState(n.getStoreState())})),x_(k_(n),"navigate",(function(e){var t="#/account/usage";if("last-month"===e){var n=new Date,a="0"===n.getMonth()?"12":n.getMonth();t+="/"+("0"===n.getMonth()?parseInt(n.getFullYear(),0)-1:n.getFullYear())+"/"+a}se.navigate(t)})),x_(k_(n),"getHistory",(function(){if(n.state.user.noHistory())return de.a.createElement("h2",{className:"account-no-history"},"Here's your usage so far this month.");var e="btn"+(n.state.isInPast?"":" active"),t="btn"+(n.state.isInPast?" active":"");return de.a.createElement("div",{className:"lead usage-links"},"Your usage:",de.a.createElement("div",{className:"btn-group usage-links-toggle","data-toggle":"buttons-radio"},de.a.createElement("button",{type:"button",className:e,onClick:function(){return n.navigate("this-month")}},"So far this month"),de.a.createElement("button",{type:"button",className:t,onClick:function(){return n.navigate("last-month")}},"Last month")))})),x_(k_(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L_(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){U_.on("change",this.onChange,this),M_.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){U_.off("change",this.onChange),M_.off("change",this.onChange)}},{key:"render",value:function(){if(!this.state.isLoaded)return de.a.createElement(Jr.LoadLines,null);if(this.state.noUsage&&this.state.user.newUser())return de.a.createElement("div",{className:"alert alert-block"},de.a.createElement("p",{className:"new-user"},"Hi ",this.state.user.username,", we haven't yet taken a snapshot of your usage, so we don't yet have usage to report to you. We will be able to show you your usage within the hour."),de.a.createElement("p",null,"Learn about ",de.a.createElement("a",{href:"https://cloudant.com/pricing"},"Cloudant pricing"),"."));var e=parseFloat(this.state.bill.total)<parseFloat(this.state.freeLimit);return de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("header",null,this.getHistory(),de.a.createElement("div",{id:"messaging"},de.a.createElement(KE,{underThirty:this.state.user.underThirty(),ccOnFile:this.state.user.get("onFile"),trialEnd:this.state.user.getTrialEnd(),freeLimit:this.state.freeLimit,isCurrentlyFree:e}))),de.a.createElement("section",{id:"summary",className:"activity-pane"},de.a.createElement("div",{id:"tabs-container"},de.a.createElement(a_,{selectedTab:this.state.selectedUsageTab,isInPast:this.state.isInPast,bill:this.state.bill}),de.a.createElement(A_,{isInPast:this.state.isInPast,selectedTab:this.state.selectedUsageTab,hasError:this.state.hasError,storagePrice:this.state.storagePrice,heavyPricePer100:this.state.heavyPricePer100,lightPricePer500:this.state.lightPricePer500,dataVolumeData:this.state.dataVolumeData,heavyRequestData:this.state.heavyRequestData,lightRequestData:this.state.lightRequestData,fetchingAccountUsageData:this.state.fetchingAccountUsageData,bill:this.state.bill}))))}}])&&P_(n.prototype,a),r&&P_(n,r),t}(de.a.Component);function H_(e){return(H_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function G_(e){return(G_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V_(e,t){return(V_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F_(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K_=hy.accountStore,W_=Jr.LoadLines,X_=function(e){var t=e.label,n=e.url;return de.a.createElement("div",{className:"settings-content"},de.a.createElement("div",{className:"settings-name"},t),de.a.createElement("div",{className:"settings-value"},de.a.createElement("a",{href:n,target:"_blank",rel:"noreferrer noopener",className:"opens-new-window"},n)))},z_=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=G_(t).call(this),e=!a||"object"!==H_(a)&&"function"!=typeof a?q_(n):a,F_(q_(e),"getStoreState",(function(){return{isLoading:!K_.isUserAuthenticated(),accountCRN:K_.getAccountCRN(),location:K_.getLocation(),username:K_.getUsername(),legacyCredentialsEnabled:K_.isLegacyCredsEnabled(),dedicatedHwCRN:K_.getDedicatedHwCRN(),domains:K_.getDomains()}})),F_(q_(e),"onChange",(function(){e.setState(e.getStoreState())})),e.state=e.getStoreState(),e.showCopiedMessage=e.showCopiedMessage.bind(q_(e)),e}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V_(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){K_.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){K_.off("change",this.onChange)}},{key:"showCopiedMessage",value:function(e){se.addNotification({msg:"The ".concat(e," has been copied to your clipboard."),type:"info",clear:!0})}},{key:"getAuthMethod",value:function(){var e=de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides?topic=cloudant-ibm-cloud-identity-and-access-management-iam-",target:"_blank",rel:"noreferrer noopener",className:"opens-new-window"},"IBM Cloud IAM (Identity and Access Management)"),t=de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-authentication",target:"_blank",rel:"noreferrer noopener",className:"opens-new-window"},"Cloudant credentials");return this.state.accountCRN?this.state.legacyCredentialsEnabled?de.a.createElement("span",null,t," and ",e):e:t}},{key:"dedicatedHardwarePanel",value:function(){var e=this;return this.state.dedicatedHwCRN?de.a.createElement("div",{className:"cloudant-bx--tile settings-tile"},de.a.createElement("div",{className:"settings-header"},"Dedicated Hardware"),de.a.createElement("div",{className:"settings-content settings-content--last"},de.a.createElement("div",{className:"settings-name"},"CRN"),de.a.createElement("div",{className:"settings-value"},de.a.createElement("span",{id:"dedi_hw_crn"},this.state.dedicatedHwCRN),de.a.createElement(Jr.Copy,{uniqueKey:this.state.dedicatedHwCRN.replace(/[:/-]/g,""),onClipboardClick:function(){e.showCopiedMessage("dedicated hardware CRN")},text:this.state.dedicatedHwCRN})))):null}},{key:"crnTooltip",value:function(){return this.tooltip("Cloud Resource Names (CRNs) uniquely identify IBM Cloud resources. A CRN is used to specify a resource in a way that is unambiguous and guaranteed to be globally unique, such as in IBM Cloud Identity and Access Management (IAM) policies and services listed in the cloud catalog.")}},{key:"tooltip",value:function(e){var t=de.a.createElement(Ct.l,{id:"graveyard-tooltip"},e);return de.a.createElement(Ct.i,{placement:"top",overlay:t},de.a.createElement("i",{className:"icon icon-question-sign"}))}},{key:"crnRow",value:function(){var e=this;return this.state.accountCRN?de.a.createElement("div",{className:"settings-content"},de.a.createElement("div",{className:"settings-name"},"CRN ",this.crnTooltip()),de.a.createElement("div",{className:"settings-value"},de.a.createElement("span",{id:"account_crn"},this.state.accountCRN),de.a.createElement(Jr.Copy,{uniqueKey:this.state.accountCRN.replace(/[:/-]/g,""),onClipboardClick:function(){e.showCopiedMessage("CRN")},text:this.state.accountCRN}))):null}},{key:"getEndpoints",value:function(){if(!this.state.domains||0===this.state.domains.length){var e="https://".concat(this.state.username,".cloudant.com");return de.a.createElement(X_,{label:"Endpoint",url:e,key:"default_domain"})}return this.state.domains.filter((function(e){return e})).map((function(e){var t="Endpoint";"internal"===e.type?t="Internal ".concat(t):"external"===e.type&&(t="External ".concat(t)),e.preferred&&(t+=" (preferred)");var n="https://".concat(e.domain);return de.a.createElement(X_,{label:t,url:n,key:t})}))}},{key:"render",value:function(){return this.state.isLoading?de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("div",{className:"activity-pane"},de.a.createElement(W_,null))):de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("div",{className:"activity-pane"},de.a.createElement("div",{className:"cloudant-bx--tile settings-tile"},de.a.createElement("div",{className:"settings-header"},"Deployment details"),this.crnRow(),de.a.createElement("div",{className:"settings-content"},de.a.createElement("div",{className:"settings-name"},"Location"),de.a.createElement("div",{className:"settings-value"},this.state.location)),this.getEndpoints(),de.a.createElement("div",{className:"settings-content"},de.a.createElement("div",{className:"settings-name"},"Authentication",de.a.createElement("br",null),"method"),de.a.createElement("div",{className:"settings-value"},this.getAuthMethod())),de.a.createElement("div",{className:"settings-content settings-content--last"},de.a.createElement("div",{className:"settings-name"},"Disk encryption"),de.a.createElement("div",{className:"settings-value"},"Yes"))),this.dedicatedHardwarePanel()))}}])&&B_(n.prototype,a),r&&B_(n,r),t}(de.a.Component);function Y_(e){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q_(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function J_(e){return(J_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $_(e,t){return($_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ev(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tv=hy.accountStore,nv=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=J_(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Y_(r)&&"function"!=typeof r?Z_(a):r,ev(Z_(n),"getStoreState",(function(){return{page:tv.getPage()}})),ev(Z_(n),"onChange",(function(){n.setState(n.getStoreState())})),ev(Z_(n),"getSidebarItems",(function(){return n.props.sidebarItems.map((function(e,t){return de.a.createElement("li",{className:n.state.page===e.pageName?"active":"",key:t},de.a.createElement("a",{href:"#"+e.link},de.a.createElement("span",{className:e.icon}),de.a.createElement("span",{className:"nav-label"},e.title)))}))})),ev(Z_(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$_(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){tv.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){tv.off("change",this.onChange)}},{key:"render",value:function(){return de.a.createElement("nav",{className:"sidenav simple-sidenav"},de.a.createElement("ul",{className:"nav nav-list"},this.getSidebarItems()))}}])&&Q_(n.prototype,a),r&&Q_(n,r),t}(de.a.Component);function av(e){return(av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ov(e,t){return!t||"object"!==av(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iv(e){return(iv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sv(e,t){return(sv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}ev(nv,"propTypes",{sidebarItems:tt.a.array.isRequired});var cv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ov(this,iv(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sv(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=null;return se.cloudantUser.isIBMCloudAccount()||(e=de.a.createElement("div",null,de.a.createElement("h4",null," Dedicated Support issue"),de.a.createElement("p",null,"IBM Cloudant Dedicated customers please note that we are experiencing delays processing support requests. We suggest using the dashboard of the affected account to raise support cases with us. This ensures that cases are handled in as timely manner as possible."),de.a.createElement("br",null))),de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("div",{className:"activity-pane"},e,de.a.createElement("h4",null,"Fined-Grained IAM Controls and new Activity Tracker Events"),de.a.createElement("p",null,"IBM Cloudant instances in the IBM Cloud now support multiple types of roles for IBM IAM. Check out our ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides?topic=cloudant-ibm-cloud-identity-and-access-management-iam-",target:"_blank",rel:"noopener noreferrer"},"IAM Guide")," for more detail on these new, more perceptive roles. We also released the ability to send ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant?topic=cloudant-at_events#at_actions_data",target:"_blank",rel:"noopener noreferrer"},"database audit events")," to IBM Cloud Activity Tracker with LogDNA. Happy Auditing!"),de.a.createElement("br",null),de.a.createElement("h4",null,"Cloudant integration with IBM Log Analysis with LogDNA"),de.a.createElement("p",null,"In the Dallas region, customers can now access their database logs automatically. Learn more ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant?topic=cloudant-logging",target:"_blank",rel:"noopener noreferrer"},"here"),"."),de.a.createElement("br",null),de.a.createElement("h4",null,"Partition Queries is now GA"),de.a.createElement("p",null,"IBM Cloudant released a new capability for partitioned databases which will require both a partition key and doc key for every document stored. Users can leverage partition queries against a partitioned database which are up to 20X cheaper than global queries with reduced latency. See the ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides/database_partitioning.html#database-partitioning",target:"_blank",rel:"noopener noreferrer"},"documentation")," for more details. The partition query feature has been rolled out to all Cloudant environments and is now officially GA."),de.a.createElement("br",null),de.a.createElement("h4",null,"TLS 1.2+ required starting on June 1, 2019"),de.a.createElement("p",null,"Starting on June 1, 2019, the IBM Cloudant API will require Transport Layer Security (TLS) 1.2 and above. The IBM Cloudant API requires HTTPS and currently supports TLS 1.0 and above. The IBM Cloud withdrew support for TLS 1.0 and 1.1 for many services in March 2018 and IBM Cloudant is following suit. If your applications are still using TLS 1.0 or 1.1, please update them immediately to TLS 1.2 or above to avoid any impact. If you are unsure what TLS version your application is using to connect to Cloudant or have any questions, open a support ticket. See IBM Cloudant security docs for more detail."),de.a.createElement("br",null),de.a.createElement("h4",null,"IBM Identity & Access Management (IAM)"),de.a.createElement("p",null,"IBM Cloudant instances in the IBM Cloud now support IBM IAM for authentication and authorization. IBM IAM allows for centralized control for granting user and programmatic access to all the Cloudant instances in your IBM Cloud account. See the ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides?topic=cloudant-ibm-cloud-identity-and-access-management-iam-#ibm-cloud-identity-and-access-management-iam-",target:"_blank",rel:"noopener noreferrer"},"IAM guide")," in the documentation for a comparison between using IAM and legacy Cloudant authentication for your applications."),de.a.createElement("p",null,"In addition, IBM Cloudant instances support Resource Groups and we encourage all customers to migrate their Cloudant instances that remain in a Cloud Foundry space to Resource Groups to take advantage of the security access benefits. See the ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides?topic=cloudant-how-does-ibm-cloudant-work-with-ibm-cloud-resource-groups-",target:"_blank",rel:"noopener noreferrer"},"guide")," on using Cloudant with Resource Groups for more details."),de.a.createElement("br",null),de.a.createElement("h4",null,"IBM Cloudant Dedicated Hardware environment security enhancements"),de.a.createElement("p",null,"The IBM Cloudant Dedicated Hardware plan in the IBM Cloud catalog is for customers who require additional security and compliance benefits. IBM Cloudant Dedicated Hardware instances are isolated environments for the sole use of a customer to run one or more IBM Cloudant Standard plan instances. We have added the ability to connect via IBM’s internal network, meaning customers can avoid public network and outbound bandwidth costs when connecting to Cloudant from their applications. With that, Dedicated Hardware environment now offer the following benefits:"),de.a.createElement("ul",null,de.a.createElement("li",null,"Isolation at the database compute and storage layers for a single customer"),de.a.createElement("li",null,"Choice of any ",de.a.createElement("a",{href:"https://www.ibm.com/cloud/data-centers/",target:"_blank",rel:"noopener noreferrer"},"IBM Cloud location")),de.a.createElement("li",null,"Optional HIPAA readiness in US locations"),de.a.createElement("li",null,"Both external and internal ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/offerings?topic=cloudant-connecting#endpoints",target:"_blank",rel:"noopener noreferrer"},"service endpoints")),de.a.createElement("li",null,"IP whitelisting"),de.a.createElement("li",null,"Bring your own encryption key (BYOK) with Key Protect")),de.a.createElement("p",null,"See the ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/offerings?topic=cloudant-ibm-cloud-public#dedicated-hardware-plan",target:"_blank",rel:"noopener noreferrer"},"documentation")," on the IBM Cloudant Dedicated Hardware plan for more details."),de.a.createElement("br",null)))}}])&&rv(n.prototype,a),r&&rv(n,r),t}(de.a.Component),lv=n(96),uv=n.n(lv),dv=function(e){var t=e.password,n=void 0,a=t?uv()(t).score:-1;return n=-1==a?"":a>=gy.MIN_PWD_STRENGTH&&t.length>=gy.MIN_PWD_SIZE?de.a.createElement("span",{className:"password-strength__strong"},"STRONG"):a>=gy.MIN_PWD_STRENGTH&&t.length<gy.MIN_PWD_SIZE?de.a.createElement("span",{className:"password-strength__almostthere"},"ALMOST THERE"):3==a?de.a.createElement("span",{className:"password-strength__better"},"BETTER"):de.a.createElement("span",{className:"password-strength__weak"},"WEAK"),de.a.createElement("span",{style:{fontSize:14}},"Password strength: ",n)};dv.propTypes={password:tt.a.string};var pv=dv;function fv(e){return(fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mv(e){return(mv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bv(e,t){return(bv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ev=hy.accountStore,_v=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=mv(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==fv(r)&&"function"!=typeof r?gv(a):r,yv(gv(n),"getStoreState",(function(){return{isAuthenticated:Ev.isUserAuthenticated(),isSaving:Ev.isSaving(),currentPwd:Ev.getCurrentPwd(),newPwd:Ev.getNewPwd(),newPwdConfirmation:Ev.getNewPwdConfirmation()}})),yv(gv(n),"onChange",(function(){n.setState(n.getStoreState())})),yv(gv(n),"setCurrentPwd",(function(e){GE.setCurrentPwd(e.target.value)})),yv(gv(n),"setNewPwd",(function(e){GE.setNewPwd(e.target.value)})),yv(gv(n),"setNewPwdConfirmation",(function(e){GE.setNewPwdConfirmation(e.target.value)})),yv(gv(n),"validate",(function(){return n.state.currentPwd?!n.state.newPwd||n.state.newPwd.length<gy.MIN_PWD_SIZE?(se.addNotification({type:"error",msg:"Your password must be at least 16 characters long.",clear:!0}),n.password.focus(),!1):uv()(n.state.newPwd).score<gy.MIN_PWD_STRENGTH?(se.addNotification({type:"error",msg:"Your password is too weak. Please consider using additional numbers/symbols and avoid guessable patterns.",clear:!0}),n.password.focus(),!1):!(!n.state.newPwdConfirmation||n.state.newPwd!==n.state.newPwdConfirmation)||(se.addNotification({type:"error",msg:"Your passwords do not match.",clear:!0}),n.passwordConfirm.focus(),!1):(se.addNotification({type:"error",msg:"Please enter your current password.",clear:!0}),n.currentPwd.focus(),!1)})),yv(gv(n),"submit",(function(e){e.preventDefault(),n.validate()&&GE.savePassword({password:n.state.newPwd,old_password:n.state.currentPwd,"new_password-confirm":n.state.newPwdConfirmation})})),yv(gv(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bv(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){Ev.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){Ev.off("change",this.onChange)}},{key:"render",value:function(){var e=this;if(!this.state.isAuthenticated)return de.a.createElement(Jr.LoadLines,null);var t=this.state.isSaving?"Saving...":"Update Password";return de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("div",{id:"password-update__desc"},de.a.createElement("p",null,"Passwords must be at least ",de.a.createElement("span",null,"16")," characters long and meet Cloudant's ",de.a.createElement("span",null,"strength requirements.")),de.a.createElement("p",null,"We recommend using a combination of alphanumeric and symbol characters and avoiding guessable patterns.")),de.a.createElement("form",{id:"password-form",onSubmit:this.submit},de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"password"},"Current Password"),de.a.createElement("input",{type:"password",id:"password",ref:function(t){return e.currentPwd=t},autoFocus:!0,value:this.state.currentPwd,onChange:this.setCurrentPwd})),de.a.createElement("hr",null),de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"new-password"},"New Password"),de.a.createElement("span",null,de.a.createElement("input",{type:"password",id:"new-password",ref:function(t){return e.password=t},value:this.state.newPwd,onChange:this.setNewPwd}),de.a.createElement("br",null),de.a.createElement(pv,{password:this.state.newPwd})),de.a.createElement("span",{className:"help-block"})),de.a.createElement("div",{className:"controls controls-row",style:{paddingTop:10}},de.a.createElement("label",{htmlFor:"new-password-confirm"},"New Password Confirmation"),de.a.createElement("input",{type:"password",id:"new-password-confirm",ref:function(t){return e.passwordConfirm=t},value:this.state.newPwdConfirmation,onChange:this.setNewPwdConfirmation}),de.a.createElement("span",{className:"help-block"})),de.a.createElement("div",{className:"form-actions"},de.a.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.state.isSaving},t))))}}])&&hv(n.prototype,a),r&&hv(n,r),t}(de.a.Component),vv=n(409),Sv=n.n(vv),Nv={},Dv=[];Nv.getSpinner=function(e){var t=_.extend({lines:16,length:8,width:4,radius:12,color:"#333",speed:1,trail:10,shadow:!1,zIndex:10},e);return new Sv.a(t).spin()},Nv.getSmallSpinner=function(){return Nv.getSpinner({lines:12,width:2,length:4,radius:4,trail:50})},Nv.getUniqueKey=function(){function e(){return Math.random().toString(36).substring(7)}for(var t=e();-1!==Dv.indexOf(t);)t=e();return Dv.push(t),t},Nv.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Nv.isValidEmail=function(e){return/^[^@]+@[^@]+\.[^@.]{2,}$/.test(e)},Nv.stripProtocol=function(e){return e.replace(/^[^/]*?:\/\//,"")},Nv.getCleanDesignDoc=function(e){return e.replace(/_design\//,"")};var Ov=Nv;function wv(e){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Cv(e){return(Cv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Av(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iv(e,t){return(Iv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rv=hy.accountStore,kv=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Cv(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==wv(r)&&"function"!=typeof r?Av(a):r,Pv(Av(n),"getStoreState",(function(){return{isAuthenticated:Rv.isUserAuthenticated(),isSaving:Rv.isSaving(),firstName:Rv.getFirstName(),lastName:Rv.getLastName(),company:Rv.getCompany(),email:Rv.getEmail()}})),Pv(Av(n),"onChange",(function(){n.setState(n.getStoreState())})),Pv(Av(n),"submit",(function(e){e.preventDefault(),n.validate()&&GE.saveProfile({first_name:n.state.firstName.trim(),last_name:n.state.lastName.trim(),company:n.state.company.trim(),email:n.state.email.trim()})})),Pv(Av(n),"validate",(function(){return""===n.state.firstName.trim()?(se.addNotification({type:"error",msg:"Please enter a first name.",clear:!0}),n.firstName.focus(),!1):""===n.state.lastName.trim()?(se.addNotification({type:"error",msg:"Please enter a last name.",clear:!0}),n.lastName.focus(),!1):""===n.state.email.trim()?(se.addNotification({type:"error",msg:"Please enter an email address.",clear:!0}),n.email.focus(),!1):!!Ov.isValidEmail(n.state.email.trim())||(se.addNotification({type:"error",msg:"Please enter a valid email address.",clear:!0}),n.email.focus(),!1)})),Pv(Av(n),"setFirstName",(function(e){GE.setFirstName(e.target.value)})),Pv(Av(n),"setLastName",(function(e){GE.setLastName(e.target.value)})),Pv(Av(n),"setCompany",(function(e){GE.setCompany(e.target.value)})),Pv(Av(n),"setEmail",(function(e){GE.setEmail(e.target.value)})),Pv(Av(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iv(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){Rv.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){Rv.off("change",this.onChange)}},{key:"render",value:function(){var e=this;if(!this.state.isAuthenticated)return de.a.createElement(Jr.LoadLines,null);var t=this.state.isSaving?"Saving...":"Save Changes";return de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("form",{onSubmit:this.submit,className:"profile-form"},de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"first-name"},"First Name"),de.a.createElement("input",{type:"text",className:"input-block-level",id:"first-name",ref:function(t){return e.firstName=t},autoFocus:!0,placeholder:"First Name",value:this.state.firstName,onChange:this.setFirstName})),de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"last-name"},"Last Name"),de.a.createElement("input",{type:"text",className:"input-block-level",id:"last-name",ref:function(t){return e.lastName=t},placeholder:"Last Name",value:this.state.lastName,onChange:this.setLastName})),de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"company"},"Company"),de.a.createElement("input",{type:"text",className:"input-block-level",id:"company",placeholder:"Your Company",value:this.state.company,onChange:this.setCompany})),de.a.createElement("div",{className:"controls controls-row"},de.a.createElement("label",{htmlFor:"email"},"Email"),de.a.createElement("input",{type:"text",className:"input-block-level",id:"email",ref:function(t){return e.email=t},placeholder:"Your Email",value:this.state.email,onChange:this.setEmail})),de.a.createElement("div",{className:"form-actions"},de.a.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.state.isSaving},de.a.createElement("i",{className:"icon fonticon-ok-circled"}),t))))}}])&&Tv(n.prototype,a),r&&Tv(n,r),t}(de.a.Component);function Lv(e){return(Lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Uv(e){return(Uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jv(e,t){return(jv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bv=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Uv(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Lv(r)&&"function"!=typeof r?Mv(a):r,Hv(Mv(n),"deleteVirtualHost",(function(){GE.showDeleteVirtualHostModal(n.props.virtualHost.host)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jv(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=window.location.hostname+this.props.virtualHost.path;return de.a.createElement("li",null,de.a.createElement("a",{className:"hostname",href:"http://"+this.props.virtualHost.host,title:this.props.virtualHost.host},this.props.virtualHost.host),de.a.createElement("span",{className:"path",title:e},de.a.createElement("span",{className:"right-arrow"},"→"),de.a.createElement("span",null,e)),de.a.createElement("button",{className:"icon-trash",onClick:this.deleteVirtualHost}))}}])&&xv(n.prototype,a),r&&xv(n,r),t}(de.a.Component);function Gv(e){return(Gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vv(e){return(Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kv(e,t){return(Kv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Hv(Bv,"propTypes",{virtualHost:tt.a.object.isRequired});var Xv=hy.accountStore,zv=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=Vv(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Gv(r)&&"function"!=typeof r?Fv(a):r,Wv(Fv(n),"getStoreState",(function(){return{isAuthenticated:Xv.isUserAuthenticated(),isSaving:Xv.isSaving(),loadError:Xv.virtualHostsLoadError(),virtualHosts:Xv.getVirtualHosts(),newHostname:Xv.getNewHostname(),newHostnamePath:Xv.getNewHostnamePath(),deleteVirtualHostModalVisible:Xv.deleteVirtualHostModalVisible(),virtualHostToDelete:Xv.getVirtualHostnameToDelete()}})),Wv(Fv(n),"onChange",(function(){n.setState(n.getStoreState())})),Wv(Fv(n),"submit",(function(e){if(e.preventDefault(),!n.validate())return!1;GE.addVirtualHost({host:n.getCleanHostName(),path:"/"+n.state.newHostnamePath})})),Wv(Fv(n),"getCleanHostName",(function(){return Ov.stripProtocol(n.state.newHostname.trim())})),Wv(Fv(n),"validate",(function(){return""!==n.getCleanHostName()||(se.addNotification({type:"error",msg:"Please enter a host name.",clear:!0}),n.hostname.focus(),!1)})),Wv(Fv(n),"loadError",(function(){return de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("header",null,de.a.createElement("h2",null,"Virtual Hosts"),de.a.createElement("p",{className:"virtual-hosts-load-error"},"There was an error loading your virtual hosts.")))})),Wv(Fv(n),"getVirtualHostRows",(function(){return n.state.virtualHosts.map((function(e,t){return de.a.createElement(Bv,{virtualHost:e,key:t})}))})),Wv(Fv(n),"getVirtualHostList",(function(){return 0===n.state.virtualHosts.length?null:de.a.createElement("section",{id:"your-virtual-hosts"},de.a.createElement("ul",{className:"unstyled show-header"},de.a.createElement("li",{className:"host-header"},de.a.createElement("h2",null,"Your Virtual Hosts")),n.getVirtualHostRows()))})),Wv(Fv(n),"setNewHostname",(function(e){GE.setNewHostname(e.target.value)})),Wv(Fv(n),"setNewHostnamePath",(function(e){GE.setNewHostnamePath(e.target.value)})),Wv(Fv(n),"deleteVirtualHost",(function(){GE.deleteVirtualHost(n.state.virtualHostToDelete)})),Wv(Fv(n),"state",n.getStoreState()),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kv(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){Xv.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){Xv.off("change",this.onChange)}},{key:"render",value:function(){var e=this;if(!this.state.isAuthenticated)return de.a.createElement(Jr.LoadLines,null);if(this.state.loadError)return this.loadError();var t=window.location.hostname,n=this.state.isSaving?"Saving...":"Add Domain";return de.a.createElement("div",{className:"tab-pane active"},de.a.createElement("header",null,de.a.createElement("p",null,"Specify a virtual host to map a domain or domain path to a Cloudant server. After you add a hostname, update the host’s DNS CNAME record to point to ",de.a.createElement("strong",null,t),".")),de.a.createElement("form",{className:"form-horizontal",onSubmit:this.submit},de.a.createElement("div",{className:"control-group add-virtual-host-form"},de.a.createElement("input",{type:"text",id:"hostname",className:"input-large",ref:function(t){return e.hostname=t},placeholder:"Hostname",autoFocus:!0,value:this.state.newHostname,onChange:this.setNewHostname}),de.a.createElement("span",{className:"right-arrow"},"→"),de.a.createElement("div",{className:"input-prepend"},de.a.createElement("span",{className:"add-on"},de.a.createElement("small",null,t,"/")),de.a.createElement("input",{type:"text",id:"path",className:"input-large",placeholder:"Path (optional)",value:this.state.newHostnamePath,onChange:this.setNewHostnamePath})),de.a.createElement("button",{className:"btn btn-secondary add-virtual-host-btn",type:"submit",disabled:this.state.isSaving},n))),this.getVirtualHostList(),de.a.createElement(_o.ConfirmationModal,{title:"Remove Host",visible:this.state.deleteVirtualHostModalVisible,text:"Are you sure you want to remove this virtual host?",onClose:GE.hideDeleteVirtualHostModal,onSubmit:this.deleteVirtualHost,buttonClass:"btn-danger",successButtonLabel:"Remove Host"}))}}])&&qv(n.prototype,a),r&&qv(n,r),t}(de.a.Component),Yv={AccountActivity:j_,BillBreakdown:d_,AccountSidebar:nv,Announcements:cv,Profile:kv,PasswordInfo:_v,PasswordStrengthIndicator:pv,AccountSettings:z_,VirtualHostRow:Bv,VirtualHosts:zv};function Qv(e){return(Qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jv(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Zv(e,t){return!t||"object"!==Qv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $v(e){return($v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eS(e,t){return(eS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tS=hy.accountStore,nS=Jr.LoadLines,aS=Jr.TabWindowWrapper,rS=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Zv(this,$v(t).call(this,e))).state=n.getStoreState(),n.state.userPromiseResolved=!1,n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eS(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){return{userAuthenticated:tS.isUserAuthenticated()}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){var e=this;tS.on("change",this.onChange,this),lS.userPromise.then((function(){e.setState({userPromiseResolved:!0})})).catch((function(){e.setState({userPromiseResolved:!0})}))}},{key:"componentWillUnmount",value:function(){tS.off("change",this.onChange)}},{key:"getTabs",value:function(){return this.props.getTabs?this.props.getTabs():[]}},{key:"render",value:function(){return this.state.userAuthenticated&&this.state.userPromiseResolved?de.a.createElement(aS,{tabs:this.getTabs(),selectedTab:this.props.selectedTab}):de.a.createElement(nS,null)}}])&&Jv(n.prototype,a),r&&Jv(n,r),t}(de.a.Component);function oS(){return(oS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}rS.propTypes={getTabs:tt.a.func.isRequired,selectedTab:tt.a.string.isRequired};var iS=ME.AccountPlan,sS=HE,cS=se.RouteObject.extend({routes:{account:"redirect","account/announcements":"announcements","account/info":"profile","account/password":"passwordInfo","account/cors":"cors","account/plans":"plans","account/settings":"settings","account/data-location":"dataLocation"},selectedHeader:"Account",roles:["_admin"],getTabs:function(){var e=sS.user.get("isCcmCustomer"),t=sS.user.isIBMCloudAccount(),n=[];return e&&n.push({name:"Capacity",component:iS,route:"".concat("#account","/plans")}),n.push({name:"Announcements",component:Yv.Announcements,route:"".concat("#account","/announcements"),badgeText:sS.hasNewAnnouncement()?"new":""}),t||n.push({name:"Profile",component:Yv.Profile,route:"".concat("#account","/info")}),n.push({name:"CORS",component:iy.Components.CORSContainer,route:"".concat("#account","/cors")}),t||n.push({name:"Password",component:Yv.PasswordInfo,route:"".concat("#account","/password")}),e&&n.push({name:"Settings",component:Yv.AccountSettings,route:"".concat("#account","/settings")}),n},redirect:function(){sS.userPromise.then((function(){var e=sS.user.get("isCcmCustomer")?"#account/plans":"#account/announcements";se.navigate(e,{redirect:!0})}))},announcements:function(){return le.utils.localStorageSet("announceBadge",gy.ANNOUNCEMENT_VERSION),se.hideHeaderLinkBadge({title:"Account"}),de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Announcements"})})},profile:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Profile"})})},passwordInfo:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Password"})})},virtualHosts:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Virtual Hosts"})})},cors:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"CORS"})})},plans:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Capacity"})})},settings:function(){return de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Settings"})})},usage:function(e,t){var n=r_.inPast(e,t),a=n?{year:e,month:t}:null;return GE.initAccountActivity(a,n,r_.getFreeLimit(oS({},a))),de.a.createElement(Nt,{crumbs:[{name:"Account"}],component:de.a.createElement(rS,{getTabs:this.getTabs.bind(this),selectedTab:"Usage"})})}});sS.RouteObjects=[cS];var lS=sS,uS=(n(730),n(731),function(){}),dS=function(){};lS.user||(se.cloudantUser=new lS.User,lS.user=se.cloudantUser,lS.userPromise=new G.a((function(e,t){uS=e,dS=t})),lS.userPromise.resolveUser=uS),lS.initialize=function(){se.session.isAuthenticated().then((function(){var e=window.location.hash,t=(e.match(/#reset/)||[]).length>0;"#login"===e||t||"#forgot"===e||lS.user.fetchOnce().then((function(){uS(),GE.userAuthenticated(lS.user)}),(function(e){var t=e.statusText;e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),dS(new Error(t))}))})),se.addHeaderLink({title:"Account",href:"#/account",icon:lS.getIcon()}),HE.hasNewAnnouncement()&&se.showHeaderLinkBadge({title:"Account"})},lS.userPromise.then((function(){fetch("/",{headers:{Accept:"application/json"}}).then((function(e){e.ok&&e.headers&&-1!==["ibm009","bluemix-uk-standard1","bm-dal-standard1","bm-dal-standard2","bm-dal-standard3","bm-syd-standard1"].indexOf(e.headers.get("x-cloudant-backend"))&&lS.user.isMeteredPlan()&&se.addNotification({msg:'Warning: The IBM Cloudant Shared Plan will be retired on October 31st, 2018. This plan is impacted by the retirement. Read more at <a href="https://www.ibm.com/blogs/bluemix/2018/08/ibm-cloudant-shared-plan-is-being-retired" target="_blank" rel="noopener noreferrer"><u>https://www.ibm.com/blogs/bluemix/2018/08/ibm-cloudant-shared-plan-is-being-retired</u></a>.',type:"error",clear:!0,escape:!1,visibleTime:15e3})})).catch((function(){}))}));var pS=lS;n(732);pS.userPromise.then((function(){se.showLogout()}));var fS={GENERAL:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-databases#databases",ALL_DBS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-databases#get-a-list-of-all-databases-in-the-account",REPLICATION:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-replication-api#replication",DESIGN_DOCS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-design-documents#design-documents",VIEW_FUNCS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-views-mapreduce#views-mapreduce-",MAP_FUNCS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-views-mapreduce#map-function-examples",REDUCE_FUNCS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-views-mapreduce#reduce-functions",API_REF:"https://cloud.ibm.com/docs/services/Cloudant?topic=cloudant-api-reference-overview#api-reference-overview",SEARCH_INDEXES:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-search#search",SEARCH_INDEX_QUERIES:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-search#queries",GEOSPATIAL_INDEXES:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-cloudant-nosql-db-geospatial#cloudant-geospatial",GEOSPATIAL_INDEXES_CREATING:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-cloudant-nosql-db-geospatial#creating-a-cloudant-geo-index",DB_PERMISSION:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-authorization#viewing-permissions",STATS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-monitoring-an-ibm-cloudant-cluster#monitoring-a-cloudant-cluster",ACTIVE_TASKS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-active-tasks#active-tasks",LOG:"",CONFIG:"",MANGO_INDEX:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-query#query",MANGO_SEARCH:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-query#finding-documents-by-using-an-index",VIEWS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-using-views#querying-a-view",CHANGES:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-databases#get-changes",SECURITY:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-authentication#authentication",DESIGN_DOC_METADATA:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-design-documents#retrieving-information-about-a-design-document",DOC_URL_DESIGN_DOCS:"https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-design-documents#creating-or-updating-a-design-document"};Object.keys(fS).forEach((function(e){se.constants.DOC_URLS[e]=fS[e]}));var hS=new se.addon;hS.initialize=function(){se.registerExtension("mango:additionalIndexes",{type:"text",filterFunc:function(e){return{type:e.type,selector:e.def.selector}},createHeader:function(e){var t=e.def;return[e.type+": "+(t.selector?JSON.stringify(t.selector):"")]}})};var mS,gS=hS;function bS(){mS=null;var e=A.getServerUrl("/_session");return T(e,le.utils.queryParams({username:"_",password:"_"}))}var yS={createAdmin:function(e){var t=e.name,n=e.password,a=e.node,r=A.getServerUrl("/_node/".concat(a,"/_config/admins/").concat(t));return D(r,n)},login:function(e){var t=A.getServerUrl("/_session");return w(t,le.utils.queryParams(e))},logout:bS,getSession:function(){if(mS)return mS;var e=A.getServerUrl("/_session"),t=v(e).then((function(e){return e.userCtx.name&&(mS=t),e.userCtx}));return t}};function ES(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(i.includes)(e,"_admin")}var vS=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._user={name:!1,roles:[]},this._onChange={},this._authenticatedPromise=new G.a((function(e,t){n._authenticateResolve=e,n._authenticateReject=t})),this._allowAdminParty=t.allowAdminParty}var t,n,a;return t=e,(n=[{key:"isAuthenticated",value:function(){return this._authenticatedPromise}},{key:"setUser",value:function(e){var t=this;return this._user.name!==e.name&&(this._user={name:e.name,roles:e.roles,isAdmin:_S(e.roles)},Object(i.each)(this._onChange,(function(e){return e(t._user)}))),this._user}},{key:"user",value:function(){return this._user}},{key:"getSession",value:function(){var e=this;return yS.getSession().then((function(t){e.setUser(t),e.isLoggedIn()&&e._authenticateResolve(e.user())})).catch((function(t){e._authenticateReject(t)}))}},{key:"isAdminParty",value:function(){return!!this._allowAdminParty&&!this._user.name&&this._user.isAdmin}},{key:"isLoggedIn",value:function(){return!_.isNull(this._user.name)}},{key:"userRoles",value:function(){var e=this._user;return this.isLoggedIn()?(-1===e.roles.indexOf("fx_loggedIn")&&e.roles.push("fx_loggedIn"),e.roles):[]}},{key:"onChange",value:function(e){var t=this,n=Object(i.uniqueId)();return this._onChange[n]=e,function(){delete t._onChange[n]}}},{key:"matchesRoles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(0===e.length)return!0;var t=_.intersection(this.userRoles(),e).length;return t>0}}])&&ES(t.prototype,n),a&&ES(t,a),e}(),SS=n(184),NS=n.n(SS),DS="SET_URL_SHARED_AUTH",OS="LOGIN_STARTED",wS="LOGIN_COMPLETE",TS="LOGIN_FAILED",CS="RESET_COMPLETED",AS="SHOW_LOGIN_FORM",IS="HIDE_LOGIN_FORM",PS=function(e){var t=e.message;se.addNotification({msg:t,type:"error"})},RS=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return e}))},kS=function(e,t){return RS(!_.isEmpty(e),!_.isEmpty(t))},LS=gy.MIN_PWD_SIZE,xS=gy.MIN_PWD_STRENGTH,US=function(e){return!e||e.length<LS||uv()(e).score<xS},MS=function(e,t){se.dispatch({type:OS}),document.execCommand&&document.execCommand("ClearAuthenticationCache");var n=new Date,a=new Date(2018,2,1);if(n>=a&&US(t))return se.addNotification({msg:"Your username or password is incorrect.",type:"error",clear:!0}),void se.dispatch({type:TS});(function(e,t,n){return kS(e,t)?yS.login({name:e,password:t}).then((function(e){if(e.error)return PS({message:e.reason}),e;var t=le.i18n.en_US["auth-logged-in"];if(t&&se.addNotification({msg:t}),n&&-1===n.indexOf("login"))return se.navigate(n);se.navigate("/")})).catch(PS):PS({message:le.i18n.en_US["auth-missing-credentials"]})})(e,t,!1).then((function(r){if(r&&r.error)return se.dispatch({type:TS}),void("payment_required"===r.error&&se.showPermanentNotification("Your account has been locked. Please contact Cloudant Support at support@cloudant.com to gain access."));v(A.getServerUrl("/_session")).then((function(r){var o=r.userCtx;if(!o||!o.roles||0===o.roles.length){if(bS(),r.error){if("payment_required"===r.error)throw new Error("Your account has been locked. Please contact Cloudant Support at support@cloudant.com.");throw new Error("".concat(r.reason))}if(o&&o.name)throw new Error("".concat(o.name," is not authorized to access this account."));throw new Error("Not authorized to access this account.")}se.reduxDispatch((function(e){e({type:pe.NAVBAR_SHOW})})),n<a&&function(e,t){US(t)&&se.addNotification({msg:'Cloudant is enforcing a <a href="https://developer.ibm.com/dwblog/2017/cloudant-sign-ups-replication-security/" target="_blank" rel="noopener noreferrer">new password standard</a> beginning <b>March 1 2018</b>. The current password for this account <b>does not meet the new requirement</b>.\n      <br/>\n      Please make sure to update your password in the Cloudant dashboard (Account &rarr; Password, or <a href="https://'.concat(e,'.cloudant.com/dashboard.html#account/password" target="_blank" rel="noopener noreferrer">https://').concat(e,".cloudant.com/dashboard.html#account/password</a>) prior to March 1 2018 to avoid interrupting account access.\n      <br/>\n      After changing your account password, you will need to:\n      <ul>\n      <li>Immediately update any applications configured with the old account password</li>\n      <li>Review the API keys that have access to each of your databases</li>\n      <li>Recreate replications using the credentials in the _replicator database. Rather than changing the existing replication document, delete it and upload a new one with the updated credentials.</li>\n      </ul>"),type:"info",escape:!1,visibleTime:6e4})}(e,t),se.dispatch({type:wS})})).catch((function(e){se.addNotification({msg:e.message,type:"error"}),se.dispatch({type:TS})}))}))},jS=function(e,t,n,a){if(function(e,t,n){return e?!t||t.length<LS?(se.addNotification({msg:"Your password must be at least 16 characters long.",type:"error",clear:!0}),!1):uv()(t).score<xS?(se.addNotification({msg:"Your password is too weak. Please consider using additional numbers/symbols and avoid guessable patterns.",type:"error",clear:!0}),!1):!(!n||t!==n)||(se.addNotification({msg:"Please ensure both passwords are the same.",type:"error",clear:!0}),!1):(se.addNotification({msg:"Please enter your Cloudant username.",type:"error",clear:!0}),!1)}(e,t,n))return se.dispatch({type:OS}),r.a.ajax({url:"".concat(le.hostDash,"/user/").concat(e,"/password_reset"),contentType:"application/json; charset=utf-8",dataType:"json",method:"PUT",data:JSON.stringify({password:t,token:a})}).then((function(){se.addNotification({msg:"Your password has been updated.",clear:!0}),se.dispatch({type:CS}),MS(e,t)}),(function(e){se.dispatch({type:TS}),se.addNotification({msg:JSON.parse(e.responseText).message,type:"error",clear:!0})}))},HS=new(se.Store.extend({setURL:function(e){this._url=e.url},getURL:function(){return this._url},dispatch:function(e){switch(e.type){case DS:this.setURL(e.options);break;default:return}}}));HS.dispatchToken=se.dispatcher.register(HS.dispatch.bind(HS));var BS=new(se.Store.extend({loginFormExpandedKey:"cloudant.loginFormExpanded",initialize:function(){this._isLoading=!1;var e=le.utils.localStorageGet(this.loginFormExpandedKey);this._loginFormVisible=!0===e},isLoading:function(){return this._isLoading},isLoginFormVisible:function(){return this._loginFormVisible},dispatch:function(e){switch(e.type){case OS:this._isLoading=!0;break;case TS:case wS:case CS:this._isLoading=!1;break;case AS:this._loginFormVisible=!0,le.utils.localStorageSet(this.loginFormExpandedKey,this._loginFormVisible);break;case IS:this._loginFormVisible=!1,le.utils.localStorageSet(this.loginFormExpandedKey,this._loginFormVisible);break;default:return}this.triggerChange()}}));function GS(e){return(GS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VS(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function FS(e,t,n){return t&&VS(e.prototype,t),n&&VS(e,n),e}function KS(e,t){return!t||"object"!==GS(t)&&"function"!=typeof t?XS(e):t}function WS(e){return(WS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zS(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YS(e,t)}function YS(e,t){return(YS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}BS.dispatchToken=se.dispatcher.register(BS.dispatch.bind(BS));var QS={sharedDBsAuthStore:HS,cloudantAuthStore:BS}.cloudantAuthStore,JS=function(e){function t(e){var n;return qS(this,t),(n=KS(this,WS(t).call(this,e))).submit=n.submit.bind(XS(n)),n.setUsername=n.setUsername.bind(XS(n)),n.state={username:"",isLoading:QS.isLoading()},n}return zS(t,e),FS(t,[{key:"onChange",value:function(){this.setState({isLoading:QS.isLoading()})}},{key:"componentDidMount",value:function(){QS.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){QS.off("change",this.onChange,this)}},{key:"setUsername",value:function(e){this.setState({username:e.target.value})}},{key:"submit",value:function(e){var t;e.preventDefault(),t=this.state.username,se.dispatch({type:OS}),r.a.ajax({url:"".concat(le.hostDash,"/user/").concat(t,"/password_reset"),contentType:"application/json; charset=utf-8",dataType:"json",method:"POST"}).then((function(){se.addNotification({msg:"We sent a link to reset your password to the email address we have on file for you.",clear:!0}),se.dispatch({type:wS})}),(function(e){se.addNotification({msg:JSON.parse(e.responseText).error,type:"error",clear:!0}),se.dispatch({type:TS})}))}},{key:"submitButton",value:function(){var e="Reset your password";return this.state.isLoading&&(e="Searching for user..."),de.a.createElement("button",{className:"btn btn-primary btn-large",type:"submit",disabled:this.state.isLoading},e)}},{key:"render",value:function(){return de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"login-wrapper"},de.a.createElement("div",{className:"login-box"},de.a.createElement("div",{className:"brand"},de.a.createElement("img",{src:NS.a,width:"80",height:"80",alt:"IBM Cloudant"}),de.a.createElement("span",null,"IBM Cloudant")),de.a.createElement("form",{onSubmit:this.submit,id:"forgot"},de.a.createElement("p",null,de.a.createElement("label",{htmlFor:"user_login"},"Forgot your password?",de.a.createElement("br",null)),de.a.createElement("input",{id:"username",onChange:this.setUsername,className:"input-block-level",type:"text",name:"name",placeholder:"Cloudant username",size:"24"})),this.submitButton()),de.a.createElement("p",{className:"ibmid_pwd_reset"},"Need to ",de.a.createElement("a",{href:"https://myibm.ibm.com/dashboard",target:"_blank",rel:"noopener noreferrer"},"reset your IBMid password")," instead?"))))}}]),t}(de.a.Component),ZS=function(e){function t(e){var n;return qS(this,t),(n=KS(this,WS(t).call(this,e))).submit=n.submit.bind(XS(n)),n.usernameChange=n.usernameChange.bind(XS(n)),n.passwordChange=n.passwordChange.bind(XS(n)),n.passwordConfirmChange=n.passwordConfirmChange.bind(XS(n)),n.state={username:"",password:"",passwordConfirm:"",isLoading:QS.isLoading()},n}return zS(t,e),FS(t,[{key:"onChange",value:function(){this.setState({isLoading:QS.isLoading()})}},{key:"componentDidMount",value:function(){QS.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){QS.off("change",this.onChange,this)}},{key:"submit",value:function(e){e.preventDefault(),jS(this.state.username,this.state.password,this.state.passwordConfirm,this.props.token)}},{key:"usernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"passwordChange",value:function(e){this.setState({password:e.target.value})}},{key:"passwordConfirmChange",value:function(e){this.setState({passwordConfirm:e.target.value})}},{key:"submitButton",value:function(){var e="Reset your password";return this.state.isLoading&&(e="Resetting password.."),de.a.createElement("button",{id:"submit",className:"btn btn-primary btn-large",type:"submit",disabled:this.state.isLoading},e)}},{key:"form",value:function(){return this.props.token?de.a.createElement("form",{onSubmit:this.submit,id:"reset"},de.a.createElement("div",null,de.a.createElement("p",{id:"password-reset__desc"},"Passwords must be at least ",de.a.createElement("span",null,"16")," characters long and meet Cloudant's ",de.a.createElement("span",null,"strength requirements.")),de.a.createElement("input",{onChange:this.usernameChange,id:"username",type:"text",name:"username",className:"input-block-level",placeholder:"Enter your username",value:this.state.username,size:"24"}),de.a.createElement("input",{onChange:this.passwordChange,id:"password",type:"password",name:"password",className:"input-block-level",placeholder:"Enter a new password",value:this.state.password,size:"24"}),de.a.createElement(Yv.PasswordStrengthIndicator,{password:this.state.password}),de.a.createElement("input",{onChange:this.passwordConfirmChange,id:"password_confirm",type:"password",name:"password_confirm",className:"input-block-level",style:{marginTop:20},placeholder:"Confirm password",value:this.state.passwordConfirm,size:"24"})),this.submitButton()):de.a.createElement("div",{className:"alert alert-warning"},de.a.createElement("strong",null,"Missing token!")," Check your email, or try to ",de.a.createElement("a",{href:"#forgot"},"reset")," again.")}},{key:"render",value:function(){return de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"login-wrapper"},de.a.createElement("div",{className:"login-box"},de.a.createElement("div",{className:"brand"},de.a.createElement("img",{src:NS.a,width:"80",height:"80",alt:"IBM Cloudant"}),de.a.createElement("span",null,"IBM Cloudant")),this.form())))}}]),t}(de.a.Component),$S={Login:function(e){function t(e){var n;return qS(this,t),(n=KS(this,WS(t).call(this,e))).showLoginForm=n.showLoginForm.bind(XS(n)),n.loginWithIBMId=n.loginWithIBMId.bind(XS(n)),n.login=n.login.bind(XS(n)),n.updateUsername=n.updateUsername.bind(XS(n)),n.updatePassword=n.updatePassword.bind(XS(n)),n.state={username:window.location.host.split(".")[0],password:"",isLoading:QS.isLoading(),loginFormVisible:QS.isLoginFormVisible(),isMT:n.isMT()},n}return zS(t,e),FS(t,[{key:"isMT",value:function(){for(var e=le.addons?le.addons.length:0,t=0;t<e;t++)if(le.addons[t]&&le.addons[t].RouteObjects&&le.addons[t].RouteObjects.length>0){var n=le.addons[t].RouteObjects[0];if(n&&n.prototype&&n.prototype.routes)if(n.prototype.routes["account/payment"])return!0}return!1}},{key:"onChange",value:function(){this.setState({isLoading:QS.isLoading(),loginFormVisible:QS.isLoginFormVisible()})}},{key:"componentDidMount",value:function(){QS.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){QS.off("change",this.onChange,this)}},{key:"updatePassword",value:function(e){this.setState({password:e.target.value})}},{key:"updateUsername",value:function(e){this.setState({username:e.target.value})}},{key:"login",value:function(e){e.preventDefault(),MS(this.state.username,this.state.password)}},{key:"loginWithIBMId",value:function(e){var t;e.preventDefault(),t="".concat(le.hostDash,"/ibmid_sso/start"),window.location.href=t}},{key:"showLoginForm",value:function(e){e.preventDefault(),se.dispatch({type:AS})}},{key:"submitButton",value:function(){var e="Sign in";return this.state.isLoading&&(e="Loading..."),de.a.createElement("button",{className:"btn btn-primary btn-large js-button-submit",type:"submit",disabled:this.state.isLoading},e)}},{key:"sharedPlanNotice",value:function(){return de.a.createElement("p",{className:"shared-plan-notice"},de.a.createElement("b",null,"Notice:")," The cloudant.com Shared plan was retired on ",de.a.createElement("b",null,"March 31, 2018"),". See ",de.a.createElement("a",{href:"https://cloudant.com/shared-plan-retirement/"},"https://cloudant.com/shared-plan-retirement/")," for details.")}},{key:"render",value:function(){var e=this.state.isMT?this.sharedPlanNotice():null,t=this.state.loginFormVisible,n=null,a=null;return this.props.ssoError?a=de.a.createElement("div",{style:{paddingTop:16}},"Sign in with IBMid is not available because this Cloudant instance is not assigned to a resource group. Learn how to ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/resources?topic=resources-migrate",target:"_blank",rel:"noopener noreferrer"},"migrate your service instances and apps to a resource group"),"."):n=de.a.createElement("div",null,de.a.createElement("button",{id:"bt_ibmid_login",className:"btn btn-primary btn-large js-button-submit",style:{width:"100%"},type:"button",onClick:this.loginWithIBMId,disabled:this.state.isLoading},"Sign in with IBMid")),de.a.createElement("div",{className:"cloudant-login-wrapper"},de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"login-wrapper"},de.a.createElement("div",{className:"login-box"},de.a.createElement("div",{className:"brand"},de.a.createElement("img",{src:NS.a,width:"80",height:"80",alt:"IBM Cloudant"}),de.a.createElement("span",null,"IBM Cloudant")),de.a.createElement("button",{id:"bt_cloudant_login",className:"btn btn-primary btn-large js-button-submit",style:{width:"100%",display:t?"none":"block"},type:"button",onClick:this.showLoginForm,disabled:this.state.isLoading},"Sign in with Cloudant Username"),de.a.createElement("div",{style:{display:t?"block":"none"}},e,de.a.createElement("form",{onSubmit:this.login},de.a.createElement("p",null,de.a.createElement("label",{htmlFor:"username"},"Username"),de.a.createElement("input",{id:"username",className:"input-block-level",type:"text",name:"name",value:this.state.username,onChange:this.updateUsername,size:"24"})),de.a.createElement("p",null,de.a.createElement("label",{htmlFor:"password"},"Password"),de.a.createElement("input",{id:"password",className:"input-block-level",type:"password",name:"password",onChange:this.updatePassword,value:this.state.password,placeholder:"Password",size:"24"})),this.submitButton(),de.a.createElement("a",{className:"forgot-password",href:"#forgot"},"Forgot Password?"))),de.a.createElement("div",null,de.a.createElement("div",{className:"login-separator"},de.a.createElement("div",{className:"login-separator-line-left"},de.a.createElement("hr",null)),de.a.createElement("span",null,"or"),de.a.createElement("div",{className:"login-separator-line-right"},de.a.createElement("hr",null))),a,n)),de.a.createElement("div",{className:"login-as-other-user"},de.a.createElement("a",{href:"https://cloudant.com/sign-in/"},"Sign in with a different account")))))}}]),t}(de.a.Component),ResetPassword:ZS,Forgot:JS},eN=function(e){var t=e.section,n=e.token,a=e.ssoError;return de.a.createElement("div",{id:"login"},de.a.createElement("div",{className:"js-login-wrapper"},function(e,t,n){return"login"===e?de.a.createElement($S.Login,{ssoError:n}):"forgot"===e?de.a.createElement($S.Forgot,null):de.a.createElement($S.ResetPassword,{token:t})}(t,n,a)))},tN={},nN=se.RouteObject.extend({routes:{reset:"reset","reset/:token":"reset",forgot:"forgot",login:"login",logout:"logout"},reset:function(e){return de.a.createElement(eN,{section:"reset",token:e||""})},forgot:function(){return de.a.createElement(eN,{section:"forgot"})},login:function(){var e=le.getParams().ssoError;return de.a.createElement(eN,{section:"login",ssoError:e})},logout:function(){localStorage.removeItem("ccm-redirect"),se.addNotification({msg:"Signing "+se.session.user().name+" out.",clear:!0});var e=function(){var e=le.i18n.en_US["auth-logged-out"];se.addNotification({msg:e,clear:!0}),document.execCommand&&document.execCommand("ClearAuthenticationCache")};se.session.isIAM()?T(A.getServerUrl("/_iam_session"),le.utils.queryParams({username:"_",password:"_"})).then((function(){bS(),e()})).then((function(){window.location="https://cloud.ibm.com/resources"})):bS().then(e).then((function(){se.navigate("#login")}))},initialize:function(){se.reduxDispatch((function(e){e({type:pe.NAVBAR_HIDE})}))}});tN.RouteObjects=[nN];var aN=tN;n(733);aN.session=new vS({allowAdminParty:!1}),se.setSession(aN.session),se.session.onChange((function(){se.session._isIAM=!1,se.session.isLoggedIn()&&v(A.getServerUrl("/_session")).then((function(e){e.info&&"iam"===e.info.authenticated&&(aN.session._isIAM=!0)})).catch((function(){}))})),se.session.isIAM=function(){return se.session._isIAM},aN.initialize=function(){};var rN=aN,oN={};Ge.Status=se.Model.extend({url:function(){return A.getServerUrl("/"+this.database.safeID())},initialize:function(e){this.database=e.database,this.loadSuccess=!1},numDocs:function(){return this.get("doc_count")},numDeletedDocs:function(){return this.get("doc_del_count")},isGraveYard:function(){return this.numDeletedDocs()>this.numDocs()},dataSize:function(){return this.get("other")?this.get("other").data_size:this.get("data_size")?this.get("data_size"):this.get("disk_size")?this.get("disk_size"):0},parse:function(e){return this.loadSuccess=!0,e},hasDataSize:function(){return this.get("other")||this.get("data_size")||this.get("disk_size")}}),Ge.List=se.Collection.extend({model:Ge.Model,documentation:function(){return se.constants.DOC_URLS.ALL_DBS},getDatabaseNames:function(){return this.toArray().map((function(e){return e.get("name")}))},cache:{expires:60},url:function(e){return"apiurl"===e?window.location.origin+"/_all_dbs":A.getServerUrl("/_all_dbs")},parse:function(e){return e.map((function(e){return{id:le.utils.safeURLName(e),name:e}}))},paginated:function(e,t){var n=(e-1)*t,a=e*t;return this.slice(n,a)}}),oN.SharedModel=Ge.Model.extend({url:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"server";return se.urls("databaseBaseURL",e,this.safeID())}}),oN.Status=Ge.Status.extend({diskSize:function(){return this.get("other").data_size},url:function(){var e=this.get("database").get("name"),t=e.split("/")[0],n=e.replace(t+"/","");return"/_api/v2/user/shared_databases/proxy/"+le.utils.safeURLName(n)+"?remote_account="+le.utils.safeURLName(t)},readAccess:!0,writeAccess:!1,replicationAccess:!1,adminAccess:!1,isAvailable:!1,revokeAccess:function(){this.readAccess=!1,this.writeAccess=!1,this.replicationAccess=!1,this.adminAccess=!1,this.isAvailable=!1},setPermissions:function(){var e=this;this.isAvailable=!0;var t=this.get("name").split("/")[0],n=this.get("name").split("/")[1],a=new oN.SharedDatabasesPermissions({sharer:t,database:n});a.fetchOnce().then((function(){var t,n,r=a.get("cloudant");void 0!==r&&se.cloudantUser.fetchOnce().then((function(){t=se.cloudantUser.get("username"),r[t]&&(n=r[t],r.nobody&&(n=n.concat(r.nobody)),n.forEach(function(e){if("_admin"===e)this.readAccess=!0,this.writeAccess=!0,this.replicationAccess=!0,this.adminAccess=!0;else switch(e){case"_reader":this.readAccess=!0;break;case"_writer":this.writeAccess=!0;break;case"_replicator":this.replicationAccess=!0}}.bind(e)),e.trigger("change"))}))}))}}),oN.SharedDatabases=Ge.List.extend({model:oN.SharedModel,perPage:500,page:1,url:function(){return"/_api/v2/user/shared_databases?per_page="+this.perPage},parse:function(e){return this.total=parseInt(e.total,10),e.shared_databases.map((function(e){return{id:encodeURIComponent(e),name:e}}))}}),oN.SharedDatabasesPermissions=Ge.Status.extend({initialize:function(e){this.sharer=e.sharer,this.database=e.database},url:function(){return"/_api/v2/user/shared_databases/proxy/"+le.utils.safeURLName(this.database)+"/_security?remote_account="+le.utils.safeURLName(this.sharer)},parse:function(e){return e}});var iN=oN,sN={};sN.SharedAllDocs=wg.AllDocs.extend({initialize:function(e,t){this.username=t.username,this.password=t.password,this.database=t.database,this.params=_.clone(t.params),this.on("remove",this.decrementTotalRows,this),this.perPageLimit=t.perPageLimit||20,this.params.limit||(this.params.limit=this.perPageLimit)},urlRef:function(e,t){var n="";return t?n=_.isEmpty(t)?"":"?"+r.a.param(t):this.params&&(n="?"+r.a.param(this.params)),_.isUndefined(e)&&(e="server"),se.urls("allDocs",e,this.database.safeID(),n)}}),sN.SharedDocument=wg.Doc.extend({initialize:function(e,t){this.database=t.database,this.doc=t.id},copyShared:function(e){return r.a.ajax({type:"COPY",url:se.urls("document","server",this.database.safeID(),this.doc),headers:{Destination:e}})}});var cN=sN,lN=wg.RouteObjects[0],uN=wg.RouteObjects[1],dN=wg.RouteObjects[2],pN=wg.RouteObjects[3],fN=uN.extend({selectedHeader:"Databases",routes:{"database/shared/:user/:database/_all_docs(:extra)":{route:"sharedAllDocs",roles:["_reader","_writer","_admin"]},"database/shared/:user/:database(:extra)":{route:"sharedAllDocs",roles:["_reader","_writer","_admin"]},"database/shared/:user/:database/_changes(:params)":{route:"sharedChanges",roles:["fx_loggedIn"]},"database/shared/:user/:database/_design/:ddoc/_info":{route:"sharedMetadata",roles:["fx_loggedIn"]}},initialize:function(e,t){le.getParams().include_docs=!0,this.username=cN.sharedUsername=t[0],this.databaseName=t[1],this.database=new iN.SharedModel({id:this.databaseName,name:this.username}),this.user=new HE.User,this.data={username:this.username,database:this.database},this.data.designDocs=new cN.SharedAllDocs(null,{username:this.username,database:this.database,paging:{pageSize:500},params:{startkey:'"_design"',endkey:'"_design1"',include_docs:!0,limit:500}});var n=t.slice(1);uN.prototype.initialize.call(this,e,n)},getAllDatabases:function(){return new iN.SharedDatabases},sharedAllDocs:function(e,t,n){return this.username=cN.sharedUsername=e,this.globalAllDocs(t,n)},sharedChanges:function(){return this.changes()},sharedMetadata:function(e,t,n){return this.designDocMetadataNoPartition(t,n)}}),hN=dN.extend({routes:{"database/shared/:user/:database/_design/:ddoc/_view/:viewName":{route:"sharedView",roles:["fx_loggedIn"]},"database/shared/:user/:database/_design/:ddoc/_view/:view/edit":{route:"editSharedView",roles:["fx_loggedIn"]},"database/shared/:user/:database/new_view":"sharedNewViewEditor","database/shared/:user/:database/new_view/:designDoc":"sharedNewViewEditor"},initialize:function(e,t){var n=t[1];this.username=cN.sharedUsername=t[0],this.databaseName=n,this.database=new iN.SharedModel({id:this.databaseName,name:this.username}),this.createDesignDocsCollection(),this.addSidebar()},sharedView:function(e,t,n,a){return this.showGlobalView(t,n,a)},editSharedView:function(e,t,n,a){return this.editViewNoPartition(t,n,a)},sharedNewViewEditor:function(e,t,n){return this.createViewNoPartition(t,n)}}),mN=pN.extend({routes:{"database/shared/:user/:database/_index":{route:"sharedCreateIndex",roles:["fx_loggedIn"]},"database/shared/:user/:database/_find":{route:"sharedFindUsingIndex",roles:["fx_loggedIn"]}},initialize:function(e,t){this.username=cN.sharedUsername=t[0],this.databaseName=t[1],this.database=new iN.SharedModel({id:this.databaseName,name:this.username})},sharedFindUsingIndex:function(){var e=arguments[1];return this.findUsingIndexNoPartition.apply(this,[e])},sharedCreateIndex:function(){var e=arguments[1];return this.createIndexNoPartition.apply(this,[e])}}),gN=lN.extend({selectedHeader:"Databases",routes:{"database/shared/:user/:database/:doc/code_editor":"sharedCodeEditor","database/shared/:user/:database/:doc":"sharedCodeEditor","database/shared/:user/:database/_design/:ddoc":"sharedShowDesignDoc","database/shared/:user/:database/_new":"sharedNewDocument"},initialize:function(e,t){le.getParams().include_docs=!0,this.username=cN.sharedUsername=t[0],this.databaseName=t[1],this.docID=t[2]||"new",this.isNewDoc=!1,this.database=new iN.SharedModel({id:this.databaseName,name:this.username}),this.user=new HE.User;var n=t.slice(1);lN.prototype.initialize.call(this,e,n)},sharedCodeEditor:function(e,t,n){this.databaseName!==t&&(this.databaseName=t,this.database=new iN.SharedModel({id:this.databaseName,name:this.username})),this.doc=new cN.SharedDocument({_id:n},{name:this.username,database:this.database,id:n}),"new"===n&&(this.doc=new wg.NewDoc(null,{database:this.database})),cf({doc:this.doc,database:this.database});var a=[{type:"back",link:se.urls("allDocs","app",this.database.id)},{name:n+" ("+this.username+")"}];return de.a.createElement(Ot,{crumbs:a,endpoint:this.doc.url("apiurl"),docURL:this.doc.documentation(),component:de.a.createElement(ah,{database:this.database,isNewDoc:this.isNewDoc,previousUrl:"#/"+this.database.url("app")})})},sharedShowDesignDoc:function(e,t,n){return this.showDesignDoc(t,n)},sharedNewDocument:function(e,t){return this.sharedCodeEditor(e,t,"new")},sharedDuplicateDoc:function(e){var t=this.doc=new cN.SharedDocument({_id:this.docID},{name:this.username,database:this.database,id:this.docID}),n=this.database,a=this.username;this.docID=e,t.copyShared(e).then((function(){t.set({_id:e}),se.navigate("/database/shared/"+a+"/"+n.safeID()+"/"+le.utils.safeURLName(e),{trigger:!0}),se.addNotification({msg:"Document has been duplicated."})}),(function(e){var t="Could not duplicate document, reason: "+e.responseText+".";se.addNotification({msg:t,type:"error"})}))}});cN.RouteObjects=[gN,hN,fN,mN];var bN=cN,yN=[{label:"Single field (json)",code:{index:{fields:["foo"]},name:"foo-json-index",type:"json"}},{label:"Multiple fields (json)",code:{index:{fields:["foo","bar"]},name:"foo-bar-json-index",type:"json"}},{label:"Single field (text)",code:{index:{fields:[{name:"foo",type:"string"}]},name:"foo-text",type:"text"}},{label:"All fields (text)",code:{index:{default_field:{enabled:!1},index_array_lengths:!1},name:"all-text",type:"text"}},{label:"All fields with default field (text)",code:{index:{index_array_lengths:!1},name:"all-text",type:"text"}}],EN=[{code:{selector:{_id:{$gt:"0"}},fields:["_id","_rev"],sort:[{_id:"asc"}]}},{code:{selector:{_id:{$gt:null}}}}];function _N(e){return e&&(e=e+"&remote_account="+bN.sharedUsername),e||(e="?remote_account="+bN.sharedUsername),e}vn.getPreviousPageForDoc=function(e,t){var n=e.url("index"),a=n,r=se.router.lastPages;return!t&&r.length>=2&&(/_new$/.test(r[1])?a=r[0]:/backups/.test(r[1])?(a=r[0])+"/backups"===r[1]&&(a=n):a=r[1]),a},bN.addRemoteAccount=_N;var vN=A.getServerUrl("/_api/v2/user/shared_databases/proxy/");bN.proxyUrl=vN,bN.sharedUrlPaths={host:function(){return"https://"+bN.sharedUsername+".cloudant.com/"},userHash:function(){return"database/shared/"+bN.sharedUsername+"/"},databaseBaseURL:{server:function(e){var t=_N();return vN+e+t},app:function(e){return bN.sharedUrlPaths.userHash()+e}},allDBs:{app:function(){return"shared-database"}},allDocs:{server:function(e,t){return t=_N(t),vN+e+"/_all_docs"+t},app:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_all_docs"+t},apiurl:function(e,t){return bN.sharedUrlPaths.host()+e+"/_all_docs"+t}},allDocsSanitized:{server:function(e,t){return e=encodeURIComponent(e),t=_N(t),vN+e+"/_all_docs"+t},app:function(e,t){return e=encodeURIComponent(e),bN.sharedUrlPaths.userHash()+e+"/_all_docs"+t},apiurl:function(e,t){return e=encodeURIComponent(e),bN.sharedUrlPaths.host()+"/"+e+"/_all_docs"+t}},bulk_docs:{server:function(e,t){return t=_N(t),vN+e+"/_bulk_docs"+t},app:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_bulk_docs"+t},apiurl:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_bulk_docs"+t}},changes:{server:function(e,t){return t=_N(t),vN+e+"/_changes"+t},app:function(e,t){return"/"+bN.sharedUrlPaths.userHash()+e+"/_changes"+t},apiurl:function(e,t){return bN.sharedUrlPaths.host()+e+"/_changes"+t}},designDocs:{server:function(e,t){var n=_N(n);return vN+e+"/"+t+"/_info"+n},app:function(e,t,n){return bN.sharedUrlPaths.userHash()+e+"/_design/"+le.utils.safeURLName(n)+"/_info"},apiurl:function(e,t){return bN.sharedUrlPaths.host()+e+"/_design"+le.utils.safeURLName(t)+"/_info"}},view:{server:function(e,t,n,a){var r=_N(r);return vN+e+"/_design/"+n+"/_view/"+a+r},app:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_design/"+le.utils.safeURLName(t)+"/_view/"},apiurl:function(e,t,n,a){return bN.sharedUrlPaths.host()+e+"/_design/"+n+"/_view/"+a},showNewlySavedView:function(e,t,n){return bN.sharedUrlPaths.userHash()+e+"/"+t+"/_view/"+n},edit:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/_design/"+n+"/_view/"+a+"/edit"},showView:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/"+n+"/_view/"+a}},permissions:{server:function(e){var t=_N(t);return vN+e+"/_security"+t},app:function(e){return"/"+bN.sharedUrlPaths.userHash()+e+"/permissions"},apiurl:function(e){return bN.sharedUrlPaths.host()+e+"/_security"}},document:{server:function(e,t,n){var a=_N(n);return vN+e+"/"+t+a},attachment:function(e,t,n,a){return a=_N(a),vN+e+"/"+t+"/"+n+a},app:function(e,t){return"/"+bN.sharedUrlPaths.userHash()+e+"/"+t},apiurl:function(e,t){return bN.sharedUrlPaths.host()+e+"/"+t},"web-index":function(e,t){return"/"+bN.sharedUrlPaths.userHash()+e+"/"+t}},new:{newDocument:function(e){return"/"+bN.sharedUrlPaths.userHash()+e+"/_new"},newView:function(e){return"/"+bN.sharedUrlPaths.userHash()+e+"/new_view"},newSearch:function(e){return"/"+bN.sharedUrlPaths.userHash()+e+"/new_search"},addView:function(e,t,n){return"/"+bN.sharedUrlPaths.userHash()+e+"/new_view/"+n},addSearch:function(e,t){return"/"+bN.sharedUrlPaths.userHash()+e+"/new_search/"+t}},base:{server:function(e){return bN.sharedUrlPaths.host()+e+"/"},app:function(e){return"/"+bN.sharedUrlPaths.userHash()+e+"/"}},mango:{"index-server":function(e,t){return t=_N(t),vN+e+"/_index"+t},"index-apiurl":function(e,t,n){return bN.sharedUrlPaths.host()+e+"/_index"+n},"index-app":function(e,t,n){return n||(n=""),"/"+bN.sharedUrlPaths.userHash()+e+"/_index"+n},"index-server-bulk-delete":function(e,t){return t=_N(t),vN+e+"/_index/_bulk_delete"+t},"query-server":function(e,t,n){return n=_N(n),vN+e+"/_find"+n},"query-apiurl":function(e,t,n){return bN.sharedUrlPaths.host()+e+"/_index"+n},"query-app":function(e,t,n){return n||(n=""),"/"+bN.sharedUrlPaths.userHash()+e+"/_find"+n},"explain-server":function(e,t,n){return n=_N(n),vN+e+"/_explain"+n},"explain-apiurl":function(e){return bN.sharedUrlPaths.host()+e+"/_explain"}},replication:{app:function(e){return"#/replication/shared/"+bN.sharedUsername+"/"+e}}},bN.initialize=function(){se.registerExtension("urls:interceptors",(function(e,t){if(!/database\/shared\//.test(window.location.hash))return!1;if(!bN.sharedUrlPaths[e][t])return!1;var n=Array.prototype.slice.call(arguments,2),a=bN.sharedUrlPaths[e][t].apply(null,n);return a})),se.registerExtension("sidebar:viewFilters",(function(e){var t=e.get("doc");return!(t&&!_.isUndefined(t.language)&&"query"===t.language)})),se.registerExtension("mango:indexTemplates",yN),se.registerExtension("mango:queryHistory",EN)};var SN=bN,NN={PERMISSIONS_DB_SECURITY_RESET:"PERMISSIONS_DB_SECURITY_RESET",PERMISSIONS_DB_SECURITY_RETURNED:"PERMISSIONS_DB_SECURITY_RETURNED",PERMISSIONS_API_GENERATE_KEY_START:"PERMISSIONS_API_GENERATE_KEY_START",PERMISSIONS_API_KEY_GENERATED:"PERMISSIONS_API_KEY_GENERATED",PERMISSIONS_SECURITY_DATA_ERROR:"PERMISSIONS_SECURITY_DATA_ERROR",PERMISSIONS_SET_PERMISSIONS_UPDATE_PENDING:"PERMISSIONS_SET_PERMISSIONS_UPDATE_PENDING",PERMISSIONS_CLEAR_PENDING_UPDATE:"PERMISSIONS_CLEAR_PENDING_UPDATE",PERMISSIONS_SHARED_DB_NO_ACCESS:"PERMISSIONS_SHARED_DB_NO_ACCESS",PERMISSIONS_SHARED_DB_SECURITY_RETURNED:"PERMISSIONS_SHARED_DB_SECURITY_RETURNED",PERMISSIONS_SET_DELETE_USERNAME_PENDING:"PERMISSIONS_SET_DELETE_USERNAME_PENDING",PERMISSIONS_TOGGLE_BULK_SELECT:"PERMISSIONS_TOGGLE_BULK_SELECT",PERMISSIONS_TOGGLE_SINGLE_ROW:"PERMISSIONS_TOGGLE_SINGLE_ROW",PERMISSIONS_SHOW_BULK_DELETE_MODAL:"PERMISSIONS_SHOW_BULK_DELETE_MODAL",PERMISSIONS_HIDE_BULK_DELETE_MODAL:"PERMISSIONS_HIDE_BULK_DELETE_MODAL",PERMISSIONS_SET_BULK_DELETE_USERNAME_PENDING:"PERMISSIONS_SET_BULK_DELETE_USERNAME_PENDING",PERMISSIONS_SET_SEARCH_FILTER:"PERMISSIONS_SET_SEARCH_FILTER"},DN={updateRoles:function(e,t,n,a){return a?(-1===t.indexOf(n)&&t.push(n),"_admin"===n&&(t=e)):t=t.filter((function(e){return e!==n})),t}},ON=DN,wN={getDefaultRoles:function(){return["_admin","_reader","_writer","_replicator"]},getNewUserDefaultRoles:function(){return["_reader"]},DEFAULT_USER_LABEL:"Unauthenticated connections"};function TN(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function CN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AN(){return(AN=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var IN=0;function PN(e){return v(se.urls("permissions","server",e))}function RN(e,t){var n=A.getServerUrl("/_api/v2/db/"+e+"/_security");return D(n,t)}function kN(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;se.dispatch({type:NN.PERMISSIONS_DB_SECURITY_RETURNED,options:{security:e,pendingUpdateCounter:t}})}function LN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;se.addNotification({msg:"There was an error updating the permissions for this database.",type:"error",clear:!0}),null!==e&&se.dispatch({type:NN.PERMISSIONS_CLEAR_PENDING_UPDATE,options:{pendingUpdateCounter:e}})}var xN={initPermissions:function(e){se.dispatch({type:NN.PERMISSIONS_DB_SECURITY_RESET,options:{isSharedDB:!1}}),PN(e).then((function(e){if(e.error)throw new Error(e.error);se.dispatch({type:NN.PERMISSIONS_DB_SECURITY_RETURNED,options:{security:e}})})).catch((function(){se.dispatch({type:NN.PERMISSIONS_SECURITY_DATA_ERROR})}))},initSharedPermissions:function(e){se.dispatch({type:NN.PERMISSIONS_DB_SECURITY_RESET,options:{isSharedDB:!0}}),PN(e).then((function(e){se.dispatch({type:NN.PERMISSIONS_SHARED_DB_SECURITY_RETURNED,options:{security:e}})})).catch((function(){se.dispatch({type:NN.PERMISSIONS_SHARED_DB_NO_ACCESS})}))},getSecurityData:PN,saveSecurityData:RN,generateAPIKey:function(e,t){se.dispatch({type:NN.PERMISSIONS_API_GENERATE_KEY_START}),N(le.hostDash+"/api_keys").then((function(n){if(n.error)throw new Error(n.error);var a=n.key,r=n.password;e.cloudant[a]=wN.getNewUserDefaultRoles(),RN(t,e).then((function(t){if(t.error)throw new Error(t.error);kN(e),se.addNotification({msg:"The API Key <code>"+a+"</code> has been created and given <b>_reader</b> permissions on this database.",type:"success",escape:!1,clear:!0})})).catch((function(){LN()})),se.dispatch({type:NN.PERMISSIONS_API_KEY_GENERATED,options:{key:a,password:r}})})).catch((function(e){se.addNotification({msg:e.message,type:"error",clear:!0})}))},grantPermissions:function(e,t,n){e.cloudant[t]=wN.getNewUserDefaultRoles(),RN(n,e).then((function(n){if(n.error)throw new Error(n.error);kN(e),se.addNotification({msg:"<code>"+t+"</code> has been given <b>_reader</b> permissions on this database.",type:"success",escape:!1,clear:!0})})).catch((function(){LN()}))},clearPermissions:function(e,t,n){var a=++IN;se.dispatch({type:NN.PERMISSIONS_SET_DELETE_USERNAME_PENDING,options:{pendingUpdateCounter:a,username:t}});var r=AN({},e);delete r.cloudant[t],RN(n,r).then((function(t){if(t.error)throw new Error(t.error);kN(e,a),se.addNotification({msg:"Database permissions have been saved.",type:"success",escape:!1,clear:!0})})).catch((function(){LN(a)}))},setPermission:function(e,t,n,a,r,o){var i=AN({},e);i.cloudant[a]=ON.updateRoles(n,i.cloudant[a],r,o);var s=++IN;se.dispatch({type:NN.PERMISSIONS_SET_PERMISSIONS_UPDATE_PENDING,options:{pendingUpdateCounter:s,username:a,role:r,isEnabled:o}}),RN(t,i).then((function(e){if(e.error)throw new Error(e.error);kN(i,s),se.addNotification({msg:"Database permissions have been saved.",type:"success",escape:!1,clear:!0})})).catch((function(){LN(s)}))},toggleBulkSelect:function(){se.dispatch({type:NN.PERMISSIONS_TOGGLE_BULK_SELECT})},toggleRow:function(e,t){se.dispatch({type:NN.PERMISSIONS_TOGGLE_SINGLE_ROW,options:{username:e,isChecked:t}})},showConfirmBulkDeleteModal:function(){se.dispatch({type:NN.PERMISSIONS_SHOW_BULK_DELETE_MODAL})},hideConfirmBulkDeleteModal:function(){se.dispatch({type:NN.PERMISSIONS_HIDE_BULK_DELETE_MODAL})},bulkDelete:function(e,t,n){var a=this,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TN(n,!0).forEach((function(t){CN(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TN(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);n.forEach((function(e){delete r.cloudant[e]})),RN(t,r).then((function(){kN(r),a.hideConfirmBulkDeleteModal(),se.addNotification({msg:"The database permissions have been updated.",type:"success",escape:!1,clear:!0})}),(function(){LN(),a.hideConfirmBulkDeleteModal()}))},setSearchFilter:function(e){se.dispatch({type:NN.PERMISSIONS_SET_SEARCH_FILTER,options:{filter:e}})}},UN={};function MN(e){return(MN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HN(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function BN(e,t,n){return t&&HN(e.prototype,t),n&&HN(e,n),e}function GN(e,t){return!t||"object"!==MN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qN(e){return(qN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VN(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FN(e,t)}function FN(e,t){return(FN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}UN.DatabasePermissionsStore=se.Store.extend({initialize:function(){this._isAuthenticated=!1,this.reset()},reset:function(){this._mayAccessPermissionsPage=!1,this._virtualHostsLoaded=!1,this._errorLoadingPermissions=!1,this._errorLoadingVirtualHosts=!1,this._allVirtualHosts=[],this._filteredVirtualHosts=[],this._isGeneratingAPIKey=!1,this._permissionsReturned=!1,this._availableRoles=wN.getDefaultRoles(),this._permissionTableRows=[],this._apiKey=null,this._apiPassword=null,this._isSharedDB=!1,this._pendingPermissionUpdates=[],this._bulkSelectChecked=!1,this._checkedRows=[],this._userList=[],this._bulkDeleteModalVisible=!1,this._searchFilter=""},isLoaded:function(){return this._isAuthenticated&&this._permissionsReturned},setAuthenticated:function(e){this._isAuthenticated=!0,this._currentUser=e,this._permissionsReturned&&this.parsePermissions(this._security)},mayAccessPermissionsPage:function(){return this._mayAccessPermissionsPage},setMayAccess:function(e){this._mayAccessPermissionsPage=e},setIsSharedDB:function(e){this._isSharedDB=e},setPermissionsReturned:function(){this._permissionsReturned=!0},parsePermissions:function(e){var t=this;(this._permissionsReturned=!0,this._security=e,this._filteredVirtualHosts=[],this._isSharedDB&&this._isAuthenticated)&&(this.setMayAccess(!1),e&&e.cloudant&&-1!==_.union(e.cloudant[this._currentUser],e.cloudant.nobody).indexOf("_admin")&&this.setMayAccess(!0));if(this._isAuthenticated&&this._mayAccessPermissionsPage)if(this._permissionTableRows=[{username:this._currentUser,specialRow:"currentUser",roles:wN.getDefaultRoles()}],e.cloudant){this._availableRoles=_.reduce(e.cloudant,(function(e,t){return _.union(e,t)}),wN.getDefaultRoles()),this._permissionTableRows[0].roles=this._availableRoles;var n=Object.keys(e.cloudant).map((function(t){return{username:t,roles:e.cloudant[t]}})),a=(n=n.filter((function(e){return""!==e.username}))).find((function(e){return"nobody"===e.username})),r=a&&a.roles?a.roles:[];n=(n=(n=n.filter((function(e){return"nobody"!==e.username}))).filter((function(e){return e.username!==t._currentUser}))).sort((function(e,t){return e.username.localeCompare(t.username)})),this._userList=n,this._permissionTableRows=_.union(this._permissionTableRows,n);var o=this._allVirtualHosts.map((function(e){return e.host}));this._permissionTableRows=this._permissionTableRows.filter((function(e){var n=-1!==o.indexOf(e.username)||e.username.indexOf("cloudant.com")>-1;return n&&t._filteredVirtualHosts.push(e),!n})),this._permissionTableRows.push({username:"nobody",specialRow:"default",roles:r})}else this._permissionTableRows.push({username:"nobody",specialRow:"default",roles:[]})},getAvailableRoles:function(){return this._availableRoles},getPermissionTableRows:function(){var e=this.includePendingUpdates(this._permissionTableRows);if(!this._searchFilter)return e;var t=new RegExp(this._searchFilter,"i");return e.filter((function(e){return"nobody"!==e.username&&t.test(e.username)}))},getDatabaseSecurity:function(){var e=this,t={};return this._permissionTableRows.forEach((function(n){var a=n.username,r=n.roles;(e._isSharedDB||e._currentUser!=a)&&(t[a]=r)})),this._filteredVirtualHosts.forEach((function(e){var n=e.username,a=e.roles;t[n]=a})),this._pendingPermissionUpdates.filter((function(e){return"update"===e.changeType})).forEach((function(n){var a=n.username,r=n.role,o=n.isEnabled;t[a]=ON.updateRoles(e.getAvailableRoles(),t[a],r,o)})),this._pendingPermissionUpdates.filter((function(e){return"delete"===e.changeType})).forEach((function(e){var n=e.username;delete t[n]})),{_id:"security",cloudant:t}},isGeneratingAPIKey:function(){return this._isGeneratingAPIKey},setAPIKey:function(e,t){this._isGeneratingAPIKey=!1,this._apiKey=e,this._apiPassword=t},getAPIKey:function(){return this._apiKey},getAPIPassword:function(){return this._apiPassword},hadErrorLoadingPermissions:function(){return this._errorLoadingPermissions},hadErrorLoadingVirtualHosts:function(){return this._errorLoadingVirtualHosts},setVirtualHosts:function(e,t){this._virtualHostsLoaded=!0,this._errorLoadingVirtualHosts=!e,t&&(this._allVirtualHosts=t),this._permissionsReturned&&this.parsePermissions(this._security)},getVirtualHosts:function(){return this._virtualHostsLoaded&&this._permissionsReturned?this.includePendingUpdates(this._filteredVirtualHosts):[]},setPendingPermissionsUpdate:function(e){var t=e.pendingUpdateCounter,n=e.username,a=e.role,r=e.isEnabled;this._pendingPermissionUpdates.push({changeType:"update",counter:t,username:n,role:a,isEnabled:r})},setPendingDeleteUser:function(e){var t=e.username,n=e.pendingUpdateCounter;this._pendingPermissionUpdates.push({changeType:"delete",counter:n,username:t})},includePendingUpdates:function(e){var t=this,n=r.a.extend(!0,[],e);return n=n.map((function(e){return t._pendingPermissionUpdates.filter((function(t){return t.username===e.username&&"update"===t.changeType})).forEach((function(n){e.roles=ON.updateRoles(t.getAvailableRoles(),e.roles,n.role,n.isEnabled)})),e})),this._pendingPermissionUpdates.filter((function(e){return"delete"===e.changeType})).forEach((function(e){var t=e.username;n=n.filter((function(e){return e.username!==t}))})),n},applyPendingUpdate:function(e){var t=this._pendingPermissionUpdates.find((function(t){return t.counter===e}));if(t){var n=this._permissionTableRows.find((function(e){return e.username===t.username}));n||(n=this._filteredVirtualHosts.find((function(e){return e.username===t.username}))),"update"===t.changeType?n.roles=ON.updateRoles(this.getAvailableRoles(),n.roles,t.role,t.isEnabled):(this._permissionTableRows=this._permissionTableRows.filter((function(e){return e.username!==t.username})),this._filteredVirtualHosts=this._filteredVirtualHosts.filter((function(e){return e.username!==t.username}))),this.clearPendingUpdate(e)}},clearPendingUpdate:function(e){e&&(this._pendingPermissionUpdates=this._pendingPermissionUpdates.filter((function(t){return t.counter!==e})))},toggleBulkSelect:function(){this._bulkSelectChecked=!this._bulkSelectChecked,this._bulkSelectChecked?this._checkedRows=this._userList.map((function(e){return e.username})):this._checkedRows=[]},isBulkSelectChecked:function(){return this._bulkSelectChecked},getCheckedRows:function(){return this._checkedRows},toggleSingleRow:function(e,t){t?this._checkedRows.push(e):this._checkedRows=this._checkedRows.filter((function(t){return t!==e})),this._checkedRows.length||(this._bulkSelectChecked=!1)},isBulkDeleteModalVisible:function(){return this._bulkDeleteModalVisible},getNumCustomUsers:function(){return this._userList.length},getSearchFilter:function(){return this._searchFilter},dispatch:function(e){switch(e.type){case sy.USER_AUTHENTICATED:this.setAuthenticated(e.options.username);break;case sy.VIRTUAL_HOSTS_LOADED:this.setVirtualHosts(e.options.success,e.options.virtualHosts);break;case NN.PERMISSIONS_DB_SECURITY_RESET:this.reset(),this.setIsSharedDB(e.options.isSharedDB);break;case NN.PERMISSIONS_DB_SECURITY_RETURNED:this.setMayAccess(!0),this.parsePermissions(e.options.security),this.applyPendingUpdate(e.options.pendingUpdateCounter);break;case NN.PERMISSIONS_SHARED_DB_SECURITY_RETURNED:this.parsePermissions(e.options.security),this.applyPendingUpdate(e.options.pendingUpdateCounter);break;case NN.PERMISSIONS_API_GENERATE_KEY_START:this._isGeneratingAPIKey=!0;break;case NN.PERMISSIONS_API_KEY_GENERATED:this.setAPIKey(e.options.key,e.options.password);break;case NN.PERMISSIONS_SECURITY_DATA_ERROR:this._permissionsReturned=!0,this._errorLoadingPermissions=!0;break;case NN.PERMISSIONS_SHARED_DB_NO_ACCESS:this._permissionsReturned=!0,this.setMayAccess(!1);break;case NN.PERMISSIONS_SET_PERMISSIONS_UPDATE_PENDING:this.setPendingPermissionsUpdate(e.options);break;case NN.PERMISSIONS_CLEAR_PENDING_UPDATE:this.clearPendingUpdate(e.options.pendingUpdateCounter);break;case NN.PERMISSIONS_SET_DELETE_USERNAME_PENDING:this.setPendingDeleteUser(e.options);break;case NN.PERMISSIONS_TOGGLE_BULK_SELECT:this.toggleBulkSelect();break;case NN.PERMISSIONS_TOGGLE_SINGLE_ROW:this.toggleSingleRow(e.options.username,e.options.isChecked);break;case NN.PERMISSIONS_SHOW_BULK_DELETE_MODAL:this._bulkDeleteModalVisible=!0;break;case NN.PERMISSIONS_HIDE_BULK_DELETE_MODAL:this._bulkDeleteModalVisible=!1;break;case NN.PERMISSIONS_SET_SEARCH_FILTER:this._searchFilter=e.options.filter;break;default:return}this.triggerChange()}}),UN.databasePermissionsStore=new UN.DatabasePermissionsStore,UN.databasePermissionsStore.dispatchToken=se.dispatcher.register(UN.databasePermissionsStore.dispatch.bind(UN.databasePermissionsStore));var KN=_o.ConfirmationModal,WN=UN.databasePermissionsStore,XN=hy.accountStore,zN=Jr.LoadLines,YN=Jr.BulkActionComponent,QN=Jr.Copy,JN=function(e){function t(e){var n;return jN(this,t),(n=GN(this,qN(t).call(this,e))).state=n.getStoreState(),n}return VN(t,e),BN(t,[{key:"componentDidMount",value:function(){WN.on("change",this.onChange,this),XN.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){WN.off("change",this.onChange),XN.off("change",this.onChange)}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"getStoreState",value:function(){return{isLoaded:WN.isLoaded(),errorLoadingPermissions:WN.hadErrorLoadingPermissions(),errorLoadingVirtualHosts:WN.hadErrorLoadingVirtualHosts(),permissionTableRows:WN.getPermissionTableRows(),availableRoles:WN.getAvailableRoles(),virtualHosts:WN.getVirtualHosts(),dbSecurity:WN.getDatabaseSecurity(),isGenerating:WN.isGeneratingAPIKey(),apiKey:WN.getAPIKey(),apiPassword:WN.getAPIPassword(),mayAccess:WN.mayAccessPermissionsPage(),bulkSelectChecked:WN.isBulkSelectChecked(),checkedRows:WN.getCheckedRows(),confirmBulkDeleteModalVisible:WN.isBulkDeleteModalVisible(),numCustomUsers:WN.getNumCustomUsers(),searchFilter:WN.getSearchFilter(),legacyCredsEnabled:XN.isLegacyCredsEnabled()}}},{key:"render",value:function(){var e=this.props,t=e.databaseName,n=e.isSharedDB,a=e.sharer,r=this.state,o=r.isLoaded,i=r.errorLoadingPermissions,s=r.dbSecurity,c=r.permissionTableRows,l=r.availableRoles,u=r.isGenerating,d=r.apiKey,p=r.apiPassword,f=r.mayAccess,h=r.errorLoadingVirtualHosts,m=r.virtualHosts,g=r.bulkSelectChecked,b=r.checkedRows,y=r.confirmBulkDeleteModalVisible,E=r.numCustomUsers,v=r.searchFilter,S=r.legacyCredsEnabled;return n&&a&&c.unshift({username:a,roles:wN.getDefaultRoles()}),o?i?de.a.createElement("p",{className:"permissions-data-load-error"},"There was an error loading the permissions data."):f?S?de.a.createElement("div",{className:"permissions-page"},de.a.createElement($N,{isSharedDB:n,sharer:a,databaseName:t,rows:c,errorLoadingVirtualHosts:h,virtualHosts:m,availableRoles:l,onDelete:function(e){return xN.clearPermissions(s,e,t)},onUpdate:function(e,n,a){return xN.setPermission(s,t,l,e,n,a)},bulkSelectChecked:g,checkedRows:b,numCustomUsers:E,searchFilter:v}),de.a.createElement(ZN,{existingUsers:_.keys(s.cloudant),onSubmit:function(e){return xN.grantPermissions(s,e,t)}}),de.a.createElement(tD,{isGenerating:u,apiKey:d,apiPassword:p,onGenerate:function(){return xN.generateAPIKey(s,t)}}),de.a.createElement(KN,{title:"Confirm Deletion",visible:y,text:"Are you sure you want to delete these rows?",onClose:xN.hideConfirmBulkDeleteModal,onSubmit:function(){return xN.bulkDelete(s,t,b)},buttonClass:"btn-danger",successButtonLabel:"Delete"})):de.a.createElement("p",{className:"permissions-iam-notice"},de.a.createElement("p",null,"Access to this account can be configured via IBM Cloud Identity and Access Management (IAM) at ",de.a.createElement("a",{href:"https://cloud.ibm.com/iam",target:"_blank",rel:"noopener noreferrer"},"https://cloud.ibm.com/iam"),"."),de.a.createElement("p",null,"You can learn more about IAM at ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/iam?topic=iam-getstarted",target:"_blank",rel:"noopener noreferrer"},"https://cloud.ibm.com/docs/iam?topic=iam-getstarted"),".")):de.a.createElement("p",{className:"permissions-no-access"},"You have not been granted access to view this page."):de.a.createElement(zN,null)}}]),t}(de.a.Component);JN.propTypes={databaseName:tt.a.string.isRequired,isSharedDB:tt.a.bool.isRequired,sharer:tt.a.string};var ZN=function(e){function t(e){var n;return jN(this,t),(n=GN(this,qN(t).call(this,e))).state={newUser:""},n}return VN(t,e),BN(t,[{key:"submit",value:function(e){e.preventDefault(),"nobody"!==this.state.newUser?-1===this.props.existingUsers.indexOf(this.state.newUser)?this.props.onSubmit(this.state.newUser):se.addNotification({msg:"The <code>"+this.state.newUser+"</code> user has already been added.",type:"info",escape:!1,clear:!0}):se.addNotification({msg:"The <code>nobody</code> username is special. Please enter a different username.",type:"error",escape:!1,clear:!0})}},{key:"render",value:function(){var e=this;return de.a.createElement("form",{className:"grant-permissions-form flex-layout flex-row",onSubmit:this.submit.bind(this)},de.a.createElement("label",{htmlFor:"grant-rights-field"},"Grant database permissions to:"),de.a.createElement("input",{type:"text",id:"grant-rights-field",className:"flex-body",placeholder:"Username or API Key",value:this.state.user,onChange:function(t){return e.setState({newUser:t.target.value})}}),de.a.createElement("input",{type:"submit",className:"btn btn-secondary",disabled:""===this.state.newUser,value:"Grant Permissions"}))}}]),t}(de.a.Component);ZN.propTypes={onSubmit:tt.a.func.isRequired,existingUsers:tt.a.array.isRequired};var $N=function(e){function t(){return jN(this,t),GN(this,qN(t).apply(this,arguments))}return VN(t,e),BN(t,[{key:"getColHeaders",value:function(e){return e.map((function(e,t){return"_creator"===e?de.a.createElement("th",{className:"muted",title:"The _creator role has been deprecated",key:t}):de.a.createElement("th",{key:t,className:"rights-col"},e)}))}},{key:"getRows",value:function(e){var t=this.props,n=t.availableRoles,a=t.onDelete,r=t.onUpdate,o=t.isSharedDB,i=t.sharer,s=t.checkedRows,c=t.numCustomUsers,l=t.searchFilter;return e.map((function(e,t){var u=-1!==s.indexOf(e.username);return de.a.createElement(eD,{key:t,isSharedDB:o,sharer:i,user:e,availableRoles:n,isChecked:u,onDelete:a,onUpdate:r,showBulkSelectCol:c>0&&""===l})}))}},{key:"getVirtualHostsSection",value:function(){var e=this.props,t=e.errorLoadingVirtualHosts,n=e.virtualHosts;return t?de.a.createElement("tbody",{className:"virtual-hosts-section"},de.a.createElement("tr",null,de.a.createElement("td",{colSpan:"6",className:"virtual-hosts-section-load-error"},"There was an error loading your virtual hosts."))):n.length?de.a.createElement("tbody",{className:"virtual-hosts-section"},de.a.createElement("tr",null,de.a.createElement("td",{colSpan:"6",className:"virtual-hosts-section-header"},de.a.createElement("strong",null,"Virtual Hosts"),de.a.createElement("span",null,"- default permissions for this database when requests come through one of your virtual hosts"))),this.getRows(n)):null}},{key:"getBulkActions",value:function(){var e=this.props,t=e.bulkSelectChecked,n=e.checkedRows,a=e.numCustomUsers,r=e.searchFilter;return 0===a||""!==r?null:de.a.createElement(YN,{hasSelectedItem:n.length>0,removeItem:xN.showConfirmBulkDeleteModal,selectAll:function(){},toggleSelect:xN.toggleBulkSelect,isChecked:void 0!==t&&t,disabled:!1})}},{key:"getFilter",value:function(){var e=this.props,t=e.numCustomUsers,n=e.searchFilter;return 0===t?null:de.a.createElement("div",{className:"flex-layout flex-row bulk-action-row"},de.a.createElement("div",null),de.a.createElement("div",{style:{position:"relative"}},de.a.createElement("i",{className:"fonticon-filter"}),de.a.createElement("input",{type:"text",value:n,placeholder:"Filter",className:"searchFilter",onChange:function(e){return xN.setSearchFilter(e.target.value)}})),de.a.createElement("div",null))}},{key:"getTable",value:function(){var e=this.props,t=e.availableRoles,n=e.numCustomUsers,a=e.rows,r=e.searchFilter;return 0===a.length?de.a.createElement("p",{className:"no-permissions-results"},"No results. Please change your filter."):de.a.createElement("table",{className:"permissions-table table table-striped"},de.a.createElement("thead",null,de.a.createElement("tr",null,de.a.createElement("th",{className:"names",colSpan:0===n||""!==r?"1":"2"},this.getBulkActions()),this.getColHeaders(t),de.a.createElement("th",{className:"th-delete-col"}))),de.a.createElement("tbody",null,this.getRows(a)))}},{key:"render",value:function(){return de.a.createElement("div",null,de.a.createElement("p",{className:"permissions-intro"},"Cloudant users and API keys with permissions on ",de.a.createElement("code",null,decodeURIComponent(this.props.databaseName)),"."),this.getFilter(),this.getTable())}}]),t}(de.a.Component);$N.propTypes={isSharedDB:tt.a.bool.isRequired,errorLoadingVirtualHosts:tt.a.bool.isRequired,databaseName:tt.a.string.isRequired,rows:tt.a.array.isRequired,availableRoles:tt.a.array.isRequired,onDelete:tt.a.func.isRequired,onUpdate:tt.a.func.isRequired,virtualHosts:tt.a.array.isRequired,sharer:tt.a.string,bulkSelectChecked:tt.a.bool.isRequired,checkedRows:tt.a.array.isRequired,numCustomUsers:tt.a.number.isRequired,searchFilter:tt.a.string.isRequired};var eD=function(e){function t(){return jN(this,t),GN(this,qN(t).apply(this,arguments))}return VN(t,e),BN(t,[{key:"getRoleColumns",value:function(){var e=this.props,t=e.user,n=e.availableRoles,a=e.onUpdate,r=e.isSharedDB,o=e.sharer,i=-1!==t.roles.indexOf("_admin")?"admin":"";return n.map((function(e,n){var s=-1!==t.roles.indexOf(e),c=!1;return"_creator"===e&&(c=!0),_.has(t,"specialRow")&&"currentUser"===t.specialRow&&(c=!0),r&&o===t.username&&(c=!0),de.a.createElement("td",{key:n},de.a.createElement("input",{type:"checkbox",className:i,checked:s,disabled:c,value:"checked",onChange:function(n){return a(t.username,e,n.target.checked)}}))}))}},{key:"getCheckboxCol",value:function(){var e=this.props,t=e.user,n=e.isSharedDB,a=e.sharer,r=e.isChecked;if(!e.showBulkSelectCol)return null;var o=n&&t.username===a;return de.a.createElement("td",{className:"bulk-select-col"},t.specialRow||o?null:de.a.createElement("input",{type:"checkbox",className:"permissions-row-cb","data-cb-user":t.username,checked:r,onChange:function(){return xN.toggleRow(t.username,!r)}}))}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.onDelete,a=e.isSharedDB,r=e.sharer,o=t.username,i="";"nobody"===t.username&&(o=wN.DEFAULT_USER_LABEL,i="other-users");var s=a&&t.username===r,c=s?de.a.createElement("span",null,"- ",de.a.createElement("i",null,"DB Owner")):null;return de.a.createElement("tr",null,this.getCheckboxCol(),de.a.createElement("td",{"data-name":t.username,className:i},o," ",c),this.getRoleColumns(),de.a.createElement("td",{className:"delete-row"},t.specialRow||s?null:de.a.createElement("span",{className:"fonticon-cancel delete-user",onClick:function(){return n(t.username)}})))}}]),t}(de.a.Component);eD.propTypes={user:tt.a.object.isRequired,availableRoles:tt.a.array.isRequired,isSharedDB:tt.a.bool.isRequired,onDelete:tt.a.func.isRequired,isChecked:tt.a.bool.isRequired,showBulkSelectCol:tt.a.bool.isRequired};var tD=function(e){function t(){return jN(this,t),GN(this,qN(t).apply(this,arguments))}return VN(t,e),BN(t,[{key:"showCopiedMessage",value:function(){se.addNotification({type:"success",msg:"The password has been copied to your clipboard.",clear:!0})}},{key:"getKeyInfo",value:function(){var e=this.props,t=e.apiKey,n=e.apiPassword;return t&&n?de.a.createElement("div",{id:"key-info",className:"alert alert-info"},de.a.createElement("div",null,de.a.createElement("strong",null,"Key:"),de.a.createElement("span",{id:"generated-api-key"},t)),de.a.createElement("div",null,de.a.createElement("strong",null,"Password:"),de.a.createElement("span",{id:"generated-api-password"},n),de.a.createElement(QN,{uniqueKey:t,onClipboardClick:this.showCopiedMessage,text:n})),de.a.createElement("p",null,"Please make a note of the password. For security reasons, we will not store it for you to retrieve in the future.")):null}},{key:"render",value:function(){var e=this.props,t=e.isGenerating,n=e.onGenerate;return de.a.createElement("div",{className:"api-keys"},de.a.createElement("div",{className:"api-keys__generate-form"},de.a.createElement("p",null,de.a.createElement("b",null,"API keys")," can grant programmatic access to Cloudant databases. If you generate an API key, you can also manage that key's permissions."),de.a.createElement("button",{className:"btn btn-tertiary",id:"generate-api",onClick:n,disabled:t},"Generate API Key")),this.getKeyInfo())}}]),t}(de.a.Component);tD.propTypes={onGenerate:tt.a.func.isRequired,isGenerating:tt.a.bool.isRequired,apiKey:tt.a.string,apiPassword:tt.a.string};var nD={PermissionsPageController:JN,PermissionsTable:$N,GrantPermissionsForm:ZN,UserRow:eD,APIKeys:tD},aD=function(e){var t=e.isSharedDB,n=e.docURL,a=e.database,r=e.sharer,o=e.endpoint,i=e.dbName,s=e.dropDownLinks,c=e.selectedNavItem,l=e.partitionKey;return de.a.createElement("div",{id:"dashboard",className:"with-sidebar"},de.a.createElement(Qp,{hideQueryOptions:!0,docURL:n,endpoint:o,dbName:decodeURIComponent(i),dropDownLinks:s,database:a}),de.a.createElement("div",{className:"with-sidebar tabs-with-sidebar content-area revert-test-class"},de.a.createElement("aside",{id:"sidebar-content",className:"scrollable"},de.a.createElement(fc,{selectedNavItem:c,selectedPartitionKey:l})),de.a.createElement("section",{id:"dashboard-content",className:"flex-layout flex-col"},de.a.createElement("div",{className:"flex-body",id:"dashboard-lower-content"},de.a.createElement(nD.PermissionsPageController,{databaseName:i,isSharedDB:t,sharer:r})))))},rD=si.extend({selectedHeader:"Databases",routes:{"database/:database/_partition/:partitionKey/permissions":{route:"permissions",roles:["fx_loggedIn"]},"database/:database/permissions":{route:"permissions",roles:["fx_loggedIn"]}},roles:["_admin"],initialize:function(e,t){this.initViews(t[0])},permissions:function(e,t){var n=new ci("permissions"),a=this.database.safeID();xN.initPermissions(a);var r=[{name:this.database.id,link:ri.databaseUrl(this.database)},{name:"Permissions"}];return de.a.createElement(aD,{docURL:se.constants.DOC_URLS.SECURITY,endpoint:se.urls("permissions","apiurl",this.database.safeID()),dbName:a,dropDownLinks:r,database:this.database,isSharedDB:!1,selectedNavItem:n,partitionKey:t})},initViews:function(e){this.databaseName=e,this.database=new ri.Model({id:this.databaseName}),this.createDesignDocsCollection(),this.addSidebar("permissions")},getExtensionLinks:function(){var e="#"+se.urls("databaseBaseURL","app",this.database.id),t=[{title:"New Doc",url:e+"/_new",icon:"fonticon-plus-circled"},{title:"New View",url:e+"/new_view",icon:"fonticon-plus-circled"}];return _.reduce(se.getExtensions("sidebar:links"),(function(t,n){return t.push({title:n.title,url:e+"/"+n.url,icon:"fonticon-plus-circled"}),t}),t)}}),oD=rD.extend({selectedHeader:"Databases",routes:{"database/shared/:user/:database/permissions":"sharedPermissions"},roles:["_admin"],initialize:function(e,t){this.sharedInitViews(t[0],t[1])},sharedPermissions:function(e){var t=new ci("permissions"),n=se.cloudantUser,a=this.database.safeID();xN.initSharedPermissions(a,n);var r=[{name:this.database.id,link:ri.databaseUrl(this.database)},{name:"Permissions"}];return de.a.createElement(aD,{docURL:se.constants.DOC_URLS.SECURITY,endpoint:se.urls("permissions","apiurl",this.database.safeID()),dbName:a,dropDownLinks:r,database:this.database,isSharedDB:!0,sharer:e,selectedNavItem:t})},sharedInitViews:function(e,t){le.getParams().include_docs=!0,cN.sharedUsername=e,this.databaseName=t,this.database=new iN.SharedModel({id:t,name:e}),this.user=new HE.User,this.data={username:e,database:this.database},this.data.designDocs=new cN.SharedAllDocs(null,{username:e,database:this.database,paging:{pageSize:500},params:{startkey:"_design",endkey:"_design1",include_docs:!0,limit:500}}),this.designDocs=this.data.designDocs,this.database=this.data.database,this.addSidebar()}}),iD={RouteObjects:[rD,oD]};n(734);iD.initialize=function(){};var sD=iD,cD={SINGLE_DATABASE_BACKUP_INFO_AVAILABLE:"SINGLE_DATABASE_BACKUP_INFO_AVAILABLE",DATABASE_BACKUP_INFO_AVAILABLE:"DATABASE_BACKUP_INFO_AVAILABLE",DOCUMENT_BACKUP_LIST_LOADED:"DOCUMENT_BACKUP_LIST_LOADED",SELECT_BACKUP_BY_URL:"SELECT_BACKUP_BY_URL",UPDATE_BACKUP_DOC_EDITOR:"UPDATE_BACKUP_DOC_EDITOR",DOCUMENT_BACKUP_RESET:"DOCUMENT_BACKUP_RESET",SHOW_RESTORE_BACKUP_MODAL:"SHOW_RESTORE_BACKUP_MODAL",HIDE_RESTORE_BACKUP_MODAL:"HIDE_RESTORE_BACKUP_MODAL",RESTORE_DOC_START:"RESTORE_DOC_START",RESTORE_DOC_COMPLETE:"RESTORE_DOC_COMPLETE"},lD=se.addon(),uD=new Backbone.Collection;lD.DatabaseBackup=se.Model.extend({initialize:function(e){this.dbName=e.database,this.source=uD},url:function(){return"/_api/v2/backup/task?databases="+this.dbName},parse:function(e,t){var n=this.source.findWhere({dbName:t.dbName});return n.set({loaded:!0,hasBackup:e.rows.length>0,tasks:e.rows}),n.unset("fetch"),n.toJSON()},isAvailable:function(e){var t=this.source.findWhere({dbName:e});return t&&t.get("loaded")},fetch:function(){var e=this.source.findWhere({dbName:this.dbName});if(e){if(e.get("loaded")){var t=se.Deferred();return this.set(e.toJSON()),t.resolve(),t.promise()}return e.get("fetch")}var n=Backbone.Model.prototype.fetch.call(this,{dbName:this.dbName});return this.source.add({dbName:this.dbName,loaded:!1,hasBackup:null,fetch:n,tasks:[]}),n}}),lD.DatabaseBackupList=se.Collection.extend({setDatabases:function(e){this.databases=e},url:function(){return"/_api/v2/backup/task?format=mapping&databases="+this.databases.join(",")},parse:function(e){return e.map((function(e,t){var n={db:t,hasBackup:null!==e};return _.isObject(e)&&(n.task=e.task,n.latest_completion=e.latest_completion),n}))}});var dD=lD;dD.DocBackups=se.Collection.extend({update:function(e){this.taskName=e.taskName,this.docID=e.docID},url:function(){var e=le.utils.safeURLName(this.docID);return-1!==this.docID.indexOf("/")&&(e=encodeURIComponent(e)),"/_api/v2/backup/monitor/"+this.taskName+"/"+e+"?include_docs=true"},parse:function(e){return e.databases},restore:function(e,t){var n=r.a.Deferred();return r.a.ajax({cache:!1,type:"POST",url:"/_api/v2/backup/restore/document",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({doc_id:this.docID,task_name:this.taskName,task_date:t,frequency:e}),success:function(e){n.resolve(e)},error:function(){n.reject(arguments)}}),n.promise()}});var pD=dD;function fD(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var hD={parseWeeklyDate:function(e){var t=fD(e.split("/"),3),n=t[0],a=t[1],r=t[2],o="".concat(n,"/").concat(r),i=h()(o,"YYYY/[w]W").startOf("isoWeek"),s=h()(o,"YYYY/[w]W").endOf("isoWeek"),c=s;return"01"!==a||"w52"!==r&&"w53"!==r||(o="".concat(parseInt(n)-1,"/").concat(r),c=h()(o,"YYYY/[w]W").endOf("isoWeek")),i.month()+1===parseInt(a)&&s.month()+1!==parseInt(a)&&(c=i.endOf("month")),c}},mD=hD;function gD(e){se.addNotification({msg:e,type:"error",clear:!0})}function bD(e){se.navigate(se.urls("allDocs","app",e))}function yD(e){var t=[{label:"Daily",backups:[]},{label:"Weekly",backups:[]},{label:"Monthly",backups:[]},{label:"Yearly",backups:[]}],n=null;return e.models.forEach((function(e){var a=e.get("backup"),r=a.match(/deltas\/[^/]+\/(.*)/)[1],o=r.split("/"),i={url:a,doc:e.get("doc")};4===o.length?(n=h()(r,"YYYY/MM/[w]W/DD"),t[0].backups.push(_.extend(i,{epoch:parseInt(n.format("X"),10),date:n.format("MMM Do, YYYY"),restoreKey:"daily",restoreTaskDate:n.format("YYYY-MM-DD")}))):3===o.length?(n=mD.parseWeeklyDate(r),t[1].backups.push(_.extend(i,{epoch:parseInt(n.format("X"),10),date:n.format("MMM Do, YYYY"),restoreKey:"weekly",restoreTaskDate:n.format("YYYY-MM-DD")}))):2===o.length?(n=h()(r,"YYYY/MM"),t[2].backups.push(_.extend(i,{epoch:parseInt(n.format("X"),10),date:h()(r,"YYYY/MM").format("MMM, YYYY"),restoreKey:"monthly",restoreTaskDate:n.format("YYYY-MM")}))):1===o.length&&t[3].backups.push(_.extend(i,{epoch:parseInt(r,10),date:r,restoreKey:"yearly",restoreTaskDate:r}))})),t.map((function(e){return e.backups=e.backups.sort((function(e,t){return t.epoch-e.epoch})),e})),t}var ED={initBackups:function(e){var t=new pD.DatabaseBackup({database:e.database.id}),n=new pD.DocBackups;se.dispatch({type:cD.DOCUMENT_BACKUP_RESET}),e.fetch().then((function(){t.fetch().then((function(){if(!t.get("hasBackup"))return gD("Sorry, this database doesn't have backups enabled."),void bD(e.database.id);t.get("tasks").length&&(n.update({docID:e.id,taskName:t.get("tasks")[0].task}),n.fetch().then((function(){if(!n.models.length)return gD("This document doesn't have any backups on file."),void se.navigate(e.url("app"));se.dispatch({type:cD.DOCUMENT_BACKUP_LIST_LOADED,options:{doc:e,backupList:yD(n),backupListCollection:n,databaseBackup:t}})})))}))}),(function(t){404===t.status&&(gD("The document does not exist."),bD(e.database.id))}))},selectBackup:function(e){se.dispatch({type:cD.SELECT_BACKUP_BY_URL,options:{url:e}})},updateDocValue:function(e){se.dispatch({type:cD.UPDATE_BACKUP_DOC_EDITOR,options:{json:e}})},saveDoc:function(e,t,n){var a=e.database.safeID();t?(se.addNotification({msg:"Saving document."}),e.save().then((function(){n(e.prettyJSON()),se.navigate(se.urls("document","app",a,e.id)+"/backups")})).fail((function(e){se.addNotification({msg:"Save failed: "+JSON.parse(e.responseText).reason,type:"error",fade:!1,clear:!0})}))):e.validationError&&"Cannot change a documents id."===e.validationError?(gD("You cannot edit the _id of an existing document. Try this: Click 'Clone Document', then change the _id on the clone before saving."),delete e.validationError):gD("Please fix the JSON errors and try saving again.")},showRestoreModal:function(){se.dispatch({type:cD.SHOW_RESTORE_BACKUP_MODAL})},hideRestoreDocModal:function(){se.dispatch({type:cD.HIDE_RESTORE_BACKUP_MODAL})},restoreDoc:function(e,t,n){se.addNotification({msg:"Restoring your document. Please wait.",type:"info",clear:!0}),se.dispatch({type:cD.RESTORE_DOC_START}),e.restore(t.restoreKey,t.restoreTaskDate).then((function(){se.dispatch({type:cD.RESTORE_DOC_COMPLETE}),se.addNotification({msg:"Your document has been restored.",type:"success",clear:!0}),se.navigate(n)}),function(){se.dispatch({type:cD.RESTORE_DOC_COMPLETE}),se.addNotification({msg:"There was an error restoring this document.",type:"error",clear:!0})}.bind(this))},navigate:function(e){se.navigate(e)},checkDatabaseHasBackups:function(e){var t=se.Deferred(),n=se.cloudantUser,a=new pD.DatabaseBackup({database:e});return n.fetchOnce().then((function(){if(!n.backupsEnabled())return se.dispatch({type:cD.SINGLE_DATABASE_BACKUP_INFO_AVAILABLE,database:a.get("dbName"),hasBackup:!1}),t.resolve(a);a.fetch().then((function(){se.dispatch({type:cD.SINGLE_DATABASE_BACKUP_INFO_AVAILABLE,database:a.get("dbName"),hasBackup:a.get("hasBackup")}),t.resolve(a)}))})),t}},_D={};_D.DocumentBackupPageStore=se.Store.extend({initialize:function(){this.reset()},reset:function(){this._doc=null,this._docContent="",this._docBackupList=[],this._backupListCollection=null,this._currentBackup=null,this._restoreModalVisible=!1,this._isRestoring=!1},setBackup:function(e,t,n){this._doc=e,this._docContent=JSON.stringify(this._doc.attributes,null,"  "),this._docBackupList=t,this._backupListCollection=n,this.hasBackups()&&(this._currentBackup=this.getMostRecentBackup())},getDocContent:function(){return this._docContent},setDocContent:function(e){this._docContent=e},getBackupList:function(){return this._docBackupList},getBackupListCollection:function(){return this._backupListCollection},hasBackups:function(){return this._docBackupList.length>0},getDoc:function(){return this._doc},isRestoreModalVisible:function(){return this._restoreModalVisible},showRestoreModal:function(){this._restoreModalVisible=!0},hideRestoreModal:function(){this._restoreModalVisible=!1},selectBackup:function(e){this._currentBackup=this.getBackupByURL(e)},restoreDoc:function(){this._isRestoring=!0},restoreDocComplete:function(){this._isRestoring=!1,this._restoreModalVisible=!1},isRestoring:function(){return this._isRestoring},getCurrentBackup:function(){return this._currentBackup},getMostRecentBackup:function(){return this._docBackupList.find((function(e){return e.backups.length>0})).backups[0]},getBackupByURL:function(e){var t;return this._docBackupList.forEach((function(n){var a=n.backups.find((function(t){return t.url===e}));a&&(t=a)})),t},dispatch:function(e){switch(e.type){case cD.DOCUMENT_BACKUP_LIST_LOADED:this.setBackup(e.options.doc,e.options.backupList,e.options.backupListCollection),this.triggerChange();break;case cD.SELECT_BACKUP_BY_URL:this.selectBackup(e.options.url),this.triggerChange();break;case cD.UPDATE_BACKUP_DOC_EDITOR:this.setDocContent(e.options.json),this.triggerChange();break;case cD.DOCUMENT_BACKUP_RESET:this.reset(),this.triggerChange();break;case cD.SHOW_RESTORE_BACKUP_MODAL:this.showRestoreModal(),this.triggerChange();break;case cD.HIDE_RESTORE_BACKUP_MODAL:this.hideRestoreModal(),this.triggerChange();break;case cD.RESTORE_DOC_START:this.restoreDoc(),this.triggerChange();break;case cD.RESTORE_DOC_COMPLETE:this.restoreDocComplete(),this.triggerChange()}}}),_D.documentBackupPageStore=new _D.DocumentBackupPageStore,_D.documentBackupPageStore.dispatchToken=se.dispatcher.register(_D.documentBackupPageStore.dispatch.bind(_D.documentBackupPageStore)),_D.DatabaseBackupStore=se.Store.extend({initialize:function(){this.reset()},reset:function(){this._databases={}},hasBackup:function(e){return!!_.has(this._databases,e)&&this._databases[e].hasBackup},hasBackupByURL:function(e){if(!_.isString(e))return!1;var t=e.split("/")[2];return!!_.has(this._databases,t)&&this._databases[t].hasBackup},getLastBackupDate:function(e){return _.has(this._databases,e)?this._databases[e].lastBackupDate:null},addSingleDatabaseBackup:function(e){this._databases[e.database]={hasBackup:e.hasBackup,lastBackupDate:null}},addDatabaseBackupList:function(e){this._databases=_.extend({},this._databases,e)},dispatch:function(e){switch(e.type){case cD.SINGLE_DATABASE_BACKUP_INFO_AVAILABLE:this.addSingleDatabaseBackup(e),this.triggerChange();break;case cD.DATABASE_BACKUP_INFO_AVAILABLE:this.addDatabaseBackupList(e.options.backupInfo),this.triggerChange()}}}),_D.databaseBackupStore=new _D.DatabaseBackupStore,_D.databaseBackupStore.dispatchToken=se.dispatcher.register(_D.databaseBackupStore.dispatch.bind(_D.databaseBackupStore));var vD=_D;function SD(e){return(SD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ND(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DD(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function OD(e,t,n){return t&&DD(e.prototype,t),n&&DD(e,n),e}function wD(e,t){return!t||"object"!==SD(t)&&"function"!=typeof t?CD(e):t}function TD(e){return(TD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AD(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ID(e,t)}function ID(e,t){return(ID=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var RD=vD.databaseBackupStore,kD=vD.documentBackupPageStore,LD=function(e){function t(){var e,n;ND(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return PD(CD(n=wD(this,(e=TD(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{doc:kD.getDoc(),docContent:kD.getDocContent(),backupList:kD.getBackupList(),backupListCollection:kD.getBackupListCollection(),hasBackups:kD.hasBackups(),currentBackup:kD.getCurrentBackup(),restoreModalVisible:kD.isRestoreModalVisible(),isRestoring:kD.isRestoring()}})),PD(CD(n),"getBackupList",(function(){return n.state.backupList.map((function(e,t){if(e.backups.length)return de.a.createElement("optgroup",{label:e.label,key:t},e.backups.map((function(e,t){return de.a.createElement("option",{value:e.url,key:t},e.date)})))}))})),PD(CD(n),"selectBackup",(function(e){ED.selectBackup(e.target.value)})),PD(CD(n),"gotoDoc",(function(e){e.preventDefault(),ED.navigate(n.state.doc.url("app"))})),PD(CD(n),"saveDoc",(function(e){e.preventDefault(),ED.saveDoc(n.state.doc,n.checkDocIsValid(),n.setDocument)})),PD(CD(n),"getEditor",(function(){return n.backupPageEditor?n.backupPageEditor.getEditor():null})),PD(CD(n),"onRestore",(function(){n.getEditor().editSaved()})),PD(CD(n),"onChange",(function(){n.setState(n.getStoreState())})),PD(CD(n),"setupEditorListener",(function(){n.getEditor().editor.on("change",function(){var e,t=this.getEditor().getValue();try{e=JSON.parse(t)}catch(e){return}var n=["_id"];this.state.doc.get("_rev")&&n.push("_rev"),ED.updateDocValue(t),_.isEmpty(_.difference(n,_.keys(e)))||se.addNotification({type:"error",msg:"Cannot remove a document's id or revision.",clear:!0})}.bind(CD(n))),n.pageInitialized=!0,n.forceUpdate()})),PD(CD(n),"setDocument",(function(e){n.getEditor().editor.getSession().setValue(e)})),PD(CD(n),"checkDocIsValid",(function(){if(n.getEditor().hasErrors())return!1;var e=JSON.parse(n.getEditor().getValue());return n.state.doc.clear().set(e,{validate:!0}),!n.state.doc.validationError})),PD(CD(n),"showRestoreModal",(function(){ED.showRestoreModal()})),PD(CD(n),"updateValues",(function(){n.state.doc.changedAttributes()&&se.addNotification({msg:"Document saved successfully.",type:"success",clear:!0})})),PD(CD(n),"state",n.getStoreState()),n}return AD(t,e),OD(t,[{key:"componentDidMount",value:function(){kD.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){kD.off("change",this.onChange),this.state.doc&&this.state.doc.off("sync")}},{key:"componentDidUpdate",value:function(){this.state.backupList.length&&Ih.formatters.html.hideUnchanged(),this.state.doc&&(this.state.doc.off("sync"),this.state.doc.on("sync",this.updateValues)),this.pageInitialized||this.setupEditorListener()}},{key:"render",value:function(){var e=this;return this.state.backupList.length?de.a.createElement("div",null,de.a.createElement("div",{id:"doc-editor-actions-panel",className:"row backup-controls"},de.a.createElement("div",{className:"span6"},de.a.createElement("h3",null,"Current Rev"),de.a.createElement("div",{className:"pull-right"},de.a.createElement("button",{className:"save-doc btn btn-primary save",type:"button",onClick:this.saveDoc},de.a.createElement("i",{className:"icon fonticon-ok-circled"})," Save"),de.a.createElement("div",{className:"cancel-button"},de.a.createElement("a",{href:"#","data-bypass":"true",onClick:this.gotoDoc},"Cancel")))),de.a.createElement("div",{className:"span6"},de.a.createElement("div",{className:"backup-list"},de.a.createElement("label",{htmlFor:"js-backup-list-select"},"Select Backup"),de.a.createElement("div",{className:"styled-select"},de.a.createElement("label",{htmlFor:"js-backup-list-select"},de.a.createElement("i",{className:"fonticon-down-dir"}),de.a.createElement("select",{id:"js-backup-list-select",onChange:this.selectBackup,defaultValue:this.state.currentBackup.url},this.getBackupList())))),de.a.createElement("div",{className:"pull-right"},de.a.createElement("button",{className:"restore-doc btn btn-primary",type:"button",onClick:this.showRestoreModal},"Restore")))),de.a.createElement("div",{id:"backups-diff",className:"code-region"},de.a.createElement(Jr.CodeEditor,{showEditorOnly:!0,ref:function(t){return e.backupPageEditor=t},id:"backups-current-doc",defaultCode:this.state.docContent,docs:!1,mode:"json",setHeightWithJS:!1,disableUnload:!0}),de.a.createElement(xD,{display:this.state.hasBackups&&null!==this.getEditor(),targetDoc:this.state.docContent,sourceDoc:this.state.currentBackup.doc})),de.a.createElement(UD,{visible:this.state.restoreModalVisible,backupListCollection:this.state.backupListCollection,currentBackup:this.state.currentBackup,docURL:this.state.doc.url("app"),onRestore:this.onRestore,isRestoring:this.state.isRestoring})):de.a.createElement("div",{id:"backups-page-loading"},de.a.createElement(Jr.LoadLines,null))}}]),t}(de.a.Component);PD(LD,"propTypes",{database:tt.a.object.isRequired});var xD=function(e){function t(){var e,n;ND(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return PD(CD(n=wD(this,(e=TD(t)).call.apply(e,[this].concat(r)))),"state",{hasDiffs:!1,diffHTML:"",jsonError:!1}),n}return AD(t,e),OD(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t={};try{t=JSON.parse(e.targetDoc)}catch(e){return void this.setState({jsonError:!0})}var n=!1,a="",r=Ih.diff(e.sourceDoc,t);_.isUndefined(r)||(n=!0,a=Ih.formatters.html.format(r,e.sourceDoc)),this.setState({jsonError:!1,hasDiffs:n,diffHTML:a})}},{key:"shouldComponentUpdate",value:function(){return!this.state.jsonError}},{key:"render",value:function(){return this.props.display?de.a.createElement("div",{id:"backups-delta"},de.a.createElement("p",{id:"backups-no-diff",className:this.state.hasDiffs?"hide":""},"This backup has no changes from the current rev."),de.a.createElement("ul",{id:"backup-legend",className:this.state.hasDiffs?"":"hide"},de.a.createElement("li",null,de.a.createElement("div",{className:"backup-legend backup-legend-removed"}),de.a.createElement("b",null,"removed")," since the selected backup"),de.a.createElement("li",null,de.a.createElement("div",{className:"backup-legend backup-legend-added"}),de.a.createElement("b",null,"added")," since the selected backup")),de.a.createElement("div",{id:"backups-delta-visualization",className:this.state.hasDiffs?"":"hide",dangerouslySetInnerHTML:{__html:this.state.diffHTML}})):null}}]),t}(de.a.Component);PD(xD,"propTypes",{sourceDoc:tt.a.object.isRequired,targetDoc:tt.a.string.isRequired}),PD(xD,"defaultProps",{sourceDoc:"",targetDoc:""});var UD=function(e){function t(){var e,n;ND(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return PD(CD(n=wD(this,(e=TD(t)).call.apply(e,[this].concat(r)))),"closeModal",(function(){ED.hideRestoreDocModal()})),PD(CD(n),"restore",(function(e){e.preventDefault(),ED.restoreDoc(n.props.backupListCollection,n.props.currentBackup,n.props.docURL)})),n}return AD(t,e),OD(t,[{key:"render",value:function(){var e=this;return this.props.visible?de.a.createElement(Ct.g,{dialogClassName:"backup__confirm-modal",show:this.props.visible,onHide:this.closeModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Please Confirm")),de.a.createElement(Ct.g.Body,null,de.a.createElement("p",null,"Are you sure you want to restore the ",de.a.createElement("code",null,this.props.currentBackup.date)," version of this document? This will overwrite your current document.")),de.a.createElement(Ct.g.Footer,null,de.a.createElement("button",{className:"btn",onClick:this.closeModal},de.a.createElement("i",{className:"icon fonticon-cancel-circled"})," Cancel"),de.a.createElement("button",{ref:function(t){return e.confirmButton=t},className:"btn btn-primary save",onClick:this.restore,disabled:this.props.isRestoring},de.a.createElement("i",{className:"fonticon-ok-circled"})," Restore"))):null}}]),t}(de.a.Component);PD(UD,"propTypes",{docURL:tt.a.string.isRequired,backupListCollection:tt.a.object.isRequired,currentBackup:tt.a.object.isRequired}),PD(UD,"defaultProps",{docURL:"",backupListCollection:null,currentBackup:null,visible:!1,isRestoring:!1});var MD=function(e){function t(){return ND(this,t),wD(this,TD(t).apply(this,arguments))}return AD(t,e),OD(t,[{key:"render",value:function(){return se.cloudantUser.backupsEnabled()?de.a.createElement("th",null,"Last Backup"):de.a.createElement("th",{className:"hide"})}}]),t}(de.a.Component),jD=function(e){function t(){var e,n;ND(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return PD(CD(n=wD(this,(e=TD(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{databaseHasBackup:RD.hasBackup(n.props.row.id),lastBackupDate:RD.getLastBackupDate(n.props.row.id)}})),PD(CD(n),"onChange",(function(){n.setState(n.getStoreState())})),PD(CD(n),"state",n.getStoreState()),n}return AD(t,e),OD(t,[{key:"componentDidMount",value:function(){RD.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){RD.off("change",this.onChange)}},{key:"render",value:function(){return se.cloudantUser.backupsEnabled()?this.state.databaseHasBackup?(null===this.state.lastBackupDate?(t="pending",e="backup-pending"):t=h()(this.state.lastBackupDate,"YYYY-MM-DDTHH:mm:ssZ",!0).format("MMM Do, h:mm a"),de.a.createElement("td",{className:e},t)):de.a.createElement("td",null,"—"):de.a.createElement("td",{className:"hide"});var e,t}}]),t}(de.a.Component);PD(jD,"propTypes",{row:tt.a.object.isRequired});var HD=function(e){function t(){var e,n;ND(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return PD(CD(n=wD(this,(e=TD(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{databaseHasBackup:RD.hasBackupByURL(n.props.doc.url)}})),PD(CD(n),"onChange",(function(){n.setState(n.getStoreState())})),PD(CD(n),"getLinkURL",(function(){return"#"+n.props.doc.url+"/backups"})),PD(CD(n),"state",n.getStoreState()),n}return AD(t,e),OD(t,[{key:"componentDidMount",value:function(){RD.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){RD.off("change",this.onChange)}},{key:"render",value:function(){return!!this.state.databaseHasBackup&&de.a.createElement(GD,{linkURL:this.getLinkURL()})}}]),t}(de.a.Component);PD(HD,"propTypes",{doc:tt.a.object.isRequired});var BD=function(e){function t(e,n){var a;ND(this,t),PD(CD(a=wD(this,TD(t).call(this,e,n))),"getStoreState",(function(){return{hasBackup:RD.hasBackup(a.props.database.id)}})),PD(CD(a),"onChange",(function(){a.setState(a.getStoreState())})),PD(CD(a),"gotoBackupPage",(function(){se.navigate(se.urls("document","app",a.props.doc.database.safeID(),a.props.doc.id)+"/backups")})),PD(CD(a),"isNewDoc",(function(){var e=se.router.lastPages[se.router.lastPages.length-1];return/\/_new$/.test(e)}));var r=a.getStoreState();return r.hasBackupOnload=RD.hasBackup(e.database.id),a.state=r,a}return AD(t,e),OD(t,[{key:"componentDidMount",value:function(){RD.on("change",this.onChange,this),ED.checkDatabaseHasBackups(this.props.database.id)}},{key:"componentWillUnmount",value:function(){RD.off("change",this.onChange)}},{key:"render",value:function(){if(this.isNewDoc())return!1;if(!this.state.hasBackup)return!1;var e="panel-button backups";return!this.state.hasBackupOnload&&this.state.hasBackup&&(e+=" fadein"),de.a.createElement("div",{className:"panel-section"},de.a.createElement("button",{className:e,title:"View document backups",onClick:this.gotoBackupPage},de.a.createElement("i",{className:"icon fonticon-clock"}),de.a.createElement("span",null,"Backups")))}}]),t}(de.a.Component);PD(BD,"propTypes",{doc:tt.a.object,database:tt.a.object.isRequired});var GD=function(e){function t(){return ND(this,t),wD(this,TD(t).apply(this,arguments))}return AD(t,e),OD(t,[{key:"render",value:function(){return de.a.createElement("div",{className:"doc-backup-symbol",title:"View document backups"},de.a.createElement("a",{href:this.props.linkURL},de.a.createElement("i",{className:"fonticon-clock"})))}}]),t}(de.a.Component);PD(GD,"propTypes",{linkURL:tt.a.string.isRequired});var qD={BackupPageController:LD,ConfirmRestoreModal:UD,DatabaseTableHeaderColumn:MD,DatabaseTableRowColumn:jD,DocListBackupsBtnController:HD,DocEditorBackupBtn:BD},VD=se.RouteObject.extend({selectedHeader:"Databases",routes:{"database/:database/:doc/backups":"backups","database/:database/_design/:ddoc/backups":"backupDesignDoc"},initialize:function(e,t){this.database=t.database},backups:function(e,t){this.docID=t||"new",this.database=this.database||new ri.Model({id:e});var n=new He.Doc({_id:this.docID},{database:this.database}),a=[{type:"back",link:vn.getPreviousPageForDoc(this.database,!1)},{name:this.docID}];return ED.initBackups(n),de.a.createElement(Ot,{crumbs:a,component:de.a.createElement(qD.BackupPageController,{database:this.database})})},backupDesignDoc:function(e,t){return this.backups(e,"_design/"+t)}}),FD=nf.extend({initialize:function(e,t){this.databaseName=t[0],this.initViews(this.databaseName),this.databaseBackup=new pD.DatabaseBackup({database:this.databaseName}),this.user=se.cloudantUser,ED.checkDatabaseHasBackups(this.databaseName)},initViews:function(e){this.databaseName=e,this.database=new ri.Model({id:this.databaseName}),this.databaseBackup=new pD.DatabaseBackup({database:e}),this.createDesignDocsCollection(),this.addSidebar()}});pD.RouteObjects=[VD,FD];var KD=pD;n(735);KD.initialize=function(){se.registerExtension("DocList:icons",qD.DocListBackupsBtnController),se.registerExtension("DocEditor:icons",qD.DocEditorBackupBtn),se.registerExtension("DatabaseTable:head",qD.DatabaseTableHeaderColumn),se.registerExtension("DatabaseTable:databaseRow",qD.DatabaseTableRowColumn)};var WD=KD,XD=n(109),zD=n.n(XD),YD={REPLICATION_SOURCE:{LOCAL:"REPLICATION_SOURCE_LOCAL",REMOTE:"REPLICATION_SOURCE_REMOTE"},REPLICATION_TARGET:{EXISTING_LOCAL_DATABASE:"REPLICATION_TARGET_EXISTING_LOCAL_DATABASE",EXISTING_REMOTE_DATABASE:"REPLICATION_TARGET_EXISTING_REMOTE_DATABASE",NEW_LOCAL_DATABASE:"REPLICATION_TARGET_NEW_LOCAL_DATABASE",NEW_REMOTE_DATABASE:"REPLICATION_TARGET_NEW_REMOTE_DATABASE"},REPLICATION_TYPE:{ONE_TIME:"REPLICATION_TYPE_ONE_TIME",CONTINUOUS:"REPLICATION_TYPE_CONTINUOUS"},REPLICATION_AUTH_METHOD:{NO_AUTH:"NO_AUTH",BASIC:"BASIC_AUTH"}};function QD(e){return(QD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JD(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ZD(e,t){return!t||"object"!==QD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $D(e){return($D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eO(e,t){return(eO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tO=Jr.StyledSelect,nO=function(e){var t=e.onChange,n=e.value;return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Database URL:"),de.a.createElement("div",{className:""},de.a.createElement("input",{type:"text",className:"replication__remote-connection-url",placeholder:"https://",value:n,onChange:function(e){return t(e.target.value)}})))};nO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var aO=function(e){var t=e.value,n=e.onChange,a=e.databases.map((function(e){return{value:e,label:e}}));return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Name:"),de.a.createElement("div",{className:"replication__input-react-select"},de.a.createElement(qr.a,{name:"source-name",value:t,placeholder:"Database name",options:a,clearable:!1,onChange:function(e){var t=e.value;return n(t)}})))};aO.propTypes={value:tt.a.string.isRequired,databases:tt.a.array.isRequired,onChange:tt.a.func.isRequired};var rO=function(e){var t=e.replicationSource,n=e.databases,a=e.localSource,r=e.remoteSource,o=e.onChangeRemote,i=e.onChangeLocal;return t===YD.REPLICATION_SOURCE.LOCAL?de.a.createElement(aO,{value:a,databases:n,onChange:i}):de.a.createElement(nO,{value:r,onChange:o})};rO.propTypes={replicationSource:tt.a.string.isRequired,databases:tt.a.array.isRequired,localSource:tt.a.string.isRequired,remoteSource:tt.a.string.isRequired,onChangeRemote:tt.a.func.isRequired,onChangeLocal:tt.a.func.isRequired};var oO=function(e){var t=e.onChange,n=e.value;return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Type:"),de.a.createElement("div",{className:"replication__input-select"},de.a.createElement(tO,{selectContent:[{value:"",label:"Select source type"},{value:YD.REPLICATION_SOURCE.LOCAL,label:"Local database"},{value:YD.REPLICATION_SOURCE.REMOTE,label:"Remote database"}].map((function(e){return de.a.createElement("option",{value:e.value,key:e.value},e.label)})),selectChange:function(e){return t(e.target.value)},selectId:"replication-source",selectValue:n})))};oO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var iO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ZD(this,$D(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eO(e,t)}(t,e),n=t,(a=[{key:"getReplicationSourceRow",value:function(){var e=this.props,t=e.replicationSource,n=e.localSource,a=e.onLocalSourceChange,r=e.onRemoteSourceChange,o=e.remoteSource,i=e.databases;return t?de.a.createElement(rO,{replicationSource:t,databases:i,localSource:n,remoteSource:o,onChangeLocal:a,onChangeRemote:r}):null}},{key:"render",value:function(){var e=this.props,t=e.replicationSource,n=e.onSourceSelect;return de.a.createElement("div",null,de.a.createElement("h3",null,"Source"),de.a.createElement(oO,{onChange:n,value:t}),this.getReplicationSourceRow())}}])&&JD(n.prototype,a),r&&JD(n,r),t}(de.a.Component);function sO(e){return(sO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lO(e,t){return!t||"object"!==sO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uO(e){return(uO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dO(e,t){return(dO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}iO.propTypes={replicationSource:tt.a.string.isRequired,localSource:tt.a.string.isRequired,remoteSource:tt.a.string.isRequired,databases:tt.a.array.isRequired,onLocalSourceChange:tt.a.func.isRequired,onRemoteSourceChange:tt.a.func.isRequired};var pO=Jr.StyledSelect,fO=function(e){var t=e.value,n=e.onChange;return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Type:"),de.a.createElement("div",{id:"replication-target",className:"replication__input-select"},de.a.createElement(pO,{selectContent:[{value:"",label:"Select target type"},{value:YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE,label:"Existing local database"},{value:YD.REPLICATION_TARGET.EXISTING_REMOTE_DATABASE,label:"Existing remote database"},{value:YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE,label:"New local database"},{value:YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE,label:"New remote database"}].map((function(e){return de.a.createElement("option",{value:e.value,key:e.value},e.label)})),selectChange:function(e){return n(e.target.value)},selectId:"replication-target",selectValue:t})))};fO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var hO=function(e){var t=e.onChange,n=e.value;return de.a.createElement("div",null,de.a.createElement("input",{type:"text",className:"replication__remote-connection-url",placeholder:"https://",value:n,onChange:function(e){return t(e.target.value)}}))};hO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var mO=function(e){var t=e.onChange,n=e.value,a=e.databases.map((function(e){return{value:e,label:e}}));return de.a.createElement("div",{id:"replication-target-local",className:"replication__input-react-select"},de.a.createElement(qr.a,{value:n,options:a,placeholder:"Database name",clearable:!1,onChange:function(e){var n=e.value;return t(n)}}))};mO.propTypes={value:tt.a.string.isRequired,databases:tt.a.array.isRequired,onChange:tt.a.func.isRequired};var gO=function(e){var t=e.onChange,n=e.value;return de.a.createElement("input",{type:"text",className:"replication__new-input",placeholder:"Database name",value:n,onChange:function(e){return t(e.target.value)}})};gO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var bO=function(e){var t,n=e.replicationTarget,a=e.onLocalTargetChange,r=e.onRemoteTargetChange,o=e.localTarget,i=e.remoteTarget,s=e.databases;if(!n)return null;n===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE?(c="New database:",t=de.a.createElement(gO,{value:o,onChange:a})):t=n===YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE?de.a.createElement(mO,{onChange:a,databases:s,value:o}):de.a.createElement(hO,{onChange:r,value:i,newRemote:YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE===n});var c="Name:";return n!==YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE&&n!==YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE||(c="New database:"),de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},c),de.a.createElement("div",null,t))};bO.propTypes={databases:tt.a.array.isRequired,onLocalTargetChange:tt.a.func.isRequired,onRemoteTargetChange:tt.a.func.isRequired,remoteTarget:tt.a.string.isRequired,localTarget:tt.a.string.isRequired,replicationTarget:tt.a.string.isRequired};var yO=function(e){var t=e.replicationTarget,n=e.targetDatabasePartitioned,a=e.onTargetDatabasePartitionedChange,r=e.allowNewPartitionedLocalDbs;if(!t)return null;if(t!==YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE&&t!==YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE)return null;var o=t===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE&&!r,i=o?"Local server does not support partitioned databases":"Creates a new partitioned database",s=de.a.createElement(Ct.l,{id:"new-db-partitioned-tooltip"},i);return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"New database options:"),de.a.createElement("div",{className:Tt()("replication__input-checkbox",{"replication__input-checkbox--disabled":o})},de.a.createElement("input",{id:"target-db-is-partitioned",type:"checkbox",value:"true",checked:n,onChange:function(){a(!n)},disabled:o}),de.a.createElement(Ct.i,{placement:"right",overlay:s},de.a.createElement("label",{htmlFor:"target-db-is-partitioned"},"Partitioned"))))};yO.propTypes={onTargetDatabasePartitionedChange:tt.a.func.isRequired,targetDatabasePartitioned:tt.a.bool.isRequired,replicationTarget:tt.a.string.isRequired,allowNewPartitionedLocalDbs:tt.a.bool.isRequired};var EO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lO(this,uO(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dO(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.replicationTarget,n=e.onLocalTargetChange,a=e.onTargetChange,r=e.databases,o=e.localTarget,i=e.onRemoteTargetChange,s=e.remoteTarget,c=e.targetDatabasePartitioned,l=e.onTargetDatabasePartitionedChange,u=e.allowNewPartitionedLocalDbs;return de.a.createElement("div",null,de.a.createElement("h3",null,"Target"),de.a.createElement(fO,{value:t,onChange:a}),de.a.createElement(bO,{remoteTarget:s,replicationTarget:t,databases:r,localTarget:o,onRemoteTargetChange:i,onLocalTargetChange:n}),de.a.createElement(yO,{replicationTarget:t,onTargetDatabasePartitionedChange:l,targetDatabasePartitioned:c,allowNewPartitionedLocalDbs:u}))}}])&&cO(n.prototype,a),r&&cO(n,r),t}(de.a.Component);function _O(e){return(_O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function SO(e,t){return!t||"object"!==_O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NO(e){return(NO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DO(e,t){return(DO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}EO.propTypes={databases:tt.a.array.isRequired,onTargetChange:tt.a.func.isRequired,onLocalTargetChange:tt.a.func.isRequired,onRemoteTargetChange:tt.a.func.isRequired,remoteTarget:tt.a.string.isRequired,localTarget:tt.a.string.isRequired,replicationTarget:tt.a.string.isRequired};var OO=Jr.StyledSelect,wO=function(e){var t=e.value,n=e.onChange;return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Replication type:"),de.a.createElement("div",{className:"replication__input-select"},de.a.createElement(OO,{selectContent:[{value:YD.REPLICATION_TYPE.ONE_TIME,label:"One time"},{value:YD.REPLICATION_TYPE.CONTINUOUS,label:"Continuous"}].map((function(e){return de.a.createElement("option",{value:e.value,key:e.value},e.label)})),selectChange:function(e){return n(e.target.value)},selectId:"replication-target",selectValue:t})))};wO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var TO=function(e){var t=e.value,n=e.onChange;return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Replication document:"),de.a.createElement("div",{className:"replication__doc-name"},de.a.createElement("span",{className:"fonticon fonticon-cancel replication__doc-name-icon",title:"Clear field",onClick:function(){return n("")}}),de.a.createElement("input",{type:"text",className:"replication__doc-name-input",placeholder:"Custom ID (optional)",value:t,onChange:function(e){return n(e.target.value)}})))};TO.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var CO=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),SO(this,NO(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DO(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.replicationType,n=e.replicationDocName,a=e.onDocChange,r=e.onTypeChange;return de.a.createElement("div",null,de.a.createElement("h3",null,"Options"),de.a.createElement(wO,{onChange:r,value:t}),de.a.createElement(TO,{onChange:a,value:n}))}}])&&vO(n.prototype,a),r&&vO(n,r),t}(de.a.Component);CO.propTypes={replicationDocName:tt.a.string.isRequired,replicationType:tt.a.string.isRequired,onDocChange:tt.a.func.isRequired,onTypeChange:tt.a.func.isRequired};var AO=Jr.ConfirmButton,IO=function(e){var t=e.onClear,n=e.disabled,a=e.onClick;return de.a.createElement("div",{className:"replication__button-row"},de.a.createElement(AO,{customIcon:"fonticon-replicate",id:"replicate",text:"Start Replication",onClick:a,disabled:n}),de.a.createElement("a",{className:"replication__clear-link",href:"#","data-bypass":"true",onClick:function(e){e.preventDefault(),t()}},"Clear"))};function PO(e){return(PO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RO(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function LO(e,t,n){return t&&kO(e.prototype,t),n&&kO(e,n),e}function xO(e,t){return!t||"object"!==PO(t)&&"function"!=typeof t?MO(e):t}function UO(e){return(UO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jO(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HO(e,t)}function HO(e,t){return(HO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}IO.propTypes={disabled:tt.a.bool.isRequired,onClick:tt.a.func.isRequired,onClear:tt.a.func.isRequired};var BO=Jr.StyledSelect,GO=function(e){function t(e){var n;return RO(this,t),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(MO(n=xO(this,UO(t).call(this,e))),"getAuthOptions",(function(){var e=le.i18n.en_US["replication-user-password-auth-label"],t=[{value:YD.REPLICATION_AUTH_METHOD.NO_AUTH,label:"None"},{value:YD.REPLICATION_AUTH_METHOD.BASIC,label:e}];return n.customAuths.map((function(e){t.push({value:e.typeValue,label:e.typeLabel})})),t.map((function(e){return de.a.createElement("option",{value:e.value,key:e.value},e.label)}))})),n.onChangeType=n.onChangeType.bind(MO(n)),n.onChangeValue=n.onChangeValue.bind(MO(n)),n.customAuths=se.getExtensions("Replication:Auth"),n.customAuths||(n.customAuths=[]),n.customAuthTypes=n.customAuths.map((function(e){return e.typeValue})),n.customAuthHelp=se.getExtensions("Replication:Auth-help"),n.customAuthHelp||(n.customAuthHelp=[]),n}return jO(t,e),LO(t,[{key:"onChangeType",value:function(e){this.props.onChangeAuthType(e)}},{key:"onChangeValue",value:function(e){this.props.onChangeAuth(e)}},{key:"getAuthInputFields",value:function(e,t){var n=this.props.authId;if(t==YD.REPLICATION_AUTH_METHOD.BASIC)return de.a.createElement(qO,{onChange:this.onChangeValue,auth:e,authId:n});var a=this.customAuths.filter((function(e){return e.typeValue===t}));if(a&&a.length>0){var r=a[0].inputComponent;return de.a.createElement(r,{onChange:this.onChangeValue,auth:e})}return null}},{key:"getHelpText",value:function(e){var t=this.customAuthHelp.filter((function(t){return e===t.authType})).map((function(e){return e.helpText}));return 0==t.length?null:de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"}),de.a.createElement("div",{className:"replication__help-tile"},t[0]))}},{key:"render",value:function(){var e=this,t=this.props,n=t.credentials,a=t.authType,r=t.authId;return de.a.createElement(de.a.Fragment,null,de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"},"Authentication:"),de.a.createElement("div",{className:"replication__input-select"},de.a.createElement(BO,{selectContent:this.getAuthOptions(),selectChange:function(t){return e.onChangeType(t.target.value)},selectId:"select-"+r,selectValue:a}))),this.getAuthInputFields(n,a),this.getHelpText(a))}}]),t}(de.a.Component);GO.propTypes={authId:tt.a.string.isRequired,authType:tt.a.string.isRequired,credentials:tt.a.object,onChangeAuth:tt.a.func.isRequired,onChangeAuthType:tt.a.func.isRequired},GO.defaultProps={authType:YD.REPLICATION_AUTH_METHOD.NO_AUTH,onChangeAuthType:function(){},onChangeAuth:function(){}};var qO=function(e){function t(e){var n;return RO(this,t),(n=xO(this,UO(t).call(this,e))).updatePassword=n.updatePassword.bind(MO(n)),n.updateUsername=n.updateUsername.bind(MO(n)),n.state={username:e.auth&&e.auth.username?e.auth.username:"",password:e.auth&&e.auth.password?e.auth.password:""},n}return jO(t,e),LO(t,[{key:"updatePassword",value:function(e){this.setState({password:e}),this.props.onChange({username:this.state.username,password:e})}},{key:"updateUsername",value:function(e){this.setState({username:e}),this.props.onChange({username:e,password:this.state.password})}},{key:"render",value:function(){var e=this,t=le.i18n.en_US["replication-username-input-placeholder"],n=le.i18n.en_US["replication-password-input-placeholder"],a=this.props.authId;return de.a.createElement(de.a.Fragment,null,de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"}),de.a.createElement("div",null,de.a.createElement("input",{id:a+"-username",type:"text",placeholder:t,value:this.state.username,onChange:function(t){return e.updateUsername(t.target.value)},readOnly:this.props.usernameReadOnly}))),de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"}),de.a.createElement("div",null,de.a.createElement("input",{id:a+"-password",type:"password",placeholder:n,value:this.state.password,onChange:function(t){return e.updatePassword(t.target.value)}}))))}}]),t}(de.a.Component);qO.propTypes={auth:tt.a.object.isRequired,onChange:tt.a.func.isRequired};var VO=Jr.ConfirmButton,FO=function(e){var t=e.visible,n=e.onClose,a=e.onClick,r=e.multipleDocs,o=e.isReplicationDB;if(!t)return null;var i="",s="Delete ".concat(o?"Document":"Replication Job"),c="Deleting a replication ".concat(o?"document":"job"," stops continuous replication\n          and incomplete one-time replication, but does not affect replicated documents.");return r>1&&(i="You are deleting <strong>".concat(r,"</strong> replication ").concat(o?"documents":"jobs","."),s="Delete ".concat(o?"Documents":"Replication Jobs")),de.a.createElement(Ct.g,{dialogClassName:"replication_delete-doc-modal",show:t,onHide:function(){return n()}},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Verify Deletion")),de.a.createElement(Ct.g.Body,null,de.a.createElement("p",{dangerouslySetInnerHTML:{__html:i}}),de.a.createElement("p",null,c)),de.a.createElement(Ct.g.Footer,null,de.a.createElement("a",{className:"cancel-link",onClick:n},"Cancel"),de.a.createElement(VO,{customIcon:"icon-trash",text:s,onClick:a})))};FO.propTypes={visible:tt.a.bool.isRequired,isReplicationDB:tt.a.bool.isRequired,onClick:tt.a.func.isRequired,onClose:tt.a.func.isRequired,multipleDocs:tt.a.number.isRequired},FO.defaultProps={isReplicationDB:!0};var KO=function(e){var t=e.visible,n=e.onClose,a=e.errorMsg,r=e.status;if(!t)return null;var o="Replication Error",i=de.a.createElement("p",null,"The replication job will be tried at increasing intervals");return"failed"===r.toLowerCase()&&(o="Replication Error - Failed",i=null),de.a.createElement(Ct.g,{dialogClassName:"replication__error-doc-modal",show:t,onHide:function(){return n()}},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,o)),de.a.createElement(Ct.g.Body,null,de.a.createElement("p",null,a),i),de.a.createElement(Ct.g.Footer,null))};KO.propTypes={visible:tt.a.bool.isRequired,onClick:tt.a.func.isRequired,onClose:tt.a.func.isRequired,errorMsg:tt.a.string.isRequired};var WO=function(e){var t=e.visible,n=e.docId,a=e.onClose,r=e.onClick;return t?de.a.createElement(Ct.g,{dialogClassName:"replication__error-doc-modal",show:t,onHide:function(){return a()}},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Custom ID Conflict")),de.a.createElement(Ct.g.Body,null,de.a.createElement("p",null,"A replication document with ID ",de.a.createElement("code",null,n)," already exists."),de.a.createElement("p",null,"You can overwrite the existing document, or change the new replication job’s document ID."),de.a.createElement("p",null,"If you overwrite the existing document, any replication job currently using the replication document will stop, and that job will not appear in Replicator DB Activity. Replicated documents will not be affected.")),de.a.createElement(Ct.g.Footer,null,de.a.createElement("button",{onClick:a,className:"btn replication__error-cancel"},"Change Document ID"),de.a.createElement("button",{onClick:r,className:"btn replication__error-continue"},de.a.createElement("i",{className:"icon icon-eraser"})," Overwrite Existing Document"))):null};function XO(e){return(XO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zO(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function YO(e){return(YO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JO(e,t){return(JO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}WO.propTypes={visible:tt.a.bool.isRequired,onClick:tt.a.func.isRequired,onClose:tt.a.func.isRequired,docId:tt.a.string.isRequired};var ZO=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=YO(t).call(this,e))||"object"!==XO(r)&&"function"!=typeof r?QO(a):r).submit=n.submit.bind(QO(n)),n.checkAuth=n.checkAuth.bind(QO(n)),n.runReplicationChecks=n.runReplicationChecks.bind(QO(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JO(e,t)}(t,e),n=t,(a=[{key:"checkAuth",value:function(){var e=this;this.props.hideConflictModal();var t=this.props,n=t.replicationSource,a=t.replicationTarget,r=t.sourceAuthType,o=t.targetAuthType,i=t.sourceAuth,s=t.targetAuth,c=n===YD.REPLICATION_SOURCE.LOCAL,l=a===YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE||a===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE;if(!se.session.isAdminParty()){if(c&&r===YD.REPLICATION_AUTH_METHOD.NO_AUTH)return void se.addNotification({msg:"Missing credentials for local source database.",type:"error",clear:!0});if(l&&o===YD.REPLICATION_AUTH_METHOD.NO_AUTH)return void se.addNotification({msg:"Missing credentials for local target database.",type:"error",clear:!0})}this.checkLocalAccountCredentials(r,i,"source",c).then((function(){e.checkLocalAccountCredentials(o,s,"target",l).then((function(){e.submit()}),(function(){}))}),(function(){}))}},{key:"checkLocalAccountCredentials",value:function(e,t,n,a){if(e!==YD.REPLICATION_AUTH_METHOD.BASIC||!a)return se.Promise.resolve(!0);if(!t.username||!t.password){var r="Missing ".concat(n," credentials.");return se.addNotification({msg:r,type:"error",clear:!0}),se.Promise.reject(new Error(r))}return this.checkCredentials(t.username,t.password).then((function(e){if(e.error)throw e;return!0})).catch((function(e){throw se.addNotification({msg:"Your username or password for ".concat(n," database is incorrect."),type:"error",clear:!0}),e}))}},{key:"checkCredentials",value:function(e,t){return E(A.getServerUrl("/"),"GET",{credentials:"omit",headers:{Authorization:"Basic "+zD.a.encode(e+":"+t)}})}},{key:"checkReplicationDocID",value:function(){var e=this,t=this.props,n=t.showConflictModal,a=t.replicationDocName,r=t.checkReplicationDocID;r(a).then((function(t){t?n():e.checkAuth()}))}},{key:"runReplicationChecks",value:function(){var e=this.props.replicationDocName;this.checkSourceTargetDatabases()&&(e?this.checkReplicationDocID():this.checkAuth())}},{key:"checkSourceTargetDatabases",value:function(){var e=this.props,t=e.remoteTarget,n=e.remoteSource,a=e.replicationSource,r=e.replicationTarget,o=e.localTarget,s=e.localSource,c=e.databases;if(r===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE&&-1!==_.indexOf(c,o))return se.addNotification({msg:"The <code>"+o+"</code> database already exists locally. Please enter another database name.",type:"error",escape:!1,clear:!0}),!1;if(r===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE||r===YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE){var l="";if(/\s/.test(o)?l="The target database may not contain any spaces.":/^_/.test(o)&&(l="The target database may not start with an underscore."),l)return se.addNotification({msg:l,type:"error",escape:!1,clear:!0}),!1}if(a===YD.REPLICATION_SOURCE.REMOTE&&!Object(i.isEmpty)(n)){var u="";try{""===new URL(n).pathname.slice(1)&&(u="Invalid source database URL. Database name is missing.")}catch(e){u="Invalid source database URL."}if(u)return se.addNotification({msg:u,type:"error",escape:!1,clear:!0}),!1}if((r===YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE||r===YD.REPLICATION_TARGET.EXISTING_REMOTE_DATABASE)&&!Object(i.isEmpty)(t)){var d="";try{""===new URL(t).pathname.slice(1)&&(d="Invalid target database URL. Database name is missing.")}catch(e){d="Invalid target database URL."}if(d)return se.addNotification({msg:d,type:"error",escape:!1,clear:!0}),!1}return!(t===n&&!Object(i.isEmpty)(t)||s===o&&!Object(i.isEmpty)(s))||(se.addNotification({msg:"Cannot replicate a database to itself",type:"error",escape:!1,clear:!0}),!1)}},{key:"submit",value:function(){var e,t=this.props,n=t.replicationTarget,a=t.replicationSource,r=t.replicationType,o=t.replicationDocName,i=t.remoteTarget,s=t.remoteSource,c=t.localTarget,l=t.localSource,u=t.sourceAuthType,d=t.sourceAuth,p=t.targetAuthType,f=t.targetAuth,h=t.targetDatabasePartitioned;if(o){var m=this.props.docs.find((function(e){return e._id===o}));m&&(e=m._rev)}this.props.replicate({replicationTarget:n,replicationSource:a,replicationType:r,replicationDocName:o,localTarget:c,localSource:l,remoteTarget:i,remoteSource:s,_rev:e,sourceAuthType:u,sourceAuth:d,targetAuthType:p,targetAuth:f,targetDatabasePartitioned:h})}},{key:"confirmButtonEnabled",value:function(){var e=this.props,t=e.remoteSource,n=e.localSourceKnown,a=e.replicationSource,r=e.replicationTarget,o=e.localTargetKnown,i=e.localTarget;return!(e.submittedNoChange||!a||!r||a===YD.REPLICATION_SOURCE.LOCAL&&!n||r===YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE&&!o||r===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE&&!i||a===YD.REPLICATION_SOURCE.REMOTE&&""===t)}},{key:"render",value:function(){var e=this.props,t=e.replicationSource,n=e.replicationTarget,a=e.replicationType,r=e.replicationDocName,o=e.conflictModalVisible,i=e.databases,s=e.localSource,c=e.remoteSource,l=e.remoteTarget,u=e.localTarget,d=e.targetDatabasePartitioned,p=e.allowNewPartitionedLocalDbs,f=e.updateFormField,h=e.clearReplicationForm,m=e.sourceAuthType,g=e.sourceAuth,b=e.targetAuthType,y=e.targetAuth;return de.a.createElement("div",{style:{paddingBottom:20}},de.a.createElement(iO,{replicationSource:t,localSource:s,databases:i,remoteSource:c,onSourceSelect:f("replicationSource"),onRemoteSourceChange:f("remoteSource"),onLocalSourceChange:f("localSource")}),de.a.createElement(GO,{credentials:g,authType:m,onChangeAuthType:f("sourceAuthType"),onChangeAuth:f("sourceAuth"),authId:"replication-source-auth"}),de.a.createElement("hr",{className:"replication__seperator",size:"1"}),de.a.createElement(EO,{replicationTarget:n,onTargetChange:f("replicationTarget"),databases:i,localTarget:u,remoteTarget:l,allowNewPartitionedLocalDbs:p,targetDatabasePartitioned:d,onRemoteTargetChange:f("remoteTarget"),onLocalTargetChange:f("localTarget"),onTargetDatabasePartitionedChange:f("targetDatabasePartitioned")}),de.a.createElement(GO,{credentials:y,authType:b,onChangeAuthType:f("targetAuthType"),onChangeAuth:f("targetAuth"),authId:"replication-target-auth"}),de.a.createElement("hr",{className:"replication__seperator",size:"1"}),de.a.createElement(CO,{replicationType:a,replicationDocName:r,onDocChange:f("replicationDocName"),onTypeChange:f("replicationType")}),de.a.createElement(IO,{disabled:!this.confirmButtonEnabled(),onClick:this.runReplicationChecks,onClear:h}),de.a.createElement(WO,{visible:o,onClick:this.checkAuth,onClose:this.props.hideConflictModal,docId:r}))}}])&&zO(n.prototype,a),r&&zO(n,r),t}(de.a.Component);function $O(e){return($O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ew=null,tw=function(e){return ew&&!e||(ew=new se.Promise((function(e){var t=A.getServerUrl("/_scheduler/jobs");v(t,{raw:!0}).then((function(t){if(t.status>202)return e(!1);e(!0)}))}))),ew},nw=function(e){if(!e)return"";var t=new URL(e);return"".concat(t.origin,"/").concat(encodeURIComponent(t.pathname.slice(1)))},aw=function(e){if(!e)return"";var t=new URL(e);return"".concat(t.origin,"/").concat(decodeURIComponent(t.pathname.slice(1)))},rw=function(e){var t=e.lastIndexOf("@");return-1===t?e:(e.startsWith("https")?"https://":"http://")+e.slice(t+1)},ow=function(e){var t=e.replicationSource,n=e.localSource,a=e.remoteSource,r=e.sourceAuthType,o=e.sourceAuth,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location,s=i.origin,c=i.pathname,l={};if(t===YD.REPLICATION_SOURCE.LOCAL){var u=encodeURIComponent(n),d=A.getRootUrl({origin:s,pathname:c});l.url="".concat(d).concat(u)}else l.url=nw(rw(a));return sw(l,r,o),l},iw=function(e){var t=e.replicationTarget,n=e.localTarget,a=e.remoteTarget,r=e.targetAuthType,o=e.targetAuth,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location,s=i.origin,c=i.pathname,l={};if(t===YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE||t===YD.REPLICATION_TARGET.EXISTING_REMOTE_DATABASE)l.url=nw(rw(a));else{var u=encodeURIComponent(n),d=A.getRootUrl({origin:s,pathname:c});l.url="".concat(d).concat(u)}return sw(l,r,o),l},sw=function(e,t,n){if(t&&t!==YD.REPLICATION_AUTH_METHOD.NO_AUTH)if(t===YD.REPLICATION_AUTH_METHOD.BASIC)e.headers=(r=n.username,o=n.password,r&&o?{Authorization:"Basic "+zD.a.encode(r+":"+o)}:{});else{var a=se.getExtensions("Replication:Auth");a&&a.filter((function(e){return e.typeValue===t})).map((function(t){t.setCredentials&&t.setCredentials(e,n)}))}else e.headers={};var r,o},cw=function(e){return-1!==s.a.indexOf([YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE,YD.REPLICATION_TARGET.NEW_REMOTE_DATABASE],e)},lw=function(e){return e===YD.REPLICATION_TYPE.CONTINUOUS},uw=function(e){var t=e.replicationTarget,n=e.replicationSource,a=e.replicationType,r=e.replicationDocName,o=e.localTarget,i=e.localSource,s=e.remoteTarget,c=e.remoteSource,l=e._rev,u=e.sourceAuthType,d=e.sourceAuth,p=e.targetAuthType,f=e.targetAuth,h=e.targetDatabasePartitioned,m={user_ctx:{name:se.session.user().name,roles:["_admin","_reader","_writer"]},source:ow({replicationSource:n,localSource:i,remoteSource:c,sourceAuthType:u,sourceAuth:d}),target:iw({replicationTarget:t,replicationSource:n,remoteTarget:s,localTarget:o,targetAuthType:p,targetAuth:f}),create_target:cw(t),continuous:lw(a)};return h&&(m.create_target_params={partitioned:!0}),function(e,t,n){return e&&(n._id=e),t&&(n._rev=t),n}(r,l,m)},dw=function(e){var t=e;return e?("object"===$O(e)&&(t=e.url),function(e){try{var t=new URL(e);return"".concat(t.origin,"/").concat(decodeURIComponent(t.pathname.slice(1)))}catch(t){return e}}(t)):""},pw=function(e){return"error"===e.toLowerCase()||"crashing"===e.toLowerCase()?"retrying":e},fw=function(){return tw().then((function(e){var t=A.getServerUrl("/_replicator/_all_docs?include_docs=true&limit=100"),n=v(t).then((function(e){return e.error?[]:e.rows.filter((function(e){return-1===e.id.indexOf("_design/")})).map((function(e){return e.doc})).map((function(e){return{_id:e._id,_rev:e._rev,selected:!1,source:dw(e.source),target:dw(e.target),createTarget:e.create_target,continuous:!0===e.continuous,status:e._replication_state,errorMsg:e._replication_state_reason?e._replication_state_reason:"",statusTime:new Date(e._replication_state_time),startTime:new Date(e._replication_start_time),url:"#/database/_replicator/".concat(encodeURIComponent(e._id)),raw:e}}))}));if(!e)return n;var a=hw();return se.Promise.join(n,a,(function(e,t){return function(e,t){return e.map((function(e){var n=t.find((function(t){return t.doc_id===e._id}));return n?(e.status=pw(n.state),n.start_time&&(e.startTime=new Date(n.start_time)),n.last_updated&&(e.stateTime=new Date(n.last_updated)),e):e}))}(e,t)})).catch((function(){return[]}))}))},hw=function(){var e=A.getServerUrl("/_scheduler/docs?include_docs=true");return v(e).then((function(e){return e.error?[]:e.docs}))},mw=function(e){return new Promise((function(t){var n=A.getServerUrl("/_replicator/".concat(e));v(n).then((function(e){"not_found"!==e.error?t(!0):t(!1)}))}))},gw=function(){return tw().then((function(e){if(!e)return[];var t=A.getServerUrl("/_scheduler/jobs");return v(t).then((function(e){return function(e){return e.jobs.filter((function(e){return null===e.database})).map((function(e){return{_id:e.id,source:dw(e.source.slice(0,e.source.length-1)),target:dw(e.target.slice(0,e.target.length-1)),startTime:new Date(e.start_time),statusTime:new Date(e.last_updated),status:pw(e.history[0].type),errorMsg:"",selected:!1,continuous:/continuous/.test(e.id),raw:e}}))}(e)}))}))};function bw(e){return(bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yw(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ew(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _w(e,t,n){return t&&Ew(e.prototype,t),n&&Ew(e,n),e}function vw(e,t){return!t||"object"!==bw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sw(e){return(Sw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nw(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dw(e,t)}function Dw(e,t){return(Dw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ow=function(e){var t,n;try{t=new URL(rw(e))}catch(e){return""}var a=A.getRootUrl();return n=function(e,t){try{var n=new URL(t),a=e.pathname.substring(n.pathname.length);return encodeURIComponent(a)}catch(e){return""}}(t,a),e.indexOf(window.location.hostname)>-1?de.a.createElement("span",null,a,de.a.createElement("a",{href:"#/database/".concat(n,"/_all_docs")},decodeURIComponent(n))):"".concat(t.origin).concat(t.pathname)},ww=function(e){function t(e){var n;return yw(this,t),(n=vw(this,Sw(t).call(this,e))).state={modalVisible:!1},n}return Nw(t,e),_w(t,[{key:"showModal",value:function(){this.setState({modalVisible:!0})}},{key:"closeModal",value:function(){this.setState({modalVisible:!1})}},{key:"getErrorIcon",value:function(){var e=this.props.status;return"error"!==e&&"retrying"!==e?null:de.a.createElement("span",null,de.a.createElement("a",{"data-bypass":"true",className:"replication__row-btn replication__row-btn--warning icon-exclamation-sign",onClick:this.showModal.bind(this),title:"View error message"}),de.a.createElement(KO,{onClick:this.closeModal.bind(this),onClose:this.closeModal.bind(this),errorMsg:this.props.errorMsg,visible:this.state.modalVisible,status:e}))}},{key:"render",value:function(){var e=this.props,t=e.statusTime,n=e.status,a=h()(t),r=de.a.createElement("span",null,n);if(a.isValid()){var o=a.format("MMM Do, h:mm a"),i=de.a.createElement(Ct.l,{id:""},"Last updated: ",o);r=de.a.createElement(Ct.i,{placement:"top",overlay:i},de.a.createElement("span",null,n))}return de.a.createElement("td",{className:"replication__row-status replication__row-status--".concat(n)},r,this.getErrorIcon())}}]),t}(de.a.Component);ww.propTypes={statusTime:tt.a.any,status:tt.a.string,errorMsg:tt.a.string.isRequired},ww.defaultProps={status:""};var Tw=function(e){var t=e.onlyDeleteAction,n=e._id,a=e.url,r=e.deleteDocs,o=[];return t||(o.push(de.a.createElement("li",{className:"replication__row-list",key:1},de.a.createElement("a",{href:"#replication/id/".concat(encodeURIComponent(n)),className:"replication__row-btn icon-wrench replication__row-btn--no-left-pad",title:"Edit replication","data-bypass":"true"}))),o.push(de.a.createElement("li",{className:"replication__row-list",key:2},de.a.createElement("a",{className:"replication__row-btn fonticon-document",title:"Edit replication document",href:a,"data-bypass":"true"})))),o.push(de.a.createElement("li",{className:"replication__row-list",key:3},de.a.createElement("a",{className:"replication__row-btn icon-trash ".concat(t?"replication__row-btn--no-left-pad":""," "),title:"Delete ".concat(t?"job":"document"," ").concat(n),onClick:function(){return r(n)}}))),de.a.createElement("ul",{className:"replication__row-actions-list"},o)};Tw.propTypes={_id:tt.a.string.isRequired,url:tt.a.string,error:tt.a.bool.isRequired,errorMsg:tt.a.string.isRequired,deleteDocs:tt.a.func.isRequired};var Cw=function(e){var t=e._id,n=e.source,a=e.target,r=e.type,o=e.startTime,i=e.status,s=e.statusTime,c=e.url,l=e.selected,u=e.selectDoc,d=e.errorMsg,p=e.deleteDocs,f=e.onlyDeleteAction,m=e.showStateRow,g=h()(o),b=g.isValid()?g.format("MMM Do, h:mm a"):"",y=null;return m&&(y=de.a.createElement(ww,{statusTime:s,status:i,errorMsg:d})),de.a.createElement("tr",{className:"replication__table-row"},de.a.createElement("td",{className:"replication__table-col"},de.a.createElement("input",{checked:l,type:"checkbox",onChange:function(){return u(t)}})," "),de.a.createElement("td",{className:"replication__table-col"},Ow(n)),de.a.createElement("td",{className:"replication__table-col"},Ow(a)),de.a.createElement("td",{className:"replication__table-col"},b),de.a.createElement("td",{className:"replication__table-col"},r),y,de.a.createElement("td",{className:"replication__table-col"},de.a.createElement(Tw,{onlyDeleteAction:f,deleteDocs:p,_id:t,url:c,error:"error"===i||"retrying"===i,errorMsg:d})))};Cw.propTypes={_id:tt.a.string.isRequired,source:tt.a.string.isRequired,target:tt.a.string.isRequired,type:tt.a.string.isRequired,status:tt.a.string,url:tt.a.string,statusTime:tt.a.object.isRequired,startTime:tt.a.object,selected:tt.a.bool.isRequired,selectDoc:tt.a.func.isRequired,errorMsg:tt.a.string.isRequired,deleteDocs:tt.a.func.isRequired,onlyDeleteAction:tt.a.bool.isRequired,showStateRow:tt.a.bool.isRequired};var Aw=function(e){var t=e.isSelected,n=e.deleteDocs,a=e.someDocsSelected,r=e.onCheck,o=a?de.a.createElement("button",{onClick:function(){return n()},className:"bulk-select-trash fonticon fonticon-trash",title:"Delete all selected"}):null;return de.a.createElement("div",{className:"replication__bulk-select-wrapper"},de.a.createElement("div",{className:"replication__bulk-select-header"},de.a.createElement("input",{className:"replication__bulk-select-input",checked:t,type:"checkbox",onChange:r})),o)};Aw.propTypes={isSelected:tt.a.bool.isRequired,someDocsSelected:tt.a.bool.isRequired,onCheck:tt.a.func.isRequired,deleteDocs:tt.a.func.isRequired};var Iw=function(e){var t=e.msg;return de.a.createElement("tr",null,de.a.createElement("td",{colSpan:"7",className:"replication__empty-row"},t))};Iw.defaultProps={msg:"There is no replicator-db activity or history to display."};var Pw=function(e){function t(e){return yw(this,t),vw(this,Sw(t).call(this,e))}return Nw(t,e),_w(t,[{key:"sort",value:function(e,t,n){var a=!1,r=n.sort((function(t,n){return t[e]<n[e]?(a=!0,-1):t[e]>n[e]?(a=!0,1):0}));return!t&&a&&r.reverse(),r}},{key:"renderRows",value:function(){var e=this;return 0===this.props.docs.length?de.a.createElement(Iw,null):this.sort(this.props.column,this.props.descending,this.props.docs).map((function(t,n){return de.a.createElement(Cw,{key:n,_id:t._id,selected:t.selected,selectDoc:e.props.selectDoc,source:t.source,target:t.target,type:!0===t.continuous?"Continuous":"One time",status:t.status,statusTime:t.statusTime,startTime:t.startTime,url:t.url,deleteDocs:e.props.deleteDocs,errorMsg:t.errorMsg,doc:t,onlyDeleteAction:e.props.onlyDeleteAction,showStateRow:e.props.showStateRow})}))}},{key:"iconDirection",value:function(e){return e!==this.props.column||this.props.descending?"fonticon-down-dir":"fonticon-up-dir"}},{key:"onSort",value:function(e){var t=this;return function(){t.props.changeSort({descending:e!==t.props.column||!t.props.descending,column:e})}}},{key:"isSelected",value:function(e){return e===this.props.column?"replication__table--selected":""}},{key:"stateCol",value:function(){return this.props.showStateRow?de.a.createElement("th",{className:"replication__table-header-status",onClick:this.onSort("status")},"State",de.a.createElement("span",{className:"replication__table-header-icon ".concat(this.iconDirection("status")," ").concat(this.isSelected("status"))})):null}},{key:"render",value:function(){return de.a.createElement(Ct.k,{striped:!0},de.a.createElement("thead",null,de.a.createElement("tr",null,de.a.createElement("th",{className:"replication__table-bulk-select"},de.a.createElement(Aw,{isSelected:this.props.allDocsSelected,onCheck:this.props.selectAllDocs,someDocsSelected:this.props.someDocsSelected,deleteDocs:this.props.deleteDocs})),de.a.createElement("th",{className:"replication__table-header-source",onClick:this.onSort("source")},"Source",de.a.createElement("span",{className:"replication__table-header-icon ".concat(this.iconDirection("source")," ").concat(this.isSelected("source"))})),de.a.createElement("th",{className:"replication__table-header-target",onClick:this.onSort("target")},"Target",de.a.createElement("span",{className:"replication__table-header-icon ".concat(this.iconDirection("target")," ").concat(this.isSelected("target"))})),de.a.createElement("th",{className:"replication__table-header-time",onClick:this.onSort("statusTime")},"Start Time",de.a.createElement("span",{className:"replication__table-header-icon ".concat(this.iconDirection("statusTime")," ").concat(this.isSelected("statusTime"))})),de.a.createElement("th",{className:"replication__table-header-type",onClick:this.onSort("continuous")},"Type",de.a.createElement("span",{className:"replication__table-header-icon ".concat(this.iconDirection("continuous")," ").concat(this.isSelected("continuous"))})),this.stateCol(),de.a.createElement("th",{className:"replication__table-header-actions"},"Actions"))),de.a.createElement("tbody",null,this.renderRows()))}}]),t}(de.a.Component);Pw.defaultProps={onlyDeleteAction:!1,showStateRow:!0};var Rw=function(e){var t=e.value,n=e.onChange;return de.a.createElement("div",{className:"replication__filter"},de.a.createElement("i",{className:"replication__filter-icon fonticon-filter"}),de.a.createElement("input",{type:"text",placeholder:"Filter replications",className:"replication__filter-input",value:t,onChange:function(e){n(e.target.value)}}))};Rw.propTypes={value:tt.a.string.isRequired,onChange:tt.a.func.isRequired};var kw=function(e){var t=e.filter,n=e.onFilterChange;return de.a.createElement("div",{className:"replication__activity_header"},de.a.createElement("div",null),de.a.createElement(Rw,{value:t,onChange:n}),de.a.createElement("a",{href:"#/replication/_create",className:"btn save replication__activity_header-btn btn-primary"},de.a.createElement("i",{className:"icon fonticon-plus-circled"}),"New Replication"))};function Lw(e){return(Lw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Uw(e,t){return!t||"object"!==Lw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mw(e){return(Mw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jw(e,t){return(jw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}kw.propTypes={filter:tt.a.string.isRequired,onFilterChange:tt.a.func.isRequired};var Hw=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Uw(this,Mw(t).call(this,e))).state={modalVisible:!1,unconfirmedDeleteDocId:null},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jw(e,t)}(t,e),n=t,(a=[{key:"closeModal",value:function(){this.setState({modalVisible:!1,unconfirmedDeleteDocId:null})}},{key:"showModal",value:function(e){this.setState({modalVisible:!0,unconfirmedDeleteDocId:e})}},{key:"confirmDeleteDocs",value:function(){var e=this,t=[];if(this.state.unconfirmedDeleteDocId){var n=this.props.docs.find((function(t){return t._id===e.state.unconfirmedDeleteDocId}));t.push(n)}else t=this.props.docs.filter((function(e){return e.selected}));this.props.deleteDocs(t),this.closeModal()}},{key:"numDocsSelected",value:function(){return this.props.docs.filter((function(e){return e.selected})).length}},{key:"render",value:function(){var e=this.props,t=e.onFilterChange,n=e.activitySort,a=e.changeActivitySort,r=e.docs,o=e.filter,i=e.selectAllDocs,s=e.someDocsSelected,c=e.allDocsSelected,l=e.selectDoc,u=this.state.modalVisible;return de.a.createElement("div",{className:"replication__activity"},de.a.createElement("p",{className:"replication__activity-caveat"},"Replications must have a replication document to display in the following table."),de.a.createElement(kw,{filter:o,onFilterChange:t}),de.a.createElement(Pw,{someDocsSelected:s,allDocsSelected:c,selectAllDocs:i,docs:r,selectDoc:l,deleteDocs:this.showModal.bind(this),descending:n.descending,column:n.column,changeSort:a}),de.a.createElement(FO,{isReplicationDB:!0,multipleDocs:this.numDocsSelected(),visible:u,onClose:this.closeModal.bind(this),onClick:this.confirmDeleteDocs.bind(this)}))}}])&&xw(n.prototype,a),r&&xw(n,r),t}(de.a.Component);function Bw(e){return(Bw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qw(e,t){return!t||"object"!==Bw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vw(e){return(Vw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fw(e,t){return(Fw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Hw.propTypes={docs:tt.a.array.isRequired,filter:tt.a.string.isRequired,selectAllDocs:tt.a.func.isRequired,allDocsSelected:tt.a.bool.isRequired,someDocsSelected:tt.a.bool.isRequired,selectDoc:tt.a.func.isRequired,onFilterChange:tt.a.func.isRequired,deleteDocs:tt.a.func.isRequired,activitySort:tt.a.object.isRequired,changeActivitySort:tt.a.func.isRequired};var Kw=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=qw(this,Vw(t).call(this,e))).state={modalVisible:!1,unconfirmedDeleteDocId:null},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fw(e,t)}(t,e),n=t,(a=[{key:"closeModal",value:function(){this.setState({modalVisible:!1,unconfirmedDeleteDocId:null})}},{key:"showModal",value:function(e){this.setState({modalVisible:!0,unconfirmedDeleteDocId:e})}},{key:"confirmDeleteDocs",value:function(){var e=this,t=[];if(this.state.unconfirmedDeleteDocId){var n=this.props.docs.find((function(t){return t._id===e.state.unconfirmedDeleteDocId}));t.push(n)}else t=this.props.docs.filter((function(e){return e.selected}));this.props.deleteDocs(t),this.closeModal()}},{key:"numDocsSelected",value:function(){return this.props.docs.filter((function(e){return e.selected})).length}},{key:"render",value:function(){var e=this.props,t=e.onFilterChange,n=e.activitySort,a=e.changeActivitySort,r=e.docs,o=e.filter,i=e.selectAllDocs,s=e.someDocsSelected,c=e.allDocsSelected,l=e.selectDoc,u=this.state.modalVisible;return de.a.createElement("div",{className:"replication__activity"},de.a.createElement("p",{className:"replication__activity-caveat"},"Active _replicate jobs are displayed. Completed and failed jobs are not."),de.a.createElement(kw,{filter:o,onFilterChange:t}),de.a.createElement(Pw,{onlyDeleteAction:!0,showStateRow:!1,someDocsSelected:s,allDocsSelected:c,selectAllDocs:i,docs:r,selectDoc:l,deleteDocs:this.showModal.bind(this),descending:n.descending,column:n.column,changeSort:a}),de.a.createElement(FO,{isReplicationDB:!1,multipleDocs:this.numDocsSelected(),visible:u,onClose:this.closeModal.bind(this),onClick:this.confirmDeleteDocs.bind(this)}))}}])&&Gw(n.prototype,a),r&&Gw(n,r),t}(de.a.Component);function Ww(e){return(Ww="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xw(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zw(e,t){return!t||"object"!==Ww(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yw(e){return(Yw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qw(e,t){return(Qw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Kw.propTypes={docs:tt.a.array.isRequired,filter:tt.a.string.isRequired,selectAllDocs:tt.a.func.isRequired,allDocsSelected:tt.a.bool.isRequired,someDocsSelected:tt.a.bool.isRequired,selectDoc:tt.a.func.isRequired,onFilterChange:tt.a.func.isRequired,deleteDocs:tt.a.func.isRequired,activitySort:tt.a.object.isRequired,changeActivitySort:tt.a.func.isRequired};var Jw=Jr.LoadLines,Zw=Jr.Polling,$w=Jr.RefreshBtn,eT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zw(this,Yw(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qw(e,t)}(t,e),n=t,(a=[{key:"loadReplicationInfo",value:function(e,t){this.props.initReplicator(e.routeLocalSource,e.localSource),this.getAllActivity(),this.loadReplicationStateFrom(e,t)}},{key:"loadReplicationStateFrom",value:function(e,t){e.replicationId&&e.replicationId!==t.replicationId&&(this.props.clearReplicationForm(),this.props.getReplicationStateFrom(e.replicationId))}},{key:"getAllActivity",value:function(){this.props.getReplicationActivity(),this.props.getReplicateActivity()}},{key:"componentDidMount",value:function(){this.props.checkForNewApi(),this.props.getDatabasesList(),this.loadReplicationInfo(this.props,{})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.loadReplicationStateFrom(e,this.props),"new replication"!==this.props.tabSection&&"new replication"===e.tabSection&&this.props.clearReplicationForm()}},{key:"componentWillUnmount",value:function(){this.props.clearReplicationForm()}},{key:"showSection",value:function(){var e=this.props,t=e.replicationSource,n=e.replicationTarget,a=e.replicationType,r=e.replicationDocName,o=e.databases,i=e.localSource,s=e.remoteSource,c=e.remoteTarget,l=e.localTarget,u=e.statusDocs,d=e.statusFilter,p=e.loading,f=e.allDocsSelected,h=e.someDocsSelected,m=e.showConflictModal,g=e.localSourceKnown,b=e.localTargetKnown,y=e.updateFormField,E=e.authenticated,_=e.activityLoading,v=e.submittedNoChange,S=e.activitySort,N=e.tabSection,D=e.replicateInfo,O=e.replicateLoading,w=e.replicateFilter,T=e.allReplicateSelected,C=e.someReplicateSelected,A=e.hideConflictModal,I=e.isConflictModalVisible,P=e.filterDocs,R=e.filterReplicate,k=e.replicate,L=e.clearReplicationForm,x=e.selectAllDocs,U=e.changeActivitySort,M=e.selectDoc,j=e.deleteDocs,H=e.deleteReplicates,B=e.selectAllReplicates,G=e.selectReplicate,q=e.sourceAuthType,V=e.sourceAuth,F=e.targetAuthType,K=e.targetAuth,W=e.targetDatabasePartitioned,X=e.allowNewPartitionedLocalDbs;return"new replication"===N?p?de.a.createElement(Jw,null):de.a.createElement(ZO,{docs:u,localTargetKnown:b,localSourceKnown:g,clearReplicationForm:L,replicate:k,replicationSource:t,replicationTarget:n,replicationType:a,replicationDocName:r,databases:o,localSource:i,remoteSource:s,remoteTarget:c,localTarget:l,sourceAuthType:q,sourceAuth:V,targetAuthType:F,targetAuth:K,targetDatabasePartitioned:W,allowNewPartitionedLocalDbs:X,updateFormField:y,conflictModalVisible:I,hideConflictModal:A,showConflictModal:m,checkReplicationDocID:mw,authenticated:E,submittedNoChange:v}):"_replicate"===N?O?de.a.createElement(Jw,null):de.a.createElement(Kw,{docs:D,filter:w,onFilterChange:R,selectDoc:G,selectAllDocs:B,allDocsSelected:T,someDocsSelected:C,activitySort:S,changeActivitySort:U,deleteDocs:H}):_?de.a.createElement(Jw,null):de.a.createElement(Hw,{docs:u,filter:d,onFilterChange:P,selectAllDocs:x,selectDoc:M,allDocsSelected:f,someDocsSelected:h,deleteDocs:j,activitySort:S,changeActivitySort:U})}},{key:"getHeaderComponents",value:function(){if("new replication"===this.props.tabSection)return null;var e="right-header-flex";return A.isIE1X()&&(e+=" "+e+"--ie1X"),de.a.createElement("div",{className:e},de.a.createElement(Zw,{min:60,max:600,startValue:300,stepSize:60,onPoll:this.getAllActivity.bind(this)}),de.a.createElement($w,{refresh:this.getAllActivity.bind(this)}))}},{key:"getTabElements",value:function(){var e=this.props.tabSection,t=[de.a.createElement(fr,{key:1,selected:"activity"===e,text:"Replicator DB Activity",onChange:this.onTabChange.bind(this,"activity","#/replication")})];return this.props.supportNewApi&&t.push(de.a.createElement(fr,{key:2,selected:"_replicate"===e,text:"_replicate Activity",onChange:this.onTabChange.bind(this,"_replicate","#/replication/_replicate")})),t}},{key:"onTabChange",value:function(e,t){se.navigate(t)}},{key:"getCrumbs",value:function(){return"new replication"===this.props.tabSection?[{name:"Job Configuration"}]:[{name:"Replication"}]}},{key:"getTabs",value:function(){return"new replication"===this.props.tabSection?null:de.a.createElement(mr,null,this.getTabElements())}},{key:"render",value:function(){return this.props.checkingAPI?de.a.createElement(Jw,null):de.a.createElement(Et,null,de.a.createElement(_t,{crumbs:this.getCrumbs()},this.getHeaderComponents()),de.a.createElement(vt,null,de.a.createElement("div",{className:"template-content flex-body flex-layout flex-col"},this.getTabs(),de.a.createElement("div",{className:"replication__page flex-layout flex-col"},this.showSection()))))}}])&&Xw(n.prototype,a),r&&Xw(n,r),t}(de.a.Component),tT="INIT_REPLICATION",nT="REPLICATION_DATABASES_LOADED",aT="REPLICATION_UPDATE_FORM_FIELD",rT="REPLICATION_CLEAR_FORM",oT="REPLICATION_STARTING",iT="REPLICATION_STATUS",sT="REPLICATION_FETCHING_STATUS",cT="REPLICATION_FILTER_DOCS",lT="REPLICATION_TOGGLE_ALL_DOCS",uT="REPLICATION_TOGGLE_DOC",dT="REPLICATION_SET_STATE_FROM_DOC",pT="REPLICATION_SHOW_CONFLICT_MODAL",fT="REPLICATION_HIDE_CONFLICT_MODAL",hT="REPLICATION_CHANGE_ACTIVITY_SORT",mT="REPLICATION_CLEAR_SELECTED_DOCS",gT="REPLICATION_CHANGE_TAB_SECTION",bT="REPLICATION_FETCHING_REPLICATE_STATUS",yT="REPLICATION_REPLICATE_STATUS",ET="REPLICATION_SUPPORT_NEW_API",_T="REPLICATION_FILTER_REPLICATE",vT="REPLICATION_TOGGLE_ALL_REPLICATE",ST="REPLICATION_TOGGLE_REPLICATE",NT="REPLICATION_CLEAR_SELECTED_REPLICATES",DT="REPLICATION_FETCHING_FORM_STATE",OT=function(e){var t=s.a.isString(e)?e.trim().replace(/\/$/,""):e.url;return new URL(t).pathname.slice(1).split("/").pop()},wT=function e(t){return function(n){var a=uw(t),r=A.getServerUrl("/_replicator"),o=N(r,a),i=OT(a.source),s=OT(a.target);n({type:oT});var c=function(e){se.addNotification({msg:e.reason,type:"error",clear:!0})};return o.then((function(e){if(!e.ok)throw e;se.addNotification({msg:"Replication from <code>".concat(decodeURIComponent(i),"</code> to <code>").concat(decodeURIComponent(s),"</code> has been scheduled."),type:"success",escape:!1,clear:!0}),n(TT()),se.navigate("#/replication")})).catch((function(a){if(a.error&&"not_found"===a.error)return function(){var e=A.getServerUrl("/_replicator");return D(e).then((function(e){if(!e.ok)throw{reason:"Failed to create the _replicator database."};return!0}))}().then((function(){return e(t)(n)})).catch(c);c(a)}))}},TT=function(){return function(e){e({type:sT}),tw().then((function(e){return fw()})).then((function(t){e({type:iT,options:t})}))}},CT=function(){return function(e){tw().then((function(t){t&&(e({type:bT}),gw().then((function(t){e({type:yT,options:t})})))}))}},AT=function(e){return function(t){var n=e.map((function(e){var t=e.raw;return t._deleted=!0,t}));se.addNotification({msg:"Deleting doc".concat(n.length>1?"s":"","."),type:"success",escape:!1,clear:!0});var a=A.getServerUrl("/_replicator/_bulk_docs");N(a,{docs:n},{raw:!0}).then((function(e){if(!e.ok)throw e;return e})).then((function(){var n="The selected documents have been deleted.";1===e.length&&(n="Document <code>".concat(e[0]._id,"</code> has been deleted")),se.addNotification({msg:n,type:"success",escape:!1,clear:!0}),t({type:mT}),t(TT())})).catch((function(e){e.json().then((function(e){se.addNotification({msg:e.reason,type:"error",clear:!0})}))}))}},IT=function(e){return function(t){se.addNotification({msg:"Deleting _replicate".concat(e.length>1?"s":"","."),type:"success",escape:!1,clear:!0}),function(e){var t=e.map((function(e){var t={replication_id:e._id,cancel:!0},n=A.getServerUrl("/_replicate");return N(n,t)}));return se.Promise.all(t)}(e).then((function(){var n="The selected replications have been deleted.";1===e.length&&(n="Replication <code>".concat(e[0]._id,"</code> has been deleted")),t({type:NT}),t(CT()),se.addNotification({msg:n,type:"success",escape:!1,clear:!0})}),(function(e){var t=JSON.parse(e.responseText);se.addNotification({msg:t.reason,type:"error",clear:!0})}))}},PT=function(e){var t={type:YD.REPLICATION_AUTH_METHOD.NO_AUTH,creds:{}};if(e.headers&&e.headers.Authorization){var n=e.headers.Authorization.substring(6),a=zD.a.decode(n);return t.type=YD.REPLICATION_AUTH_METHOD.BASIC,t.creds={username:a.split(":")[0],password:a.split(":")[1]},t}var r=se.getExtensions("Replication:Auth"),o=void 0,i=void 0;return r&&r.map((function(t){!o&&t.getCredentials&&(o=t.getCredentials(e),i=t.typeValue)})),o&&(t.type=i,t.creds=o),t},RT=function(){return function(e){tw().then((function(t){e({type:ET,options:t})}))}};function kT(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function LT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kT(n,!0).forEach((function(t){xT(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kT(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var UT=function(e){le.utils.localStorageSet("replication-activity-sort",e)},MT=function(){var e=le.utils.localStorageGet("replication-activity-sort");return e||(e={descending:!1,column:"statusTime"}),UT(e),e},jT={remoteSource:"remoteSource",remoteTarget:"remoteTarget",localTarget:"localTarget",replicationType:"replicationType",replicationDocName:"replicationDocName",replicationSource:"replicationSource",replicationTarget:"replicationTarget",localSource:"localSource",sourceAuthType:"sourceAuthType",sourceAuth:"sourceAuth",targetAuthType:"targetAuthType",targetAuth:"targetAuth",targetDatabasePartitioned:"targetDatabasePartitioned"},HT={loading:!1,databases:[],replicationSource:"",localSource:"",remoteSource:"",sourceAuthType:YD.REPLICATION_AUTH_METHOD.NO_AUTH,sourceAuth:{},replicationTarget:"",localTarget:"",remoteTarget:"",targetAuthType:YD.REPLICATION_AUTH_METHOD.NO_AUTH,targetAuth:{},targetDatabasePartitioned:!1,isConflictModalVisible:!1,replicationType:YD.REPLICATION_TYPE.ONE_TIME,replicationDocName:"",submittedNoChange:!1,statusDocs:[],statusFilteredStatusDocs:[],statusFilter:"",replicateFilter:"",allDocsSelected:!1,allReplicateSelected:!1,username:"",password:"",activityLoading:!1,tabSection:"new replication",supportNewApi:!1,fetchingReplicateInfo:!1,replicateInfo:[],checkingAPI:!0,activitySort:MT()},BT=function(e){var t=LT({},e);return Object.values(jT).forEach((function(e){t[e]="sourceAuth"===e||"targetAuth"===e?{}:"targetDatabasePartitioned"!==e&&""})),t.sourceAuthType=YD.REPLICATION_AUTH_METHOD.NO_AUTH,t.targetAuthType=YD.REPLICATION_AUTH_METHOD.NO_AUTH,t},GT=function(e,t,n){var a=LT({},e,{submittedNoChange:!1});if(a[jT[t]]=n,t===jT.sourceAuthType||t===jT.replicationSource){var r=a[jT.sourceAuthType]===YD.REPLICATION_AUTH_METHOD.BASIC,o=a[jT.replicationSource]===YD.REPLICATION_SOURCE.LOCAL,i=!a[jT.sourceAuth]||!a[jT.sourceAuth].username;r&&o&&i&&(a[jT.sourceAuth]={username:se.session.user().name,password:""})}else if(t===jT.targetAuthType||t===jT.replicationTarget){var s=a[jT.targetAuthType]===YD.REPLICATION_AUTH_METHOD.BASIC,c=a[jT.replicationTarget]===YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE||a[jT.replicationTarget]===YD.REPLICATION_TARGET.NEW_LOCAL_DATABASE,l=!a[jT.targetAuth]||!a[jT.targetAuth].username;s&&c&&l&&(a[jT.targetAuth]={username:se.session.user().name,password:""})}return a},qT=function(e,t){var n=e.statusDocs.find((function(e){return e._id===t}));return n?(n.selected=!n.selected,LT({},e,{allDocsSelected:!1})):e},VT=function(e){var t=LT({},e,{allDocsSelected:!e.allDocsSelected});return sC(t).forEach((function(e){return e.selected=t.allDocsSelected})),t},FT=function(e,t){var n=LT({},e),a=n._replicateInfo.find((function(e){return e._id===t}));if(!a)return n;a.selected=!a.selected,n._allReplicateSelected=!1},KT=function(e){var t=LT({},e,{allReplicateSelected:!e.allReplicateSelected});return _C(t).forEach((function(e){return e.selected=t.allReplicateSelected})),t},WT=function(e,t){var n=LT({},e,{loading:!1});return Object.keys(t).reduce((function(e,n){return GT(e,n,t[n])}),n)},XT=function(e){return e.activityLoading},zT=function(e){return e.databases},YT=function(e){return e.replicationSource},QT=function(e){return e.localSource},JT=function(e){return-1!==_.indexOf(e.databases,e.localSource)},ZT=function(e){return e.remoteSource},$T=function(e){return e.replicationTarget},eC=function(e){return e.localTarget},tC=function(e){return-1!==_.indexOf(e.databases,e.localTarget)},nC=function(e){return e.remoteTarget},aC=function(e){return e.isConflictModalVisible},rC=function(e){return e.replicationType},oC=function(e){return e.replicationDocName},iC=function(e){return e.submittedNoChange},sC=function(e){return e.statusDocs.filter((function(t){return Object.values(t).filter((function(t){return t?t.toString().toLowerCase().match(e.statusFilter):null})).length>0}))},cC=function(e){return e.statusFilter},lC=function(e){return e.replicateFilter},uC=function(e){return e.allDocsSelected},dC=function(e){return sC(e).some((function(e){return e.selected}))},pC=function(e){return e.username},fC=function(e){return e.password},hC=function(e){return e.activitySort},mC=function(e){return e.checkingAPI},gC=function(e){return e.supportNewApi},bC=function(e){return e.fetchingReplicateInfo},yC=function(e){return e.allReplicateSelected},EC=function(e){return _C(e).some((function(e){return e.selected}))},_C=function(e){return e.replicateInfo.filter((function(t){return Object.values(t).filter((function(t){return!!t&&t.toString().toLowerCase().match(e._replicateFilter)})).length>0}))},vC=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:HT,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.options;switch(n){case tT:var r=LT({},e,{loading:!0});return a.localSource&&(r.localSource=a.localSource,r.replicationSource=YD.REPLICATION_SOURCE.LOCAL,r.remoteSource="",r.replicationTarget="",r.localTarget="",r.remoteTarget=""),r;case nT:return LT({},e,{loading:!1,databases:a.databases});case DT:return LT({},e,{loading:!0});case aT:return GT(e,a.fieldName,a.value);case rT:return BT(e);case oT:return LT({},e,{submittedNoChange:!0});case sT:return LT({},e,{activityLoading:!0});case iT:return LT({},e,{activityLoading:!1,statusDocs:a});case cT:return LT({},e,{statusFilter:a});case _T:return LT({},e,{replicateFilter:a});case uT:return qT(e,a);case lT:return VT(e);case ST:return FT(e,a);case vT:return KT(e);case dT:return WT(e,a);case pT:return LT({},e,{isConflictModalVisible:!0});case fT:return LT({},e,{isConflictModalVisible:!1});case hT:return UT(a),LT({},e,{activitySort:MT()});case mT:return LT({},e,{allDocsSelected:!1});case gT:return LT({},e,{tabSection:a});case ET:return LT({},e,{checkingApi:!1,supportNewApi:a});case bT:return LT({},e,{fetchingReplicateInfo:!0});case yT:return LT({},e,{fetchingReplicateInfo:!1,replicateInfo:a});case NT:return LT({},e,{allReplicateSelected:!1});default:return e}},SC=Object(nt.b)((function(e,t){var n,a=e.replication;return{allowNewPartitionedLocalDbs:e.databases.partitionedDatabasesAvailable,routeLocalSource:t.routeLocalSource,replicationId:t.replicationId,tabSection:t.section,loading:(n=a,n.isLoading),activityLoading:XT(a),databases:zT(a),replicationSource:YT(a),localSource:QT(a),localSourceKnown:JT(a),remoteSource:ZT(a),sourceAuthType:a.sourceAuthType,sourceAuth:a.sourceAuth,replicationTarget:$T(a),localTarget:eC(a),localTargetKnown:tC(a),remoteTarget:nC(a),targetAuthType:a.targetAuthType,targetAuth:a.targetAuth,targetDatabasePartitioned:a.targetDatabasePartitioned,isConflictModalVisible:aC(a),replicationType:rC(a),replicationDocName:oC(a),submittedNoChange:iC(a),statusDocs:sC(a),statusFilter:cC(a),replicateFilter:lC(a),allDocsSelected:uC(a),someDocsSelected:dC(a),username:pC(a),password:fC(a),activitySort:hC(a),checkingApi:mC(a),supportNewApi:gC(a),replicateLoading:bC(a),replicateInfo:_C(a),allReplicateSelected:yC(a),someReplicateSelected:EC(a)}}),(function(e){return{checkForNewApi:function(){return e(RT())},updateFormField:function(t){return function(n){e(function(e,t){return{type:aT,options:{fieldName:e,value:t}}}(t,n))}},clearReplicationForm:function(){return e({type:rT})},initReplicator:function(t){return e(function(e,t){return function(n){e&&e!==t&&n({type:tT,options:{localSource:e}})}}(t))},getReplicationActivity:function(){return e(TT())},getReplicateActivity:function(){return e(CT())},getReplicationStateFrom:function(t){return e(function(e){return function(t){t({type:DT});var n=A.getServerUrl("/_replicator/".concat(encodeURIComponent(e)));v(n).then((function(e){var n={replicationDocName:e._id,replicationType:e.continuous?YD.REPLICATION_TYPE.CONTINUOUS:YD.REPLICATION_TYPE.ONE_TIME},a=_.isObject(e.source)?e.source.url:e.source,r=_.isObject(e.target)?e.target.url:e.target;if(a.indexOf(window.location.hostname)>-1){var o=new URL(a);n.replicationSource=YD.REPLICATION_SOURCE.LOCAL,n.localSource=decodeURIComponent(o.pathname.slice(1))}else n.replicationSource=YD.REPLICATION_SOURCE.REMOTE,n.remoteSource=aw(a);var i=PT(e.source);if(n.sourceAuthType=i.type,n.sourceAuth=i.creds,r.indexOf(window.location.hostname)>-1){var s=new URL(r);n.replicationTarget=YD.REPLICATION_TARGET.EXISTING_LOCAL_DATABASE,n.localTarget=decodeURIComponent(s.pathname.slice(1))}else n.replicationTarget=YD.REPLICATION_TARGET.EXISTING_REMOTE_DATABASE,n.remoteTarget=aw(r);var c,l=PT(e.target);n.targetAuthType=l.type,n.targetAuth=l.creds,n.targetDatabasePartitioned=!(!(c=e.create_target_params)||!0!==c.partitioned),t({type:dT,options:n})})).catch((function(e){se.addNotification({msg:e.reason,type:"error",clear:!0})}))}}(t))},getDatabasesList:function(){return e((function(e){var t=A.getServerUrl("/_all_dbs");v(t).then((function(t){e({type:nT,options:{databases:t}})}))}))},replicate:function(t){return e(wT(t))},showConflictModal:function(){return e({type:pT})},hideConflictModal:function(){return e({type:fT})},filterReplicate:function(t){return e(function(e){return{type:_T,options:e}}(t))},filterDocs:function(t){return e(function(e){return{type:cT,options:e}}(t))},selectDoc:function(t){return e({type:uT,options:t})},deleteDocs:function(t){return e(AT(t))},selectAllDocs:function(){return e({type:lT})},changeActivitySort:function(t){return e(function(e){return{type:hT,options:e}}(t))},selectAllReplicates:function(){return e({type:vT})},deleteReplicates:function(t){return e(IT(t))},selectReplicate:function(t){return e({type:ST,options:t})}}}))(eT),NC={RouteObjects:[se.RouteObject.extend({routes:{"replication/_create":"createView","replication/_create/:dbname":"createView","replication/id/:id":"createViewFromId",replication:"activityView","replication/_replicate":"replicateView"},selectedHeader:"Replication",roles:["fx_loggedIn"],setActivityCrumbs:function(){this.crumbs=[{name:"Replication"}]},setCreateReplicationCrumbs:function(){this.crumbs=[{name:"Replication",link:"replication"},{name:"New Replication"}]},createView:function(e){var t=e||"";return de.a.createElement(SC,{routeLocalSource:t,section:"new replication"})},createViewFromId:function(e){return de.a.createElement(SC,{replicationId:e,section:"new replication"})},activityView:function(){return de.a.createElement(SC,{section:"activity"})},replicateView:function(){return de.a.createElement(SC,{section:"_replicate"})}})]};n(736);NC.initialize=function(){se.addHeaderLink({title:"Replication",href:"#/replication",icon:"fonticon-replicate"}),se.session.isAuthenticated().then((function(){RT()}))},se.addReducers({replication:vC}),se.registerUrls("replication",{app:function(e){return"#/replication/_create/"+e},api:function(){return A.getApiUrl("/_replicator")}});var DC=NC,OC={};OC.Doc=He.Doc.extend({setIndex:function(e,t){if(!this.isDdoc())return!1;var n=this.get("st_indexes");return n||(n={}),n[e]||(n[e]={}),n[e].index=t,this.set({st_indexes:n})},removeIndex:function(e){if(!this.isDdoc())return!1;var t=this.get("st_indexes")||{};delete t[e],this.set({st_indexes:t})},getIndex:function(e){return this.get("st_indexes")[e].index},dDocModel:function(){if(!this.isDdoc())return!1;var e=this.get("doc");return!!e&&new OC.Doc(e,{database:this.database})}}),OC.AllDocs=He.AllDocs.extend({model:OC.Doc});var wC=OC,TC={GEO_INDEX_CLEAR:"GEO_INDEX_CLEAR",GEO_SET_LOADING:"GEO_SET_LOADING",GEO_INDEX_PAGE_INITIALIZING:"GEO_INDEX_PAGE_INITIALIZING",GEO_QUERY_STARTED:"GEO_QUERY_STARTED",GEO_INDEX_DESIGN_DOCS_LOADED:"GEO_INDEX_DESIGN_DOCS_LOADED",GEO_INDEX_SELECT_DESIGN_DOC:"GEO_INDEX_SELECT_DESIGN_DOC",GEO_INDEX_SET_NAME:"GEO_INDEX_SET_NAME",GEO_INIT_EDIT_SEARCH_INDEX:"GEO_INIT_EDIT_SEARCH_INDEX",GEO_TOGGLE_RESULTS_VIEW:"GEO_TOGGLE_RESULTS_VIEW",GEO_INDEX_INFO_LOADED:"GEO_INDEX_INFO_LOADED",GEO_SELECT_SEARCH_SHAPE:"GEO_SELECT_SEARCH_SHAPE",GEO_RESULTS_RETURNED:"GEO_RESULTS_RETURNED",GEO_INDEX_UPDATE_INDEX_FUNCTION:"GEO_INDEX_UPDATE_INDEX_FUNCTION",GEO_INDEX_UPDATE_PER_PAGE:"GEO_INDEX_UPDATE_PER_PAGE",GEO_UPDATE_SHAPE_RELATION:"GEO_UPDATE_SHAPE_RELATION",GEO_UPDATE_SEARCH_SETTING:"GEO_UPDATE_SEARCH_SETTING",GEO_TOGGLE_ROW:"GEO_TOGGLE_ROW",GEO_HIDE_DELETE_DOCS_MODAL:"GEO_HIDE_DELETE_DOCS_MODAL",GEO_SHOW_DELETE_DOCS_MODAL:"GEO_SHOW_DELETE_DOCS_MODAL",GEO_TOGGLE_ALL_DOCS:"GEO_TOGGLE_ALL_DOCS",GEO_CLEAR_SHAPE:"GEO_CLEAR_SHAPE",GEO_ADD_BLANK_POINT:"GEO_ADD_BLANK_POINT",GEO_DELETE_POINT:"GEO_DELETE_POINT",GEO_UPDATE_POINT:"GEO_UPDATE_POINT",GEO_TOGGLE_NEAREST_NEIGHBOUR:"GEO_TOGGLE_NEAREST_NEIGHBOUR",GEO_TOGGLE_QUERY_OPTIONS_TRAY:"GEO_TOGGLE_QUERY_OPTIONS_TRAY",GEO_NEW_DESIGN_DOC_NAME_UPDATED:"GEO_NEW_DESIGN_DOC_NAME_UPDATED"},CC={GEO_INDEX_VIEW:"GEO_INDEX_VIEW",GEO_INDEX_PER_PAGE:"GEO_INDEX_PER_PAGE",GEO_INDEX_DEFAULT_RESULTS_PER_PAGE:20,GEO_INDEX_DEFAULT_BBOX_SEARCH:{sw:{lat:-90,lon:-180},ne:{lat:90,lon:180}},DEFAULT_GEO_INDEX_NAME:"newGeoIndex",DEFAULT_GEO_INDEX_FUNCTION:"function (doc) {\n  if (doc.geometry && doc.geometry.coordinates) {\n    st_index(doc.geometry);\n  }\n}",SHAPES:{POINT:"SHAPE_POINT",LINE:"SHAPE_LINE",CIRCLE:"SHAPE_CIRCLE",ELLIPSE:"SHAPE_ELLIPSE",POLYGON:"SHAPE_POLYGON",RECTANGLE:"SHAPE_RECTANGLE"},VIEWS:{MAP:"TABLE_MAP",JSON:"TABLE_JSON",TABLE:"TABLE_VIEW"}};function AC(e){return e.filter((function(e){return""!==e[0]&&""!==e[1]})).map((function(e){return e[0]+" "+e[1]})).toString()}var IC={getGeoSearchQuery:function(e){var t={};return e.shape===CC.SHAPES.CIRCLE?t={lat:e.shapeSettings.mapData.lat,lon:e.shapeSettings.mapData.lon,radius:e.shapeSettings.mapData.radius}:e.shape===CC.SHAPES.RECTANGLE?t={bbox:e.shapeSettings.mapData.sw.lon+","+e.shapeSettings.mapData.sw.lat+","+e.shapeSettings.mapData.ne.lon+","+e.shapeSettings.mapData.ne.lat}:e.shape===CC.SHAPES.POINT?t={g:"point("+e.shapeSettings.mapData.lon+" "+e.shapeSettings.mapData.lat+")"}:e.shape===CC.SHAPES.LINE?t={g:"linestring("+AC(e.shapeSettings.mapData)+")"}:e.shape===CC.SHAPES.POLYGON&&(t={g:"polygon(("+AC(e.shapeSettings.mapData)+"))"}),t.limit=e.perPage,e.shape!==CC.SHAPES.POINT&&"none"!==e.shapeSettings.relation&&(t.relation=e.shapeSettings.relation),e.shapeSettings.nearest&&(t.nearest="true"),e.includeDocs&&(t.include_docs="true"),e.skip&&(t.skip=e.skip),t},setValueInObjectByPath:function(e,t,n){var a=t.split("."),r=a.length,o=e;a.forEach((function(e,t){t!==r-1?o=o[e]:o[e]=n}))},getLatLngString:AC};function PC(e){var t=IC.getGeoSearchQuery({shape:e.shape,shapeSettings:e.shapeSettings,perPage:e.perPage,includeDocs:e.includeDocs,skip:e.skip});le.utils.localStorageSet(CC.GEO_INDEX_PER_PAGE,e.perPage),se.dispatch({type:TC.GEO_QUERY_STARTED,options:{searchSettings:e}});var n=se.urls("geoindex","query",le.utils.safeURLName(e.databaseName),le.utils.safeURLName(e.ddocName),e.indexName),a=se.urls("geoindex","apiurl",le.utils.safeURLName(e.databaseName),le.utils.safeURLName(e.ddocName),e.indexName,r.a.param(t));return r.a.ajax({type:"GET",url:n,dataType:"json",data:t}).then((function(e){se.dispatch({type:TC.GEO_RESULTS_RETURNED,options:{resp:e,endpoint:a}}),0===e.rows.length&&se.addNotification({msg:"No results found. Please broaden your search criteria.",type:"info",clear:!0})}),(function(){se.dispatch({type:TC.GEO_RESULTS_RETURNED,options:{resp:{rows:[]}}}),se.addNotification({msg:"There was an error with this request.",type:"error",clear:!0})}))}var RC={initNewGeoIndex:function(e){se.dispatch({type:TC.GEO_INDEX_CLEAR}),se.dispatch({type:TC.GEO_INDEX_PAGE_INITIALIZING,options:{loading:!0}}),se.when([e.designDocs.fetch()]).then((function(){se.dispatch({type:TC.GEO_INDEX_DESIGN_DOCS_LOADED,options:{designDocs:e.designDocs,defaultDDoc:e.defaultDDoc,database:e.database}})}))},initCurrentGeoIndex:function(e){var t=new ob.DdocInfo({_id:e.ddocID},{database:e.database});se.dispatch({type:TC.GEO_INDEX_PAGE_INITIALIZING});var n,a,r,o,i,s=(n=e.database.id,a=e.ddocID,r=e.indexName,o=a.replace(/^_design\//,""),i=se.urls("geoindex","geoinfo",le.utils.safeURLName(n),le.utils.safeURLName(o),r),fetch(i,{credentials:"include",headers:{Accept:"application/json; charset=utf-8"},method:"GET"}).then((function(e){return e.json()})).then((function(e){if(e.error)throw new Error(e.error);return se.dispatch({type:TC.GEO_INDEX_INFO_LOADED,options:{geoInfo:e.geo_index}}),e})));return se.Promise.join(s,e.designDocs.fetch(),t.fetch()).then((function(){se.dispatch({type:TC.GEO_INIT_EDIT_SEARCH_INDEX,options:{indexName:e.indexName,ddocInfo:t,designDocs:e.designDocs,database:e.database}}),e.autoSearch&&PC({databaseName:e.database.id,ddocName:Ov.getCleanDesignDoc(e.ddocID),indexName:e.indexName,perPage:e.perPage,shape:CC.SHAPES.RECTANGLE,shapeSettings:{mapData:CC.GEO_INDEX_DEFAULT_BBOX_SEARCH,relation:"contains"},includeDocs:!1,skip:0})}),(function(t){se.dispatch({type:TC.GEO_SET_LOADING,options:{loading:!1}});var n="There was a problem editing the geospatial index.";"not_found"===t.message&&(n="".concat(e.indexName," geo index does not exist."),se.navigate(se.urls("allDocsSanitized","app",e.database.id),{trigger:!0})),se.addNotification({msg:n,type:"error",escape:!1,clear:!0})}))},setGeoIndexName:function(e){se.dispatch({type:TC.GEO_INDEX_SET_NAME,options:{value:e}})},selectDesignDoc:function(e){se.dispatch({type:TC.GEO_INDEX_SELECT_DESIGN_DOC,options:{value:e}})},saveGeoIndex:function(e,t,n){if(e.setIndex(t.indexName,t.indexFunction),t.lastSavedDesignDocName===e.id&&t.lastSavedIndexName!==t.indexName){var a=e.get("indexes")||{};delete a[t.lastSavedIndexName],e.set({indexes:a})}var r="The geospatial index has been saved.";t.isCreatingIndex&&(r="The geospatial index has been created."),e.save().then((function(){t.designDocs.add(e),se.addNotification({msg:r,type:"success",clear:!0}),se.navigate(n,{trigger:!0}),function(e){ii.dispatchUpdateDesignDocs(e.designDocs)}(t)}),(function(e){var t=JSON.parse(e.responseText).reason;se.addNotification({msg:"Save failed: "+t,type:"error",clear:!0})}))},deleteGeoIndex:function(e){Vi.safeDeleteIndex(e.designDoc,e.designDocs,"st_indexes",e.indexName,{onSuccess:function(){if(e.isOnIndex){var t=se.urls("allDocs","app",e.database.safeID());se.navigate(t)}ii.dispatchUpdateDesignDocs(e.designDocs),se.addNotification({msg:"The <code>"+_.escape(e.indexName)+"</code> geospatial index has been deleted.",type:"info",escape:!1,clear:!0}),ii.dispatchHideDeleteIndexModal()}})},cloneGeoIndex:function(e){var t=function(e,t,n,a){if("new-doc"===t){var r={_id:"_design/"+n,st_indexes:{},language:"javascript"};return new wC.Doc(r,{database:a})}var o=e.find((function(e){return e.id===t}));return o?o.dDocModel():null}(e.designDocs,e.targetDesignDocName,e.newDesignDocName,e.database),n=t.get("st_indexes");if(n&&_.has(n,e.newIndexName))se.addNotification({msg:"That geospatial index name is already used in this design doc. Please enter a new name.",type:"error",clear:!0});else{n||(n={});var a=Vi.helpers.findDesignDoc(e.designDocs,"_design/"+e.sourceDesignDocName).toJSON();n[e.newIndexName]=a.st_indexes[e.sourceIndexName],t.set({st_indexes:n}),t.save().then((function(){e.onComplete(),se.addNotification({msg:"The geospatial index has been cloned.",type:"success",clear:!0}),ii.dispatchUpdateDesignDocs(e.designDocs)}),(function(t){e.onComplete();var n=JSON.parse(t.responseText).reason;se.addNotification({msg:"Clone failed: "+n,type:"error",clear:!0})}))}},toggleResultsView:function(e){le.utils.localStorageSet(CC.GEO_INDEX_VIEW,e),se.dispatch({type:TC.GEO_TOGGLE_RESULTS_VIEW,options:{view:e}})},selectShape:function(e){se.dispatch({type:TC.GEO_SELECT_SEARCH_SHAPE,options:{shape:e}})},query:PC,updatePerPage:function(e){le.utils.localStorageSet(CC.GEO_INDEX_PER_PAGE,e),se.dispatch({type:TC.GEO_INDEX_UPDATE_PER_PAGE,options:{perPage:e}})},updateShapeRelation:function(e,t){se.dispatch({type:TC.GEO_UPDATE_SHAPE_RELATION,options:{shape:e,relation:t}})},setSearchSetting:function(e,t,n){se.dispatch({type:TC.GEO_UPDATE_SEARCH_SETTING,options:{shape:e,setting:t,value:n}})},toggleRow:function(e){se.dispatch({type:TC.GEO_TOGGLE_ROW,options:{docID:e}})},hideDeleteDocsModal:function(){se.dispatch({type:TC.GEO_HIDE_DELETE_DOCS_MODAL})},showDeleteDocsModal:function(){se.dispatch({type:TC.GEO_SHOW_DELETE_DOCS_MODAL})},toggleAllDocs:function(){se.dispatch({type:TC.GEO_TOGGLE_ALL_DOCS})},addBlankPoint:function(e){se.dispatch({type:TC.GEO_ADD_BLANK_POINT,options:{shape:e}})},deletePoint:function(e,t){se.dispatch({type:TC.GEO_DELETE_POINT,options:{shape:e,index:t}})},updatePoint:function(e,t,n,a){se.dispatch({type:TC.GEO_UPDATE_POINT,options:{shape:e,index:t,latOrLng:n,value:a}})},toggleNearestNeighbour:function(e){se.dispatch({type:TC.GEO_TOGGLE_NEAREST_NEIGHBOUR,options:{shape:e}})},toggleQueryOptionsTray:function(e){se.dispatch({type:TC.GEO_TOGGLE_QUERY_OPTIONS_TRAY,options:{visible:e}})},gotoEditGeoIndexPage:function(e,t,n,a){var r=t?encodeURIComponent(t):"";se.navigate("#"+se.urls("geoindex","edit",encodeURIComponent(e),r,n,a))},updateNewDesignDocName:function(e){se.dispatch({type:TC.GEO_NEW_DESIGN_DOC_NAME_UPDATED,options:{value:e}})}},kC=se.Store.extend({initialize:function(){this.reset(),this._selectedResultsView=CC.VIEWS.MAP,this._perPage=CC.GEO_INDEX_DEFAULT_RESULTS_PER_PAGE},reset:function(){this._database=null,this._queryOptionsTrayVisible=!1,this._designDocs=new Backbone.Collection,this._ddocName="new-doc",this._pageInitializing=!1,this._hasActiveQuery=!1,this._geoInfo={},this.clearShape(),this._includeDocs=!1,this._skip=0,this._deleteDocumentsModalVisible=!1,this._results=[],this._searchCount=0,this._checkedRows=[],this.updateLastSearch(),this.softReset(),this._endpoint=""},softReset:function(){this._geoIndexFunction=CC.DEFAULT_GEO_INDEX_FUNCTION,this._geoIndexName=CC.DEFAULT_GEO_INDEX_NAME,this._lastSavedIndexName="",this._newDesignDocName=""},setEndpoint:function(e){this._endpoint=e},getEndpoint:function(){return this._endpoint},isPageInitializing:function(){return this._pageInitializing},setPageInitializing:function(e){this._pageInitializing=e},hasActiveGeoQuery:function(){return this._hasActiveQuery},getSkip:function(){return this._skip},isQueryTrayVisible:function(){return this._queryOptionsTrayVisible},initNewGeoIndex:function(e){this.setPageInitializing(!1),this._designDocs=e.designDocs,this._ddocName=e.defaultDDoc?"_design/"+e.defaultDDoc:"new-doc",this._database=e.database,this.softReset()},initEditIndex:function(e){this.setPageInitializing(!1),this._searchPerformed=!1,this._designDocs=e.designDocs,this._geoIndexName=e.indexName,this._searchQuery="",this._ddocName=e.ddocInfo.id,this._lastSavedIndexName=e.indexName,this._lastSavedDesignDocName=this._ddocName,this._database=e.database;var t=this._designDocs.find(function(e){return e.id===this._ddocName}.bind(this)).dDocModel();this._geoIndexFunction=t.getIndex(this._geoIndexName)},getCurrentDesignDoc:function(){return this._designDocs.find(function(e){return e.id===this._ddocName}.bind(this)).dDocModel()},getSearchCount:function(){return this._searchCount},getPerPage:function(){return this._perPage},setPerPage:function(e){this._perPage=e,this._lastSearch.perPage=e},getDDocName:function(){return this._ddocName},getDesignDocs:function(){return this._designDocs},getDesignDocList:function(){return this.getDesignDocs().map((function(e){return e.id}))},setDDocName:function(e){this._ddocName=e},getNewDesignDocName:function(){return this._newDesignDocName},setNewDesignDocName:function(e){this._newDesignDocName=e},getIncludeDocs:function(){return this._includeDocs},getShape:function(){return this._shape},setShape:function(e){this._shape=e},getShapeSettings:function(){return this._shapeSettings},getGeoIndexFunction:function(){return this._geoIndexFunction},setGeoIndexName:function(e){this._geoIndexName=e},getGeoIndexName:function(){return this._geoIndexName},getLastSavedIndexName:function(){return this._lastSavedIndexName},getLastSavedDesignDocName:function(){return this._lastSavedDesignDocName},getSaveDesignDoc:function(){if("new-doc"===this._ddocName){var e={_id:"_design/"+this._newDesignDocName,views:{},language:"javascript"};return new wC.Doc(e,{database:this._database})}var t=this._designDocs.find(function(e){return e.id===this._ddocName}.bind(this));return t?t.dDocModel():null},getSelectedResultsView:function(){return this._selectedResultsView},setSelectedResultsView:function(e){this._selectedResultsView=e},setGeoInfo:function(e){this._geoInfo=e},getGeoInfo:function(){return this._geoInfo},setResults:function(e){this._hasActiveQuery=!1,this._results=e.rows,this._searchCount++},getResults:function(){return this._results},updateShapeRelation:function(e,t){this._shapeSettings[e].relation=t},getLastSearch:function(){return this._lastSearch},updateSearchSetting:function(e,t,n){IC.setValueInObjectByPath(this._shapeSettings[e],t,n)},getCheckedRows:function(){return this._checkedRows},toggleRow:function(e){-1!==this._checkedRows.indexOf(e)?this._checkedRows=this._checkedRows.filter((function(t){return t!==e})):this._checkedRows.push(e)},areAllCheckedOnPage:function(){var e=this;return this._results.every((function(t){return-1!==e._checkedRows.indexOf(t.id)}))},hasOneCheckedOnAnyPage:function(){return this._checkedRows.length>0},isDeleteDocumentsModalVisible:function(){return this._deleteDocumentsModalVisible},showDeleteDocsModal:function(){this._deleteDocumentsModalVisible=!0},hideDeleteDocsModal:function(){this._deleteDocumentsModalVisible=!1},toggleAllDocs:function(){var e=this._results.map((function(e){return e.id}));this.areAllCheckedOnPage()?this._checkedRows=_.difference(this._checkedRows,e):this._checkedRows=_.union(this._checkedRows,e)},getDeleteDocsData:function(){return{docs:[]}},clearShape:function(){this._shape=CC.SHAPES.RECTANGLE,this._shapeSettings={},this._shapeSettings[CC.SHAPES.RECTANGLE]={mapData:CC.GEO_INDEX_DEFAULT_BBOX_SEARCH,relation:"contains",nearest:!0},this._shapeSettings[CC.SHAPES.POINT]={mapData:{lat:"",lon:""},nearest:!0},this._shapeSettings[CC.SHAPES.LINE]={mapData:[],relation:"none",nearest:!0},this._shapeSettings[CC.SHAPES.CIRCLE]={mapData:{lat:"",lon:"",radius:0},relation:"contains",nearest:!1},this._shapeSettings[CC.SHAPES.POLYGON]={mapData:[],relation:"contains",nearest:!1}},startQuery:function(e){this._hasActiveQuery=!0,this.setSkip(e.skip),this._perPage=e.perPage,this._includeDocs=e.includeDocs,this._shape=e.shape,this._shapeSettings[this._shape]=e.shapeSettings,this.updateLastSearch()},setSkip:function(e){this._skip=e},updateLastSearch:function(){this._lastSearch={perPage:this._perPage,skip:this._skip,includeDocs:this._includeDocs,shape:this._shape,shapeSettings:this._shapeSettings}},addBlankPoint:function(e){this._shapeSettings[e].mapData.push(["",""])},deletePoint:function(e,t){this._shapeSettings[e].mapData.splice(t,1)},updatePoint:function(e,t,n,a){var r="lat"===n?1:0;this._shapeSettings[e].mapData[t][r]=a},toggleNearestNeighbour:function(e){this._shapeSettings[e].nearest=!this._shapeSettings[e].nearest},toggleQueryOptionsTray:function(e){this._queryOptionsTrayVisible=e},dispatch:function(e){var t=this;switch(e.type){case TC.GEO_INDEX_PAGE_INITIALIZING:this.reset(),this.setPageInitializing(!0);break;case TC.GEO_INDEX_DESIGN_DOCS_LOADED:this.initNewGeoIndex(e.options);break;case TC.GEO_INDEX_SELECT_DESIGN_DOC:this.setDDocName(e.options.value);break;case TC.GEO_INDEX_SET_NAME:this.setGeoIndexName(e.options.value);break;case TC.GEO_INIT_EDIT_SEARCH_INDEX:this.initEditIndex(e.options);break;case TC.SEARCH_INDEX_CLEAR:this.reset();break;case TC.GEO_TOGGLE_RESULTS_VIEW:this.setSelectedResultsView(e.options.view);break;case TC.GEO_INDEX_INFO_LOADED:this.setGeoInfo(e.options.geoInfo);break;case TC.GEO_SELECT_SEARCH_SHAPE:this.setShape(e.options.shape);break;case TC.GEO_RESULTS_RETURNED:this.setResults(e.options.resp),this.setEndpoint(e.options.endpoint);break;case TC.GEO_INDEX_UPDATE_PER_PAGE:this.setPerPage(e.options.perPage);break;case TC.GEO_QUERY_STARTED:this.startQuery(e.options.searchSettings);break;case TC.GEO_UPDATE_SHAPE_RELATION:this.updateShapeRelation(e.options.shape,e.options.relation);break;case TC.GEO_UPDATE_SEARCH_SETTING:this.updateSearchSetting(e.options.shape,e.options.setting,e.options.value);break;case TC.GEO_TOGGLE_ROW:this.toggleRow(e.options.docID);break;case TC.GEO_HIDE_DELETE_DOCS_MODAL:this.hideDeleteDocsModal();break;case TC.GEO_SHOW_DELETE_DOCS_MODAL:this.showDeleteDocsModal();break;case TC.GEO_TOGGLE_ALL_DOCS:this.toggleAllDocs();break;case TC.GEO_CLEAR_SHAPE:this.clearShape();break;case TC.GEO_ADD_BLANK_POINT:this.addBlankPoint(e.options.shape);break;case TC.GEO_DELETE_POINT:this.deletePoint(e.options.shape,e.options.index);break;case TC.GEO_UPDATE_POINT:this.updatePoint(e.options.shape,e.options.index,e.options.latOrLng,e.options.value);break;case TC.GEO_TOGGLE_NEAREST_NEIGHBOUR:this.toggleNearestNeighbour(e.options.shape);break;case TC.GEO_TOGGLE_QUERY_OPTIONS_TRAY:this.toggleQueryOptionsTray(e.options.visible);break;case TC.GEO_NEW_DESIGN_DOC_NAME_UPDATED:this.setNewDesignDocName(e.options.value);break;default:return}setTimeout((function(){t.triggerChange()}))}}),LC=new kC;LC.dispatchToken=se.dispatcher.register(LC.dispatch.bind(LC));var xC={GeoIndexStore:kC,geoIndexStore:LC},UC=n(185),MC=n.n(UC);function jC(e){return(jC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BC(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function GC(e,t,n){return t&&BC(e.prototype,t),n&&BC(e,n),e}function qC(e,t){return!t||"object"!==jC(t)&&"function"!=typeof t?FC(e):t}function VC(e){return(VC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KC(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WC(e,t)}function WC(e,t){return(WC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zC=null,YC=null,QC=null,JC={circle:CC.SHAPES.CIRCLE,polyline:CC.SHAPES.LINE,marker:CC.SHAPES.POINT,polygon:CC.SHAPES.POLYGON,rectangle:CC.SHAPES.RECTANGLE},ZC={polygon:{color:"green",fill:!1},rectangle:{color:"green"},circle:{color:"green"},polyline:{color:"green"}},$C=null,eA=null,tA=function(e){function t(){var e,n;HC(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return XC(FC(n=qC(this,(e=VC(t)).call.apply(e,[this].concat(r)))),"state",{lat:36,lon:0,zoom:2,lockAutoZoom:!1}),XC(FC(n),"updateResults",(function(){QC&&QC.clearLayers();var e=[],t=[],a=n.props.getEditDocURL,r=[];n.props.results.forEach((function(n){var o=n.geometry;if("Point"===o.type){var i=o.coordinates[0],s=o.coordinates[1];e.push(i),t.push(s),r.push({type:"Feature",geometry:o,properties:{"marker-color":"#f3622d",popupHTML:MC.a.renderToStaticMarkup(de.a.createElement(nA,{id:n.id,editURL:a(n.id)}))}})}"LineString"===o.type&&(o.coordinates.forEach((function(n){e.push(n[0]),t.push(n[1])})),r.push({type:"Feature",geometry:o,properties:{popupHTML:MC.a.renderToStaticMarkup(de.a.createElement(nA,{id:n.id,editURL:a(n.id)}))}})),"Polygon"!==o.type&&"MultiPolygon"!==o.type||("Polygon"===o.type&&o.coordinates.forEach((function(n){n.forEach((function(n){e.push(n[0]),t.push(n[1])}))})),"MultiPolygon"===o.type&&o.coordinates.forEach((function(n){n.forEach((function(n){n.forEach((function(n){e.push(n[0]),t.push(n[1])}))}))})),r.push({type:"Feature",geometry:o,properties:{fill:"#cd8a07","fill-opacity":.3,stroke:"#cd8a07","stroke-opacity":.7,popupHTML:MC.a.renderToStaticMarkup(de.a.createElement(nA,{id:n.id,editURL:a(n.id)}))}}))})),r.length&&((QC=L.mapbox.featureLayer({type:"FeatureCollection",features:r}).addTo(zC)).eachLayer((function(e){e.bindPopup(e.feature.properties.popupHTML)})),n.state.lockAutoZoom||(eA={sw:[_.min(t),_.min(e)],ne:[_.max(t),_.max(e)]},n.fitBounds()))})),XC(FC(n),"fitBounds",(function(){null!==eA&&zC.fitBounds([eA.sw,eA.ne])})),XC(FC(n),"getShapeType",(function(e){return e instanceof L.Circle?"circle":e instanceof L.Rectangle?"rectangle":"polygon"})),XC(FC(n),"drawShape",(function(e,t){if(YC.clearLayers(),e!==JC.circle)if(e!==JC.marker)if(e!==JC.rectangle){if(e===JC.polygon||e===JC.polyline){var n=t.map((function(e){return[parseFloat(e[1]),parseFloat(e[0])]}));L.polyline(n,ZC.polygon).addTo(YC)}}else{if(-90===t.sw.lat&&-180===t.sw.lon&&90===t.ne.lat&&180===t.ne.lon)return void document.querySelector(".leaflet-draw-edit-remove").classList.add("leaflet-disabled");var a=[[t.sw.lat,t.sw.lon],[t.ne.lat,t.ne.lon]];L.rectangle(a,ZC.rectangle).addTo(YC)}else L.marker([t.lat,t.lon]).addTo(YC);else L.circle([t.lat,t.lon],t.radius,ZC.circle).addTo(YC)})),XC(FC(n),"shapeCreated",(function(e){YC.clearLayers(),YC.addLayer(e.layer),n.onDraw(e.layerType,e.layer)})),XC(FC(n),"shapeEdited",(function(e){e.layers.eachLayer(function(e){var t=this.getShapeType(e);this.onDraw(t,e)}.bind(FC(n)))})),XC(FC(n),"onDraw",(function(e,t){var a={shape:JC[e],data:{}};if("circle"===e){var r=t.getLatLng();a.data={lat:r.lat,lon:r.lng,radius:t.getRadius()}}else if("marker"===e){var o=t.getLatLng();a.data={lat:o.lat,lon:o.lng}}else if("polyline"===e)a.data=t.toGeoJSON().geometry.coordinates;else if("rectangle"===e){var i=t.getLatLngs();a.data={sw:{lat:i[0].lat,lon:i[0].lng},ne:{lat:i[2].lat,lon:i[2].lng}}}else if("polygon"===e){var s=t.toGeoJSON().geometry.coordinates;1===s.length&&Array.isArray(s[0])&&(s=s[0]),a.data=s}$C=a,document.querySelector(".leaflet-draw-edit-remove").classList.remove("leaflet-disabled"),n.props.onDraw(a)})),XC(FC(n),"toggleAutoZoomLocking",(function(){n.setState({lockAutoZoom:!n.state.lockAutoZoom})})),n}return KC(t,e),GC(t,[{key:"componentDidUpdate",value:function(e){this.props.searchCount!==e.searchCount&&(this.updateResults(),this.drawShape(this.props.shape,this.props.shapeSettings))}},{key:"componentDidMount",value:function(){L.mapbox.config.FORCE_HTTPS=!0,L.mapbox.accessToken="pk.eyJ1IjoiYmVua2VlbiIsImEiOiJjaWphY3Y0MTYwMDU4dXNtNDM1cTlkZ2poIn0.xspf02UPZnouGttSPhyiVg",zC=L.mapbox.map(this.map,"mapbox.streets",{zoomControl:!1}).setView([this.state.lat,this.state.lon],this.state.zoom),YC=L.featureGroup().addTo(zC),new L.Control.Zoom({position:"topright"}).addTo(zC),new L.Control.Draw({position:"topright",edit:{featureGroup:YC,remove:!1,edit:!1},draw:{polyline:{shapeOptions:ZC.polyline},marker:!0,polygon:{shapeOptions:ZC.polygon},rectangle:{shapeOptions:ZC.rectangle},circle:{shapeOptions:ZC.circle}}}).addTo(zC),zC.on("draw:created",this.shapeCreated),zC.on("draw:edited",this.shapeEdited);var e=this.props.onClear;L.Control.RemoveAll=L.Control.extend({options:{position:"topright"},onAdd:function(){var t=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar");L.DomEvent.addListener(t,"click",L.DomEvent.stopPropagation).addListener(t,"click",L.DomEvent.preventDefault).addListener(t,"click",(function(){var t=this.querySelector("a");t.classList.contains("leaflet-disabled")||(YC.clearLayers(),e(),$C=null,t.classList.add("leaflet-disabled"))}));var n="leaflet-draw-edit-remove";null===$C&&(n+=" leaflet-disabled");var a=L.DomUtil.create("a",n,t);return a.title="Remove Shape",a.href="#",t}});var t=new L.Control.RemoveAll;zC.addControl(t),this.updateResults(),this.drawShape(this.props.shape,this.props.shapeSettings)}},{key:"render",value:function(){var e=this;return de.a.createElement("div",{className:"map flex-body flex-layout flex-col"},de.a.createElement("div",{ref:function(t){return e.map=t},className:"flex-body"}),de.a.createElement("div",{className:"lock-auto-zoom-section"},de.a.createElement("input",{type:"checkbox",id:"lock-auto-zoom",onChange:this.toggleAutoZoomLocking,checked:this.state.lockAutoZoom}),de.a.createElement("label",{htmlFor:"lock-auto-zoom"},"Lock auto-zoom/panning")))}}]),t}(de.a.Component);XC(tA,"propTypes",{searchCount:tt.a.number.isRequired,results:tt.a.array.isRequired,onDraw:tt.a.func.isRequired});var nA=function(e){function t(){return HC(this,t),qC(this,VC(t).apply(this,arguments))}return KC(t,e),GC(t,[{key:"render",value:function(){return de.a.createElement("div",{className:"geo-map-result"},de.a.createElement("div",null,"ID: ",this.props.id),de.a.createElement("div",null,de.a.createElement("a",{href:this.props.editURL,"data-bypass":"true",target:"_blank",rel:"noopener noreferrer",className:"opens-new-window"},"Edit document")))}}]),t}(de.a.Component);XC(nA,"propTypes",{id:tt.a.string.isRequired,editURL:tt.a.string.isRequired});var aA={Map:tA};function rA(){return(rA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function oA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iA(e){return(iA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cA(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lA(e,t,n){return t&&cA(e.prototype,t),n&&cA(e,n),e}function uA(e,t){return!t||"object"!==iA(t)&&"function"!=typeof t?dA(e):t}function dA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pA(e){return(pA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hA(e,t)}function hA(e,t){return(hA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mA=os.DesignDocSelector,gA=Jr.connectToStores,bA=Jr.Document,yA=Jr.ToggleHeaderButton,EA=Jr.TrayContents,_A=Jr.TrayWrapper,vA=Ct.a,SA=Ct.b,NA=_o.ConfirmationModal,DA=xC.geoIndexStore,OA=function(e){function t(){return sA(this,t),uA(this,pA(t).apply(this,arguments))}return fA(t,e),lA(t,[{key:"render",value:function(){return de.a.createElement("div",{className:"tab-content flex-body"},de.a.createElement(IA,this.props))}}]),t}(de.a.Component),wA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{pageInitializing:DA.isPageInitializing(),resultsView:DA.getSelectedResultsView(),perPage:DA.getPerPage(),geoInfo:DA.getGeoInfo()}})),oA(dA(n),"onChange",(function(){n.setState(n.getStoreState())})),oA(dA(n),"state",n.getStoreState()),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){DA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){DA.off("change",this.onChange,this)}},{key:"getCancelLinkUrl",value:function(){var e=encodeURIComponent(this.props.databaseName),t=this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"",n=encodeURIComponent(this.props.ddocName),a=encodeURIComponent(this.props.indexName);return"#"+se.urls("geoindex","queryPage",e,t,n,a)}},{key:"render",value:function(){var e=this;return this.state.pageInitializing?de.a.createElement("div",{className:"edit-search-index-page-loading"},de.a.createElement(Jr.LoadLines,null)):de.a.createElement(IA,rA({ref:function(t){return e.geoIndexEditor=t},cancelLink:this.getCancelLinkUrl()},this.props))}}]),t}(de.a.Component);oA(wA,"propTypes",{databaseName:tt.a.string.isRequired,ddocName:tt.a.string.isRequired,indexName:tt.a.string.isRequired,partitionKey:tt.a.string});var TA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(o)))),"getStoreState",(function(){return{pageInitializing:DA.isPageInitializing(),activeGeoQuery:DA.hasActiveGeoQuery(),perPage:DA.getPerPage(),resultsView:DA.getSelectedResultsView(),geoInfo:DA.getGeoInfo(),deleteDocumentsModalVisible:DA.isDeleteDocumentsModalVisible(),results:DA.getResults(),searchCount:DA.getSearchCount(),shape:DA.getShape(),shapeSettings:DA.getShapeSettings(),includeDocs:DA.getIncludeDocs(),skip:DA.getSkip(),lastSearch:DA.getLastSearch(),checkedRows:DA.getCheckedRows(),allCheckedOnPage:DA.areAllCheckedOnPage(),hasOneChecked:DA.hasOneCheckedOnAnyPage(),deleteDocsData:DA.getDeleteDocsData(),designDocs:DA.getDesignDocs()}})),oA(dA(n),"onChange",(function(){n.setState(n.getStoreState())})),oA(dA(n),"runQuery",(function(e){RC.query({databaseName:n.props.databaseName,ddocName:n.props.ddocName,indexName:n.props.indexName,perPage:e.perPage,shape:e.shape,shapeSettings:e.shapeSettings,includeDocs:e.includeDocs,skip:e.skip})})),oA(dA(n),"onChangePerPage",(function(e){n.runQuery({perPage:e,shape:n.state.lastSearch.shape,shapeSettings:n.state.lastSearch.shapeSettings[n.state.lastSearch.shape],includeDocs:n.state.lastSearch.includeDocs,skip:0})})),oA(dA(n),"onDraw",(function(e){var t=r.a.extend(!0,{},n.state.shapeSettings[e.shape]);t.mapData=e.data,n.runQuery({perPage:n.state.perPage,shape:e.shape,shapeSettings:t,includeDocs:n.state.includeDocs,skip:0})})),oA(dA(n),"onClear",(function(){n.runQuery({perPage:n.state.perPage,shape:CC.SHAPES.RECTANGLE,shapeSettings:{mapData:CC.GEO_INDEX_DEFAULT_BBOX_SEARCH,relation:"contains"},includeDocs:n.state.includeDocs,skip:0})})),oA(dA(n),"getLoaderOverlay",(function(){return n.state.resultsView===CC.VIEWS.MAP&&n.state.activeGeoQuery?de.a.createElement("div",{className:"query-loader"},de.a.createElement(Jr.LoadLines,null)):null})),oA(dA(n),"getPage",(function(){return n.state.resultsView===CC.VIEWS.JSON?de.a.createElement(CA,{isLoading:n.state.activeGeoQuery,databaseName:n.props.databaseName,checkedRows:n.state.checkedRows,includeDocs:n.state.includeDocs,numDocsInIndex:n.state.geoInfo.doc_count,results:n.state.results,allCheckedOnPage:n.state.allCheckedOnPage,hasOneChecked:n.state.hasOneChecked}):n.state.resultsView===CC.VIEWS.MAP?de.a.createElement(PA,{onDraw:n.onDraw,onClear:n.onClear,databaseName:n.props.databaseName,results:n.state.results,searchCount:n.state.searchCount,defaultShape:n.state.shape,defaultShapeSettings:n.state.shapeSettings[n.state.shape].mapData}):void 0})),oA(dA(n),"getNoDocsOverlay",(function(){return n.state.resultsView!==CC.VIEWS.MAP?null:n.state.geoInfo.doc_count>0||n.state.activeGeoQuery||n.state.results.length>0?null:de.a.createElement("div",{className:"geo-no-docs"},de.a.createElement("h5",null,"No documents found."),de.a.createElement("p",null,"If this is a new index, depending on the size of your database it may take time to show results. Click the button below to refresh the page."),de.a.createElement("a",{href:"#","data-bypass":"true",onClick:n.refreshPage,className:"btn btn-primary"},"Refresh"))})),oA(dA(n),"refreshPage",(function(e){e.preventDefault(),window.location.reload()})),oA(dA(n),"onDeleteDocuments",(function(){})),oA(dA(n),"navigatePrevious",(function(){n.runQuery({perPage:n.state.lastSearch.perPage,shape:n.state.lastSearch.shape,shapeSettings:n.state.lastSearch.shapeSettings[n.state.lastSearch.shape],includeDocs:n.state.lastSearch.includeDocs,skip:n.state.skip-n.state.perPage})})),oA(dA(n),"navigateNext",(function(){n.runQuery({perPage:n.state.lastSearch.perPage,shape:n.state.lastSearch.shape,shapeSettings:n.state.lastSearch.shapeSettings[n.state.lastSearch.shape],includeDocs:n.state.lastSearch.includeDocs,skip:n.state.skip+n.state.perPage})})),oA(dA(n),"getFooter",(function(){if(0===n.state.geoInfo.doc_count&&0===n.state.results.length)return null;var e=n.state.skip+1,t=(n.state.results.length<n.state.perPage?n.state.results.length:n.state.perPage)+e-1;return de.a.createElement(AA,{perPage:n.state.perPage,onChangePerPage:n.onChangePerPage,navigatePrevious:n.navigatePrevious,navigateNext:n.navigateNext,databaseName:n.props.databaseName,ddocName:n.props.ddocName,indexName:n.props.indexName,shape:n.state.shape,shapeSettings:n.state.shapeSettings[n.state.shape],firstDocNum:e,lastDocNum:t,isFirstPage:0==n.state.skip,isLastPage:n.state.results.length<n.state.perPage})})),oA(dA(n),"state",n.getStoreState()),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){DA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){DA.off("change",this.onChange,this)}},{key:"render",value:function(){if(this.state.pageInitializing)return de.a.createElement("div",{className:"geo-index-page-loading"},de.a.createElement(Jr.LoadLines,null));var e="Are you sure you want to delete ";return 1===this.state.checkedRows.length?e+="this document?":e+="these "+this.state.checkedRows.length+" documents?",de.a.createElement("div",{className:"flex-layout flex-col flex-body"},this.getPage(),this.getLoaderOverlay(),this.getNoDocsOverlay(),this.getFooter(),de.a.createElement(NA,{visible:this.state.deleteDocumentsModalVisible,text:e,onClose:RC.hideDeleteDocsModal,onSubmit:this.onDeleteDocuments}))}}]),t}(de.a.Component);oA(TA,"propTypes",{databaseName:tt.a.string.isRequired,database:tt.a.object.isRequired,ddocName:tt.a.string.isRequired,indexName:tt.a.string.isRequired});var CA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"onDoubleClick",(function(e){se.navigate(n.getURL(e))})),oA(dA(n),"getLink",(function(e){return de.a.createElement("a",{href:n.getURL(e)},de.a.createElement("i",{className:"fonticon-pencil"}))})),oA(dA(n),"getURL",(function(e){return"#"+se.urls("document","web-index",n.props.databaseName,e)})),oA(dA(n),"toggleSelectAll",(function(e){e.preventDefault(),RC.toggleAllDocs()})),oA(dA(n),"onRemoveItem",(function(){RC.showDeleteDocsModal()})),oA(dA(n),"getBulkSelector",(function(){return null})),oA(dA(n),"getLoadLines",(function(){return n.props.isLoading?de.a.createElement(Jr.LoadLines,null):null})),oA(dA(n),"getResults",(function(){return 0!==n.props.results.length||n.props.isLoading?n.props.results.map((function(e,t){var a=e;return _.has(e,"doc")&&(a=e.doc),de.a.createElement(bA,{key:e.id+t,doc:e,onDoubleClick:n.onDoubleClick,keylabel:"id",docContent:JSON.stringify(a,null,"  "),checked:-1!==n.props.checkedRows.indexOf(e.id),header:e.id,docChecked:RC.toggleRow,isDeletable:!1,maxRows:100,docIdentifier:e.id},n.getLink(e.id))})):de.a.createElement("p",null,"No results found.")})),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){prettyPrint()}},{key:"componentDidUpdate",value:function(){prettyPrint()}},{key:"render",value:function(){return 0!==this.props.numDocsInIndex||this.props.isLoading||0!==this.props.results.length?de.a.createElement("div",{className:"flex-body geo-json-loader"},de.a.createElement("div",{className:"loading-lines-wrapper"},this.getLoadLines()),de.a.createElement("div",{className:"geo-json-results"},de.a.createElement("div",{className:"show-select"},this.getBulkSelector(),de.a.createElement("div",{id:"doc-list"},this.getResults())))):de.a.createElement(Vd,{text:"No Documents Found"})}}]),t}(de.a.Component);oA(CA,"propTypes",{isLoading:tt.a.bool.isRequired,results:tt.a.array.isRequired,databaseName:tt.a.string.isRequired,includeDocs:tt.a.bool.isRequired,checkedRows:tt.a.array.isRequired,allCheckedOnPage:tt.a.bool.isRequired,hasOneChecked:tt.a.bool.isRequired});var AA=function(e){function t(){return sA(this,t),uA(this,pA(t).apply(this,arguments))}return fA(t,e),lA(t,[{key:"render",value:function(){var e=0===this.props.lastDocNum?de.a.createElement("span",{className:"geo-no-results"},"No results."):de.a.createElement("span",null,"Showing ",this.props.firstDocNum," - ",this.props.lastDocNum);return de.a.createElement("footer",{className:"flex-fill geo-index-map-footer pagination-footer flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"}),de.a.createElement("div",{className:"flex-fill"},de.a.createElement("div",{className:"doclist-count"},e),de.a.createElement(oo,{perPageChange:this.props.onChangePerPage,perPage:this.props.perPage,options:[1,2,5,10,20,30,50,100,150,200]}),de.a.createElement(BA,{isFirstPage:this.props.isFirstPage,isLastPage:this.props.isLastPage,navigatePrevious:this.props.navigatePrevious,navigateNext:this.props.navigateNext})))}}]),t}(de.a.Component);oA(AA,"propTypes",{perPage:tt.a.number.isRequired,onChangePerPage:tt.a.func.isRequired,databaseName:tt.a.string.isRequired,ddocName:tt.a.string.isRequired,indexName:tt.a.string.isRequired,shape:tt.a.string.isRequired,shapeSettings:tt.a.object.isRequired,isFirstPage:tt.a.bool.isRequired,isLastPage:tt.a.bool.isRequired});var IA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{pageInitializing:DA.isPageInitializing(),designDocs:DA.getDesignDocs(),designDocList:DA.getDesignDocList(),ddocName:DA.getDDocName(),geoIndexFunction:DA.getGeoIndexFunction(),geoIndexName:DA.getGeoIndexName(),lastSavedIndexName:DA.getLastSavedIndexName(),lastSavedDesignDocName:DA.getLastSavedDesignDocName(),newDesignDocName:DA.getNewDesignDocName(),saveDoc:DA.getSaveDesignDoc()}})),oA(dA(n),"onChange",(function(){n.setState(n.getStoreState())})),oA(dA(n),"updateGeoIndexName",(function(e){RC.setGeoIndexName(e.target.value)})),oA(dA(n),"saveIndex",(function(e){if(e.preventDefault(),n.designDocSelector.validate()){var t=n.state.saveDoc.id.replace(/_design\//,""),a=n.props.partitionKey?encodeURIComponent(n.props.partitionKey):"",r=se.urls("geoindex","queryPage",encodeURIComponent(n.props.database.id),a,encodeURIComponent(t),encodeURIComponent(n.state.geoIndexName));RC.saveGeoIndex(n.state.saveDoc,{isCreatingIndex:n.props.isCreatingIndex,indexName:n.state.geoIndexName,designDocs:n.state.designDocs,database:n.props.database,indexFunction:n.getIndexFunction(),lastSavedIndexName:n.state.lastSavedIndexName,lastSavedDesignDocName:n.state.lastSavedDesignDocName},r)}})),oA(dA(n),"getIndexFunction",(function(){return n.geoIndexEditor.getValue()})),oA(dA(n),"getCancelLink",(function(){if(!n.props.isCreatingIndex)return de.a.createElement("a",{href:n.props.cancelLink,className:"geo-index-edit-cancel-link"},"Cancel")})),oA(dA(n),"state",n.getStoreState()),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){DA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){DA.off("change",this.onChange,this)}},{key:"render",value:function(){var e=this;if(this.state.pageInitializing)return de.a.createElement("div",{className:"search-index-page-loading"},de.a.createElement(Jr.LoadLines,null));var t=this.props.isCreatingIndex?"New Geospatial Index":"Edit Geospatial Index",n=this.props.isCreatingIndex?"Create Document and Build Index":"Save Document and Build Index";return de.a.createElement("div",{className:"geo-page-wrapper"},de.a.createElement("form",{className:"form-horizontal search-query-save",id:"search-index"},de.a.createElement("h3",{className:"index-page-header"},t),de.a.createElement(mA,{ref:function(t){return e.designDocSelector=t},designDocLabel:"Save to design document",designDocList:this.state.designDocList,isDbPartitioned:!1,newDesignDocName:this.state.ddocName,newDesignDocPartitioned:!1,selectedDesignDocName:this.state.ddocName,selectedDesignDocPartitioned:!1,onSelectDesignDoc:RC.selectDesignDoc,onChangeNewDesignDocName:RC.updateNewDesignDocName,onChangeNewDesignDocPartitioned:function(){},docLink:le.helpers.getDocUrl("DOC_URL_DESIGN_DOCS")}),de.a.createElement("div",{className:"control-group"},de.a.createElement("label",{htmlFor:"search-name"},"Index name"),de.a.createElement("input",{type:"text",id:"search-name",value:this.state.geoIndexName,onChange:this.updateGeoIndexName})),de.a.createElement(Jr.CodeEditorPanel,{ref:function(t){return e.geoIndexEditor=t},id:"geoindex-function",className:"ace-editor-section",title:"Geospatial index function",allowZenMode:!0,docLink:le.helpers.getDocUrl("GEOSPATIAL_INDEXES_CREATING"),defaultCode:this.state.geoIndexFunction,blur:this.props.blur}),de.a.createElement("div",{className:"control-group"},de.a.createElement("button",{id:"save-index",className:"btn btn-primary save",onClick:this.saveIndex},de.a.createElement("i",{className:"icon fonticon-ok-circled"})," ",n),this.getCancelLink()),de.a.createElement("div",{className:"clearfix"})))}}]),t}(de.a.Component);oA(IA,"defaultProps",{isCreatingIndex:!1,database:null,blur:function(){}}),oA(IA,"propTypes",{isCreatingIndex:tt.a.bool,database:tt.a.object});var PA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getEditDocURL",(function(e){return"#"+se.urls("document","web-index",n.props.databaseName,e)})),n}return fA(t,e),lA(t,[{key:"render",value:function(){var e=aA.Map;return de.a.createElement(e,{shape:this.props.defaultShape,shapeSettings:this.props.defaultShapeSettings,results:this.props.results,searchCount:this.props.searchCount,onDraw:this.props.onDraw,onClear:this.props.onClear,getEditDocURL:this.getEditDocURL})}}]),t}(de.a.Component);oA(PA,"propTypes",{results:tt.a.array.isRequired,searchCount:tt.a.number.isRequired,defaultShape:tt.a.string.isRequired});var RA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getWrap",(function(){return gA(_A,[DA],(function(){return{contentVisible:DA.isQueryTrayVisible(),shape:DA.getShape(),shapeSettings:DA.getShapeSettings()}}))})),n}return fA(t,e),lA(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.getWrap();return de.a.createElement(e,null,de.a.createElement(kA,{contentVisible:!1,onSubmit:this.props.onSubmit}))}}]),t}(de.a.Component),kA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"onSubmit",(function(e){e.preventDefault(),n.geoSettings.validate()&&(n.closeTray(),n.props.onSubmit())})),oA(dA(n),"getTray",(function(){return de.a.createElement(EA,{contentVisible:n.props.contentVisible,closeTray:n.closeTray,className:"query-options geo-query-options",id:"query-options-tray"},de.a.createElement("form",{onSubmit:n.onSubmit,className:"js-view-query-update custom-inputs"},de.a.createElement(UA,{ref:function(e){return n.geoSettings=e},shape:n.props.shape,shapeSettings:n.props.shapeSettings}),de.a.createElement(Ql,{onCancel:n.closeTray})))})),oA(dA(n),"toggleQueryOptionsTray",(function(){RC.toggleQueryOptionsTray(!n.props.contentVisible)})),oA(dA(n),"closeTray",(function(){RC.toggleQueryOptionsTray(!1)})),n}return fA(t,e),lA(t,[{key:"render",value:function(){return de.a.createElement("div",{id:"geo-query-options"},de.a.createElement(yA,{containerClasses:"header-control-box control-toggle-queryoptions",title:"Options",fonticon:"fonticon-gears",text:"Options",toggleCallback:this.toggleQueryOptionsTray}),this.getTray())}}]),t}(de.a.Component);oA(kA,"propTypes",{onSubmit:tt.a.func.isRequired});var LA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{selectedView:DA.getSelectedResultsView(),includeDocs:DA.getIncludeDocs()}})),oA(dA(n),"onChange",(function(){n.setState(n.getStoreState())})),oA(dA(n),"toggleView",(function(e){RC.toggleResultsView(e)})),oA(dA(n),"state",n.getStoreState()),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){DA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){DA.off("change",this.onChange)}},{key:"render",value:function(){return de.a.createElement("div",{className:"alternative-header flex-body geo-btns"},de.a.createElement(SA,{className:"header-toggle-button"},de.a.createElement(vA,{className:this.state.selectedView===CC.VIEWS.JSON?"active":"",onClick:this.toggleView.bind(this,CC.VIEWS.JSON)},de.a.createElement("i",{className:"fonticon-json"})," JSON"),de.a.createElement(vA,{className:this.state.selectedView===CC.VIEWS.MAP?"active":"",onClick:this.toggleView.bind(this,CC.VIEWS.MAP)},de.a.createElement("i",{className:"fonticon-map2"}),de.a.createElement("span",{className:"geo-map-view-label"},"Map"))),de.a.createElement(yA,{toggleCallback:this.props.onToggleIncludeDocs,containerClasses:"header-control-box control-toggle-include-docs",title:"Enable/Disable include_docs",fonticon:this.state.includeDocs?"icon-check":"icon-check-empty",iconDefaultClass:"icon fontawesome",text:""}))}}]),t}(de.a.Component);oA(LA,"propTypes",{onToggleIncludeDocs:tt.a.func.isRequired});var xA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{lastSearch:DA.getLastSearch(),perPage:DA.getPerPage(),shape:DA.getShape(),shapeSettings:DA.getShapeSettings(),includeDocs:DA.getIncludeDocs(),skip:DA.getSkip()}})),oA(dA(n),"onChange",(function(){n.setState(n.getStoreState())})),oA(dA(n),"runQuery",(function(e){RC.query({databaseName:n.props.databaseName,ddocName:n.props.ddocName,indexName:n.props.indexName,perPage:e.perPage,shape:e.shape,shapeSettings:e.shapeSettings,includeDocs:e.includeDocs,skip:e.skip})})),oA(dA(n),"onToggleIncludeDocs",(function(){n.runQuery({perPage:n.state.lastSearch.perPage,shape:n.state.lastSearch.shape,shapeSettings:n.state.lastSearch.shapeSettings[n.state.lastSearch.shape],includeDocs:!n.state.lastSearch.includeDocs,skip:n.state.lastSearch.skip})})),oA(dA(n),"onSubmit",(function(){n.runQuery({perPage:n.state.perPage,shape:n.state.shape,shapeSettings:n.state.shapeSettings[n.state.shape],includeDocs:n.state.includeDocs,skip:0})})),oA(dA(n),"state",n.getStoreState()),n}return fA(t,e),lA(t,[{key:"componentDidMount",value:function(){DA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){DA.off("change",this.onChange,this)}},{key:"render",value:function(){return de.a.createElement("div",{className:"flex-body flex-layout flex-row"},de.a.createElement(LA,{onToggleIncludeDocs:this.onToggleIncludeDocs}),de.a.createElement("div",{className:"flex-fill"},de.a.createElement(RA,{onSubmit:this.onSubmit})))}}]),t}(de.a.Component);oA(xA,"propTypes",{databaseName:tt.a.string.isRequired,ddocName:tt.a.string.isRequired,indexName:tt.a.string.isRequired});var UA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"validate",(function(){var e="",t={};return n.props.shape===CC.SHAPES.CIRCLE&&(""===(t=n.props.shapeSettings[CC.SHAPES.CIRCLE]).mapData.lat||""===t.mapData.lon?e="Please enter a lat/lon coordinate for the circle.":""!==t.mapData.radius&&0!==t.mapData.radius||(e="Please enter a radius for the circle")),n.props.shape===CC.SHAPES.RECTANGLE&&(""===(t=n.props.shapeSettings[CC.SHAPES.RECTANGLE]).mapData.sw.lat||""===t.mapData.sw.lon||""===t.mapData.ne.lat||""===t.mapData.ne.lon?e="Please enter all bounding box lat/lon coordinates.":_.isNumber(parseFloat(t.mapData.sw.lat))&&_.isNumber(parseFloat(t.mapData.sw.lon))&&_.isNumber(parseFloat(t.mapData.ne.lat))&&_.isNumber(parseFloat(t.mapData.ne.lon))||(e="Please only enter numeric values for the lat/lon coordinates.")),n.props.shape===CC.SHAPES.LINE&&(t=n.props.shapeSettings[CC.SHAPES.LINE].mapData).length<2&&(e="Line searches require at least two vertexes."),n.props.shape===CC.SHAPES.POLYGON&&((t=n.props.shapeSettings[CC.SHAPES.POLYGON].mapData).length<3?e="Polygon searches require a connected polygon of at least three vertexes.":t[0][0]===t[t.length-1][0]&&t[0][0]===t[t.length-1][0]||(e="Polygon searches require a connected polygon. The last vertexes lat/lng coordinates should be the same as the first.")),n.props.shape===CC.SHAPES.POINT&&(""!==(t=n.props.shapeSettings[CC.SHAPES.POINT]).mapData.lat&&""!==t.mapData.lon||(e="Please enter a lat/lon coordinate.")),!e||(se.addNotification({msg:e,type:"error",clear:!0}),!1)})),oA(dA(n),"selectShape",(function(e){RC.selectShape(e)})),oA(dA(n),"getShapeSettings",(function(){return n.props.shape===CC.SHAPES.RECTANGLE?n.rectangleSettings():n.props.shape===CC.SHAPES.POINT?n.pointSettings():n.props.shape===CC.SHAPES.LINE?n.lineSettings():n.props.shape===CC.SHAPES.CIRCLE?n.circleSettings():n.props.shape===CC.SHAPES.POLYGON?n.polygonSettings():void 0})),oA(dA(n),"setSearchSetting",(function(e){var t=e.target.getAttribute("data-shape"),n=e.target.getAttribute("data-setting");RC.setSearchSetting(t,n,e.target.value)})),oA(dA(n),"toggleNearestNeighbour",(function(e){RC.toggleNearestNeighbour(e)})),oA(dA(n),"rectangleSettings",(function(){var e=n.props.shapeSettings[CC.SHAPES.RECTANGLE];return de.a.createElement("div",{className:"geo-settings rect-shape-settings"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("h5",null,"Lower Left Coordinates"),de.a.createElement("div",null,de.a.createElement("label",null,"Lat"),de.a.createElement("input",{type:"text",value:e.mapData.sw.lat,"data-shape":CC.SHAPES.RECTANGLE,"data-setting":"mapData.sw.lat",onChange:n.setSearchSetting})),de.a.createElement("div",null,de.a.createElement("label",null,"Lng"),de.a.createElement("input",{type:"text",value:e.mapData.sw.lon,"data-shape":CC.SHAPES.RECTANGLE,"data-setting":"mapData.sw.lon",onChange:n.setSearchSetting}))),de.a.createElement("div",{className:"flex-body"},de.a.createElement("h5",null,"Upper Right Coordinates"),de.a.createElement("div",null,de.a.createElement("label",null,"Lat"),de.a.createElement("input",{type:"text",value:e.mapData.ne.lat,"data-shape":CC.SHAPES.RECTANGLE,"data-setting":"mapData.ne.lat",onChange:n.setSearchSetting})),de.a.createElement("div",null,de.a.createElement("label",null,"Lng"),de.a.createElement("input",{type:"text",value:e.mapData.ne.lon,"data-shape":CC.SHAPES.RECTANGLE,"data-setting":"mapData.ne.lon",onChange:n.setSearchSetting})))),de.a.createElement("div",{className:"flex-layout flex-row geo-tray-nn-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",{className:"row-fluid fieldsets geo-nn-cell"},de.a.createElement("div",{className:"checkbox"},de.a.createElement("input",{onChange:n.toggleNearestNeighbour.bind(dA(n),CC.SHAPES.RECTANGLE),id:"geo-nn",name:"geo-nn",type:"checkbox",checked:e.nearest}),de.a.createElement("label",{htmlFor:"geo-nn"},"Nearest neighbour")))),de.a.createElement("div",{className:"flex-body relation-col"},de.a.createElement("label",{className:"mid-label"},"Relation"),de.a.createElement(HA,{value:e.relation,shape:CC.SHAPES.RECTANGLE,onChange:RC.updateShapeRelation}))))})),oA(dA(n),"circleSettings",(function(){var e=n.props.shapeSettings[CC.SHAPES.CIRCLE];return de.a.createElement("div",{className:" geo-settings ellipse-shape-settings"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",null,de.a.createElement("label",null,"Lat"),de.a.createElement("input",{type:"text",value:e.mapData.lat,"data-shape":CC.SHAPES.CIRCLE,"data-setting":"mapData.lat",onChange:n.setSearchSetting})),de.a.createElement("div",null,de.a.createElement("label",null,"Lng"),de.a.createElement("input",{type:"text",value:e.mapData.lon,"data-shape":CC.SHAPES.CIRCLE,"data-setting":"mapData.lon",onChange:n.setSearchSetting}))),de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",null,de.a.createElement("label",{className:"mid-label"},"Radius"),de.a.createElement("input",{type:"text",value:e.mapData.radius,"data-shape":CC.SHAPES.CIRCLE,"data-setting":"mapData.radius",onChange:n.setSearchSetting})))),de.a.createElement("div",{className:"flex-layout flex-row geo-tray-nn-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",{className:"row-fluid fieldsets geo-nn-cell"},de.a.createElement("div",{className:"checkbox"},de.a.createElement("input",{onChange:n.toggleNearestNeighbour.bind(dA(n),CC.SHAPES.CIRCLE),id:"geo-nn",name:"geo-nn",type:"checkbox",checked:e.nearest}),de.a.createElement("label",{htmlFor:"geo-nn"},"Nearest neighbour")))),de.a.createElement("div",{className:"flex-body relation-col"},de.a.createElement("label",{className:"mid-label"},"Relation"),de.a.createElement(HA,{value:e.relation,shape:CC.SHAPES.CIRCLE,onChange:RC.updateShapeRelation}))))})),oA(dA(n),"pointSettings",(function(){var e=n.props.shapeSettings[CC.SHAPES.POINT];return de.a.createElement("div",{className:"geo-settings point-shape-settings"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",null,de.a.createElement("label",null,"Lat"),de.a.createElement("input",{type:"text",value:e.mapData.lat,"data-shape":CC.SHAPES.POINT,"data-setting":"mapData.lat",onChange:n.setSearchSetting})),de.a.createElement("div",null,de.a.createElement("label",null,"Lng"),de.a.createElement("input",{type:"text",value:e.mapData.lon,"data-shape":CC.SHAPES.POINT,"data-setting":"mapData.lon",onChange:n.setSearchSetting})))),de.a.createElement("div",{className:"flex-layout flex-row geo-tray-nn-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",{className:"row-fluid fieldsets geo-nn-cell"},de.a.createElement("div",{className:"checkbox"},de.a.createElement("input",{onChange:n.toggleNearestNeighbour.bind(dA(n),CC.SHAPES.POINT),id:"geo-nn",name:"geo-nn",type:"checkbox",checked:e.nearest}),de.a.createElement("label",{htmlFor:"geo-nn"},"Nearest neighbour"))))))})),oA(dA(n),"lineSettings",(function(){var e=n.props.shapeSettings[CC.SHAPES.LINE];return de.a.createElement("div",{className:"flex-layout flex-row geo-settings line-shape-settings"},de.a.createElement("div",{className:"flex-body"},de.a.createElement(MA,{points:e.mapData,addPoint:RC.addBlankPoint.bind(dA(n),CC.SHAPES.LINE),shape:CC.SHAPES.LINE}),de.a.createElement("div",{className:"flex-layout flex-row geo-tray-nn-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",{className:"row-fluid fieldsets geo-nn-cell"},de.a.createElement("div",{className:"checkbox"},de.a.createElement("input",{onChange:n.toggleNearestNeighbour.bind(dA(n),CC.SHAPES.LINE),id:"geo-nn",name:"geo-nn",type:"checkbox",checked:e.nearest}),de.a.createElement("label",{htmlFor:"geo-nn"},"Nearest neighbour")))),de.a.createElement("div",{className:"flex-body relation-col"},de.a.createElement("label",{className:"mid-label"},"Relation"),de.a.createElement(HA,{value:e.relation,shape:CC.SHAPES.LINE,onChange:RC.updateShapeRelation})))))})),oA(dA(n),"polygonSettings",(function(){var e=n.props.shapeSettings[CC.SHAPES.POLYGON];return de.a.createElement("div",{className:"geo-settings polygon-shape-settings"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement(MA,{points:e.mapData,addPoint:RC.addBlankPoint.bind(dA(n),CC.SHAPES.POLYGON),shape:CC.SHAPES.POLYGON}))),de.a.createElement("div",{className:"flex-layout flex-row geo-tray-nn-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement("div",{className:"row-fluid fieldsets geo-nn-cell"},de.a.createElement("div",{className:"checkbox"},de.a.createElement("input",{onChange:n.toggleNearestNeighbour.bind(dA(n),CC.SHAPES.POLYGON),id:"geo-nn",name:"geo-nn",type:"checkbox",checked:e.nearest}),de.a.createElement("label",{htmlFor:"geo-nn"},"Nearest neighbour")))),de.a.createElement("div",{className:"flex-body relation-col"},de.a.createElement("label",{className:"mid-label"},"Relation"),de.a.createElement(HA,{value:e.relation,shape:CC.SHAPES.POLYGON,onChange:RC.updateShapeRelation}))))})),n}return fA(t,e),lA(t,[{key:"render",value:function(){var e="drop-down btn",t="drop-down btn",n="drop-down btn",a="drop-down btn",r="drop-down btn";return this.props.shape===CC.SHAPES.RECTANGLE?e+=" active":this.props.shape===CC.SHAPES.POINT?t+=" active":this.props.shape===CC.SHAPES.LINE?n+=" active":this.props.shape===CC.SHAPES.CIRCLE?a+=" active":this.props.shape===CC.SHAPES.POLYGON&&(r+=" active"),de.a.createElement("div",{className:"query-group",id:"query-options-key-search"},de.a.createElement("div",{className:"add-on"},"Query Options",de.a.createElement("a",{className:"help-link",href:se.constants.DOC_URLS.GEOSPATIAL_INDEXES,target:"_blank",rel:"noopener noreferrer","data-bypass":"true"},de.a.createElement("i",{className:"icon-question-sign"}))),de.a.createElement("div",{className:"btn-group toggle-btns row-fluid"},de.a.createElement("label",{onClick:this.selectShape.bind(this,CC.SHAPES.RECTANGLE),className:e},"Rectangle"),de.a.createElement("label",{onClick:this.selectShape.bind(this,CC.SHAPES.POINT),className:t},"Point"),de.a.createElement("label",{onClick:this.selectShape.bind(this,CC.SHAPES.LINE),className:n},"Lines"),de.a.createElement("label",{onClick:this.selectShape.bind(this,CC.SHAPES.CIRCLE),className:a},"Circle"),de.a.createElement("label",{onClick:this.selectShape.bind(this,CC.SHAPES.POLYGON),className:r},"Polygon")),this.getShapeSettings())}}]),t}(de.a.Component);oA(UA,"propTypes",{shape:tt.a.string.isRequired,shapeSettings:tt.a.object.isRequired});var MA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"getLatLngGrid",(function(){return 0===n.props.points.length?null:de.a.createElement("div",{className:"lat-lng-grid"},de.a.createElement("div",{className:"flex-layout flex-row heading-row"},de.a.createElement("div",{className:"lat-lng-row-num"}),de.a.createElement("div",{className:"flex-body"},"Latitude"),de.a.createElement("div",{className:"flex-body"},"Longitude"),de.a.createElement("div",{className:"lat-lng-delete"})),de.a.createElement("div",{className:"lat-lng-grid-rows"},n.getLatLngRows()))})),oA(dA(n),"editPoint",(function(e,t,a){RC.updatePoint(n.props.shape,e,t,a)})),oA(dA(n),"getLatLngRows",(function(){return n.props.points.map((function(e,t){return de.a.createElement(jA,{key:t,lat:e[1],lng:e[0],index:t,canDelete:!0,onEdit:n.editPoint,onDelete:RC.deletePoint.bind(dA(n),n.props.shape,t)})}))})),oA(dA(n),"addPoint",(function(e){e.preventDefault(),n.props.addPoint()})),n}return fA(t,e),lA(t,[{key:"render",value:function(){return de.a.createElement("div",null,this.getLatLngGrid(),de.a.createElement("p",{className:"add-point"},de.a.createElement("a",{href:"#","data-bypass":"true",onClick:this.addPoint},"Add point »")))}}]),t}(de.a.Component);oA(MA,"propTypes",{points:tt.a.array.isRequired,addPoint:tt.a.func.isRequired,shape:tt.a.string.isRequired});var jA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"updateLatitude",(function(e){n.props.onEdit(n.props.index,"lat",e.target.value)})),oA(dA(n),"updateLongitude",(function(e){n.props.onEdit(n.props.index,"lng",e.target.value)})),n}return fA(t,e),lA(t,[{key:"render",value:function(){var e="fonticon fonticon-cancel";return this.props.canDelete||(e+=" disabled"),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"lat-lng-row-num"},this.props.index+1),de.a.createElement("div",{className:"flex-body"},de.a.createElement("input",{type:"text",value:this.props.lat,onChange:this.updateLatitude})),de.a.createElement("div",{className:"flex-body"},de.a.createElement("input",{type:"text",value:this.props.lng,onChange:this.updateLongitude})),de.a.createElement("div",{className:"lat-lng-delete"},de.a.createElement("i",{className:e,onClick:this.props.onDelete})))}}]),t}(de.a.Component);oA(jA,"propTypes",{index:tt.a.number.isRequired,onDelete:tt.a.func.isRequired,onEdit:tt.a.func.isRequired});var HA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"onChange",(function(e){n.props.onChange(n.props.shape,e.target.value)})),n}return fA(t,e),lA(t,[{key:"render",value:function(){return de.a.createElement("select",{value:this.props.value,onChange:this.onChange},de.a.createElement("option",{value:"none"},"None"),de.a.createElement("option",{value:"contains"},"Contains"),de.a.createElement("option",{value:"contains_properly"},"Contains properly"),de.a.createElement("option",{value:"covered_by"},"Covered by"),de.a.createElement("option",{value:"covers"},"Covers"),de.a.createElement("option",{value:"crosses"},"Crosses"),de.a.createElement("option",{value:"disjoint"},"Disjoint"),de.a.createElement("option",{value:"intersects"},"Intersects"),de.a.createElement("option",{value:"overlaps"},"Overlaps"),de.a.createElement("option",{value:"touches"},"Touches"),de.a.createElement("option",{value:"within"},"Within"))}}]),t}(de.a.Component);oA(HA,"propTypes",{value:tt.a.string.isRequired,shape:tt.a.string.isRequired,onChange:tt.a.func.isRequired});var BA=function(e){function t(){var e,n;sA(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oA(dA(n=uA(this,(e=pA(t)).call.apply(e,[this].concat(r)))),"nextClicked",(function(e){e.preventDefault(),n.props.isLastPage||n.props.navigateNext()})),oA(dA(n),"previousClicked",(function(e){e.preventDefault(),n.props.isFirstPage||n.props.navigatePrevious()})),n}return fA(t,e),lA(t,[{key:"render",value:function(){var e=this.props.isFirstPage?"disabled":"",t=this.props.isLastPage?"disabled":"";return de.a.createElement("ul",{className:"pagination"},de.a.createElement("li",{className:e},de.a.createElement("a",{href:"#",onClick:this.previousClicked,className:"icon fonticon-left-open","data-bypass":"true"})),de.a.createElement("li",{className:t},de.a.createElement("a",{href:"#",onClick:this.nextClicked,className:"icon fonticon-right-open","data-bypass":"true"})))}}]),t}(de.a.Component);oA(BA,"propTypes",{isFirstPage:tt.a.bool.isRequired,isLastPage:tt.a.bool.isRequired,navigatePrevious:tt.a.func.isRequired,navigateNext:tt.a.func.isRequired});var GA={CreateGeoIndexController:OA,EditGeoIndexController:wA,QueryGeoIndexController:TA,GeoIndexEditor:IA,ViewControls:LA,GeoQueryOptions:kA,Header:xA,Footer:AA,GeoSettings:UA,JSONResults:CA,LatLngGrid:MA,GeoDocsNavigation:BA};function qA(e){return(qA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VA(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function FA(e,t){return!t||"object"!==qA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KA(e){return(KA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WA(e,t){return(WA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var XA=xC.geoIndexStore,zA=function(e){var t=e.hideHeader,n=e.database,a=e.dbName,r=e.indexName,o=e.ddocName,i=e.dropDownLinks,s=e.docURL,c=e.endpoint;return de.a.createElement("header",{className:"two-panel-header flex-fill"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{id:"header-docs-left"},de.a.createElement(bc,{dbName:a,dropDownLinks:i})),de.a.createElement("div",{className:"right-header-wrapper flex-layout flex-row flex-body"},de.a.createElement("div",{id:"react-headerbar",className:"flex-body"},t?null:de.a.createElement(GA.Header,{database:n,databaseName:a,ddocName:o,indexName:r})),de.a.createElement("div",{id:"right-header",className:"flex-fill"}),de.a.createElement(yt,{docURL:s,endpoint:c}),de.a.createElement("div",{id:"notification-center-btn",className:"flex-fill"},de.a.createElement(pt,null)))))};zA.defaultProps={hideHeader:!1},zA.propTypes={dbName:tt.a.string.isRequired,dropDownLinks:tt.a.array.isRequired,docURL:tt.a.string,endpoint:tt.a.string,database:tt.a.object.isRequired};var YA=function(e){var t=e.content,n=e.database,a=e.dbName,r=e.ddocName,o=e.indexName,i=e.selectedNavItem,s=e.partitionKey;return de.a.createElement("div",{className:"with-sidebar tabs-with-sidebar content-area flex-layout flex-body"},de.a.createElement("aside",{id:"sidebar-content"},de.a.createElement(fc,{selectedNavItem:i,selectedPartitionKey:s})),de.a.createElement("section",{id:"dashboard-content",className:"flex-body flex-layout flex-col"},de.a.createElement("div",{id:"dashboard-upper-content"}),de.a.createElement("div",{id:"dashboard-lower-content",className:"flex-body flex-layout flex-col"},function(e,t,n,a,r,o){return"edit"===e?de.a.createElement(GA.EditGeoIndexController,{database:t,databaseName:n,ddocName:a,indexName:r,partitionKey:o}):"create"===e?de.a.createElement(GA.CreateGeoIndexController,{isCreatingIndex:!0,database:t,databaseName:n,partitionKey:o}):de.a.createElement(GA.QueryGeoIndexController,{database:t,databaseName:n,ddocName:a,indexName:r})}(t,n,a,r,o,s)),de.a.createElement("div",{id:"footer"})))},QA=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FA(this,KA(t).call(this,e))).state=n.getStoreState(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WA(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){return{endpoint:XA.getEndpoint()}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){XA.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){XA.off("change",this.onChange)}},{key:"render",value:function(){var e=this.props,t=e.content,n=e.hideHeader,a=e.dbName,r=e.dropDownLinks,o=e.docURL,i=e.database,s=e.ddocName,c=e.indexName,l=e.selectedNavItem,u=e.partitionKey;return de.a.createElement("div",{id:"dashboard",className:"with-sidebar flex-template flex-layout flex-col"},de.a.createElement(zA,{docURL:o,endpoint:this.state.endpoint,dbName:a,dropDownLinks:r,database:i,ddocName:s,indexName:c,hideHeader:n}),de.a.createElement(YA,{database:i,dbName:a,ddocName:s,indexName:c,content:t,selectedNavItem:l,partitionKey:u}))}}])&&VA(n.prototype,a),r&&VA(n,r),t}(de.a.Component),JA=si.extend({routes:{"database/:database/_design/:ddoc/_geoindex/:geoindex":{route:"queryGeoIndexNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_geoindex/:geoindex":{route:"queryGeoIndex",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_geoindex/:geoindex/edit":{route:"editGeoIndexNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_geoindex/:geoindex/edit":{route:"editGeoIndex",roles:["fx_loggedIn"]},"database/:database/new_geoindex":{route:"createGeoIndexNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/new_geoindex":{route:"createGeoIndex",roles:["fx_loggedIn"]},"database/:database/new_geoindex/:designDoc":{route:"createGeoIndexNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/new_geoindex/:designDoc":{route:"createGeoIndex",roles:["fx_loggedIn"]}},initialize:function(e,t){this.databaseName=t[0],this.database=new ri.Model({id:this.databaseName}),this.data={database:new ri.Model({id:this.databaseName})},this.data.designDocs=new wC.AllDocs(null,{database:this.data.database,params:{startkey:'"_design"',endkey:'"_design1"',include_docs:!0}}),ii.dispatchNewOptions({database:this.data.database,designDocs:this.data.designDocs})},createGeoIndexNoPartition:function(e,t){return this.createGeoIndex(e,"",t)},createGeoIndex:function(e,t,n){return this.apiUrl=!1,RC.initNewGeoIndex({designDocs:this.data.designDocs,defaultDDoc:n,database:this.database}),$e.fetchSelectedDatabaseInfo(e),de.a.createElement(QA,{dropDownLinks:this.getCrumbs(this.database),database:this.database,dbName:this.databaseName,hideHeader:!0,docURL:se.constants.DOC_URLS.GEOSPATIAL_INDEXES_CREATING,content:"create",partitionKey:t})},queryGeoIndexNoPartition:function(e,t,n){return this.queryGeoIndex(e,"",t,n)},queryGeoIndex:function(e,t,n,a){this.databaseName=e,this.ddocName=n,this.indexName=a;var r=le.utils.localStorageGet(CC.GEO_INDEX_VIEW);r&&RC.toggleResultsView(r);var o=le.utils.localStorageGet(CC.GEO_INDEX_PER_PAGE);_.isUndefined(o)&&(o=CC.GEO_INDEX_DEFAULT_RESULTS_PER_PAGE),RC.updatePerPage(o),RC.initCurrentGeoIndex({ddocID:"_design/"+n,indexName:a,designDocs:this.data.designDocs,autoSearch:!0,perPage:o,database:this.database});var i=new ci("designDoc",{designDocName:n,designDocSection:"Geospatial Indexes",indexName:a});return ii.dispatchExpandSelectedItem(i),$e.fetchSelectedDatabaseInfo(e),de.a.createElement(QA,{dropDownLinks:this.getCrumbs(this.database),database:this.database,dbName:this.databaseName,ddocName:this.ddocName,docURL:se.constants.DOC_URLS.GEOSPATIAL_INDEXES,indexName:this.indexName,selectedNavItem:i,partitionKey:t})},editGeoIndexNoPartition:function(e,t,n){return this.editGeoIndex(e,"",t,n)},editGeoIndex:function(e,t,n,a){this.databaseName=e,this.ddocName=n,this.indexName=a,RC.initCurrentGeoIndex({ddocID:"_design/"+n,database:this.database,indexName:a,designDocs:this.data.designDocs});var r=new ci("designDoc",{designDocName:n,designDocSection:"Geospatial Indexes",indexName:a});return ii.dispatchExpandSelectedItem(r),$e.fetchSelectedDatabaseInfo(e),de.a.createElement(QA,{dropDownLinks:this.getCrumbs(this.database),database:this.database,dbName:this.databaseName,ddocName:this.ddocName,indexName:this.indexName,hideHeader:!0,docURL:se.constants.DOC_URLS.GEOSPATIAL_INDEXES_CREATING,content:"edit",selectedNavItem:r,partitionKey:t})},getExtensionLinks:function(){var e="#"+se.urls("databaseBaseURL","app",this.database.id),t=[{title:"New Doc",url:e+"/_new",icon:"fonticon-plus-circled"},{title:"New View",url:e+"/new_view",icon:"fonticon-plus-circled"}];return _.reduce(se.getExtensions("sidebar:links"),(function(t,n){return t.push({title:n.title,url:e+"/"+n.url,icon:"fonticon-plus-circled"}),t}),t)}}),ZA=JA.extend({routes:{"database/shared/:user/:database/_design/:ddoc/_geoindex/:geoindex":{route:"sharedQueryGeoIndex",roles:["fx_loggedIn"]},"database/shared/:user/:database/_design/:ddoc/_geoindex/:geoindex/edit":{route:"sharedEditGeoIndex",roles:["fx_loggedIn"]},"database/shared/:user/:database/new_geoindex":{route:"sharedCreateGeoIndex",roles:["fx_loggedIn"]},"database/shared/:user/:database/new_geoindex/:designDoc":{route:"sharedCreateGeoIndex",roles:["fx_loggedIn"]}},initialize:function(e,t){this.username=cN.sharedUsername=t[0],this.databaseName=t[1],this.database=new ri.Model({id:this.databaseName}),this.data={database:new ri.Model({id:this.databaseName})},this.data.designDocs=new wC.AllDocs(null,{database:this.data.database,params:{startkey:'"_design"',endkey:'"_design1"',include_docs:!0}}),ii.dispatchNewOptions({database:this.data.database,designDocs:this.data.designDocs})},sharedCreateGeoIndex:function(e,t,n){return this.createGeoIndexNoPartition(t,n)},sharedQueryGeoIndex:function(e,t,n,a){return this.queryGeoIndexNoPartition(t,n,a)},sharedEditGeoIndex:function(e,t,n,a){return this.editGeoIndexNoPartition(t,n,a)}});wC.RouteObjects=[JA,ZA];var $A=wC;n(741);function eI(e){return e?"/_partition/"+e:""}$A.initialize=function(){se.registerExtension("sidebar:list",{selector:"st_indexes",name:"Geospatial Indexes",icon:"fonticon-sidenav-search",urlNamespace:"geoindex",indexLabel:"geospatial index",onDelete:RC.deleteGeoIndex,onClone:RC.cloneGeoIndex,onEdit:RC.gotoEditGeoIndexPage}),se.registerExtension("sidebar:links",{title:"New Geospatial Index",url:"new_geoindex",icon:"fonticon-plus-circled"}),se.registerExtension("IndexTypes:propNames","st_indexes")};var tI=bN.proxyUrl;_.extend(bN.sharedUrlPaths,{geoindex:{app:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_design/"+t+"/_geoindex/"},queryPage:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/_design/"+n+"/_geoindex/"+a},query:function(e,t,n,a){return a=bN.addRemoteAccount(a),tI+e+"/_design/"+t+"/_geo/"+n+a},edit:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/_design/"+n+"/_geoindex/"+a+"/edit"},geoinfo:function(e,t,n,a){return a=bN.addRemoteAccount(a),tI+e+"/_design/"+t+"/_geo_info/"+n+a},apiurl:function(e,t,n,a){return a=bN.addRemoteAccount(a),tI+e+"/_design/"+t+"/_geo/"+n+"?"+a}}}),se.registerUrls("partitioned_geoindex",{app:function(e,t,n){return"database/"+e+eI(t)+"/_design/"+n+"/_geoindex/"}}),se.registerUrls("geoindex",{app:function(e,t){return"database/"+e+"/_design/"+t+"/_geoindex/"},queryPage:function(e,t,n,a){return"database/"+e+eI(t)+"/_design/"+n+"/_geoindex/"+a},query:function(e,t,n){return A.getServerUrl("/"+e+"/_design/"+t+"/_geo/"+n)},edit:function(e,t,n,a){return"database/"+e+eI(t)+"/_design/"+n+"/_geoindex/"+a+"/edit"},geoinfo:function(e,t,n){return A.getServerUrl("/"+e+"/_design/"+t+"/_geo_info/"+n)},apiurl:function(e,t,n,a){return window.location.origin+"/"+e+"/_design/"+t+"/_geo/"+n+"?"+a}});var nI=$A,aI={SEARCH_INDEX_DESIGN_DOCS_LOADED:"SEARCH_INDEX_DESIGN_DOCS_LOADED",SEARCH_INDEX_INIT:"SEARCH_INDEX_INIT",SEARCH_INDEX_SELECT_TAB:"SEARCH_INDEX_SELECT_TAB",SEARCH_INDEX_SET_NAME:"SEARCH_INDEX_SET_NAME",SEARCH_INDEX_SET_ANALYZER_TYPE:"SEARCH_INDEX_SET_ANALYZER_TYPE",SEARCH_INDEX_ADD_ANALYZER_ROW:"SEARCH_INDEX_ADD_ANALYZER_ROW",SEARCH_INDEX_REMOVE_ANALYZER_ROW:"SEARCH_INDEX_REMOVE_ANALYZER_ROW",SEARCH_INDEX_SET_ANALYZER_ROW_FIELD_NAME:"SEARCH_INDEX_SET_ANALYZER_ROW_FIELD_NAME",SEARCH_INDEX_SET_ANALYZER_ROW:"SEARCH_INDEX_SET_ANALYZER_ROW",SEARCH_INDEX_SET_DEFAULT_MULTIPLE_ANALYZER:"SEARCH_INDEX_SET_DEFAULT_MULTIPLE_ANALYZER",SEARCH_INDEX_INIT_EDIT_SEARCH_INDEX:"SEARCH_INDEX_INIT_EDIT_SEARCH_INDEX",SEARCH_INDEX_PREVIEW_MODEL_UPDATED:"SEARCH_INDEX_PREVIEW_MODEL_UPDATED",SEARCH_INDEX_PREVIEW_REQUEST_MADE:"SEARCH_INDEX_PREVIEW_REQUEST_MADE",SEARCH_INDEX_PREVIEW_REQUEST_ERROR:"PREVIEW_MODEL_REQUEST_ERROR",SEARCH_INDEX_SELECT_DESIGN_DOC:"SEARCH_INDEX_SELECT_DESIGN_DOC",SEARCH_INDEX_SET_SINGLE_ANALYZER:"SEARCH_INDEX_SET_SINGLE_ANALYZER",SEARCH_INDEX_SET_SEARCH_QUERY:"SEARCH_INDEX_SET_SEARCH_QUERY",SEARCH_INDEX_SET_LOADING:"SEARCH_INDEX_SET_LOADING",SEARCH_INDEX_CLEAR:"SEARCH_INDEX_CLEAR",SEARCH_INDEX_UPDATE_INDEX_FUNCTION:"SEARCH_INDEX_UPDATE_INDEX_FUNCTION",SEARCH_INDEX_NEW_DESIGN_DOC_NAME_UPDATED:"SEARCH_INDEX_NEW_DESIGN_DOC_NAME_UPDATED",SEARCH_INDEX_NEW_DESIGN_DOC_PARTITONED_UPDATED:"SEARCH_INDEX_NEW_DESIGN_DOC_PARTITONED_UPDATED",SEARCH_INDEX_PARTITION_PARAM_NOT_SUPPORTED:"SEARCH_INDEX_PARTITION_PARAM_NOT_SUPPORTED",SEARCH_INDEX_PARTITION_PARAM_MANDATORY:"SEARCH_INDEX_PARTITION_PARAM_MANDATORY"},rI={ANALYZER_SINGLE:"single",ANALYZER_MULTIPLE:"multiple",DEFAULT_SEARCH_INDEX_NAME:"newSearch",DEFAULT_ANALYZER_TYPE:"single",DEFAULT_ANALYZER:"standard",DEFAULT_SEARCH_INDEX_FUNCTION:'function (doc) {\n  index("name", doc.name);\n}'};function oI(e){return(oI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var iI={};iI.Doc=He.Doc.extend({setIndex:function(e,t,n){if(!this.isDdoc())return!1;var a=this.get("indexes");return a||(a={}),a[e]||(a[e]={}),n&&(a[e].analyzer=n),a[e].index=t,this.set({indexes:a})},getIndex:function(e){return this.get("indexes")[e].index},getAnalyzer:function(e){return this.get("indexes")[e].analyzer},analyzerType:function(e){return"object"===oI(this.getAnalyzer(e))?rI.ANALYZER_MULTIPLE:rI.ANALYZER_SINGLE},dDocModel:function(){if(!this.isDdoc())return!1;var e=this.get("doc");return!!e&&new iI.Doc(e,{database:this.database})}}),iI.AllDocs=He.AllDocs.extend({model:iI.Doc});var sI=iI;var cI=function(e,t,n,a,r){var o=function(e,t,n,a,r){var o=t?encodeURIComponent(t):"";return se.urls("search","server",encodeURIComponent(e),o,encodeURIComponent(n),encodeURIComponent(a),"?limit=10&q="+encodeURIComponent(r))}(e,t,n,a,r);return v(o).then((function(e){if(e.error)throw new Error(e.reason);return e.rows}))};function lI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var uI=function(e,t,n,a,r,o){return o({type:aI.SEARCH_INDEX_PREVIEW_REQUEST_MADE}),cI(e,t,n,a,r).then((function(e){o({type:aI.SEARCH_INDEX_PREVIEW_MODEL_UPDATED,options:{searchResults:e}})})).catch((function(t){o({type:aI.SEARCH_INDEX_PREVIEW_REQUEST_ERROR}),t&&-1!==t.message.indexOf("`partition` not supported")?o(dI()):t&&-1!==t.message.indexOf("`partition` parameter is mandatory")?o(pI()):se.addNotification({msg:"Search failed: "+t.message,type:"error",clear:!0}),-1!==t.message.indexOf("not found")&&se.navigate(se.urls("allDocsSanitized","app",e),{trigger:!0})}))},dI=function(){return{type:aI.SEARCH_INDEX_PARTITION_PARAM_NOT_SUPPORTED}},pI=function(){return{type:aI.SEARCH_INDEX_PARTITION_PARAM_MANDATORY}};var fI={dispatchInitNewSearchIndex:function(e){se.reduxDispatch({type:aI.SEARCH_INDEX_CLEAR}),se.reduxDispatch({type:aI.SEARCH_INDEX_SET_LOADING,options:{loading:!0}}),e.designDocs.fetch().then((function(){se.reduxDispatch({type:aI.SEARCH_INDEX_DESIGN_DOCS_LOADED,options:{designDocs:e.designDocs,defaultDDoc:e.defaultDDoc,database:e.database}})}))},dispatchInitSearchIndex:function(e){if(se.reduxDispatch({type:aI.SEARCH_INDEX_SET_LOADING,options:{loading:!0}}),se.reduxDispatch({type:aI.SEARCH_INDEX_INIT,options:{databaseName:e.databaseName,partitionKey:e.partitionKey,ddocName:e.designDoc,indexName:e.indexName,searchQuery:e.query?e.query:""}}),e.query)return uI(e.databaseName,e.partitionKey,e.designDoc,e.indexName,e.query,se.reduxDispatch)},dispatchEditSearchIndex:function(e){var t=new ob.DdocInfo({_id:e.ddocID},{database:e.database});se.reduxDispatch({type:aI.SEARCH_INDEX_SET_LOADING,options:{loading:!0}}),se.Promise.all([e.designDocs.fetch(),t.fetch()]).then((function(n){var a=lI(n,1)[0].rows.find((function(e){return e._id===t.id})).doc;if(!a.indexes||!a.indexes[e.indexName])throw Error('Index "'.concat(e.indexName,'" not found'));se.reduxDispatch({type:aI.SEARCH_INDEX_INIT_EDIT_SEARCH_INDEX,options:{indexName:e.indexName,database:e.database,ddocInfo:t,designDocs:e.designDocs}})})).catch((function(t){var n=t.message?t.message:"";se.addNotification({msg:'There was a problem editing the search index "'.concat(e.indexName,'". ')+n,type:"error",clear:!0})}))},selectTab:function(e){return function(t){t({type:aI.SEARCH_INDEX_SELECT_TAB,options:{tab:e}})}},setSearchIndexName:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_NAME,options:{value:e}})}},setAnalyzerType:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_ANALYZER_TYPE,options:{value:e}})}},addAnalyzerRow:function(e){return function(t){t({type:aI.SEARCH_INDEX_ADD_ANALYZER_ROW,options:{analyzer:e}})}},removeAnalyzerRow:function(e){return function(t){t({type:aI.SEARCH_INDEX_REMOVE_ANALYZER_ROW,options:{rowIndex:e}})}},setAnalyzerRowFieldName:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_ANALYZER_ROW_FIELD_NAME,options:{rowIndex:e.rowIndex,fieldName:e.fieldName}})}},setAnalyzer:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_ANALYZER_ROW,options:{rowIndex:e.rowIndex,analyzer:e.analyzer}})}},setDefaultMultipleAnalyzer:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_DEFAULT_MULTIPLE_ANALYZER,options:{analyzer:e}})}},selectDesignDoc:function(e){return function(t){t({type:aI.SEARCH_INDEX_SELECT_DESIGN_DOC,options:{value:e}})}},saveSearchIndex:function(e,t,n){if(e.setIndex(t.indexName,t.indexFunction,t.analyzerInfo),t.lastSavedDesignDocName===e.id&&t.lastSavedSearchIndexName!==t.indexName){var a=e.get("indexes")||{};delete a[t.lastSavedSearchIndexName],e.set({indexes:a})}e.save().then((function(){if(t.designDocs.add(e,{merge:!0}),se.addNotification({msg:"The search index has been saved.",type:"success",clear:!0}),!t.isCreatingIndex&&t.lastSavedDesignDocName!==e.id){var a=Vi.helpers.findDesignDoc(t.designDocs,t.lastSavedDesignDocName);Vi.safeDeleteIndex(a,t.designDocs,"indexes",t.lastSavedSearchIndexName,{onSuccess:function(){ii.dispatchUpdateDesignDocs(t.designDocs)}})}ii.dispatchUpdateDesignDocs(t.designDocs),se.navigate(n,{trigger:!0})}),(function(e){var t=JSON.parse(e.responseText).reason;se.addNotification({msg:"Save failed: "+t,type:"error",clear:!0})}))},cloneSearchIndex:function(e){var t=function(e,t,n,a){if("new-doc"===t){var r={_id:"_design/"+n,indexes:{},language:"javascript"};return new sI.Doc(r,{database:a})}var o=e.find((function(e){return e.id===t}));return o?o.dDocModel():null}(e.designDocs,e.targetDesignDocName,e.newDesignDocName,e.database),n=t.get("indexes");if(n&&_.has(n,e.newIndexName))se.addNotification({msg:"That index name is already used in this design doc. Please enter a new name.",type:"error",clear:!0});else{n||(n={});var a=Vi.helpers.findDesignDoc(e.designDocs,"_design/"+e.sourceDesignDocName).toJSON();n[e.newIndexName]=a.indexes[e.sourceIndexName],t.set({indexes:n}),t.save().then((function(){e.onComplete(),se.addNotification({msg:"The search index has been cloned.",type:"success",clear:!0}),ii.dispatchUpdateDesignDocs(e.designDocs)}),(function(t){e.onComplete();var n=JSON.parse(t.responseText).reason;se.addNotification({msg:"Clone failed: "+n,type:"error",clear:!0})}))}},deleteSearchIndex:function(e){Vi.safeDeleteIndex(e.designDoc,e.designDocs,"indexes",e.indexName,{onSuccess:function(){if(e.isOnIndex){var t=se.urls("allDocs","app",e.database.safeID());se.navigate(t)}ii.dispatchUpdateDesignDocs(e.designDocs),se.addNotification({msg:"The <code>"+_.escape(e.indexName)+"</code> search index has been deleted.",type:"info",escape:!1,clear:!0}),ii.dispatchHideDeleteIndexModal()}})},gotoEditSearchIndexPage:function(e,t,n,a){var r=t?encodeURIComponent(t):"";se.navigate("#"+se.urls("search","edit",encodeURIComponent(e),r,encodeURIComponent(n),encodeURIComponent(a)))},querySearch:function(e,t,n,a,r){var o=t?se.urls("partitioned_search","app",encodeURIComponent(e),encodeURIComponent(t),encodeURIComponent(n),encodeURIComponent(a)):se.urls("search","app",encodeURIComponent(e),encodeURIComponent(n),encodeURIComponent(a));se.navigate("".concat(o).concat(encodeURIComponent(a),"?").concat(encodeURIComponent(r)),{trigger:!0})},setSearchQuery:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_SEARCH_QUERY,options:{query:e}})}},setSingleAnalyzer:function(e){return function(t){t({type:aI.SEARCH_INDEX_SET_SINGLE_ANALYZER,options:{analyzer:e}})}},updateNewDesignDocName:function(e){return function(t){t({type:aI.SEARCH_INDEX_NEW_DESIGN_DOC_NAME_UPDATED,options:{value:e}})}},updateNewDesignDocPartitioned:function(e){return function(t){t({type:aI.SEARCH_INDEX_NEW_DESIGN_DOC_PARTITONED_UPDATED,options:{value:e}})}},partitionParamNotSupported:dI,partitionParamIsMandatory:pI};function hI(e){return(hI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mI(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gI(e){return(gI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yI(e,t){return(yI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _I=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=gI(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==hI(r)&&"function"!=typeof r?bI(a):r,EI(bI(n),"querySearch",(function(e){if(e.preventDefault(),""===n.props.searchQuery.trim())return se.addNotification({msg:"Please enter a search term.",type:"error",clear:!0}),void n.searchInput.focus();var t=n.props,a=t.databaseName,r=t.partitionKey,o=t.ddocName,i=t.indexName,s=t.searchQuery;n.props.querySearch(a,r,o,i,s)})),EI(bI(n),"getRows",(function(){var e=encodeURIComponent(n.props.databaseName);return n.props.searchResults.map((function(t){var a={header:t.id,content:JSON.stringify(t,null,"  "),url:se.urls("document","app",e,encodeURIComponent(t.id))};return de.a.createElement(Jr.Document,{key:t.id,keylabel:"id:",doc:a,header:t.id,isDeletable:!1,docContent:a.content,onClick:n.onClick,docChecked:function(){},docIdentifier:t.id})}))})),EI(bI(n),"onClick",(function(e,t){t.url&&se.navigate(t.url)})),EI(bI(n),"onType",(function(e){n.props.setSearchQuery(e.target.value)})),EI(bI(n),"getResults",(function(){return n.props.hasActiveQuery?de.a.createElement(Jr.LoadLines,null):n.props.noResultsWarning?de.a.createElement("div",{"data-select":"search-result-set"},n.props.noResultsWarning):!!n.props.searchResults&&(0===n.props.searchResults.length?de.a.createElement("div",{"data-select":"search-result-set"},"No results found."):de.a.createElement("div",{id:"doc-list","data-select":"search-result-set"},n.getRows()))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yI(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.searchInput.focus()}},{key:"render",value:function(){var e=this,t=this.props.hasActiveQuery?"Querying...":"Query";return de.a.createElement("div",null,de.a.createElement("form",{id:"search-index-preview-form"},de.a.createElement("span",{className:"input-append"},de.a.createElement("input",{className:"span4",ref:function(t){return e.searchInput=t},type:"text",placeholder:"Enter your search query",onChange:this.onType,value:this.props.searchQuery}),de.a.createElement("button",{className:"btn btn-primary",id:"search-index-query-button",type:"submit",disabled:this.props.hasActiveQuery,onClick:this.querySearch},t)),de.a.createElement("a",{className:"help-link","data-bypass":"true",href:se.constants.DOC_URLS.SEARCH_INDEX_QUERIES,target:"_blank",rel:"noopener noreferrer"},de.a.createElement("i",{className:"icon-question-sign"}))),this.getResults())}}])&&mI(n.prototype,a),r&&mI(n,r),t}(de.a.Component);EI(_I,"propTypes",{hasActiveQuery:tt.a.bool.isRequired,searchQuery:tt.a.string.isRequired,searchPerformed:tt.a.bool.isRequired,querySearch:tt.a.func.isRequired,setSearchQuery:tt.a.func.isRequired,searchResults:tt.a.array});var vI=Object(nt.b)((function(e){var t=e.search;return{databaseName:t.databaseName,partitionKey:t.partitionKey,ddocName:t.ddocName,indexName:t.indexName,hasActiveQuery:t.hasActiveQuery,searchQuery:t.searchQuery,searchPerformed:t.searchPerformed,searchResults:t.searchResults,noResultsWarning:t.noResultsWarning}}),(function(e){return{querySearch:function(e,t,n,a,r){fI.querySearch(e,t,n,a,r)},setSearchQuery:function(t){e(fI.setSearchQuery(t))}}}))(_I);function SI(e){return(SI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NI(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function DI(e){return(DI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function OI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wI(e,t){return(wI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var CI=Jr.StyledSelect,AI=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=DI(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==SI(r)&&"function"!=typeof r?OI(a):r,TI(OI(n),"getAnalyzers",(function(){return["Standard","Keyword","Simple","Whitespace","Classic","Email"].map((function(e){return de.a.createElement("option",{value:e.toLowerCase(),key:e},e)}))})),TI(OI(n),"getLanguages",(function(){return["Arabic","Armenian","Basque","Bulgarian","Brazilian","Catalan","Cjk","Chinese","Czech","Danish","Dutch","English","Finnish","French","Galician","German","Greek","Hindi","Hungarian","Indonesian","Irish","Italian","Japanese","Latvian","Norwegian","Persian","Polish","Portuguese","Romanian","Russian","Spanish","Swedish","Thai","Turkish"].map((function(e){return de.a.createElement("option",{value:e.toLowerCase(),key:e},e)}))})),TI(OI(n),"getLabel",(function(){return""===n.props.label?null:de.a.createElement("label",{htmlFor:n.props.id},n.props.label)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wI(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=de.a.createElement("optgroup",{label:"Language-specific",key:"languages"},this.getLanguages());return de.a.createElement("div",{className:this.props.classes},this.getLabel(),de.a.createElement(CI,{selectChange:this.props.onChange,selectValue:this.props.defaultSelected,selectId:this.props.id,selectContent:[this.getAnalyzers(),e]}))}}])&&NI(n.prototype,a),r&&NI(n,r),t}(de.a.Component);function II(e){return(II="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PI(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function RI(e){return(RI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LI(e,t){return(LI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}TI(AI,"defaultProps",{defaultSelected:"standard",label:"Type",id:"analyzer-default",classes:"",onChange:function(){}}),TI(AI,"propTypes",{defaultSelected:tt.a.string.isRequired,label:tt.a.string.isRequired,id:tt.a.string.isRequired,classes:tt.a.string.isRequired,onChange:tt.a.func.isRequired});var UI=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=RI(t).call(this,e),n=!r||"object"!==II(r)&&"function"!=typeof r?kI(a):r,xI(kI(n),"deleteRow",(function(e){e.preventDefault(),n.props.removeAnalyzerRow(n.props.rowIndex)})),xI(kI(n),"getFieldNameHeading",(function(e){return 0===n.props.rowIndex&&de.a.createElement("label",{htmlFor:e},"Fieldname")})),xI(kI(n),"changeFieldName",(function(e){n.props.setAnalyzerRowFieldName({rowIndex:n.props.rowIndex,fieldName:e.target.value})})),xI(kI(n),"selectAnalyzer",(function(e){n.props.setAnalyzer({rowIndex:n.props.rowIndex,analyzer:e.target.value})})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LI(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e="analyzer-row-"+this.props.rowIndex,t=0===this.props.rowIndex?"Analyzer":"",n="span12";return this.props.showErrors&&!this.props.row.valid&&(n+=" unhappy"),de.a.createElement("li",null,de.a.createElement("div",{className:"row-fluid"},de.a.createElement("div",{className:"span4"},this.getFieldNameHeading(e),de.a.createElement("input",{type:"text",value:this.props.row.fieldName,className:n,onChange:this.changeFieldName})),de.a.createElement(AI,{id:e,label:t,defaultSelected:this.props.row.analyzer,classes:"span4",onChange:this.selectAnalyzer}),de.a.createElement("div",{className:"span4"},de.a.createElement("button",{className:"btn btn-danger delete-analyzer",onClick:this.deleteRow},"delete"))))}}])&&PI(n.prototype,a),r&&PI(n,r),t}(de.a.Component);function MI(e){return(MI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jI(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function HI(e){return(HI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GI(e,t){return(GI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}xI(UI,"propTypes",{rowIndex:tt.a.number.isRequired,row:tt.a.object.isRequired,showErrors:tt.a.bool.isRequired,removeAnalyzerRow:tt.a.func.isRequired,setAnalyzerRowFieldName:tt.a.func.isRequired,setAnalyzer:tt.a.func.isRequired});var VI=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=HI(t).call(this,e),n=!r||"object"!==MI(r)&&"function"!=typeof r?BI(a):r,qI(BI(n),"addRow",(function(e){e.preventDefault(),n.props.addAnalyzerRow(n.props.defaultAnalyzer)})),qI(BI(n),"getRows",(function(){return n.props.fields.map((function(e,t){return de.a.createElement(UI,{row:e,key:e.key,rowIndex:t,showErrors:n.state.showErrors,setAnalyzer:n.props.setAnalyzer,setAnalyzerRowFieldName:n.props.setAnalyzerRowFieldName,removeAnalyzerRow:n.props.removeAnalyzerRow})}))})),qI(BI(n),"validate",(function(){n.setState({showErrors:!0});var e=!1,t=[],a=n.props.fields.every((function(n){return-1!==t.indexOf(n.fieldName)&&(e=!0),t.push(n.fieldName),n.valid}));return a&&!e||se.addNotification({msg:"Fieldnames cannot be empty and must be unique.",type:"error",clear:!0}),a})),n.state={showErrors:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GI(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",null,de.a.createElement(AI,{label:"Default",id:"defaultAnalyzer",defaultSelected:this.props.defaultAnalyzer,onChange:this.props.selectDefaultMultipleAnalyzer,isValidating:this.validate}),de.a.createElement("ul",{id:"analyzer-fields",className:"unstyled"},this.getRows()),de.a.createElement("button",{className:"addfield btn btn-small btn-primary",onClick:this.addRow},de.a.createElement("i",{className:"cloudant-circle-plus"}),"Add Field"))}}])&&jI(n.prototype,a),r&&jI(n,r),t}(de.a.Component);function FI(e){return(FI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KI(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function WI(e){return(WI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zI(e,t){return(zI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YI(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}qI(VI,"propTypes",{addAnalyzerRow:tt.a.func.isRequired,defaultAnalyzer:tt.a.string.isRequired,selectDefaultMultipleAnalyzer:tt.a.func.isRequired,fields:tt.a.array.isRequired});var QI=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=WI(t).call(this,e),n=!r||"object"!==FI(r)&&"function"!=typeof r?XI(a):r,YI(XI(n),"selectAnalyzerType",(function(e){n.props.setAnalyzerType(e.target.value)})),YI(XI(n),"validate",(function(){return n.props.analyzerType===rI.ANALYZER_SINGLE||n.analyzerMultiple.validate()})),YI(XI(n),"getAnalyzerFieldsAsObject",(function(){var e={};return n.props.analyzerFields.forEach((function(t){var n=t.fieldName.replace(/["']/g,"");e[n]=t.analyzer})),e})),YI(XI(n),"getInfo",(function(){return n.props.analyzerType===rI.ANALYZER_SINGLE?n.props.singleAnalyzer:{name:"perfield",default:n.props.defaultMultipleAnalyzer,fields:n.getAnalyzerFieldsAsObject()}})),YI(XI(n),"selectSingleAnalyzer",(function(e){n.props.setSingleAnalyzer(e.target.value)})),YI(XI(n),"selectDefaultMultipleAnalyzer",(function(e){n.props.setDefaultMultipleAnalyzer(e.target.value)})),YI(XI(n),"getAnalyzerType",(function(){return n.props.analyzerType===rI.ANALYZER_SINGLE?de.a.createElement(AI,{label:"Type",defaultSelected:n.props.singleAnalyzer,onChange:n.selectSingleAnalyzer}):de.a.createElement(VI,{ref:function(e){return n.analyzerMultiple=e},defaultAnalyzer:n.props.defaultMultipleAnalyzer,selectDefaultMultipleAnalyzer:n.selectDefaultMultipleAnalyzer,fields:n.props.analyzerFields,addAnalyzerRow:n.props.addAnalyzerRow,removeAnalyzerRow:n.props.removeAnalyzerRow,setAnalyzerRowFieldName:n.props.setAnalyzerRowFieldName,setAnalyzer:n.props.setAnalyzer})})),n.selectAnalyzerType=n.selectAnalyzerType.bind(XI(n)),n.selectSingleAnalyzer=n.selectSingleAnalyzer.bind(XI(n)),n.selectDefaultMultipleAnalyzer=n.selectDefaultMultipleAnalyzer.bind(XI(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zI(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e="btn";this.props.analyzerType===rI.ANALYZER_MULTIPLE&&(e+=" active");var t="btn";return this.props.analyzerType===rI.ANALYZER_SINGLE&&(t+=" active"),de.a.createElement("div",{className:"well"},de.a.createElement("div",{className:"control-group"},de.a.createElement("label",{htmlFor:"search-analyzer"},"Analyzer"),de.a.createElement("div",{className:"btn-group toggle-btns",id:"analyzer"},de.a.createElement("label",{style:{width:"82px"},htmlFor:"single-analyzer",className:t},"Single"),de.a.createElement("input",{type:"radio",id:"single-analyzer",name:"search-analyzer",value:"single",checked:this.props.analyzerType===rI.ANALYZER_SINGLE,onChange:this.selectAnalyzerType}),de.a.createElement("input",{type:"radio",id:"multiple-analyzer",name:"search-analyzer",value:"multiple",checked:this.props.analyzerType===rI.ANALYZER_MULTIPLE,onChange:this.selectAnalyzerType}),de.a.createElement("label",{style:{width:"82px"},htmlFor:"multiple-analyzer",className:e},"Multiple"))),this.getAnalyzerType())}}])&&KI(n.prototype,a),r&&KI(n,r),t}(de.a.Component);function JI(e){return(JI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZI(){return(ZI=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function $I(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function eP(e){return(eP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nP(e,t){return(nP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function aP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}YI(QI,"propTypes",{analyzerType:tt.a.string.isRequired,analyzerFields:tt.a.array.isRequired,defaultMultipleAnalyzer:tt.a.string.isRequired,singleAnalyzer:tt.a.string.isRequired,setAnalyzerType:tt.a.func.isRequired,setSingleAnalyzer:tt.a.func.isRequired,setDefaultMultipleAnalyzer:tt.a.func.isRequired,addAnalyzerRow:tt.a.func.isRequired});var rP=os.DesignDocSelector,oP=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=eP(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==JI(r)&&"function"!=typeof r?tP(a):r,aP(tP(n),"updateSearchIndexName",(function(e){n.props.setSearchIndexName(e.target.value)})),aP(tP(n),"saveIndex",(function(e){if(e.preventDefault(),n.designDocSelector.validate()&&n.analyzer.validate())if(n.props.searchIndexName.trim()){var t=n.props.saveDoc.id.replace(/_design\//,""),a=n.props.partitionKey?encodeURIComponent(n.props.partitionKey):"",r=se.urls("search","fragment",encodeURIComponent(n.props.database.id),a,encodeURIComponent(t),encodeURIComponent(n.props.searchIndexName));n.props.saveSearchIndex(n.props.saveDoc,{isCreatingIndex:n.props.isCreatingIndex,indexName:n.props.searchIndexName,designDocs:n.props.designDocs,database:n.props.database,indexFunction:n.getIndexFunction(),analyzerInfo:n.analyzer.getInfo(),lastSavedSearchIndexName:n.props.lastSavedSearchIndexName,lastSavedDesignDocName:n.props.lastSavedDesignDocName},r)}else se.addNotification({msg:"Please enter the index name.",type:"error",clear:!0})})),aP(tP(n),"getIndexFunction",(function(){return n.searchIndexEditor.getValue()})),aP(tP(n),"getDesignDocList",(function(){return n.props.designDocs.map((function(e){return e.id}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nP(e,t)}(t,e),n=t,(a=[{key:"getCancelLink",value:function(){var e=encodeURIComponent(this.props.database.id),t=this.props.partitionKey?encodeURIComponent(this.props.partitionKey):"";if(!this.props.lastSavedDesignDocName||this.props.isCreatingIndex)return"#"+se.urls("allDocs","app",e,t);var n=this.props.lastSavedDesignDocName.replace(/^_design\//,""),a="_design/"+encodeURIComponent(n),r=encodeURIComponent(this.props.lastSavedSearchIndexName);return"#"+se.urls("search","showIndex",e,t,a,r)}},{key:"render",value:function(){var e=this;if(this.props.isLoading)return de.a.createElement("div",{className:"search-index-page-loading"},de.a.createElement(Jr.LoadLines,null));if(!this.props.database)return null;var t=this.props.isCreatingIndex?"New Search Index":"Edit Search Index",n=this.props.isCreatingIndex?"Create Document and Build Index":"Save Document and Build Index";return de.a.createElement("form",{className:"form-horizontal search-query-save",id:"search-index"},de.a.createElement("h3",{className:"simple-header"},t),de.a.createElement(rP,{ref:function(t){return e.designDocSelector=t},designDocLabel:"Save to design document",designDocList:this.getDesignDocList(),isDbPartitioned:this.props.isDbPartitioned,newDesignDocName:this.props.newDesignDocName,newDesignDocPartitioned:this.props.newDesignDocPartitioned,selectedDesignDocName:this.props.ddocName,selectedDesignDocPartitioned:this.props.ddocPartitioned,onSelectDesignDoc:this.props.selectDesignDoc,onChangeNewDesignDocName:this.props.updateNewDesignDocName,onChangeNewDesignDocPartitioned:this.props.updateNewDesignDocPartitioned,docLink:le.helpers.getDocUrl("DOC_URL_DESIGN_DOCS")}),de.a.createElement("div",{className:"control-group"},de.a.createElement("label",{htmlFor:"search-name"},"Index name"),de.a.createElement("input",{type:"text",id:"search-name",value:this.props.searchIndexName,onChange:this.updateSearchIndexName})),de.a.createElement(Jr.CodeEditorPanel,{id:"search-function",className:"ace-editor-section",ref:function(t){return e.searchIndexEditor=t},title:"Search index function",allowZenMode:!1,docLink:le.helpers.getDocUrl("SEARCH_INDEXES"),defaultCode:this.props.searchIndexFunction,blur:this.props.blur}),de.a.createElement(QI,ZI({ref:function(t){return e.analyzer=t}},this.props)),de.a.createElement("div",{className:"control-group"},de.a.createElement("button",{id:"save-index",className:"btn btn-primary save",onClick:this.saveIndex},de.a.createElement("i",{className:"icon fonticon-ok-circled"}),n),de.a.createElement("a",{href:this.getCancelLink(),className:"index-cancel-link"},"Cancel")))}}])&&$I(n.prototype,a),r&&$I(n,r),t}(de.a.Component);function iP(){return(iP=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function sP(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function cP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sP(n,!0).forEach((function(t){lP(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sP(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}aP(oP,"defaultProps",{isCreatingIndex:!0,blur:function(){},isLoading:!0}),aP(oP,"propTypes",{isLoading:tt.a.bool,isCreatingIndex:tt.a.bool,database:tt.a.object.isRequired,saveDoc:tt.a.object.isRequired,newDesignDocName:tt.a.string,blur:tt.a.func,setSearchIndexName:tt.a.func.isRequired,searchIndexFunction:tt.a.string.isRequired,saveSearchIndex:tt.a.func.isRequired,selectDesignDoc:tt.a.func.isRequired,updateNewDesignDocName:tt.a.func.isRequired});var uP=cP({designDocs:new Backbone.Collection,database:{},loading:!0,ddocName:"new-doc",partitionKey:"",indexName:"",databaseName:""},dP());function dP(){return{noResultsWarning:"",hasActiveQuery:!1,searchQuery:"",searchResults:void 0,searchPerformed:!1,newDesignDocName:"",newDesignDocPartitioned:!0,lastSavedSearchIndexName:"",searchIndexFunction:rI.DEFAULT_SEARCH_INDEX_FUNCTION,searchIndexName:rI.DEFAULT_SEARCH_INDEX_NAME,analyzerType:rI.DEFAULT_ANALYZER_TYPE,analyzerFields:[],singleAnalyzer:rI.DEFAULT_ANALYZER,defaultMultipleAnalyzer:rI.DEFAULT_ANALYZER}}function pP(e,t){var n=t.analyzer,a=t.fieldName,r=e.analyzerFields.slice();return r.push({key:Ov.getUniqueKey(),fieldName:a||"",analyzer:n,valid:a&&a.trim().length>0}),r}function fP(e,t){var n=e.analyzerFields.slice();return t=parseInt(t,10),n.splice(t,1),n}function hP(e,t){var n=t.fieldName,a=t.rowIndex,r=e.analyzerFields.slice(),o=parseInt(a,10);return r[o].fieldName=n,r[o].valid=""!==n,r}function mP(e,t){var n=t.analyzer,a=t.rowIndex,r=e.analyzerFields.slice();return r[parseInt(a,10)].analyzer=n,r}function gP(e,t){if("new-doc"===e.ddocName){var n={_id:"_design/"+e.newDesignDocName,views:{},language:"javascript"},a=new sI.Doc(n,{database:e.database});return t&&a.setDDocPartitionedOption(e.newDesignDocPartitioned),a}var r=e.designDocs.find((function(t){return t.id===e.ddocName}));return r?r.dDocModel():null}var bP=Object(nt.b)((function(e,t){var n,a,r,o=e.search,i=e.databases,s=(n=o,a=i.isDbPartitioned,!!(r=n.designDocs.find((function(e){return n.ddocName===e.id})))&&vn.isDDocPartitioned(r.get("doc"),a));return{isCreatingIndex:t.isCreatingIndex,isLoading:o.loading,database:o.database,designDocs:o.designDocs,searchIndexFunction:o.searchIndexFunction,ddocName:o.ddocName,ddocPartitioned:s,lastSavedDesignDocName:o.lastSavedDesignDocName,lastSavedSearchIndexName:o.lastSavedSearchIndexName,searchIndexName:o.searchIndexName,analyzerType:o.analyzerType,analyzerFields:o.analyzerFields,analyzerFieldsObj:o.analyzerFieldsObj,defaultMultipleAnalyzer:o.defaultMultipleAnalyzer,singleAnalyzer:o.singleAnalyzer,saveDoc:gP(o,i.isDbPartitioned),newDesignDocName:o.newDesignDocName,newDesignDocPartitioned:o.newDesignDocPartitioned,isDbPartitioned:i.isDbPartitioned,partitionKey:t.partitionKey}}),(function(e){return{setSearchIndexName:function(t){e(fI.setSearchIndexName(t))},saveSearchIndex:function(e,t,n){fI.saveSearchIndex(e,t,n)},selectDesignDoc:function(t){e(fI.selectDesignDoc(t))},updateNewDesignDocName:function(t){e(fI.updateNewDesignDocName(t))},updateNewDesignDocPartitioned:function(t){e(fI.updateNewDesignDocPartitioned(t))},setAnalyzerType:function(t){e(fI.setAnalyzerType(t))},setSingleAnalyzer:function(t){e(fI.setSingleAnalyzer(t))},setDefaultMultipleAnalyzer:function(t){e(fI.setDefaultMultipleAnalyzer(t))},addAnalyzerRow:function(t){e(fI.addAnalyzerRow(t))},removeAnalyzerRow:function(t){e(fI.removeAnalyzerRow(t))},setAnalyzerRowFieldName:function(t){e(fI.setAnalyzerRowFieldName(t))},setAnalyzer:function(t){e(fI.setAnalyzer(t))}}}))(oP),yP=function(e){var t=e.section,n=e.database,a=e.indexName,r=e.ddocName,o=e.docURL,i=e.endpoint,s=e.dropDownLinks,c=e.designDocs,l=e.ddoc,u=e.selectedNavItem,d=e.partitionKey,p=e.onPartitionKeySelected,f=e.onGlobalModeSelected,h=e.globalMode;return de.a.createElement("div",{id:"dashboard",className:"with-sidebar"},de.a.createElement(Qp,{hideQueryOptions:!0,docURL:o,endpoint:i,dbName:n.id,dropDownLinks:s,database:n,showPartitionKeySelector:"search"===t,partitionKey:d,onPartitionKeySelected:p,onGlobalModeSelected:f,globalMode:h}),de.a.createElement("div",{className:"with-sidebar tabs-with-sidebar content-area"},de.a.createElement("aside",{id:"sidebar-content",className:"scrollable"},de.a.createElement(fc,{selectedNavItem:u,selectedPartitionKey:d})),de.a.createElement("section",{id:"dashboard-content",className:"flex-layout flex-col"},de.a.createElement("div",{className:"flex-body",id:"dashboard-lower-content"},de.a.createElement("div",{className:"search-index-content"},de.a.createElement("div",{className:"tab-content search-index-tab-content"},function(e,t,n,a,r,o,i){return"create"===e?de.a.createElement(bP,{designDocs:r,ddoc:o,database:t,isCreatingIndex:!0,partitionKey:i}):"edit"===e?de.a.createElement(bP,{database:t,indexName:n,ddocName:a,isCreatingIndex:!1,partitionKey:i}):de.a.createElement(vI,null)}(t,n,a,r,c,l,d)))))))};yP.propTypes={section:tt.a.string.isRequired,docURL:tt.a.string,endpoint:tt.a.string,ddocName:tt.a.string,indexName:tt.a.string,dropDownLinks:tt.a.array.isRequired,database:tt.a.object.isRequired};var EP=yP,_P=si.extend({routes:{"database/:database/_design/:ddoc/_search/:search(?*searchQuery)":{route:"searchNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_search/:search(?*searchQuery)":{route:"search",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_indexes/:search(?*searchQuery)":{route:"searchNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_indexes/:search(?*searchQuery)":{route:"search",roles:["fx_loggedIn"]},"database/:database/_design/:ddoc/_search/:search/edit":{route:"editNoPartition",roles:["fx_loggedIn"]},"database/:database/_partition/:partitionkey/_design/:ddoc/_search/:search/edit":{route:"edit",roles:["fx_loggedIn"]},"database/:database/new_search":"createNoPartition","database/:database/_partition/:partitionkey/new_search":"create","database/:database/new_search/:designDoc":"createNoPartition","database/:database/_partition/:partitionkey/new_search/:designDoc":"create"},initialize:function(e,t){this.allDatabases=new ri.List,this.databaseName=t[0],this.database=new ri.Model({id:this.databaseName}),this.data={database:new ri.Model({id:this.databaseName})},this.data.designDocs=new sI.AllDocs(null,{database:this.data.database,params:{startkey:'"_design"',endkey:'"_design1"',include_docs:!0}}),ii.dispatchNewOptions({database:this.data.database,designDocs:this.data.designDocs})},searchNoPartition:function(e,t,n,a){return this.search(e,"",t,n,a)},search:function(e,t,n,a,r){this.databaseName=e,this.ddocName=n,this.indexName=a;var o=new ci("designDoc",{designDocName:n,designDocSection:"Search Indexes",indexName:a});ii.dispatchExpandSelectedItem(o);var i=this.getCrumbs(this.database);fI.dispatchInitSearchIndex({databaseName:e,partitionKey:t,designDoc:n,indexName:a,query:r}),$e.fetchSelectedDatabaseInfo(e);var s=t?encodeURIComponent(t):"",c=se.urls("search","apiurl",this.databaseName,s,this.ddocName,this.indexName,r||"*:*"),l=r?"?".concat(encodeURIComponent(r)):"";return de.a.createElement(EP,{section:"search",dropDownLinks:i,endpoint:c,docURL:se.constants.DOC_URLS.SEARCH_INDEXES,database:this.database,indexName:a,selectedNavItem:o,partitionKey:t,onPartitionKeySelected:function(t){var r=se.urls("partitioned_search","app",encodeURIComponent(e),encodeURIComponent(t),encodeURIComponent(n));se.navigate("#/"+r+encodeURIComponent(a)+l)},onGlobalModeSelected:function(){var t=se.urls("search","app",encodeURIComponent(e),encodeURIComponent(n));se.navigate("#/"+t+encodeURIComponent(a)+l)},globalMode:""===t})},editNoPartition:function(e,t,n){return this.edit(e,"",t,n)},edit:function(e,t,n,a){var r=new ci("designDoc",{designDocName:n,designDocSection:"Search Indexes",indexName:a});ii.dispatchExpandSelectedItem(r),fI.dispatchEditSearchIndex({ddocID:"_design/"+n,database:this.database,indexName:a,designDocs:this.data.designDocs}),$e.fetchSelectedDatabaseInfo(e);var o=this.getCrumbs(this.database);return de.a.createElement(EP,{section:"edit",dropDownLinks:o,database:this.database,indexName:a,ddocName:n,selectedNavItem:r,partitionKey:t})},createNoPartition:function(e,t){return this.create(e,"",t)},create:function(e,t,n){var a=new ci("");fI.dispatchInitNewSearchIndex({database:this.database,designDocs:this.data.designDocs,defaultDDoc:n}),$e.fetchSelectedDatabaseInfo(e);var r=this.getCrumbs(this.database);return de.a.createElement(EP,{section:"create",dropDownLinks:r,database:this.database,designDocs:this.data.designDocs,ddoc:n,selectedNavItem:a,partitionKey:t})},getCrumbs:function(e){return[{type:"back",link:"/_all_dbs"},{name:e.id}]}}),vP=_P.extend({routes:{"database/shared/:user/:database/_design/:ddoc/_search/:search(?*searchQuery)":{route:"sharedSearch",roles:["fx_loggedIn"]},"database/shared/:user/:database/_design/:ddoc/_indexes/:search(?*searchQuery)":{route:"sharedSearch",roles:["fx_loggedIn"]},"database/shared/:user/:database/new_search":"sharedNewSearch","database/shared/:user/:database/new_search/:designDoc":"sharedNewSearch","database/shared/:user/:database/_design/:ddoc/_search/:search/edit":{route:"sharedEdit",roles:["fx_loggedIn"]}},initialize:function(e,t){le.getParams().include_docs=!0,this.username=cN.sharedUsername=t[0],this.databaseName=t[1],this.database=new iN.SharedModel({id:this.databaseName,name:this.username}),this.user=new HE.User,this.data={username:this.username,database:this.database},this.data.designDocs=new cN.SharedAllDocs(null,{username:this.username,database:this.database,paging:{pageSize:500},params:{startkey:'"_design"',endkey:'"_design1"',include_docs:!0,limit:500}});var n=t.slice(1);_P.prototype.initialize.call(this,e,n)},sharedSearch:function(e,t,n,a,r){return this.searchNoPartition(t,n,a,r)},sharedEdit:function(e,t,n,a){return this.editNoPartition(t,n,a)},sharedNewSearch:function(e,t,n){return this.createNoPartition(t,n)}});sI.RouteObjects=[_P,vP];var SP=sI;n(742);function NP(e){return e?"/_partition/"+e:""}SP.initialize=function(){se.registerExtension("sidebar:list",{selector:"indexes",name:"Search Indexes",urlNamespace:"search",indexLabel:"search index",onDelete:fI.deleteSearchIndex,onClone:fI.cloneSearchIndex,onEdit:fI.gotoEditSearchIndexPage}),se.registerExtension("sidebar:links",{title:"New Search Index",url:"new_search",icon:"fonticon-plus-circled",showForPartitionedDDocs:!0}),se.registerExtension("sidebar:newLinks",{url:"new_search",name:"Search Index"}),se.registerExtension("IndexTypes:propNames","indexes")};var DP=bN.proxyUrl;_.extend(bN.sharedUrlPaths,{search:{server:function(e,t,n,a,r){return r=bN.addRemoteAccount(r),DP+e+"/_design/"+n+"/_search/"+a+r},app:function(e,t){return bN.sharedUrlPaths.userHash()+e+"/_design/"+le.utils.safeURLName(t)+"/_search/"},edit:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/_design/"+n+"/_search/"+a+"/edit"},apiurl:function(e,t,n,a){return bN.sharedUrlPaths.host()+encodeURIComponent(e)+"/_design/"+encodeURIComponent(n)+"/_search/"+encodeURIComponent(a)},fragment:function(e,t,n,a){return bN.sharedUrlPaths.userHash()+e+"/_design/"+n+"/_search/"+a},showIndex:function(e,t,n,a){return bN.sharedUrlPaths.host()+e+"/"+n+"/_search/"+a}},partitioned_search:{app:function(e,t,n){return bN.sharedUrlPaths.userHash()+e+"/_design/"+le.utils.safeURLName(n)+"/_search/"}}}),se.registerUrls("partitioned_search",{app:function(e,t,n){return"database/"+e+NP(t)+"/_design/"+n+"/_search/"}}),se.registerUrls("search",{server:function(e,t,n,a,r){return A.getServerUrl("/"+e+NP(t)+"/_design/"+n+"/_search/"+a+r)},app:function(e,t){return"database/"+e+"/_design/"+t+"/_search/"},edit:function(e,t,n,a){return"database/"+e+NP(t)+"/_design/"+n+"/_search/"+a+"/edit"},fragment:function(e,t,n,a){return"database/"+e+NP(t)+"/_design/"+n+"/_search/"+a},showIndex:function(e,t,n,a){return"database/"+e+NP(t)+"/"+n+"/_search/"+a},apiurl:function(e,t,n,a,r){return window.location.origin+"/"+encodeURIComponent(e)+"/_design/"+encodeURIComponent(n)+"/_search/"+encodeURIComponent(a)+"?q="+encodeURIComponent(r)}}),se.addReducers({search:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:uP,t=arguments.length>1?arguments[1]:void 0,n=t.options;switch(t.type){case aI.SEARCH_INDEX_SET_LOADING:return cP({},e,{loading:n.loading});case aI.SEARCH_INDEX_DESIGN_DOCS_LOADED:var a=cP({},e,{loading:!1,designDocs:n.designDocs,database:n.database},dP());return n.defaultDDoc&&(a.ddocName="_design/"+n.defaultDDoc),a;case aI.SEARCH_INDEX_SET_NAME:return cP({},e,{searchIndexName:n.value});case aI.SEARCH_INDEX_SET_ANALYZER_TYPE:return cP({},e,{analyzerType:n.value});case aI.SEARCH_INDEX_SET_SINGLE_ANALYZER:return cP({},e,{singleAnalyzer:n.analyzer});case aI.SEARCH_INDEX_ADD_ANALYZER_ROW:return cP({},e,{analyzerFields:pP(e,n)});case aI.SEARCH_INDEX_PREVIEW_REQUEST_MADE:return cP({},e,{hasActiveQuery:!0});case aI.SEARCH_INDEX_PREVIEW_REQUEST_ERROR:return cP({},e,{hasActiveQuery:!1,searchResults:[]});case aI.SEARCH_INDEX_SET_SEARCH_QUERY:return cP({},e,{searchQuery:n.query});case aI.SEARCH_INDEX_PREVIEW_MODEL_UPDATED:return cP({},e,{searchResults:n.searchResults,hasActiveQuery:!1,searchPerformed:!0});case aI.SEARCH_INDEX_REMOVE_ANALYZER_ROW:return cP({},e,{analyzerFields:fP(e,n.rowIndex)});case aI.SEARCH_INDEX_SET_ANALYZER_ROW_FIELD_NAME:return cP({},e,{analyzerFields:hP(e,n)});case aI.SEARCH_INDEX_SET_ANALYZER_ROW:return cP({},e,{analyzerFields:mP(e,n)});case aI.SEARCH_INDEX_SET_DEFAULT_MULTIPLE_ANALYZER:return cP({},e,{defaultMultipleAnalyzer:n.analyzer});case aI.SEARCH_INDEX_INIT_EDIT_SEARCH_INDEX:return cP({},e,{},function(e,t){var n,a=t.database,r=t.designDocs,o=t.ddocInfo,i=t.indexName,s=r.find((function(e){return e.id===o.id})).dDocModel(),c=s.getAnalyzer(i);n=_.isString(c)?c:_.has(c,"default")?c.default:rI.DEFAULT_ANALYZER;var l=[];return c&&c.fields&&Object.keys(c.fields).forEach((function(e){l.push({key:Ov.getUniqueKey(),fieldName:e||"",analyzer:c.fields[e],valid:!_.isUndefined(e)&&!_.isEmpty(e)})})),{loading:!1,searchPerformed:!1,database:a,designDocs:r,searchIndexName:i,ddocName:o.id,lastSavedSearchIndexName:i,lastSavedDesignDocName:o.id,searchIndexFunction:s.getIndex(i),analyzerType:s.analyzerType(i),singleAnalyzer:n,defaultMultipleAnalyzer:n,analyzerFields:l}}(0,n));case aI.SEARCH_INDEX_SELECT_DESIGN_DOC:return cP({},e,{ddocName:n.value});case aI.SEARCH_INDEX_CLEAR:return cP({},uP,{designDocs:new Backbone.Collection});case aI.SEARCH_INDEX_INIT:return cP({},e,{loading:!1,databaseName:n.databaseName,partitionKey:n.partitionKey,ddocName:n.ddocName,indexName:n.indexName,searchQuery:n.searchQuery,searchResults:""===n.searchQuery?void 0:e.searchResults,noResultsWarning:""});case aI.SEARCH_INDEX_NEW_DESIGN_DOC_NAME_UPDATED:return cP({},e,{newDesignDocName:n.value});case aI.SEARCH_INDEX_NEW_DESIGN_DOC_PARTITONED_UPDATED:return cP({},e,{newDesignDocPartitioned:n.value});case aI.SEARCH_INDEX_PARTITION_PARAM_NOT_SUPPORTED:return iP({},e,{noResultsWarning:"The selected index does not support partitions. Switch back to global mode."});case aI.SEARCH_INDEX_PARTITION_PARAM_MANDATORY:return iP({},e,{noResultsWarning:"The selected index requires a partition key. Use the selector at the top to enter a partition key."});default:return e}}});var OP=SP;function wP(e){return(wP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function CP(e){return(CP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IP(e,t){return(IP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var RP=Jr.TabElement,kP=Jr.TabElementWrapper,LP=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=CP(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==wP(r)&&"function"!=typeof r?AP(a):r,PP(AP(n),"checked",(function(e){return n.props.selectedRadio===e})),PP(AP(n),"onRadioClick",(function(e){var t=e.target.value;n.props.onRadioClick(t)})),PP(AP(n),"createFilterTabs",(function(){return n.props.radioNames.map((function(e,t){var a=n.checked(e);return de.a.createElement(RP,{key:t,selected:a,text:e,onChange:n.onRadioClick})}))})),PP(AP(n),"searchTermChange",(function(e){var t=e.target.value;n.props.onSearch(t)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IP(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.createFilterTabs();return de.a.createElement(kP,null,e,de.a.createElement("li",{className:"component-tab-list-element"},de.a.createElement("input",{id:"active-tasks-search-box",className:"searchbox",type:"text",name:"search",placeholder:"Search for databases...",value:this.props.searchTerm,onChange:this.searchTermChange})))}}])&&TP(n.prototype,a),r&&TP(n,r),t}(de.a.Component);function xP(e){return(xP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function MP(e){return(MP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HP(e,t){return(HP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}PP(LP,"defaultProps",{radioNames:["All Tasks","Replication","Database Compaction","Indexer","View Compaction"]});var GP={getTimeInfo:function(e){return[le.helpers.formatDate(e),le.helpers.getDateFromNow(e)]},getDatabaseFieldMessage:function(e){var t=e.type,n=[];return"replication"===t?(n.push("From: "+e.source),n.push("To: "+e.target)):"indexer"===t?(n.push(e.database),n.push("(View: "+e.design_document+")")):n.push(e.database),n},getProgressMessage:function(e){var t=[],n=e.type;return _.has(e,"progress")&&t.push("Progress: "+e.progress+"%"),"indexer"===n?t.push("Processed "+e.changes_done+" of "+e.total_changes+" changes."):"replication"===n&&(t.push(e.docs_written+" docs written."),_.has(e,"changes_pending")&&t.push(e.changes_pending+" pending changes.")),_.has(e,"changes_done")&&t.push(e.changes_done+" Changes done."),t},getSourceSequence:function(e){return e.source_seq}},qP=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,n=!(r=(e=MP(t)).call.apply(e,[this].concat(i)))||"object"!==xP(r)&&"function"!=typeof r?jP(a):r,BP(jP(n),"getInfo",(function(e){return{type:e.type,objectField:GP.getDatabaseFieldMessage(e),started_on:GP.getTimeInfo(e.started_on),updated_on:GP.getTimeInfo(e.updated_on),pid:e.pid.replace(/[<>]/g,""),progress:GP.getProgressMessage(e)}})),BP(jP(n),"multilineMessage",(function(e,t){t||(t="");var n="multiline-active-tasks-message "+t;return e.map((function(e,t){return de.a.createElement("p",{key:t,className:n},e)}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HP(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.getInfo(this.props.item),t=this.multilineMessage(e.objectField,"to-from-database"),n=this.multilineMessage(e.started_on,"time"),a=this.multilineMessage(e.updated_on,"time"),r=this.multilineMessage(e.progress);return de.a.createElement("tr",null,de.a.createElement("td",null,e.type),de.a.createElement("td",null,t),de.a.createElement("td",null,n),de.a.createElement("td",null,a),de.a.createElement("td",null,e.pid),de.a.createElement("td",null,r))}}])&&UP(n.prototype,a),r&&UP(n,r),t}(de.a.Component);function VP(e){return(VP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function KP(e){return(KP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XP(e,t){return(XP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var YP=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=KP(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==VP(r)&&"function"!=typeof r?WP(a):r,zP(WP(n),"createRows",(function(){var e=""===n.props.searchTerm.trim();return 0===n.props.tasks.length||n.props.isLoading?e?n.noActiveTasks():n.noActiveTasksMatchFilter():n.props.tasks.map((function(e,t){return de.a.createElement(qP,{key:t,item:e})}))})),zP(WP(n),"getType",(function(){var e=n.props.selectedRadio;return"All Tasks"===e?"":e})),zP(WP(n),"noActiveTasks",(function(){var e=n.getType(),t=de.a.createElement("td",{colSpan:"6"},"No active ",e," tasks.");return n.props.isLoading&&(t=de.a.createElement("td",{colSpan:"6"},"Loading tasks.")),de.a.createElement("tr",{className:"no-matching-database-on-search"},t)})),zP(WP(n),"noActiveTasksMatchFilter",(function(){var e=n.getType();return de.a.createElement("tr",{className:"no-matching-database-on-search"},de.a.createElement("td",{colSpan:"6"},"No active ",e,' tasks match with filter: "',n.props.searchTerm,'"'))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XP(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("tbody",{className:"js-tasks-go-here"},this.createRows())}}])&&FP(n.prototype,a),r&&FP(n,r),t}(de.a.Component);function QP(e){return(QP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JP(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZP(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $P(e,t,n){return t&&ZP(e.prototype,t),n&&ZP(e,n),e}function eR(e,t){return!t||"object"!==QP(t)&&"function"!=typeof t?nR(e):t}function tR(e){return(tR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aR(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rR(e,t)}function rR(e,t){return(rR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var iR=function(e){function t(e){var n;return JP(this,t),oR(nR(n=eR(this,tR(t).call(this,e))),"arrow",(function(){var e=n.props.sortByHeader,t=n.props.headerName,a=n.props.headerIsAscending?"icon icon-caret-up":"icon icon-caret-down";if(e===t)return de.a.createElement("i",{className:a})})),oR(nR(n),"onTableHeaderClick",(function(){n.props.onTableHeaderClick(n.props.headerName)})),n.onTableHeaderClick=n.onTableHeaderClick.bind(nR(n)),n}return aR(t,e),$P(t,[{key:"render",value:function(){return de.a.createElement("td",{className:"header-field ".concat(this.props.headerName," tableheader"),onClick:this.onTableHeaderClick},de.a.createElement("label",{className:"header-field label-text active-tasks-header noselect"},this.props.displayName," ",this.arrow()))}}]),t}(de.a.Component),sR=function(e){function t(){var e,n;JP(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return oR(nR(n=eR(this,(e=tR(t)).call.apply(e,[this].concat(r)))),"createTableHeadingFields",(function(){var e=n.props,t=e.onTableHeaderClick,a=e.sortByHeader,r=e.headerIsAscending;return n.props.headerNames.map((function(e){return de.a.createElement(iR,{headerName:e[0],displayName:e[1],key:e[0],onTableHeaderClick:t,sortByHeader:a,headerIsAscending:r})}))})),n}return aR(t,e),$P(t,[{key:"render",value:function(){return de.a.createElement("thead",null,de.a.createElement("tr",null,this.createTableHeadingFields()))}}]),t}(de.a.Component);function cR(e){return(cR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lR(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function uR(e,t){return!t||"object"!==cR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dR(e){return(dR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pR(e,t){return(pR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}oR(sR,"defaultProps",{headerNames:[["type","Type"],["database","Database"],["started-on","Started on"],["updated-on","Updated on"],["pid","PID"],["progress","Status"]]});var fR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uR(this,dR(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pR(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.tasks,n=e.selectedRadio,a=e.searchTerm,r=e.sortByHeader,o=e.onTableHeaderClick,i=e.headerIsAscending,s=e.isLoading;return de.a.createElement("div",{id:"dashboard-lower-content"},de.a.createElement("table",{id:"active-tasks-table",className:"table table-bordered table-striped active-tasks"},de.a.createElement(sR,{onTableHeaderClick:o,sortByHeader:r,headerIsAscending:i}),de.a.createElement(YP,{tasks:t,selectedRadio:n,isLoading:s,searchTerm:a})))}}])&&lR(n.prototype,a),r&&lR(n,r),t}(de.a.Component);function hR(e){return(hR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mR(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gR(e){return(gR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yR(e,t){return(yR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ER(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _R=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=gR(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==hR(r)&&"function"!=typeof r?bR(a):r,ER(bR(n),"setNewSearchTerm",(function(e){n.props.setSearchTerm(e)})),ER(bR(n),"switchTab",(function(e){n.props.switchTab(e)})),ER(bR(n),"tableHeaderOnClick",(function(e){n.props.sortByColumnHeader(e)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yR(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.props.init()}},{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.tasks,a=e.searchTerm,r=e.selectedRadio,o=e.sortByHeader,i=e.headerIsAscending,s=this.setNewSearchTerm,c=this.tableHeaderOnClick;return de.a.createElement("div",{id:"active-tasks-page",className:"scrollable"},de.a.createElement("div",{className:"inner"},de.a.createElement(LP,{searchTerm:a,selectedRadio:r,onSearch:s,onRadioClick:this.switchTab}),de.a.createElement(fR,{isLoading:t,tasks:n,searchTerm:a,selectedRadio:r,onTableHeaderClick:c,sortByHeader:o,headerIsAscending:i})))}}])&&mR(n.prototype,a),r&&mR(n,r),t}(de.a.Component);function vR(e){return(vR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SR(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function NR(e){return(NR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OR(e,t){return(OR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var TR=Jr.Polling,CR=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=NR(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==vR(r)&&"function"!=typeof r?DR(a):r,wR(DR(n),"runPollingUpdate",(function(){n.props.runPollingUpdate()})),wR(DR(n),"getPluralForLabel",(function(){return"1"===n.state.pollingInterval?"":"s"})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OR(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e="active-tasks__polling-wrapper";return A.isIE1X()&&(e+=" "+e+"--ie1X"),de.a.createElement("div",{className:e},de.a.createElement(TR,{min:1,max:30,stepSize:1,startValue:15,valueUnits:"second",onPoll:this.runPollingUpdate}))}}])&&SR(n.prototype,a),r&&SR(n,r),t}(de.a.Component),AR=[{name:"Active Tasks"}],IR=function(e){return de.a.createElement(Et,null,de.a.createElement(_t,{crumbs:AR,docURL:se.constants.DOC_URLS.ACTIVE_TASKS,endpoint:A.getApiUrl("/_active_tasks")},de.a.createElement(CR,e)),de.a.createElement(vt,null,de.a.createElement(_R,e)))},PR={ACTIVE_TASKS_SWITCH_TAB:"ACTIVE_TASKS_SWITCH_TAB",ACTIVE_TASKS_SET_COLLECTION:"ACTIVE_TASKS_SET_COLLECTION",ACTIVE_TASKS_SET_SEARCH_TERM:"ACTIVE_TASKS_SET_SEARCH_TERM",ACTIVE_TASKS_SORT_BY_COLUMN_HEADER:"ACTIVE_TASKS_SORT_BY_COLUMN_HEADER",ACTIVE_TASKS_FETCH_AND_SET:"ACTIVE_TASKS_FETCH_AND_SET",ACTIVE_TASKS_SET_IS_LOADING:"ACTIVE_TASKS_SET_IS_LOADING",ACTIVE_TASKS_POLLING_COLLECTION:"ACTIVE_TASKS_POLLING_COLLECTION"},RR=function(){return v(A.getServerUrl("/_active_tasks")).then((function(e){if(e.error)throw new Error(e.reason);return e}))},kR=function(e){return{type:PR.ACTIVE_TASKS_SET_IS_LOADING,options:e}},LR=function(e){return{type:PR.ACTIVE_TASKS_FETCH_AND_SET,options:e}};function xR(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function UR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xR(n,!0).forEach((function(t){MR(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xR(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function MR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jR={isLoading:!1,sortByHeader:"started-on",headerIsAscending:!0,selectedRadio:"All Tasks",searchTerm:"",tasks:[],filteredTasks:[]},HR=function(e,t){return UR({},e,{filteredTasks:BR(t,e.selectedRadio,e.sortbyHeader,e.tasks,e.headerIsAscending),searchTerm:t})},BR=function(e,t,n,a,r){return function(e,t,n){var a=Object(i.sortBy)(t,(function(t){var n=e;return Object(i.isUndefined)(t[n])&&(n="source"),t[n]}));return n?a:a.reverse()}(n,a.filter((function(n){return function(e,t){var n=t.toLowerCase().replace(" ","_");return e.type===n||"all_tasks"===n}(n,t)&&function(e,t){var n=new RegExp(t,"g"),a="";return Object(i.has)(e,"database")&&(a+=e.database),Object(i.has)(e,"source")&&(a+=e.source),Object(i.has)(e,"target")&&(a+=e.target),n.test(a)}(n,e)})),r)},GR=function(e,t,n){return e!==t||!n},qR=function(e){return e.headerIsAscending},VR=function(e){return e.isLoading},FR=function(e){return e.selectedRadio},KR=function(e){return e.sortByHeader},WR=function(e){return e.searchTerm},XR=Object(nt.b)((function(e){var t,n=e.activetasks;return{tasks:(t=n,t.filteredTasks),headerIsAscending:qR(n),selectedRadio:FR(n),sortByHeader:KR(n),searchTerm:WR(n),isLoading:VR(n)}}),(function(e){return{init:function(){return e((function(e){e(kR(!0)),RR().then((function(t){e(kR(!1)),e(LR(t))})).catch((function(e){se.addNotification({msg:"Fetching active tasks failed: ".concat(e),type:"error"})}))}))},setSearchTerm:function(t){return e({type:PR.ACTIVE_TASKS_SET_SEARCH_TERM,options:t})},sortByColumnHeader:function(t){return e({type:PR.ACTIVE_TASKS_SORT_BY_COLUMN_HEADER,options:t})},switchTab:function(t){return e(function(e){return{type:PR.ACTIVE_TASKS_SWITCH_TAB,options:e}}(t))},runPollingUpdate:function(){return e((function(e){RR().then((function(t){e(LR(t))})).catch((function(e){se.addNotification({msg:"Fetching active tasks failed: ".concat(e),type:"error"})}))}))}}}))(IR),zR={RouteObjects:[se.RouteObject.extend({selectedHeader:"Active Tasks",routes:{"activetasks/:id":"showActiveTasks",activetasks:"showActiveTasks"},roles:["_admin"],showActiveTasks:function(){return de.a.createElement(XR,null)}})]};n(743);zR.initialize=function(){se.addHeaderLink({title:"Active Tasks",icon:"fonticon-activetasks",href:"#/activetasks"})},se.addReducers({activetasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jR,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.options;switch(n){case PR.ACTIVE_TASKS_FETCH_AND_SET:return UR({},e,{tasks:a,filteredTasks:BR(e.searchTerm,e.selectedRadio,e.sortByHeader,a,e.headerIsAscending)});case PR.ACTIVE_TASKS_SWITCH_TAB:var r=BR(e.searchTerm,a,e.sortByHeader,e.tasks,s);return UR({},e,{selectedRadio:a,filteredTasks:r});case PR.ACTIVE_TASKS_CHANGE_POLLING_INTERVAL:return UR({},e,{pollingIntervalSeconds:a});case PR.ACTIVE_TASKS_SET_SEARCH_TERM:return HR(e,a);case PR.ACTIVE_TASKS_SORT_BY_COLUMN_HEADER:var o=e.sortByHeader,i=a,s=GR(o,i,e.headerIsAscending),c=BR(e.searchTerm,e.selectedRadio,i,e.tasks,s);return UR({},e,{sortByHeader:i,headerIsAscending:s,filteredTasks:c});case PR.ACTIVE_TASKS_SET_IS_LOADING:return UR({},e,{isLoading:a})}return e}});var YR=zR,QR={RouteObjects:[se.RouteObject.extend({selectedHeader:"Monitoring",routes:{}})]},JR='Your Lite account contains over 1 GB of data, and is <b>restricted</b>. To remove the restrictions on your account, <a href="https://cloud.ibm.com/resources" class="doc-link opens-new-window" target="_blank"> upgrade to a paid plan</a>, or <a href="#/_all_dbs" class="doc-link">delete data</a> to return storage to under the 1 GB limit. Restrictions are lifted after daily storage assessment completes.',ZR=(n(744),pS.userPromise);QR.initialize=function(){var e=document.createElement("div");e.id="plan-limit-modal",document.body.appendChild(e),z.a.render(de.a.createElement(ME.AccountPlanExceededModal),document.getElementById("plan-limit-modal")),r()(document).ajaxError((function(e,t){429===t.status&&Ey.showPlanExceededModal()})),y.filter((function(e){return 429===e.status})).subscribe((function(){Ey.showPlanExceededModal()})),ZR.then((function(){var e=pS.user.get("plan"),t=pS.user.get("over_quota"),n=r_.isCcmPlan(e);pS.user.set("isCcmCustomer",n),function(e,t,n){n&&t&&se.showPermanentNotification(JR)}(0,t,n)}))};var $R=QR,ek={SUPPORT_SELECT_PAGE:"SUPPORT_SELECT_PAGE",SUPPORT_USER_TICKET_LIST_LOADED:"SUPPORT_USER_TICKET_LIST_LOADED",SUPPORT_USER_TICKET_LOADED:"SUPPORT_USER_TICKET_LOADED",SUPPORT_SELECT_TICKET:"SUPPORT_SELECT_TICKET",SUPPORT_SET_NEW_TICKET_SUBJECT:"SUPPORT_SET_NEW_TICKET_SUBJECT",SUPPORT_SET_NEW_TICKET_MESSAGE:"SUPPORT_SET_NEW_TICKET_MESSAGE",SUPPORT_SET_NEW_TICKET_ATTACHMENT:"SUPPORT_SET_NEW_TICKET_ATTACHMENT",SUPPORT_NEW_CASE_SUBMITTED:"SUPPORT_NEW_CASE_SUBMITTED",SUPPORT_SHOW_RESPONSE_FORM:"SUPPORT_SHOW_RESPONSE_FORM",SUPPORT_HIDE_RESPONSE_FORM:"SUPPORT_HIDE_RESPONSE_FORM",SUPPORT_SET_RESPONSE_MESSAGE:"SUPPORT_SET_RESPONSE_MESSAGE",SUPPORT_SET_RESPONSE_ATTACHMENT:"SUPPORT_SET_RESPONSE_ATTACHMENT",SUPPORT_CLEAR_CACHE:"SUPPORT_CLEAR_CACHE",SUPPORT_RESPONSE_ADDED:"SUPPORT_RESPONSE_ADDED",SUPPORT_CLEAR_RESPONSE_FORM:"SUPPORT_CLEAR_RESPONSE_FORM",SUPPORT_SUBMITTING_RESPONSE:"SUPPORT_SUBMITTING_RESPONSE",SUPPORT_RESPONSE_COMPLETE:"SUPPORT_RESPONSE_COMPLETE"},tk={SUPPORT_PAGES:{NEW_TICKET:"NEW_TICKET",OPEN_TICKETS:"OPEN_TICKETS",CLOSED_TICKETS:"CLOSED_TICKETS"},TICKET_LIST_TYPES:{OPEN:"TICKET_LIST_TYPE_OPEN",CLOSED:"TICKET_LIST_TYPE_CLOSED"},RESPONSE_FORM_ANIMATION_SPEED:400,TICKET_CACHE_DURATION:12e4,VALID_FILE_UPLOAD_FORMATS:[".png",".jpg",".jpeg",".gif",".bmp",".tif",".log",".csv"]};function nk(e){return e.split("_")[0]}var ak={cleanUpTickets:function(e){return e?e.map((function(e){return{caseID:nk(e.id),id:e.id,open:"true"===e.open,title:e.title,timeUpdated:e.timeupdated,timeViewed:e.timeviewed}})):[]},getCaseID:nk,getFirstTicketByType:function(e,t){var n=t===tk.TICKET_LIST_TYPES.OPEN,a=e?e.find((function(e){return e.open===n})):void 0;return a||null},getPerson:function(e,t){return-1!==["wilson (API server)","FogBugz","Support On-Call"].indexOf(t)?e:"Cloudant Support"},parseTicketDetails:function(e){var t=e.public_events.map((function(e){return{moment:h()(e.date),content:e.content,person:e.person,attachments:e.attachments}}));return"false"===e.open&&t.push({content:"This ticket has been closed.",moment:h()(e.timeupdated),person:"Cloudant Support",attachments:[]}),{id:e.id,fetched:!0,fetchTime:h()().unix(),correspondence:t.reverse()}}};function rk(e){(function(e,t){var n=t?t.find((function(t){return t.id===e})):void 0,a=h()().unix();if(n&&n.details.fetched&&n.details.fetchTime+tk.TICKET_CACHE_DURATION>a){return se.Deferred().resolve({fromCache:!0,ticketInfo:n.details})}return r.a.ajax({method:"GET",contentType:"application/json; charset=utf-8",dataType:"json",url:le.hostDash+"/support/tickets/"+ak.getCaseID(e)})})(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).then((function(e){var t=e.fromCache?e.ticketInfo:ak.parseTicketDetails(e.tickets[0]);se.dispatch({type:ek.SUPPORT_USER_TICKET_LOADED,options:{ticketInfo:t}})}),(function(){se.addNotification({msg:"There was an error retrieving this ticket.",type:"error",clear:!0})}))}var ok={selectPage:function(e){se.dispatch({type:ek.SUPPORT_SELECT_PAGE,options:{page:e}})},selectTicket:function(e,t,n){se.dispatch({type:ek.SUPPORT_SELECT_TICKET,options:{ticketType:e,ticketID:n}}),rk(n,t)},initSupportPage:function(e){r.a.ajax({method:"GET",contentType:"application/json; charset=utf-8",dataType:"json",url:le.hostDash+"/support/tickets"}).then((function(t){var n,a=ak.cleanUpTickets(t.tickets);(se.dispatch({type:ek.SUPPORT_USER_TICKET_LIST_LOADED,options:{tickets:a}}),-1!==[tk.SUPPORT_PAGES.OPEN_TICKETS,tk.SUPPORT_PAGES.CLOSED_TICKETS].indexOf(e))&&((n=e===tk.SUPPORT_PAGES.OPEN_TICKETS?ak.getFirstTicketByType(a,tk.TICKET_LIST_TYPES.OPEN):ak.getFirstTicketByType(a,tk.TICKET_LIST_TYPES.CLOSED))&&rk(n.id))}),(function(){se.addNotification({msg:"There was an error retrieving the support tickets.",type:"error",clear:!0})}))},getSingleTicket:rk,setNewTicketAttachment:function(e){se.dispatch({type:ek.SUPPORT_SET_NEW_TICKET_ATTACHMENT,options:{attachment:e}})},setNewTicketSubject:function(e){se.dispatch({type:ek.SUPPORT_SET_NEW_TICKET_SUBJECT,options:{subject:e}})},setNewTicketMessage:function(e){se.dispatch({type:ek.SUPPORT_SET_NEW_TICKET_MESSAGE,options:{message:e}})},setResponseMessage:function(e){se.dispatch({type:ek.SUPPORT_SET_RESPONSE_MESSAGE,options:{message:e}})},setResponseAttachment:function(e){se.dispatch({type:ek.SUPPORT_SET_RESPONSE_ATTACHMENT,options:{attachment:e}})},showResponseForm:function(){se.dispatch({type:ek.SUPPORT_SHOW_RESPONSE_FORM})},hideResponseForm:function(){se.dispatch({type:ek.SUPPORT_HIDE_RESPONSE_FORM})},submitTicket:function(e){se.addNotification({msg:"Creating ticket.",type:"info",clear:!0}),fetch("".concat(le.hostDash,"/support/tickets"),{method:"POST",credentials:"include",body:e,headers:{Accept:"multipart/form-data; charset=utf-8"}}).then((function(e){return e.json()})).then((function(e){e.error||e.message?se.addNotification({msg:"The ticket could not be created: ".concat(e.error||e.message),type:"error",clear:!0}):se.addNotification({msg:"The ticket has been created.",type:"success",clear:!0})})),se.dispatch({type:ek.SUPPORT_NEW_CASE_SUBMITTED})},submitResponse:function(e,t,n){se.addNotification({msg:"Submitting response. Please wait.",type:"info",clear:!0}),se.dispatch({type:ek.SUPPORT_SUBMITTING_RESPONSE}),function(e,t){return r.a.ajax({method:"PUT",url:le.hostDash+"/support/tickets/"+e,data:t,async:!0,dataType:"json",cache:!1,contentType:!1,processData:!1})}(ak.getCaseID(t),n).then((function(t){se.dispatch({type:ek.SUPPORT_RESPONSE_COMPLETE}),se.addNotification({msg:e?"You have replied to this ticket.":"The ticket has been re-opened.",type:"success",clear:!0}),e?(se.dispatch({type:ek.SUPPORT_CLEAR_RESPONSE_FORM}),se.dispatch({type:ek.SUPPORT_USER_TICKET_LOADED,options:{ticketInfo:ak.parseTicketDetails(t)}})):(se.dispatch({type:ek.SUPPORT_CLEAR_CACHE}),se.navigate("support/opentickets"))}),(function(){se.addNotification({msg:e?"There was an error replying to this ticket.":"There was an error re-opening this ticket.",type:"error",clear:!0})}))}},ik=new(se.Store.extend({initialize:function(){this._currentPage=tk.SUPPORT_PAGES.NEW_TICKET,this.clearUserInfo(),this.reset()},clearUserInfo:function(){this._userAuthenticated=!1,this._userEmail="",this._isInChina=null},reset:function(){this._tickets=null,this._ticketDetails={},this._selectedOpenTicket=null,this._selectedClosedTicket=null,this._newTicketSubject="",this._newTicketMessage="",this._newTicketAttachment="",this._newCaseSubmitted=!1,this._responseFormVisible=!1,this._responseMessage="",this._responseAttachment="",this._responseSubmitting=!1},selectPage:function(e){this._currentPage=e,e===tk.SUPPORT_PAGES.NEW_TICKET&&(this._newTicketSubject="",this._newTicketMessage="",this._newTicketAttachment="",this._newCaseSubmitted=!1)},isLoaded:function(){return null!==this._tickets&&this._userAuthenticated},isAuthenticated:function(){return this._userAuthenticated},getPage:function(){return this._currentPage},setUser:function(e){this._userAuthenticated=!0,this._userEmail=e.email,this._isGoldSupport="gold"===e.supportLevel,this._isInChina=e.isInChina},isUserInChina:function(){return this._isInChina},getUserEmail:function(){return this._userEmail},getNewTicketAttachment:function(){return this._newTicketAttachment},getTickets:function(e){var t=this;return(this._tickets?this._tickets.filter((function(t){return t.open===e})):[]).map((function(e){var n=e.id;return t.getTicketById(n)}))},updateTicketList:function(e){this._tickets=e;var t=ak.getFirstTicketByType(this._tickets,tk.TICKET_LIST_TYPES.OPEN);this._selectedOpenTicket=null===t?null:this.getTicketById(t.id);var n=ak.getFirstTicketByType(this._tickets,tk.TICKET_LIST_TYPES.CLOSED);this._selectedClosedTicket=null===n?null:this.getTicketById(n.id)},isGoldSupport:function(){return this._isGoldSupport},getSelectedTicket:function(e){return e?this._selectedOpenTicket:this._selectedClosedTicket},getNewTicketSubject:function(){return this._newTicketSubject},getNewTicketMessage:function(){return this._newTicketMessage},setTicketDetails:function(e){this._ticketDetails[e.id]=e},selectTicket:function(e,t){e!==tk.TICKET_LIST_TYPES.OPEN?this._selectedClosedTicket=this.getTicketById(t):this._selectedOpenTicket=this.getTicketById(t)},isNewCaseSubmitted:function(){return this._newCaseSubmitted},isResponseFormVisible:function(){return this._responseFormVisible},getResponseMessage:function(){return this._responseMessage},getResponseAttachment:function(){return this._responseAttachment},isResponseBeingSubmitted:function(){return this._responseSubmitting},getTicketById:function(e){var t=this._tickets?this._tickets.find((function(t){return t.id===e})):void 0;return t.details=_.has(this._ticketDetails,e)?this._ticketDetails[e]:{fetched:!1},t},dispatch:function(e){switch(e.type){case sy.USER_AUTHENTICATED:this.setUser(e.options);break;case ek.SUPPORT_SELECT_PAGE:this.selectPage(e.options.page);break;case ek.SUPPORT_USER_TICKET_LIST_LOADED:this.updateTicketList(e.options.tickets);break;case ek.SUPPORT_USER_TICKET_LOADED:this.setTicketDetails(e.options.ticketInfo);break;case ek.SUPPORT_SELECT_TICKET:this.selectTicket(e.options.ticketType,e.options.ticketID);break;case ek.SUPPORT_SET_NEW_TICKET_ATTACHMENT:this._newTicketAttachment=e.options.attachment;break;case ek.SUPPORT_SET_NEW_TICKET_SUBJECT:this._newTicketSubject=e.options.subject;break;case ek.SUPPORT_SET_NEW_TICKET_MESSAGE:this._newTicketMessage=e.options.message;break;case ek.SUPPORT_NEW_CASE_SUBMITTED:this._newCaseSubmitted=!0;break;case ek.SUPPORT_SHOW_RESPONSE_FORM:this._responseFormVisible=!0;break;case ek.SUPPORT_HIDE_RESPONSE_FORM:this._responseFormVisible=!1;break;case ek.SUPPORT_CLEAR_RESPONSE_FORM:this._responseFormVisible=!1,this._responseMessage="",this._responseAttachment="";break;case ek.SUPPORT_SET_RESPONSE_MESSAGE:this._responseMessage=e.options.message;break;case ek.SUPPORT_SET_RESPONSE_ATTACHMENT:this._responseAttachment=e.options.attachment;break;case ek.SUPPORT_CLEAR_CACHE:this.reset();break;case ek.SUPPORT_SUBMITTING_RESPONSE:this._responseSubmitting=!0;break;case ek.SUPPORT_RESPONSE_COMPLETE:this._responseSubmitting=!1;break;default:return}this.triggerChange()}}));ik.dispatchToken=se.dispatcher.register(ik.dispatch.bind(ik));var sk={supportPageStore:ik};function ck(e){return(ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uk(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function dk(e,t,n){return t&&uk(e.prototype,t),n&&uk(e,n),e}function pk(e,t){return!t||"object"!==ck(t)&&"function"!=typeof t?hk(e):t}function fk(e){return(fk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mk(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gk(e,t)}function gk(e,t){return(gk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bk=Jr.LoadLines,yk=sk.supportPageStore,Ek=function(e){function t(e){var n;return lk(this,t),(n=pk(this,fk(t).call(this,e))).state=n.getStoreState(),n.state.userPromiseResolved=!1,n.submit=n.submit.bind(hk(n)),n}return mk(t,e),dk(t,[{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){var e=this;yk.on("change",this.onChange,this),pS.userPromise.then((function(){e.setState({userPromiseResolved:!0})})).catch((function(){e.setState({userPromiseResolved:!0})}))}},{key:"componentWillUnmount",value:function(){yk.off("change",this.onChange)}},{key:"getStoreState",value:function(){return{page:yk.getPage(),userAuthenticated:yk.isAuthenticated(),userEmail:yk.getUserEmail(),userIsInChina:yk.isUserInChina(),newTicketSubject:yk.getNewTicketSubject(),newTicketMessage:yk.getNewTicketMessage(),newTicketAttachment:yk.getNewTicketAttachment(),newCaseSubmitted:yk.isNewCaseSubmitted(),isGoldSupport:yk.isGoldSupport()}}},{key:"submit",value:function(e){if(e.preventDefault(),this.validate()){var t=new FormData(e.target);t.append("priority",3),ok.submitTicket(t)}}},{key:"validate",value:function(){var e=this.state,t=e.newTicketSubject,n=e.newTicketMessage;return t?!!n||(se.addNotification({msg:"Please enter a message.",type:"error",clear:!0}),this.message.focus(),!1):(se.addNotification({msg:"Please enter a subject.",type:"error",clear:!0}),this.subject.focus(),!1)}},{key:"getCaseSubmittedMsg",value:function(){return this.state.isGoldSupport?de.a.createElement("div",null,de.a.createElement("p",null,"Thank you. Cloudant support will reply to you within the hour."),de.a.createElement("p",null,"Add ",de.a.createElement("a",{href:"mailto:support@cloudant.com"},"support@cloudant.com")," to the address book of your email application, so that our replies don't end up anywhere but your inbox.")):de.a.createElement("p",null,"Thank you. Cloudant support will reply to you as soon as possible.")}},{key:"getNewCaseContent",value:function(){var e=this,t=this.state,n=t.userEmail,a=t.newTicketSubject,r=t.newTicketMessage,o=t.newTicketAttachment;return t.newCaseSubmitted?de.a.createElement("div",{className:"support-page-title"},de.a.createElement("h4",null,"Case Submitted"),this.getCaseSubmittedMsg()):de.a.createElement("div",null,de.a.createElement("div",{className:"support-page-title"},de.a.createElement("h4",null,"New Case"),de.a.createElement("p",null,"Use the following form to ask a question or report a problem to Cloudant Support. Responses will be posted in the Support section of the Cloudant Dashboard and sent to ",n,". Please describe the issue in as much detail as possible.")),de.a.createElement("form",{id:"support-form",className:"newticket",encType:"multipart/form-data",onSubmit:this.submit},de.a.createElement("label",{htmlFor:"subject"},"Subject"),de.a.createElement("input",{type:"text",id:"subject",name:"title",ref:function(t){return e.subject=t},className:"input-xxlarge",autoFocus:!0,value:a,onChange:function(e){return ok.setNewTicketSubject(e.target.value)}}),de.a.createElement("label",{htmlFor:"comments"},"Details"),de.a.createElement("textarea",{id:"comments",name:"body",ref:function(t){return e.message=t},className:"input-xxlarge input-xxtall",value:r,onChange:function(e){return ok.setNewTicketMessage(e.target.value)}}),de.a.createElement(Ok,{attachment:o,onSelect:ok.setNewTicketAttachment,acceptedFileFormats:tk.VALID_FILE_UPLOAD_FORMATS}),de.a.createElement("div",{className:"support-buttons"},de.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Open Case"))))}},{key:"render",value:function(){var e=this.state,t=e.userAuthenticated,n=e.userIsInChina,a=e.userPromiseResolved;return t&&a?n?de.a.createElement(Tk,null):pS.user.isIBMCloudAccount()?de.a.createElement("div",{id:"new-ticket-wrapper",className:"new-ticket-page"},de.a.createElement("p",null,"To open a new support ticket, please visit the ",de.a.createElement("a",{href:"https://cloud.ibm.com/unifiedsupport/supportcenter",target:"_blank",rel:"noopener noreferrer"},"IBM Cloud Support page"),"."),de.a.createElement("p",null,"You can still view and update any previously open tickets here until June 30th, 2019. After this date, visit the IBM Cloud Support page to manage your support cases.")):de.a.createElement("div",{id:"new-ticket-wrapper",className:"new-ticket-page"},this.getNewCaseContent()):de.a.createElement("div",{className:"support-load-lines"},de.a.createElement(bk,null))}}]),t}(de.a.Component),_k=function(e){function t(e){var n;return lk(this,t),(n=pk(this,fk(t).call(this,e))).state=n.getStoreState(),n}return mk(t,e),dk(t,[{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){yk.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){yk.off("change",this.onChange)}},{key:"getStoreState",value:function(){return{loaded:yk.isLoaded(),userIsInChina:yk.isUserInChina(),tickets:yk.getTickets(this.props.open),selectedTicket:yk.getSelectedTicket(this.props.open),userEmail:yk.getUserEmail(),responseFormVisible:yk.isResponseFormVisible(),responseMessage:yk.getResponseMessage(),responseAttachment:yk.getResponseAttachment(),responseFormSubmitting:yk.isResponseBeingSubmitted()}}},{key:"render",value:function(){var e=this.state,t=e.loaded,n=e.userIsInChina,a=e.tickets,r=e.selectedTicket,o=e.userEmail,i=e.responseFormVisible,s=e.responseMessage,c=e.responseAttachment,l=e.responseFormSubmitting;if(n)return de.a.createElement(Tk,null);if(!t)return de.a.createElement("div",{className:"support-load-lines"},de.a.createElement(bk,null));var u=this.props.open?tk.TICKET_LIST_TYPES.OPEN:tk.TICKET_LIST_TYPES.CLOSED;return de.a.createElement("div",{className:"ticket-list flex-layout flex-col"},de.a.createElement(vk,{ticketType:u,tickets:a,selectedTicket:r,userEmail:o,responseFormVisible:i,responseMessage:s,responseAttachment:c,responseFormSubmitting:l}))}}]),t}(de.a.Component);_k.propTypes={open:tt.a.bool.isRequired};var vk=function(e){function t(){return lk(this,t),pk(this,fk(t).apply(this,arguments))}return mk(t,e),dk(t,[{key:"getOptions",value:function(){return this.props.tickets.map((function(e){return{value:e.id,label:"".concat(e.caseID," - ").concat(e.title)}}))}},{key:"getTicketHistory",value:function(){var e=this.props,t=e.selectedTicket,n=e.userEmail;return t.details.fetched?de.a.createElement(Sk,{correspondence:t.details.correspondence,userEmail:n,id:t.id}):de.a.createElement("div",{className:"support-load-lines"},de.a.createElement(bk,null))}},{key:"getResponseForm",value:function(e){var t=this.props,n=t.responseFormVisible,a=t.responseMessage,r=t.responseAttachment,o=t.responseFormSubmitting,i=t.selectedTicket,s=e.map((function(e){var t=e.style;return de.a.createElement(Dk,{key:"1",style:t,id:i.id,isOpen:i.open,isSubmitting:o,visible:n,message:a,attachment:r,onChangeMessage:ok.setResponseMessage,onChangeAttachment:ok.setResponseAttachment,onCancel:ok.hideResponseForm,onSubmit:ok.submitResponse})}));return de.a.createElement("div",null,s)}},{key:"getStyles",value:function(e){var t=this.props.responseFormVisible,n={opacity:0,height:0};return t&&(n={opacity:Object(Wa.spring)(1,Wa.presets.gentle),height:Object(Wa.spring)(350,Wa.presets.gentle)}),e&&!t&&(n={opacity:Object(Wa.spring)(0),height:Object(Wa.spring)(0)}),[{key:"1",style:n}]}},{key:"render",value:function(){var e=this.props,t=e.tickets,n=e.ticketType,a=e.selectedTicket;if(0===t.length){var r={};return r[tk.TICKET_LIST_TYPES.OPEN]="open",r[tk.TICKET_LIST_TYPES.CLOSED]="closed",de.a.createElement("p",{className:"no-tickets-of-type"},"You have no ",r[n]," tickets.")}var o=n===tk.TICKET_LIST_TYPES.OPEN?"Reply":"Reopen Case";return de.a.createElement("div",{className:"tab-pane flex-layout flex-col"},de.a.createElement("div",{className:"flex-fill"},de.a.createElement("div",{className:"support-header flex-layout flex-row"},de.a.createElement("div",{className:"flex-body"},de.a.createElement(qr.a,{name:"ticket-selector",value:a.id,options:this.getOptions(),clearable:!1,onChange:function(e){return ok.selectTicket(n,t,e.value)}})),de.a.createElement("div",{className:"flex-fill button-row-item"},de.a.createElement("button",{className:"btn btn-small btn-primary",disabled:!a.details.fetched,onClick:ok.showResponseForm},o)))),de.a.createElement("div",{className:"flex-fill"},de.a.createElement(Wa.TransitionMotion,{styles:this.getStyles.bind(this)},this.getResponseForm.bind(this)),this.getTicketHistory()))}}]),t}(de.a.Component);vk.propTypes={tickets:tt.a.array.isRequired,ticketType:tt.a.oneOf([tk.TICKET_LIST_TYPES.OPEN,tk.TICKET_LIST_TYPES.CLOSED]).isRequired,userEmail:tt.a.string.isRequired,responseFormVisible:tt.a.bool.isRequired,responseMessage:tt.a.string.isRequired,responseAttachment:tt.a.string.isRequired};var Sk=function(e){function t(){return lk(this,t),pk(this,fk(t).apply(this,arguments))}return mk(t,e),dk(t,[{key:"getList",value:function(){var e=this.props,t=e.correspondence,n=e.userEmail,a=e.id;return t?t.map((function(e,t){return de.a.createElement(Nk,{item:e,key:t,userEmail:n,id:a})})):[]}},{key:"render",value:function(){return de.a.createElement("div",null,this.getList())}}]),t}(de.a.Component),Nk=function(e){function t(){return lk(this,t),pk(this,fk(t).apply(this,arguments))}return mk(t,e),dk(t,[{key:"getAttachments",value:function(){return 0===this.props.item.attachments.length?null:de.a.createElement("ul",{className:"unstyled"},this.getAttachmentList())}},{key:"getAttachmentList",value:function(){var e=this.props,t=e.id,n=e.item;return n.attachments?Object.keys(n.attachments).map((function(e){var a=n.attachments[e];if(/NO_FILENAME/.test(e))return null;var r="/_api/v2/support/tickets/".concat(t,"/files/").concat(a);return de.a.createElement("li",{className:"attachment",key:e},de.a.createElement("span",{className:"icon fonticon-paperclip"}),de.a.createElement("a",{href:r,"data-bypass":"true",target:"_blank",rel:"noopener noreferrer"},e))})):[]}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.userEmail;return de.a.createElement("div",{className:"volley"},de.a.createElement("div",{className:"row-fluid time-stamp"},de.a.createElement("div",{className:"span3"},de.a.createElement("h4",{className:"meta"},de.a.createElement("div",{className:"date"},t.moment.format("MMM D, YYYY"),de.a.createElement("span",{className:"time"},t.moment.format("h:mm A"))))),de.a.createElement("div",{className:"span8"},de.a.createElement("h4",null,de.a.createElement("div",{className:"person"},de.a.createElement("span",{className:"edited"},"From")," ",ak.getPerson(n,t.person))))),de.a.createElement("div",{className:"row-fluid content"},de.a.createElement("div",{className:"span12"},de.a.createElement("pre",null,t.content),this.getAttachments())))}}]),t}(de.a.Component),Dk=function(e){function t(e){var n;return lk(this,t),(n=pk(this,fk(t).call(this,e))).submit=n.submit.bind(hk(n)),n.focus=n.focus.bind(hk(n)),n}return mk(t,e),dk(t,[{key:"submit",value:function(e){if(e.preventDefault(),!this.validate())return!1;var t=new FormData(e.target);this.props.onSubmit(this.props.isOpen,this.props.id,t)}},{key:"focus",value:function(){this.message.focus()}},{key:"validate",value:function(){return!!this.props.message||(se.addNotification({msg:"Please enter a message.",type:"error",clear:!0}),this.message.focus(),!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.visible,a=t.style,r=t.message,o=t.attachment,i=t.onChangeMessage,s=t.onChangeAttachment,c=t.onCancel,l=t.isSubmitting;return 0!==a.opacity||n?de.a.createElement("div",{style:{opacity:a.opacity,height:a.height+"px"},className:"support-response-form-wrapper"},de.a.createElement("form",{className:"support-response-form",encType:"multipart/form-data",onSubmit:this.submit},de.a.createElement("textarea",{name:"body",ref:function(t){return e.message=t},className:"input-xxlarge input-xxtall",placeholder:"Enter comments here",onChange:function(e){return i(e.target.value)},value:r,autoFocus:!0,disabled:l}),de.a.createElement(Ok,{attachment:o,onSelect:s,acceptedFileFormats:tk.VALID_FILE_UPLOAD_FORMATS}),de.a.createElement("div",{className:"support-buttons"},de.a.createElement("button",{type:"submit",className:"btn btn-primary",value:"Submit",disabled:l},"Submit"),de.a.createElement("a",{"data-bypass":"true",className:"cancel-link",onClick:function(){return c()}},"Cancel")))):null}}]),t}(de.a.Component);Dk.propTypes={id:tt.a.string.isRequired,isOpen:tt.a.bool.isRequired,message:tt.a.string.isRequired,attachment:tt.a.string.isRequired,onChangeMessage:tt.a.func.isRequired,onChangeAttachment:tt.a.func.isRequired,onCancel:tt.a.func.isRequired,onSubmit:tt.a.func.isRequired};var Ok=function(e){function t(e){var n;return lk(this,t),(n=pk(this,fk(t).call(this,e))).selectAttachment=n.selectAttachment.bind(hk(n)),n}return mk(t,e),dk(t,[{key:"selectAttachment",value:function(e){var t=this.props,n=t.onSelect,a=t.acceptedFileFormats;if(""!==e){var r=e.toLowerCase().match(/.[0-9a-z]+$/),o="";r.length>0&&(o=r[0].toLowerCase()),0===a.length||-1!==a.indexOf(o)?n(e):(se.addNotification({msg:"Attachments may only be of the following formats: "+a.join(", "),type:"error",clear:!0}),n(""))}else n("")}},{key:"getAttachment",value:function(){var e=this.props,t=e.attachment,n=e.onSelect;if(!t)return null;var a=t.replace("C:\\fakepath\\","");return de.a.createElement("span",{className:"support-attachment"},de.a.createElement("span",{className:"attachment-name"},a),de.a.createElement("span",{className:"remove-attachment fonticon-cancel",onClick:function(){return n("")}}))}},{key:"render",value:function(){var e=this,t=this.props.attachment;return de.a.createElement("div",null,de.a.createElement("label",{className:"fileContainer attach-file btn btn-link"},de.a.createElement("i",{className:"icon fonticon-paperclip"}),"Attach a file",de.a.createElement("input",{className:"file",type:"file",name:"attachments",value:t,onChange:function(t){return e.selectAttachment(t.target.value)}})),this.getAttachment())}}]),t}(de.a.Component);Ok.propTypes={attachment:tt.a.string.isRequired,onSelect:tt.a.func.isRequired,acceptedFileFormats:tt.a.array},Ok.defaultProps={acceptedFileFormats:[]};var wk=function(e){function t(e){var n;return lk(this,t),(n=pk(this,fk(t).call(this,e))).state=n.getStoreState(),n}return mk(t,e),dk(t,[{key:"getStoreState",value:function(){return{page:yk.getPage(),loaded:yk.isLoaded(),isAuthenticated:yk.isAuthenticated(),userIsInChina:yk.isUserInChina(),openTickets:yk.getTickets(!0),closedTickets:yk.getTickets(!1)}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){yk.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){yk.off("change",this.onChange)}},{key:"getOpenCasesCount",value:function(){var e=this.state,t=e.loaded,n=e.openTickets;return t?de.a.createElement("span",{id:"open-case-count",className:"case-count"},"(",n.length,")"):null}},{key:"getSupportUnavailableNav",value:function(){return de.a.createElement("div",{className:"flex-layout flex-col no-support-nav"},de.a.createElement("nav",{className:"sidenav simple-sidenav"},de.a.createElement("ul",{className:"nav nav-list"},de.a.createElement("li",{className:"active"},de.a.createElement("a",{href:"#/support",id:"case-button"},"How to get support")))))}},{key:"getNav",value:function(){var e=this.state.page,t=e===tk.SUPPORT_PAGES.NEW_TICKET?"active":"",n=e===tk.SUPPORT_PAGES.OPEN_TICKETS?"active":"",a=e===tk.SUPPORT_PAGES.CLOSED_TICKETS?"active":"";return de.a.createElement("div",{className:"flex-layout flex-col"},de.a.createElement("nav",{className:"sidenav simple-sidenav"},de.a.createElement("ul",{className:"nav nav-list"},de.a.createElement("li",{className:t},de.a.createElement("a",{href:"#/support",id:"case-button"},"New Case")),de.a.createElement("li",{className:n},de.a.createElement("a",{href:"#support/opentickets",className:"cases-link",id:"open-cases"},"Open Tickets",this.getOpenCasesCount())),de.a.createElement("li",{className:a},de.a.createElement("a",{href:"#support/closedtickets",className:"cases-link",id:"closed-cases"},"Closed Tickets")))),de.a.createElement("div",{className:"support-more-resources"},de.a.createElement("div",null,de.a.createElement("h4",null,"More resources"),de.a.createElement("ul",null,de.a.createElement("li",null,de.a.createElement("a",{href:"https://twitter.com/cloudantstatus",target:"_blank",rel:"noopener noreferrer",className:"opens-new-window"},"@cloudantstatus on Twitter")),de.a.createElement("li",null,de.a.createElement("a",{href:"https://cloudant.com/learning-center/",target:"_blank",rel:"noopener noreferrer",className:"opens-new-window"},"Learning Center"))))))}},{key:"render",value:function(){var e=this.state,t=e.isAuthenticated,n=e.userIsInChina;return t?n?this.getSupportUnavailableNav():this.getNav():de.a.createElement("div",{className:"support-sidebar-loading"},de.a.createElement(bk,null))}}]),t}(de.a.Component),Tk=function(e){function t(){return lk(this,t),pk(this,fk(t).apply(this,arguments))}return mk(t,e),dk(t,[{key:"render",value:function(){return de.a.createElement("div",{className:"support-unavailable"},de.a.createElement("p",null,"For Cloudant questions and support, please email ",de.a.createElement("a",{href:"mailto:Cloudant@21vianet.com"},"Cloudant@21vianet.com")," and include your username with a brief description of the question or problem."))}}]),t}(de.a.Component),Ck={TicketsController:_k,NewTicketController:Ek,TicketCorrespondence:Sk,TicketDetails:Nk,TicketsList:vk,FileUploader:Ok,ResponseForm:Dk,Sidebar:wk,SupportUnavailable:Tk},Ak=[{name:"Support"}],Ik=function(){return de.a.createElement("header",{className:"two-panel-header flex-fill"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("div",{id:"header-docs-left"}),de.a.createElement("div",{className:"right-header-wrapper flex-layout flex-row flex-body"},de.a.createElement("div",{id:"react-headerbar",className:"flex-body"},de.a.createElement(mt,{crumbs:Ak})),de.a.createElement("div",{id:"right-header",className:"flex-fill"}),de.a.createElement("div",{id:"notification-center-btn",className:"flex-fill"},de.a.createElement(pt,null)))))},Pk=function(e){var t=e.content,n=e.open;return de.a.createElement("div",{className:"with-sidebar tabs-with-sidebar content-area flex-layout flex-body"},de.a.createElement("aside",{id:"sidebar-content"},de.a.createElement(Ck.Sidebar,null)),de.a.createElement("section",{id:"dashboard-content",className:"flex-body flex-layout flex-col"},function(e,t){return"create"===e?de.a.createElement(Ck.NewTicketController,null):de.a.createElement(Ck.TicketsController,{open:t})}(t,n)))},Rk=function(e){var t=e.content,n=e.open;return de.a.createElement("div",{id:"dashboard",className:"with-sidebar flex-template flex-layout flex-col"},de.a.createElement(Ik,null),de.a.createElement(Pk,{content:t,open:n}))},kk={RouteObjects:[se.RouteObject.extend({routes:{support:"defaultPage","support/opentickets":"openTickets","support/closedtickets":"closedTickets"},roles:["_admin"],selectedHeader:"Support",defaultPage:function(){return ok.selectPage(tk.SUPPORT_PAGES.NEW_TICKET),ok.initSupportPage(tk.SUPPORT_PAGES.NEW_TICKET),de.a.createElement(Rk,{content:"create"})},openTickets:function(){return ok.selectPage(tk.SUPPORT_PAGES.OPEN_TICKETS),ok.initSupportPage(tk.SUPPORT_PAGES.OPEN_TICKETS),de.a.createElement(Rk,{content:"open",open:!0})},closedTickets:function(){return ok.selectPage(tk.SUPPORT_PAGES.CLOSED_TICKETS),ok.initSupportPage(tk.SUPPORT_PAGES.CLOSED_TICKETS),de.a.createElement(Rk,{content:"open",open:!1})}})]};n(745);kk.initialize=function(){se.addHeaderLink({title:"Support",href:"#/support",icon:"fonticon-support"}),pS.userPromise.then((function(){ok.initSupportPage(tk.SUPPORT_PAGES.OPEN_TICKETS)}))};var Lk=kk,xk="DATABASES_PAGE_SELECT_TAB",Uk="DATABASES_PAGE_LOADING",Mk="DATABASES_PAGE_LOADING_COMPLETED",jk="SHARED_DATABASES_SHOW_DB_UNAVAILABLE_MODAL",Hk="SHARED_DATABASES_HIDE_DB_UNAVAILABLE_MODAL",Bk="SHARED_DATABASES_SETLOADING",Gk="SHARED_DATABASES_SET_TAB_STATUS",qk="SHARED_DATABASES_SETPAGE",Vk="SHARED_DATABASES_SET_PROMPT_VISIBLE",Fk="SHARED_DATABASES_STARTLOADING",Kk="SHARED_DATABASES_LOADCOMPLETE",Wk="SHARED_DATABASES_UPDATE",Xk=function(e){var t=e.split("/")[0];return{username:t,db:e.replace(t+"/","")}},zk=function(e,t,n,a,r,o){var i=[],s=0,c=t.filter((function(e){return-1===a.indexOf(e)}));c.forEach((function(e){var l=Xk(e),u=se.urls("sharedDatabasePermissions","server",l.db,"?remote_account="+l.username);$e.fetch(u).then((function(t){i.push({db:e,permissions:t})})).finally((function(){s++,c.length===s&&(Yk({permissions:i,dbList:t,databaseDetails:r,failedDbs:a,fullDbList:n}),o&&o(null,t,n,a,r))}))}))},Yk=function(e){se.dispatch({type:Wk,options:e})},Qk=function(e,t){if(e.backupsEnabled()){var n={};t.forEach((function(e){n[e.get("db")]={hasBackup:e.get("hasBackup"),lastBackupDate:e.get("latest_completion")}})),se.dispatch({type:cD.DATABASE_BACKUP_INFO_AVAILABLE,options:{backupInfo:n}})}},Jk=function(e){se.dispatch({type:Bk,options:{isLoading:e}})},Zk=function(){var e=le.getParams(),t=e.page?parseInt(e.page,10):1,n=se.constants.MISC.DEFAULT_PAGE_SIZE;se.dispatch({type:Fk}),function(e){se.dispatch({type:qk,options:{page:e}})}(t),Jk(!0);var a=se.urls("sharedAllDbs","server","?per_page=500");$e.fetch(a).then((function(e){var a=e.shared_databases;Jk(!1);var r=$e.paginate(a,t,n);Yk({dbList:r,databaseDetails:[],failedDbs:[],fullDbList:a}),function(e,t,n){var a=[],r=[],o=0;e.forEach((function(i){var s=Xk(i),c=se.urls("sharedDatabaseBaseURL","server",s.db,"?remote_account="+s.username);$e.fetch(c).then((function(e){e.db_name=i,a.push(e)}),(function(){r.push(i)})).finally((function(){++o===e.length&&(Yk({dbList:e,databaseDetails:a,failedDbs:r,fullDbList:t}),n&&n(null,e,t,r,a))}))}))}(r,a,zk)}))},$k={updateSharedDatabases:Yk,setSharedDbsLoading:Jk,init:function(e){var t=e.page,n=e.limit,a=se.cloudantUser,r=new dD.DatabaseBackupList;return $e.setStartLoading(),$e.setPage(t),n&&$e.setLimit(n),a.fetchOnce().then((function(){var e=a.backupsEnabled();$e.getDatabaseList(n,t).then((function(o){var i=$e.paginate(o,t,n);$e.updateDatabases({dbList:i,databaseDetails:[],failedDbs:[],fullDbList:o}),$e.getDatabaseDetails(i,o),e&&i.length&&(r.setDatabases(i),r.fetch().then((function(){Qk(a,r)})))}))}))},initSharedDBs:Zk,setTab:function(e,t){e!==t&&($e.updateDatabases({dbList:[],databaseDetails:[],failedDbs:[],fullDbList:[]}),Yk({dbList:[],databaseDetails:[],failedDbs:[],fullDbList:[]})),se.dispatch({type:xk,tab:e})},showDatabaseUnavailableModal:function(){se.dispatch({type:jk})},hideDatabaseUnavailableModal:function(){se.dispatch({type:Hk})},removeSharedDatabase:function(e){var t=A.getServerUrl("/_api/v2/user/shared_databases"),n=JSON.stringify({database:e.dbName});S(t,{body:n}).then((function(e){if(e.message)throw new Error(e.message);Zk(),se.addNotification({msg:"The database has been removed from the list.",type:"success",clear:!0})})).catch((function(){se.addNotification({msg:"There was an error removing the database from the list.",type:"error",clear:!0})}))},finishedLoading:function(){se.dispatch({type:Hk})},fetchAccountType:function(){se.dispatch({type:Uk}),pS.userPromise.then((function(){se.dispatch({type:Mk,options:{showSharedDBsTab:!pS.user.isIBMCloudAccount()}})})).catch((function(){se.dispatch({type:Mk,options:{showSharedDBsTab:!1}})}))}},eL={DATABASES_TAB:"databases",SHARED_DATABASES_TAB:"shared-databases"},tL={};tL.CloudantDatabasesPageStore=se.Store.extend({initialize:function(){this.currentTab=eL.DATABASES_TAB,this._tabDisabled=!0,this._isLoading=!0,this._isSharedDBsTabVisible=!1},selectTab:function(e){this.currentTab=e},getIsTabDisabled:function(){return this._tabDisabled},getTab:function(){return this.currentTab},isSharedDBsTabVisible:function(){return this._isSharedDBsTabVisible},isLoading:function(){return this._isLoading},dispatch:function(e){switch(e.type){case xk:this.selectTab(e.tab);break;case Gk:this._tabDisabled=e.options.isTabDisabled;break;case Uk:this._isLoading=!0;break;case Mk:this._isLoading=!1,this._isSharedDBsTabVisible=e.options.showSharedDBsTab;break;default:return}this.triggerChange()}}),tL.cloudantDatabasesPageStore=new tL.CloudantDatabasesPageStore,tL.cloudantDatabasesPageStore.dispatchToken=se.dispatcher.register(tL.cloudantDatabasesPageStore.dispatch.bind(tL.cloudantDatabasesPageStore)),tL.SharedDatabasesStore=se.Store.extend({initialize:function(){this.reset()},reset:function(){this._isLoading=!0,this._permissions=[],this._dbUnavailableModalVisible=!1},isDatabaseUnavailableModalVisible:function(){return this._dbUnavailableModalVisible},showDBUnavailableModal:function(){this._dbUnavailableModalVisible=!0},hideDBUnavailableModal:function(){this._dbUnavailableModalVisible=!1},getPermissions:function(){var e=se.cloudantUser.get("username");return this._permissions.map((function(t){if(!t.permissions)return t;var n=t.permissions.cloudant[e];return{db:t.db,permissions:n}}))},getIsSharedDbLoading:function(){return this._isLoading},dispatch:function(e){switch(e.type){case Bk:this._isLoading=e.options.isLoading;break;case xk:this.hideDBUnavailableModal();break;case jk:this.showDBUnavailableModal();break;case Hk:this.hideDBUnavailableModal();break;case ke.DATABASES_UPDATE:this._permissions=e.options.permissions||[];break;default:return}this.triggerChange()}}),tL.sharedDatabasesStore=new tL.SharedDatabasesStore,tL.sharedDatabasesStore.dispatchToken=se.dispatcher.register(tL.sharedDatabasesStore.dispatch.bind(tL.sharedDatabasesStore)),tL.databasesStore=new We.DatabasesStoreConstructor,tL.databasesStore.dispatch=function(e){switch(e.type){case qk:this._page=e.options.page;break;case Vk:this.setPromptVisible(e.options.visible);break;case Fk:this.setLoading(!0);break;case Kk:this.setLoading(!1);break;case Wk:this._fullDbList=e.options.fullDbList,this._dbList=e.options.dbList,this._databaseDetails=e.options.databaseDetails,this._failedDbs=e.options.failedDbs,this.setLoading(!1);break;default:return}this.triggerChange()},tL.databasesStore.dispatchToken=se.dispatcher.register(tL.databasesStore.dispatch.bind(tL.databasesStore));var nL=tL;function aL(e){return(aL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oL(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function iL(e,t,n){return t&&oL(e.prototype,t),n&&oL(e,n),e}function sL(e,t){return!t||"object"!==aL(t)&&"function"!=typeof t?lL(e):t}function cL(e){return(cL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uL(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dL(e,t)}function dL(e,t){return(dL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fL=nL.databasesStore,hL=nL.cloudantDatabasesPageStore,mL=nL.sharedDatabasesStore,gL=Wo.GraveyardInfo,bL=Jr.TabElement,yL=Jr.TabElementWrapper,EL=function(e){function t(e){var n;return rL(this,t),pL(lL(n=sL(this,cL(t).call(this,e))),"getStoreState",(function(){return{selectedTab:hL.getTab(),isTabDisabled:hL.getIsTabDisabled(),isSharedDBsTabVisible:hL.isSharedDBsTabVisible(),isLoading:hL.isLoading()}})),pL(lL(n),"onChange",(function(){n.setState(n.getStoreState())})),pL(lL(n),"getSharedDBTab",(function(){if(n.state.isSharedDBsTabVisible){var e=n.state.selectedTab;return de.a.createElement(bL,{selected:e===eL.SHARED_DATABASES_TAB,text:"Databases Shared by Others",onChange:function(){se.navigate("#shared-database")},iconClass:""})}})),pL(lL(n),"getSharedDBTabContent",(function(){if(n.state.isSharedDBsTabVisible&&n.state.selectedTab==eL.SHARED_DATABASES_TAB){var e="shared-database-content-tag tab-pane";return n.state.selectedTab===eL.SHARED_DATABASES_TAB&&(e+=" active"),de.a.createElement("div",{className:e,id:"shared-database-tab"},de.a.createElement(_L,null))}return null})),n.state=n.getStoreState(),n}return uL(t,e),iL(t,[{key:"componentDidMount",value:function(){hL.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){hL.off("change",this.onChange)}},{key:"render",value:function(){var e=this.state,t=e.selectedTab;if(e.isLoading)return de.a.createElement(Jr.LoadLines,null);var n="your-database-content-tag tab-pane";return this.state.selectedTab===eL.DATABASES_TAB&&(n+=" active"),de.a.createElement("div",{style:{padding:0}},de.a.createElement(yL,null,de.a.createElement(bL,{selected:t===eL.DATABASES_TAB,text:"Your Databases",onChange:function(){se.navigate("#your-database")},iconClass:""}),this.getSharedDBTab()),de.a.createElement("div",{className:"tab-content dashboard-tab-content"},de.a.createElement("div",{className:n,id:"your-database-tab"},de.a.createElement(Wo.DatabasesController,null)),this.getSharedDBTabContent()),de.a.createElement("div",{id:"database-unavailable-modal-wrapper"}))}}]),t}(de.a.Component),_L=function(e){function t(){var e,n;rL(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return pL(lL(n=sL(this,(e=cL(t)).call.apply(e,[this].concat(r)))),"getStoreState",(function(){return{dbUnavailableModalVisible:mL.isDatabaseUnavailableModalVisible(),permissions:mL.getPermissions(),dbList:fL.getDbList(),isLoading:mL.getIsSharedDbLoading()}})),pL(lL(n),"onChange",(function(){n.setState(n.getStoreState())})),pL(lL(n),"state",n.getStoreState()),n}return uL(t,e),iL(t,[{key:"componentDidMount",value:function(){fL.on("change",this.onChange,this),mL.on("change",this.onChange,this)}},{key:"componentWillUnmount",value:function(){fL.off("change",this.onChange),mL.off("change",this.onChange)}},{key:"render",value:function(){var e=this.state,t=e.permissions,n=e.dbList;return de.a.createElement("div",null,de.a.createElement(vL,{permissions:t,dbList:n,loading:this.state.isLoading}),de.a.createElement(NL,{visible:this.state.dbUnavailableModalVisible}))}}]),t}(de.a.Component),vL=function(e){function t(){var e,n;rL(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return pL(lL(n=sL(this,(e=cL(t)).call.apply(e,[this].concat(r)))),"createRows",(function(){return n.props.dbList.map((function(e,t){var a=n.props.permissions.filter((function(t){if(t)return t.db!==e.id}))[0];return de.a.createElement(SL,{permissions:a,item:e,key:t})}))})),pL(lL(n),"emptyTableMsg",(function(){return de.a.createElement("tr",{className:"no-shared-dbs-available"},de.a.createElement("td",{colSpan:"5"},"You do not have any shared databases available."))})),n}return uL(t,e),iL(t,[{key:"render",value:function(){if(this.props.loading)return de.a.createElement("div",{className:"view"},de.a.createElement(Jr.LoadLines,null));var e=0===this.props.dbList.length?this.emptyTableMsg():this.createRows();return de.a.createElement("div",{className:"view"},de.a.createElement("table",{className:"databases table table-striped fauxton-table-list shared-db-table"},de.a.createElement("thead",null,de.a.createElement("tr",null,de.a.createElement("th",null,"Name"),de.a.createElement("th",null,"Size"),de.a.createElement("th",null,"Documents"),de.a.createElement("th",null,"Actions"))),de.a.createElement("tbody",null,e)))}}]),t}(de.a.Component),SL=function(e){function t(){var e,n;rL(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return pL(lL(n=sL(this,(e=cL(t)).call.apply(e,[this].concat(r)))),"showDatabaseUnavailableModal",(function(){$k.showDatabaseUnavailableModal()})),pL(lL(n),"deleteFromList",(function(){var e=n.props.item;$k.removeSharedDatabase({dbName:e.id})})),pL(lL(n),"getDeleteIcon",(function(){var e=de.a.createElement(Ct.l,{id:"tooltip-delete"},"Delete from this list");return de.a.createElement(Ct.i,{placement:"top",overlay:e},de.a.createElement("a",{ref:function(e){return n.deleteIcon=e},onClick:n.deleteFromList,className:"js-db-remove db-actions btn fa fa-remove icon-remove fonticon-remove delete-db-from-list",title:"Delete from this list"}))})),pL(lL(n),"getReplicationIcon",(function(e,t){var a=t&&(-1!==t.indexOf("_writer")||-1!==t.indexOf("_replicator")),r=de.a.createElement(Ct.l,{id:"tooltip-replication"},"You do not have permission to replicate this database");return a?(r=de.a.createElement(Ct.l,{id:"tooltip-replication"},"Replicate ".concat(decodeURIComponent(e))),de.a.createElement(Ct.i,{placement:"top",overlay:r},de.a.createElement("a",{ref:function(e){return n.replicationIcon=e},className:"db-actions btn fonticon-replicate set-replication-start",title:"Replicate "+e,href:"#/replication/shared/"+e}," "))):de.a.createElement(Ct.i,{placement:"top",overlay:r},de.a.createElement("a",{ref:function(e){return n.replicationIcon=e},className:"db-actions btn fonticon-replicate set-replication-start disabled disabled-shared-button",title:"You do not have permission to replicate this database"}," "))})),pL(lL(n),"getPermissionsIcon",(function(e,t){var a=t&&-1!==t.indexOf("_admin"),r=de.a.createElement(Ct.l,{id:"tooltip-permissions"},"You do not have permission to view this database's security settings");return a?(r=de.a.createElement(Ct.l,{id:"tooltip-permissions"},"Set permissions for ".concat(decodeURIComponent(e))),de.a.createElement(Ct.i,{placement:"top",overlay:r},de.a.createElement("a",{ref:function(e){return n.permissionsIcon=e},className:"db-actions btn icon-lock set-permissions",title:"Set permissions for "+decodeURIComponent(e),href:"#/database/shared/"+e+"/permissions"}))):de.a.createElement(Ct.i,{placement:"top",overlay:r},de.a.createElement("a",{ref:function(e){return n.permissionsIcon=e},className:"db-actions btn icon-lock set-permissions disabled disabled-shared-button",title:"You do not have permission to view this database's security settings"}))})),n}return uL(t,e),iL(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.permissions,a=t.encodedId,r=t.id,o=t.dataSize,i=t.docCount,s=t.docDelCount,c=t.showTombstoneWarning;if(t.failed)return de.a.createElement("tr",null,de.a.createElement("td",null,r),de.a.createElement("td",{className:"gray js-db-unavailable database-unavailable-msg",onClick:this.showDatabaseUnavailableModal},"Database Unavailable ",de.a.createElement("i",{className:"icon icon-exclamation-sign"})),de.a.createElement("td",null),de.a.createElement("td",null,this.getDeleteIcon()));var l=c?de.a.createElement(gL,{docCount:i,docDelCount:s}):null,u=n?n.permissions:null;return de.a.createElement("tr",null,de.a.createElement("td",null,de.a.createElement("a",{href:"#/database/shared/"+r+"/_all_docs"},r)),de.a.createElement("td",null,o),de.a.createElement("td",null,i," ",l),de.a.createElement("td",null,this.getDeleteIcon()," ",this.getReplicationIcon(a,u)," ",this.getPermissionsIcon(a,u)))}}]),t}(de.a.Component),NL=function(e){function t(){var e,n;rL(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return pL(lL(n=sL(this,(e=cL(t)).call.apply(e,[this].concat(r)))),"closeModal",(function(){$k.hideDatabaseUnavailableModal()})),n}return uL(t,e),iL(t,[{key:"render",value:function(){if(!this.props.visible)return null;var e=this.props.visible;return de.a.createElement(Ct.g,{dialogClassName:"",show:e,onHide:this.closeModal},de.a.createElement(Ct.g.Header,{closeButton:!0},de.a.createElement(Ct.g.Title,null,"Database Unavailable")),de.a.createElement(Ct.g.Body,null,de.a.createElement("b",null,'"Database Unavailable"')," is typically the result of one the following:",de.a.createElement("br",null),de.a.createElement("div",{className:"dashboard__database-unavailable-reasons"},de.a.createElement("p",null,"The person sharing this database needs to enable CORS."),de.a.createElement("p",{className:"dashboard__unavailable-modal-text-indent"},"They can do this in the 'CORS' section, under their 'Account' tab."),de.a.createElement("p",{className:"dashboard__unavailable-modal-p"},de.a.createElement("span",{className:"dashboard__unavailable-modal-or-span"},"OR"),"This database has been deleted."),de.a.createElement("p",{className:"dashboard__unavailable-modal-p"},de.a.createElement("span",{className:"dashboard__unavailable-modal-or-span"},"OR"),"You have permission to replicate this database, but not to view."),de.a.createElement("p",{className:"dashboard__unavailable-modal-p"},de.a.createElement("span",{className:"dashboard__unavailable-modal-or-span"},"OR"),"Your permission to view this database has been revoked."))))}}]),t}(de.a.Component);pL(NL,"defaultProps",{visible:!1});var DL={DatabasesPageController:EL,SharedDatabasesPage:_L,SharedDatabaseTable:vL,SharedDatabaseRow:SL,DatabaseUnavailableModal:NL};function OL(e){return(OL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wL(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function TL(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function CL(e,t){return!t||"object"!==OL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AL(e){return(AL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IL(e,t){return(IL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var PL=nL.cloudantDatabasesPageStore,RL=nL.databasesStore,kL=We.databasesStore,LL=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),CL(this,AL(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IL(e,t)}(t,e),n=t,(a=[{key:"isSharedDbsTab",value:function(e){return e!==eL.DATABASES_TAB}},{key:"loadCorrectTab",value:function(e){$k.setTab(e.tab,PL.getTab()),this.isSharedDbsTab(e.tab)&&$k.initSharedDBs()}},{key:"componentDidMount",value:function(){this.loadCorrectTab(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.loadCorrectTab(e)}},{key:"render",value:function(){var e=this.props.linkPath,t=wL(["shared-database"===this.props.tab?window.location.origin+"/_api/v2/user/shared_databases":window.location.origin+"/_all_dbs","https://cloud.ibm.com/docs/services/Cloudant/api?topic=cloudant-databases#get-a-list-of-all-databases-in-the-account"],2),n=t[0],a=t[1],r=this.isSharedDbsTab(this.props.tab)?RL:kL;return de.a.createElement(Et,null,de.a.createElement(_t,{crumbs:[{name:"Databases"}],endpoint:n,docURL:a},de.a.createElement(Wo.RightDatabasesHeader,{partitionedDbHelpText:le.i18n.en_US["create-db-partitioned-help"]})),de.a.createElement(vt,null,de.a.createElement(DL.DatabasesPageController,null)),de.a.createElement(St,null,de.a.createElement(Wo.DatabasePagination,{linkPath:e,store:r})))}}])&&TL(n.prototype,a),r&&TL(n,r),t}(de.a.Component);var xL=se.RouteObject.extend({routes:{"":"databasesTab",_all_dbs:"databasesTab","your-database":"databasesTab","_all_dbs(:params)":"databasesTab","_all_shared_dbs(:params)":"sharedDatabasesTab","shared-database(:params)":"sharedDatabasesTab"},selectedHeader:"Databases",roles:["_admin"],databasesTab:function(e,t){var n=function(e){var t=1,n=void 0;if(e){var a=le.getParams(e);isFinite(parseInt(a.page))&&(t=parseInt(a.page)),isFinite(parseInt(a.limit))&&(n=parseInt(a.limit))}return{page:t,limit:n}}(t),a=n.page,r=n.limit;return $e.setPage(a),r&&$e.setLimit(r),$k.fetchAccountType(),de.a.createElement(LL,{tab:eL.DATABASES_TAB})},sharedDatabasesTab:function(){return $k.fetchAccountType(),de.a.createElement(LL,{linkPath:"_all_shared_dbs",tab:eL.SHARED_DATABASES_TAB})}});iN.RouteObjects=[xL];var UL=iN;n(746);UL.initialize=function(){},se.registerUrls("sharedAllDbs",{server:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return A.getServerUrl("/_api/v2/user/shared_databases".concat(e))},app:function(){throw new Error("not implemented")},apiurl:function(){throw new Error("not implemented")}}),se.registerUrls("sharedDatabaseBaseURL",{server:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return A.getServerUrl("/_api/v2/user/shared_databases/proxy/"+e+t)},app:function(){throw new Error("not implemented")},apiurl:function(){throw new Error("not implemented")}}),se.registerUrls("sharedDatabasePermissions",{server:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return A.getServerUrl("/_api/v2/user/shared_databases/proxy/".concat(e,"/_security").concat(t))},app:function(){throw new Error("not implemented")},apiurl:function(){throw new Error("not implemented")}});var ML=UL;function jL(e){return(jL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HL(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function BL(e,t){return!t||"object"!==jL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GL(e){return(GL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qL(e,t){return(qL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VL={DocPage:function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),BL(this,GL(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qL(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement("div",{className:"doc-page-links"},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant?topic=cloudant-overview#overview",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"Documentation"),de.a.createElement("div",{className:"link-desc"},"The Cloudant Documentation Center contains information on Cloudant features, Language libraries, and the Cloudant API.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"https://www.ibm.com/cloudant",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"ibm.com/cloudant"),de.a.createElement("div",{className:"link-desc"},"The Cloudant homepage is a portal to numerous resources on Cloudant, including webinars, tutorials, case studies, and white papers.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"https://developer.ibm.com/clouddataservices/cloudant-learning-center/",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"Cloudant Learning Center"),de.a.createElement("div",{className:"link-desc"},"The Cloudant Learning Center contains numerous videos, tutorials, and the Cloudant API Reference.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"https://www.ibm.com/blogs/bluemix/?s=cloudant",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"Bluemix Blog"),de.a.createElement("div",{className:"link-desc"},"The Bluemix Blog contains posts on Cloudant within IBM Bluemix and related services for building applications with Cloudant.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"http://www.ibm.com/developerworks",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"developerWorks"),de.a.createElement("div",{className:"link-desc"},"IBM developerWorks is a technical resource center for software developers, and contains thousands of technical posts on Cloudant and Cloudant integrations with other products. IBM developerWorks has a ",de.a.createElement("a",{href:"https://developer.ibm.com/dwblog/search/?hq=more%3Anextdwblog&visual_q=cloudant&q=cloudant+more%3Anextdwblog",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"blog")," which has hundreds of posts on new Cloudant features and services and ",de.a.createElement("a",{href:"https://developer.ibm.com/answers/search.html?f=&type=question&redirect=search%2Fsearch&sort=relevance&q=cloudant",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"developerWorks Answers")," which has thousands of posted questions and answers about Cloudant and other products.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"http://stackoverflow.com/questions/tagged/cloudant",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"Stack Overflow"),de.a.createElement("div",{className:"link-desc"},"Stack Overflow contains thousands of posted questions and answers about Cloudant and other products. These forums are owned by the Stack Exchange Network.")),de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("a",{href:"https://www.youtube.com/user/CloudantInc/videos",target:"_blank",rel:"noopener noreferrer",className:"doc-link opens-new-window"},"Cloudant's YouTube channel"),de.a.createElement("div",{className:"link-desc"},"Cloudant's YouTube channel is regularly updated with videos explaining Cloudant features and functionality.")))}}])&&HL(n.prototype,a),r&&HL(n,r),t}(de.a.Component)},FL=new se.addon,KL=se.RouteObject.extend({routes:{doc:"showDocumentation"},selectedHeader:"Documentation",roles:["_admin"],showDocumentation:function(){return de.a.createElement(Nt,{component:de.a.createElement(VL.DocPage,null),crumbs:[{name:"Documentation"}]})}});FL.RouteObjects=[KL];var WL=FL;n(747);function XL(e){if(e&&e.altKey&&e.shiftKey&&86===e.keyCode){var t=document.getElementById("cloudant_dashboard_build");t&&t.innerText?window.alert("Cloudant Dashboard build:\n".concat(t.innerText)):window.alert("Cloudant Dashboard build information is not available")}}WL.initialize=function(){se.addHeaderLink({id:"Documentation",title:"Documentation",icon:"fonticon-bookmark",href:"#doc",bottomNav:!0,top:!0}),document.addEventListener("keyup",XL,!1)};var zL=WL;function YL(e){return(YL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QL(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function JL(e){return(JL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $L(e,t){return($L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ex,tx=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(n=!(r=JL(t).call(this,e))||"object"!==YL(r)&&"function"!=typeof r?ZL(a):r).updateKey=n.updateKey.bind(ZL(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$L(e,t)}(t,e),n=t,(a=[{key:"updateKey",value:function(e){this.props.onChange({iamApiKey:e})}},{key:"render",value:function(){var e=this,t=this.props.auth,n=t&&t.iamApiKey||"";return de.a.createElement("div",{className:"replication__section"},de.a.createElement("div",{className:"replication__input-label"}),de.a.createElement("div",null,de.a.createElement("input",{type:"password",placeholder:"IAM API Key",value:n,onChange:function(t){return e.updateKey(t.target.value)}})))}}])&&QL(n.prototype,a),r&&QL(n,r),t}(de.a.Component),nx=!1,ax=function(){se.registerExtension("Replication:Auth",{typeValue:"IBM_IAM",typeLabel:"IAM Authentication",inputComponent:tx,getCredentials:function(e){if(e.auth&&e.auth.iam)return{iamApiKey:e.auth.iam.api_key}},setCredentials:function(e,t){e.auth={iam:{api_key:t.iamApiKey}}}})},rx={initialize:function(){pS.userPromise.then((function(){if(!nx){ax();se.registerExtension("Replication:Auth-help",{authType:YD.REPLICATION_AUTH_METHOD.BASIC,helpText:"For security purposes, the IBM Cloudant team recommends that you use IAM API keys or IBM Cloudant legacy authentication API keys rather than account-level credentials for replication jobs."})}nx=!0}))}},ox="MONITORING_FETCHING_CLUSTER_NAME",ix="MONITORING_CHANGE_CLUSTER",sx="MONITORING_CLUSTER_NAME",cx="MONITORING_UPDATE_POLLING_FREQ",lx="MONITORING_CHANGE_RANGE",ux="MONITORING_HIDE_RANGE",dx="MONITORING_SHOW_RANGE",px="MONITORING_SHOW_REFRESH_CONTROLS",fx="MONITORING_HIDE_REFRESH_CONTROLS",hx="MONITORING_CHANGE_TAB",mx="MONITORING_HTTP_METRICS",gx="MONITORING_HTTP_STATUS_METRICS",bx="MONITORING_VIEW_EMITS_METRICS",yx="MONITORING_DOCS_PROCESSED_METRICS",Ex="MONITORING_DATA_VOLUME",_x="MONITORING_CLEAR_METRICS",vx="MONITORING_NODE_INFO",Sx="MONITORING_CHART_STATE",Nx="MONITORING_SET_USER_TYPE",Dx="MONITORING_GOT_CCM_USAGE",Ox="MONITORING_STOP_AUTO_UPDATE_CCM_CHART",wx={MAX_NODES_IN_REQUEST:4,POLLING:{DEFAULT_AUTO_REFRESH_FREQ_SECS:180,POLLING_STEP_SIZE:60,POLLING_FREQ_OPTIONS:[60,120,180,240,300,360,420,480,540,600]},DEFAULT_OVERVIEW_GRAPHS_RANGE:"24h",EVENTS:{COUNTDOWN_COMPLETE:"countdownComplete",REFRESH_CLUSTER:"refreshCluster",REFRESH_OVERVIEW:"refreshOverview",OVERVIEW_CHANGE_RANGE:"overviewChangeRange",SINGLE_CHART_LOADED:"singleChartLoaded",ALL_CHARTS_LOADED:"allChartsLoaded",TOGGLE_AUTO_REFRESH:"toggleAutoRefresh",CHANGE_AUTO_REFRESH_FREQ:"changeAutoRefreshFrequency",CLUSTER_TAB_SELECTED:"clusterTabSelected",UPDATE_API_URL:"updateAPIURL"},NODE_STATUSES:{UP:"UP",DOWN:"DOWN",NOLB:"NOLB"},LOCAL_STORAGE:{AUTO_REFRESH_ENABLED:"monitoringAutoRefreshEnabled",AUTO_REFRESH_FREQ:"monitoringAutoRefreshFrequency",OVERVIEW_GRAPHS_RANGE:"overviewGraphsRange",LAST_CLUSTER_NAME:"lastClusterName",HTTP_STATUS:"http-status",HTTP_REQUESTS:"http-requests"}},Tx=function(e){return function(e){return e.filter((function(e){return!s.a.isNull(e[0])}))}(e).map((function(e){return{value:e[0],epoch:e[1],date:new Date(1e3*e[1])}}))},Cx=function(e){var t=function(e){return ly.a.min(e.filter((function(e){return 0!==e.points.length})).map((function(e){return e.points.length})))}(e),n=t<200,a=Math.floor(t/200);return e.filter((function(e){return 0!==e.points.length&&(e.points=e.points.slice(0,t).filter((function(e,r){return n?r<=t-1:0===r||r%a==0})),e.mean=ly.a.mean(e.points,(function(e){return e.value})),e.mean<1&&(e.toggle=!0),!0)}))},Ax=function(e){var t=e.map((function(e){return e.points.length})),n=ly.a.min(t),a=s.a.range(0,n).map((function(){return 0}));return e.forEach((function(e){a=a.map((function(t,n){return t+e.points[n].value}))})),[0,ly.a.max(a)]},Ix=function(e){var t,n=((t=Cx(e.target_responses.map((function(e){return{name:e.target.split(" ")[1],points:Tx(e.datapoints),toggle:!1,mean:0}})))).length>1&&t.forEach((function(e,n){0!==n&&e.points.forEach((function(e,n){e.date=s.a.has(t[0].points[n],"date")?t[0].points[n].date:null,e.epoch=t[0].points[n].epoch}))})),t);return{datapoints:n,domain:Ax(n)}},Px=function(e){var t=e.url;return r.a.ajax({type:"GET",url:t,contentType:"application/json; charset=utf-8",dataType:"json"}).then((function(e){return Ix(e)}))},Rx=function(e){return function(t){return t.datapoints.forEach((function(t){var n=t.name.toLowerCase();s.a.isUndefined(e[n])||(t.toggle=e[n])})),t}},kx=function(e){var t=Object.keys(e)[0],n=Object.keys(e[t])[0],a=e[t][n];return a.name=n,a.cluster=t,a.memory&&Object.prototype.hasOwnProperty.call(a.memory,"Used")?a.memory=A.formatSize(a.memory.Used):a.memory=A.formatSize(a.memory.Processes),a.uptimeDate=h()().subtract(a.uptime,"seconds").format("dddd, MMMM Do YYYY, h:mm:ss a"),a.uptimeSince=h()().subtract(a.uptime,"seconds").fromNow(!0),a.statusExplain={UP:"This node is up",NOLB:"This node is not load balanced",DOWN:"This node is down"}[a.status],a.runQueue=a.run_queue,a.processes=a.process_count,a.osProcesses=a.os_proc_count,a},Lx=function(e,t){return r.a.ajax({type:"GET",url:"/_api/v2/clusters/status?force_complete=true&cluster=".concat(e,"&nodes=").concat(t),contentType:"application/json; charset=utf-8",dataType:"json"}).then(kx,function(e,t){return function(n){var a="An error occurred with this request.";if(n&&n.responseText){var r=JSON.parse(n.responseText);r.error&&(a=r.error)}return{name:t,cluster:e,error:a}}}(e,t))},xx=function(){ex&&window.clearInterval(ex)};function Ux(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Mx=function(e,t,n,a){Kx(),Wx(e,t,a),Xx(t,n)},jx=function(e,t){var n=parseInt(e,10);0===n||n>600?xx():function(e,t){xx(),ex=window.setInterval(t,e)}(1e3*n,t),se.dispatch({type:cx,data:n})},Hx=function(){xx()},Bx=function(e){if("cluster"===e)se.navigate("/monitoring/cluster",{replace:!0});else if("current_operations"===e)se.navigate("/monitoring/usage",{replace:!0});else if("denied_requests"===e)se.navigate("/monitoring/denied",{replace:!0});else if("storage"===e)se.navigate("/monitoring/storage",{replace:!0});else{if("metrics"!==e)return;se.navigate("/monitoring/overview",{replace:!0})}se.dispatch({type:hx,data:e})},Gx=function(e){se.dispatch({type:Nx,data:e})},qx=function(){se.dispatch({type:px})},Vx=function(){se.dispatch({type:fx})},Fx=function(e,t){var n=v("/_api/v2/clusters?admin=true").then((function(e){var t=e.clusters;return t?(t.forEach((function(e){e.nodes=e.nodes.map((function(e){return e.split(".")[0]}))})),t):[]}));se.Promise.all([n,pS.userPromise]).then((function(n){var a=Ux(n,1)[0];if((r=se.cloudantUser).isGlobalAdmin()||!s.a.isNull(r.adminCluster())){var r,o=function(e){var t=le.utils.localStorageGet(wx.LOCAL_STORAGE.LAST_CLUSTER_NAME),n=e.map((function(e){return e.cluster}));return t&&n.indexOf(t)>-1?t:e[0].cluster}(a);se.dispatch({type:sx,data:{clusters:a,userClusters:se.cloudantUser.get("admin_clusters"),selectedCluster:o}}),Wx(e,o,t),Xx(o,a.find((function(e){return e.cluster===o})).nodes)}}))},Kx=function(){se.dispatch({type:_x})},Wx=function(e,t,n){var a,o,i;(a={duration:e,cluster:t},o=n["http-requests"],i=r.a.param(a),Px({url:"/_api/v2/monitoring/rate/verb?".concat(i)}).then(Rx(o))).then((function(e){se.dispatch({type:mx,data:e})})),function(e,t){var n=r.a.param(e);return Px({url:"/_api/v2/monitoring/rate/status_code?".concat(n)}).then(Rx(t))}({duration:e,cluster:t},n["http-status"]).then((function(e){se.dispatch({type:gx,data:e})})),function(e){var t=r.a.param(e);return Px({url:"/_api/v2/monitoring/map_doc?".concat(t)}).then((function(e){return e.datapoints.length>0&&(e.datapoints[0].name="Docs"),e}))}({duration:e,cluster:t}).then((function(e){se.dispatch({type:yx,data:e})})),function(e){var t=r.a.param(e);return Px({url:"/_api/v2/monitoring/kv_emits?".concat(t)}).then((function(e){return e.datapoints.length>0&&(e.datapoints[0].name="Emits"),e}))}({duration:e,cluster:t}).then((function(e){se.dispatch({type:bx,data:e})})),function(e){var t=r.a.param(e);return Px({url:"/_api/v2/monitoring/disk_use?".concat(t)}).then((function(e){var t=ly.a.format(".0f");if(0===e.datapoints.length)return e;var n=e.datapoints.find((function(e){return"Used"===e.name})).points,a=e.datapoints.find((function(e){return"Free"===e.name})).points;return{domain:[0,100],datapoints:[{name:"Usage",toggle:!0,points:n.map((function(e,n){var r=a[n].value,o=e.value+r,i=py(r),s="".concat(t(r/i.pow2)," ").concat(i.unit);return{value:0===e.value?0:t(e.value/o*100),total:o,free:r,freeFormatted:s,epoch:e.epoch,date:e.date,symbol:"%"}}))}]}}))}({duration:e,cluster:t}).then((function(e){se.dispatch({type:Ex,data:e})}))},Xx=function(e,t){t.forEach((function(t){Lx(e,t).then((function(e){return se.dispatch({type:vx,data:e})}),(function(e){return se.dispatch({type:vx,data:e})}))}))},zx=function(e,t,n){se.dispatch({type:Sx,data:{chart:e,state:t,type:n}})},Yx=0,Qx=function(){se.Promise.all([v("/_api/v2/user/plan"),v("/_api/v2/user/ccm_diagnostics")]).then((function(e){var t=Ux(e,2),n=t[0],a=t[1];if(!n.throughput&&!n.plan){var r=Jx(n);throw new Error("Could not retrieve your plan details. ".concat(r))}if(!a.account){var o=Jx(a);throw new Error("Could not retrieve your service usage. ".concat(o))}Yx=0,se.dispatch({type:Dx,options:{usage:a,planDetails:n}})})).catch((function(e){if(!(++Yx<=3)){var t=e&&e.message?e.message:"Could not retrieve your service usage.";se.addNotification({msg:t,type:"error",clear:!0}),se.dispatch({type:Ox,options:{reason:t}})}}))};function Jx(e){return e.error?e.error:e.message?e.message:""}function Zx(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function $x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zx(n,!0).forEach((function(t){eU(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zx(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function eU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tU={};tU.MonitoringStore=se.Store.extend({initialize:function(){this._clusters=[],this._userClusters=[],this._selectedCluster="",this._isLoading=!1,this._pollingFreq=le.utils.localStorageGet(wx.LOCAL_STORAGE.AUTO_REFRESH_FREQ)||300,this._monitoringRange="7d",this._rangeVisible=!0,this._refreshControlsVisible=!1,this._selectedTab="network",this._monitoringRange=le.utils.localStorageGet(wx.LOCAL_STORAGE.OVERVIEW_GRAPHS_RANGE)||wx.DEFAULT_OVERVIEW_GRAPHS_RANGE,this._metrics={},this._nodeInfo={},this._isUserAdmin=void 0,this.loadChartState()},isUserInformationLoaded:function(){return void 0!==this._isUserAdmin},isUserAdmin:function(){return!0===this._isUserAdmin},loadChartState:function(){var e=function(e){var t=le.utils.localStorageGet(e);return t||{}};this._chartToggleStates={"http-status":e(wx.LOCAL_STORAGE.HTTP_STATUS),"http-requests":e(wx.LOCAL_STORAGE.HTTP_REQUESTS)}},toggleChartState:function(e){var t=e.chart,n=e.state,a=e.type;this._chartToggleStates[t][a.toLowerCase()]=!n,le.utils.localStorageSet(t,this._chartToggleStates[t])},getToggleChartState:function(){return this._chartToggleStates},setClusters:function(e){this._clusters=e},setUserClusters:function(e,t){this.setActiveCluster(t),this._userClusters=e},setActiveCluster:function(e){this._selectedCluster=e,le.utils.localStorageSet(wx.LOCAL_STORAGE.LAST_CLUSTER_NAME,e)},getSelectedCluster:function(){return this._selectedCluster},getClusterNames:function(){return this._userClusters},getClusters:function(){return this._clusters},isLoading:function(){return this._isLoading},hideRange:function(){this._rangeVisible=!1},showRange:function(){this._rangeVisible=!0},rangeVisible:function(){return this._rangeVisible},hideRefreshControls:function(){this._refreshControlsVisible=!1},showRefreshControls:function(){this._refreshControlsVisible=!0},refreshControlsVisible:function(){return this._refreshControlsVisible},updatePollingFreq:function(e){this._pollingFreq=e,le.utils.localStorageSet(wx.LOCAL_STORAGE.AUTO_REFRESH_FREQ,e)},changeRange:function(e){this._monitoringRange=e,le.utils.localStorageSet(wx.LOCAL_STORAGE.OVERVIEW_GRAPHS_RANGE,e)},changeTab:function(e){this._selectedTab=e},getSelectedTab:function(){return this._selectedTab},getPollingFreq:function(){return this._pollingFreq},getGraphRefresh:function(){return this._autoGraphRefresh},getMonitoringRange:function(){return this._monitoringRange},getHttpMetrics:function(){return this._metrics.http},getHttpStatusMetrics:function(){return this._metrics["http-status"]},getDocsProcessedMetrics:function(){return this._metrics["docs-processed"]},getViewEmitsMetrics:function(){return this._metrics["view-emits"]},getDataVolumeMetrics:function(){return this._metrics["data-volume"]},getSelectedClusterNodes:function(){return 0===this.getClusters().length?[]:this.getClusterNodes(this.getSelectedCluster())},getClusterNodes:function(e){return this.getClusters().find((function(t){return t.cluster===e})).nodes},getSeletedClusterNodesStatus:function(){return this._nodeInfo[this.getSelectedCluster()]||[]},setMetrics:function(e,t){this._metrics[e]=t},clearNodeInfo:function(){this._nodeInfo=[]},setNodeInfo:function(e){this._nodeInfo[e.cluster]||(this._nodeInfo[e.cluster]=[]),this._nodeInfo[e.cluster].push(e)},clearMetrics:function(){this._metrics={}},setCcmUsage:function(e){var t=e.usage,n=e.planDetails;if(this._ccmUsage=t,this._ccmPlanDetails=n,-1!==Object.keys(wx.NEW_BLUEMIX_PLANS).indexOf(this._ccmPlanDetails.plan)&&this._preSelectedPlan.multiple&&this._ccmPlanDetails.throughput){var a=this._ccmPlanDetails.throughput;this._ccmPlanDetails.throughput=$x({},this._ccmPlanDetails.throughput,{write:this._preSelectedPlan.multiple*a.write,query:this._preSelectedPlan.multiple*a.query,lookup:this._preSelectedPlan.multiple*a.lookup})}},dispatch:function(e){var t=e.type,n=e.data;switch(t){case ox:this._isLoading=!0;break;case sx:this._isLoading=!1,this.setClusters(n.clusters),this.setUserClusters(n.userClusters,n.selectedCluster);break;case ix:this.clearNodeInfo(),this.clearMetrics(),this.setActiveCluster(n);break;case ux:this.hideRange();break;case dx:this.showRange();break;case fx:this.hideRefreshControls();break;case px:this.showRefreshControls();break;case cx:this.updatePollingFreq(n);break;case lx:this.changeRange(n);break;case hx:this.changeTab(n);break;case mx:this.setMetrics("http",n);break;case gx:this.setMetrics("http-status",n);break;case yx:this.setMetrics("docs-processed",n);break;case bx:this.setMetrics("view-emits",n);break;case Ex:this.setMetrics("data-volume",n);break;case _x:this.clearMetrics(),this.clearNodeInfo();break;case vx:this.setNodeInfo(n);break;case Sx:this.toggleChartState(n);break;case Nx:this._isUserAdmin=n;break;default:return}this.triggerChange()}}),tU.monitoringStore=new tU.MonitoringStore,tU.monitoringStore.dispatchToken=se.dispatcher.register(tU.monitoringStore.dispatch.bind(tU.monitoringStore)),tU.CCMMonitoringStore=se.Store.extend({initialize:function(){this._ccmUsage={write:0,query:0,lookup:0},this._ccmPlanDetails={throughput:{write:0,query:0,lookup:0}},this._stopAutoUpdate=!1,this._stopAutoUpdateReason=null,this._userPlan=void 0,this._isAccountOnCcmPlan=!1},isAccountOnCcmPlan:function(){return this._isAccountOnCcmPlan},getCcmUsage:function(){return this._ccmUsage},getCcmPlanDetails:function(){return this._ccmPlanDetails},getStopAutoUpdateStatus:function(){return this._stopAutoUpdate},getStopAutoUpdateReason:function(){return this._stopAutoUpdateReason},setCcmUsage:function(e){var t=e.usage,n=e.planDetails;if(this._userPlan&&(this._ccmUsage=t,n.throughput&&(this._ccmPlanDetails=n),-1!==Object.keys(gy.NEW_BLUEMIX_PLANS).indexOf(this._ccmPlanDetails.plan)&&this._userPlan.multiple&&this._ccmPlanDetails.throughput)){var a=this._ccmPlanDetails.throughput;this._ccmPlanDetails.throughput=$x({},this._ccmPlanDetails.throughput,{write:this._userPlan.multiple*a.write,query:this._userPlan.multiple*a.query,lookup:this._userPlan.multiple*a.lookup})}},dispatch:function(e){var t=e.type,n=e.options;switch(t){case sy.USER_AUTHENTICATED:this._userPlan={id:n.plan,multiple:n.plan_multiple},this._isAccountOnCcmPlan=r_.isCcmPlan(n.plan);break;case Dx:this.setCcmUsage(n);break;case Ox:this._stopAutoUpdate=!0,this._stopAutoUpdateReason=n.reason;break;default:return}this.triggerChange()}}),tU.ccmMonitoringStore=new tU.CCMMonitoringStore,tU.ccmMonitoringStore.dispatchToken=se.dispatcher.register(tU.ccmMonitoringStore.dispatch.bind(tU.ccmMonitoringStore));var nU=tU,aU=function(e){var t=e.isVisible,n=e.monitoringRange,a=e.changeRange;return t?de.a.createElement("div",{className:"monitoring__duration"},de.a.createElement("label",{className:"monitoring__duration-text"},"Range:"),de.a.createElement("select",{className:"monitoring__duration-input",value:n,onChange:function(e){return a(e.target.value)}},de.a.createElement("option",{value:"7d"},"7 days"),de.a.createElement("option",{value:"3d"},"3 days"),de.a.createElement("option",{value:"24h"},"24 hours"),de.a.createElement("option",{value:"12h"},"12 hours"),de.a.createElement("option",{value:"30min"},"30 mins"),de.a.createElement("option",{value:"5min"},"5 mins"))):null},rU=function(e){var t=e.rangeVisible,n=e.monitoringRange,a=e.changeMonitoringRange,r=e.pollingAction;return de.a.createElement("div",{className:"monitoring__right-header"},de.a.createElement(aU,{monitoringRange:n,changeRange:a,isVisible:t}),de.a.createElement(Dr,{stepSize:wx.POLLING.POLLING_STEP_SIZE,pollingFreqOptions:wx.POLLING.POLLING_FREQ_OPTIONS,startValue:wx.POLLING.POLLING_FREQ_OPTIONS[Math.floor((wx.POLLING.POLLING_FREQ_OPTIONS.length-1)/2)],min:wx.POLLING.POLLING_FREQ_OPTIONS[0],max:wx.POLLING.POLLING_FREQ_OPTIONS[wx.POLLING.POLLING_FREQ_OPTIONS.length-1],onPoll:r}),de.a.createElement(Or,{refresh:r}))},oU=function(e){var t=e.clusters,n=e.selectedCluster,a=e.onChange;return de.a.createElement("div",{className:"monitoring__left-header"},de.a.createElement("label",{className:"monitoring__left-header-label"},"Monitoring > Cluster:"),de.a.createElement("select",{className:"monitoring__left-header-select",value:n,onChange:function(e){return a(e.target.value)}},t.map((function(e){return de.a.createElement("option",{key:e,value:e},e)}))))},iU=function(e){var t=e.clusterName,n=e.clusters,a=e.onClusterChange;return t?n.length>1?de.a.createElement(oU,{selectedCluster:t,clusters:n,onChange:a}):de.a.createElement(mt,{crumbs:[{name:"Monitoring"},{name:t}]}):null},sU=n(178),cU={Area:function(){this._width=100,this._height=100;var e={top:10,right:20,bottom:27,left:65},t=ly.a.time.scale(),n=ly.a.scale.linear(),a=ly.a.svg.line().x((function(e){return t(e.date)})).y((function(e){return n(e.value)})),r=ly.a.svg.area().x((function(e){return t(e.date)})).y0((function(){return n(0)})).y1((function(e){return n(e.value)})),o=ly.a.svg.axis().scale(t).tickPadding(10).orient("bottom"),i=ly.a.svg.axis().scale(n).tickPadding(10).ticks(5).orient("left");function s(c){s.selection=c,c.each((function(c){var l=s.width()-e.left-e.right,u=s.height()-e.top-e.bottom,d=s.httpColours();s.color=d,s.w1=l,s.margin=e,s.setXScale(t,c,l),n.range([u,0]),i.tickSize(-l),o.tickSize(-u);var p=ly.a.select(this).append("svg").attr("width",s.width()).attr("height",s.height()).append("g").attr("transform","translate(".concat(e.left,", ").concat(e.top,")"));p.append("g").attr("class","x axis");var f=ly.a.dispatch("toggle");s.renderLines=function(e,t){var c=e.selectAll(".line-group").data(t,(function(e){return e.name})),l=c.enter().append("g").attr("class","line-group");l.append("path").attr("class",(function(e){return"area-".concat(e.name," line area")})).style("fill",(function(e){return d(e.name)})),l.append("path").attr("class",(function(e){return"line-".concat(e.name," stroke-line")})).style("stroke",(function(e){return d(e.name)})),i.tickFormat(s.yAxisTickFormat),n.domain(s.yScaleDomain),s.setXAxis(e,o,u),e.append("g").attr("class","y axis").call(i),c.select(".line").attr("d",(function(e){return r(e.points)})),c.select(".stroke-line").attr("d",(function(e){return a(e.points)})),f.on("toggle",(function(e,t){s.toggleAreaLine(c,e,t)}))},s.margin=e,s.renderLines(p,c,!1),s.renderLegend(c,f,{toggleState:s.toggleState}),s.renderSlider(p,t,c,u,l)}))}return s.createGradient=function(e,t,n){var a=e.select("defs").append("linearGradient").attr("id","gradient-"+n).attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%").attr("spreadMethod","pad");a.append("stop").attr("offset","0%").attr("stop-color",t).attr("stop-opacity",.6),a.append("stop").attr("offset","100%").attr("stop-color",t).attr("stop-opacity",.1)},s._area=!1,s.area=function(){return s._area=!0,this},_.extend(s,sU.a),s},Line:function(){this._width=100,this._height=100;var e={top:10,right:20,bottom:20,left:65},t=ly.a.time.scale(),n=ly.a.scale.linear(),a=ly.a.svg.area().x((function(e){return t(e.date)})).y0((function(){return n(0)})).y1((function(e){return n(e.value)}));i.yScale=n,i.xScale=t;var r=ly.a.svg.axis().scale(t).tickPadding(10).orient("bottom"),o=ly.a.svg.axis().scale(n).ticks(5).tickPadding(10).orient("left");function i(s){i.selection=s,s.each((function(s){var c=i.width()-e.left-e.right,l=i.height()-e.top-e.bottom,u=i.httpColours();i.setXScale(t,s,c),n.range([l,0]),o.tickSize(-c),r.tickSize(-l),o.tickFormat(i.yAxisTickFormat),n.domain(i.yScaleDomain);var d=ly.a.select(this).append("svg").attr("width",i.width()).attr("height",i.height()).append("g").attr("transform","translate(".concat(e.left,", ").concat(e.top,")"));d.append("g").attr("class","x axis"),d.append("g").attr("class","y axis").call(o).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),i.renderLines=function(e,t){var n=e.selectAll(".line-group").data(t,(function(e){return e.name}));n.enter().append("g").attr("class","line-group");var o=n.selectAll(".line").data((function(e){return[e.points]}));o.enter().append("path").attr("class","realTimeline-line line").style("fill",(function(){return u("default")})),o.attr("d",a),i.setXAxis(e,r,l)},i.margin=e,i.renderLines(d,s,!1),i.renderSlider(d,t,s,l,c)}))}return _.extend(i,sU.a),i}};function lU(e){return(lU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uU(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function dU(e,t){return!t||"object"!==lU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pU(e){return(pU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fU(e,t){return(fU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hU=Jr.LoadLines,mU=function(){return de.a.createElement("div",{className:"monitoring__chart-nodata"},"Graph data is unavailable.")},gU=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),dU(this,pU(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fU(e,t)}(t,e),n=t,(a=[{key:"getEl",value:function(){return this.rootNode}},{key:"getElWidth",value:function(){return this.getEl().getBoundingClientRect().width}},{key:"renderChart",value:function(e){var t=e.metrics,n=t.datapoints,a=t.domain,r=e.toggleState,o=e.range,s=e.chartType;i.isEmpty(n)||i.isEmpty(n[0].points)||(this.chart=cU[s]({}),this.chartWidth=this.getElWidth(),this.chart.setToggleState(r).width(this.chartWidth).height(240).setYDomain(a).setXAxisTickFormat("5min"===o||"30min"===o?ly.a.time.format.multi([[":%S",function(e){return e.getSeconds()}],["%-I:%M %p",function(){return!0}]]):"12h"===o||"24h"===o?ly.a.time.format.multi([["%-I:%M %p",function(e){return e.getMinutes()}],["%-I %p",function(){return!0}]]):ly.a.time.format.multi([[":%S",function(e){return e.getSeconds()}],["%-I:%M %p",function(e){return e.getMinutes()}],["%-I %p",function(e){return e.getHours()}],["%a %e",function(e){return e.getDay()||0===e.getDay()}],["%Y",function(){return!0}]])).setYAxisTickFormat((function(e){return ly.a.format(",.0f")(e)})).legendEl(ly.a.select(this.getEl()).select(".monitoring__chart-legend")),ly.a.select(this.getEl()).select(".monitoring__chart-graph").datum(n).call(this.chart))}},{key:"componentDidMount",value:function(){var e=this;this.removeChart(),this.props.loading||this.renderChart(this.props),this.debounceReRender=function(){e.props.metrics&&(e.removeChart(),e.renderChart(e.props))},window.addEventListener("resize",this.debounceReRender),se.Events.on(se.constants.EVENTS.NAVBAR_SIZE_CHANGED,this.debounceReRender)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.debounceReRender),se.Events.off(se.constants.EVENTS.NAVBAR_SIZE_CHANGED,this.debounceReRender),this.removeChart()}},{key:"shouldComponentUpdate",value:function(e){return!this.props.loading&&e.loading?(this.removeChart(),!0):this.props.loading&&!e.loading?(this.removeChart(),!0):!(!e.metrics||!this.props.metrics||(e.metrics.domain[1]===this.props.metrics.domain[1]&&this.chartWidth===this.getElWidth()||(this.removeChart(),this.renderChart(e)),1))}},{key:"componentDidUpdate",value:function(e){!this.props.loading&&e.loading&&(this.removeChart(),this.renderChart(this.props))}},{key:"removeChart",value:function(){ly.a.select(this.getEl()).selectAll("svg").remove()}},{key:"showLoading",value:function(){return this.props.loading?de.a.createElement(hU,null):null}},{key:"showNoData",value:function(){return this.props.metrics&&this.props.metrics.datapoints&&0===this.props.metrics.datapoints.length?de.a.createElement(mU,null):null}},{key:"showFooter",value:function(){return"RealTimeLine"===this.props.chartType?null:de.a.createElement("div",{className:"monitoring__chart-footer"},de.a.createElement("div",{className:"monitoring__chart-legend"}))}},{key:"render",value:function(){var e=this;return de.a.createElement("div",{className:"monitoring__chart",ref:function(t){return e.rootNode=t}},de.a.createElement("h3",{className:"monitoring__chart-title"},this.props.name),this.showLoading(),this.showNoData(),de.a.createElement("div",{className:"monitoring__chart-graph"}),de.a.createElement("br",{style:{clear:"both"}}),this.showFooter())}}])&&uU(n.prototype,a),r&&uU(n,r),t}(de.a.Component),bU=function(e){var t=e.httpMetrics,n=e.httpStatusMetrics,a=e.docsProcessedMetrics,r=e.viewEmitsMetrics,o=e.dataVolumeMetrics,i=e.range,c=e.toggleChartState;return de.a.createElement("div",{className:"monitoring__overview",style:{padding:0,marginTop:"5px"}},de.a.createElement(gU,{loading:s.a.isUndefined(t),metrics:t,name:"HTTP Requests Received per Second",chartType:"Area",range:i,toggleState:c.bind(null,"http-requests")}),de.a.createElement(gU,{loading:s.a.isUndefined(n),metrics:n,name:"HTTP Status Codes Sent per Second",chartType:"Area",range:i,toggleState:c.bind(null,"http-status")}),de.a.createElement(gU,{loading:s.a.isUndefined(a),metrics:a,name:"Documents Processed by Map Functions per Second",chartType:"Line",range:i}),de.a.createElement(gU,{loading:s.a.isUndefined(r),metrics:r,name:"Key-Value Pairs Emitted into Indexes per Second",chartType:"Line",range:i}),de.a.createElement(gU,{loading:s.a.isUndefined(o),metrics:o,name:"Percentage of Disk Used",chartType:"Line",range:i}))};function yU(e){return(yU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EU(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _U(e,t){return!t||"object"!==yU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vU(e){return(vU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SU(e,t){return(SU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NU=Jr.LoadLines,DU=function(e){var t=e.node,n=t.osProcesses,a=t.name,r=t.status,o=t.memory,i=t.uptimeDate,s=t.uptimeSince,c=t.statusExplain,l=t.processes,u=t.runQueue,d=de.a.createElement(Ct.l,{id:"monitoring__cluster-table-time-tooltip"},i),p=de.a.createElement(Ct.l,{id:"monitoring__cluster-table-status-tooltip"},c);return de.a.createElement("tr",null,de.a.createElement("td",null,a),de.a.createElement("td",null,de.a.createElement(Ct.i,{placement:"bottom",overlay:p},de.a.createElement("span",{className:"label monitoring__cluster-table-status--".concat(r),width:70},r))),de.a.createElement("td",null,de.a.createElement(Ct.i,{placement:"bottom",overlay:d},de.a.createElement("span",null,s))),de.a.createElement("td",null,n),de.a.createElement("td",null,l),de.a.createElement("td",null,o),de.a.createElement("td",null,u))},OU=function(e){var t=e.node,n=t.error,a=t.name;return de.a.createElement("tr",null,de.a.createElement("td",null,a),de.a.createElement("td",null,de.a.createElement(Ct.e,{bsStyle:"danger"},"Error")),de.a.createElement("td",{colSpan:"5"},de.a.createElement("pre",null,n)))},wU=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_U(this,vU(t).call(this,e))).state={descending:!0,column:"name"},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SU(e,t)}(t,e),n=t,(a=[{key:"sort",value:function(e,t,n){var a=n.sort((function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}));return t||a.reverse(),a}},{key:"renderRows",value:function(){var e=this.state,t=e.column,n=e.descending;return this.sort(t,n,this.props.nodes).map((function(e){return e.error?de.a.createElement(OU,{key:"".concat(e.cluster,"-").concat(e.name),node:e}):de.a.createElement(DU,{key:"".concat(e.cluster,"-").concat(e.name),node:e})}))}},{key:"onClickOrder",value:function(e){var t=this;return function(){t.setState({descending:e!==t.state.column||!t.state.descending,column:e})}}},{key:"showSortIcon",value:function(e){return e!==this.state.column?"":this.state.descending?"fonticon-down-dir":"fonticon-up-dir"}},{key:"render",value:function(){return de.a.createElement(Ct.k,null,de.a.createElement("thead",null,de.a.createElement("tr",null,de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("name")},"Node",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("name"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("status")},"Status",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("status"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("uptimeSince")},"Uptime",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("uptimeSince"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("osProcesses")},"OS Proc.",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("osProcesses"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("processes")},"Processes",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("processes"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("memory")},"Memory",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("memory"))})),de.a.createElement("th",{className:"monitoring__cluster-table-header",onClick:this.onClickOrder("runQueue")},"Run Queue",de.a.createElement("span",{className:"monitoring__cluster-table-icon ".concat(this.showSortIcon("runQueue"))})))),de.a.createElement("tbody",null,this.renderRows()))}}])&&EU(n.prototype,a),r&&EU(n,r),t}(de.a.Component),TU=function(e){var t=e.cluster,n=e.nodes;return de.a.createElement("div",{className:"monitoring__cluster"},de.a.createElement(wU,{cluster:t,nodes:n}),0===n.length?de.a.createElement(NU,null):"")},CU=n(179);n(838);function AU(e){return(AU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IU(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function PU(e,t){return!t||"object"!==AU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RU(e){return(RU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kU(e,t){return(kU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LU=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),PU(this,RU(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kU(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.timestampData,n=e.usageData,a=e.reservedRate,r=e.showLegend,o={labels:t,datasets:[{label:"Throughput",data:n,borderWidth:1,fill:"origin",lineTension:0,pointRadius:0,backgroundColor:"#60D0C1",borderColor:"#00BAA1",type:"line"}]},i={legend:{display:!0===(void 0===r||r),fontSize:12,fontStyle:"ibm-plex-sans, 'Helvetica Neue', Arial, sans-serif",fontColor:"#1D364D"},tooltips:{intersect:!1},maintainAspectRatio:!1,animation:{duration:0},scales:{xAxes:[{type:"time",time:{tooltipFormat:"ll HH:mm:ss Z",displayFormats:{hour:"HH",minute:"HH:mm",second:"HH:mm:ss",millisecond:"HH:mm:ss.SSS"}}}],yAxes:[{id:"tp",stacked:!0,ticks:{reverse:!1,min:0,suggestedMax:1.2*a}}]}};return a&&(i.annotation={annotations:[{enabled:!0,type:"line",mode:"horizontal",scaleID:"tp",value:a,label:"Reserved Capacity",borderWidth:2,borderDash:[5,5],borderColor:"black",backgroundColor:"#f1f1f1"}]}),de.a.createElement(CU.a,{data:o,width:600,height:180,options:i})}}])&&IU(n.prototype,a),r&&IU(n,r),t}(ue.Component);function xU(e){return(xU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UU(){return(UU=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function MU(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jU(e,t){return!t||"object"!==xU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HU(e){return(HU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BU(e,t){return(BU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var GU=nU.ccmMonitoringStore,qU=hy.accountStore,VU=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=jU(this,HU(t).call(this,e))).state=n.getStoreState(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BU(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){var e=void 0,t=void 0,n=UU({},{deny429History:[],operationHistory:[]},GU.getCcmUsage());if(this.state){if(this.state&&this.state.ccmUsageHistory){e=this.state.ccmUsageHistory.slice(),t=this.state.ccm429History.slice();for(var a=0;a<n.operationHistory.length;a++){var r=n.operationHistory[a];r.ts=1e3*r.ts;var o=n.deny429History[a];o.ts=1e3*o.ts;var i=e[e.length-1];r.ts>i.ts&&(e.splice(0,1),e.push(r),t.splice(0,1),t.push(o))}}}else{e=[];for(var s=h()().subtract(900,"s"),c=0;c<900;c++)e.push({lookup:0,query:0,write:0,ts:s.add(1,"s").valueOf()});t=e}return{planDetails:GU.getCcmPlanDetails(),ccm429History:t||this.state.ccm429History,ccmUsageHistory:e||this.state.ccmUsageHistory,stopAutoUpdate:GU.getStopAutoUpdateStatus(),stopAutoUpdateReason:GU.getStopAutoUpdateReason()}}},{key:"componentDidMount",value:function(){GU.on("change",this.onChange,this),qU.on("change",this.onChange,this),Qx(),this.interval=window.setInterval((function(){Qx()}),3e3)}},{key:"componentWillUnmount",value:function(){GU.off("change",this.onChange),qU.off("change",this.onChange),window.clearInterval(this.interval)}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"UNSAFE_componentWillUpdate",value:function(e,t){t.stopAutoUpdate&&window.clearInterval(this.interval)}},{key:"render",value:function(){var e=this.state,t=e.planDetails,n=e.ccmUsageHistory,a=e.stopAutoUpdateReason,r=this.props.isCcmPlan?de.a.createElement(WU,null):null;return de.a.createElement("div",{className:"c-ccmsection"},de.a.createElement("div",null,de.a.createElement(KU,{planDetails:t,usageDataHistory:n,errorMessage:a,isCcmPlan:this.props.isCcmPlan})),r)}}])&&MU(n.prototype,a),r&&MU(n,r),t}(ue.Component),FU=function(e){var t=e.usageItem,n=e.currentUsage,a=e.reservedCapacity,r=e.usageHistory,o=e.showLegend,i=null;if(r){var s=r.map((function(e){return e.ts})),c=[];"Reads"===t?c=r.map((function(e){return e.lookup})):"Writes"===t?c=r.map((function(e){return e.write})):"Global Queries"===t&&(c=r.map((function(e){return e.query}))),i=de.a.createElement(LU,{timestampData:s,usageData:c,reservedRate:a,showLegend:o})}var l=null;return a>0&&(l=de.a.createElement("div",{className:"c-requestrate__reserved-rate-box"},"Reserved",de.a.createElement("br",null),de.a.createElement("span",{className:"c-requestrate__reserved-rate-value"},a," ops/s"))),de.a.createElement("div",{className:"c-requestrate__graph-row"},de.a.createElement("div",{className:"c-requestrate__graph-legend"},de.a.createElement("div",null,de.a.createElement("span",{className:"c-requestrate__graph-legend--mainlabel"},t),de.a.createElement("br",null),"(per second)")),de.a.createElement("div",{style:{padding:4}},i),de.a.createElement("div",{className:"c-requestrate__current-reserved-wrapper"},de.a.createElement("div",{className:"c-requestrate__current-reserved-box"},de.a.createElement("div",{className:"c-requestrate__current-rate-box"},"Throughput",de.a.createElement("br",null),de.a.createElement("span",{className:"c-requestrate__current-rate-value"},n," ",de.a.createElement("span",{className:"c-requestrate__current-rate-unit"},"ops/s"))),l)))},KU=function(e){var t,n=e.planDetails,a=e.usageDataHistory,r=e.errorMessage,o=e.isCcmPlan,i=a[a.length-1],s=i.write,c=i.query,l=i.lookup,u=n.throughput,d=r?de.a.createElement("div",{className:"alert alert-error"},"Something went wrong while retrieving your service usage. Try refreshing the page.",de.a.createElement("br",null),r):null;return t=o?de.a.createElement("div",{className:"c-requestratesection__desc"},"Your ",de.a.createElement("a",{href:"#account/plans"},"provisioned throughput capacity")," includes a reserved number of database operations (reads, writes, and queries) per second."):de.a.createElement("div",{className:"c-requestratesection__desc"},"The below graphs show a recent history of throughput against the Cloudant instance. This is for informative purposes only to help users who are migrating to Lite or Standard plan instances on the IBM Cloud which are priced based on provisioned throughput capacity and data volume. See the ",de.a.createElement("a",{href:"https://cloud.ibm.com/docs/services/Cloudant/guides?topic=cloudant-migrating-to-ibm-cloudant-on-ibm-cloud#migrating-to-ibm-cloudant-on-ibm-cloud",target:"_blank",rel:"noopener noreferrer"},"migration guide")," in our documentation for more information."),de.a.createElement("div",{className:"c-requestratesection"},d,de.a.createElement("div",{className:"c-ccmheading"},"Throughput"),de.a.createElement("br",null),de.a.createElement("div",{className:"c-ccmsection"},t,de.a.createElement("br",null),de.a.createElement(FU,{usageItem:"Reads",currentUsage:l,reservedCapacity:u.lookup,usageHistory:a}),de.a.createElement(FU,{usageItem:"Writes",currentUsage:s,reservedCapacity:u.write,usageHistory:a,showLegend:!1}),de.a.createElement(FU,{usageItem:"Global Queries",currentUsage:c,reservedCapacity:u.query,usageHistory:a,showLegend:!1}),de.a.createElement("div",null)))};KU.propTypes={usageDataHistory:tt.a.array.isRequired,planDetails:tt.a.shape({throughput:tt.a.object}).isRequired,isCcmPlan:tt.a.bool.isRequired};var WU=function(){return de.a.createElement("div",{className:"c-bluemix-tier-section"},de.a.createElement("div",{className:"c-ccmheading"},"Provisioning"),de.a.createElement("br",null),de.a.createElement("div",{className:"c-ccmsection"},de.a.createElement("div",{className:"c-bluemix-tier-section__desc"},"You can increase or decrease your account’s throughput capacity as the needs of your application change. To make a provisioning adjustment, visit the Cloudant dashboard’s ",de.a.createElement("a",{href:"#account/plans"},"provisioned capacity page"),".")))},XU=function(e){var t=e.limit,n=e.current,a=e.text,r=e.className,o="c-requestrate__barcontent--inlimit";n>=t&&(o="c-requestrate__barcontent--abovelimit");var i=200/t*Math.min(t,n),s={height:"".concat(i,"px"),width:"".concat(200/1.62,"px")},c=null,l=null;if(Number.isNaN(i)&&(i=0),i>25){l=de.a.createElement("div",{style:{color:"#fff",marginTop:"1px"},className:"c-requestrate__currentvalue"},n)}else{var u={color:"#000",bottom:"".concat(i+2,"px"),zIndex:5};c=de.a.createElement("div",{style:u,className:"c-requestrate__currentvalue"},n)}return de.a.createElement("div",{style:{width:"".concat(200/1.62,"px")},className:"flex-fill c-requestrate__wrapper ".concat(r)},de.a.createElement("div",{className:"c-requestrate__limit"},t,"/s"),de.a.createElement("div",{style:{height:"".concat(200,"px")},className:"c-requestrate__bar"},c,de.a.createElement("div",{className:"c-requestrate__barcontent "+o,style:s},l)),de.a.createElement("div",{className:"c-requestrate__text"},a))};function zU(e){return(zU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YU(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function QU(e,t){return!t||"object"!==zU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JU(e){return(JU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZU(e,t){return(ZU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}XU.propTypes={limit:tt.a.number.isRequired,current:tt.a.number.isRequired,text:tt.a.string.isRequired},XU.defaultProps={className:""};var $U=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),QU(this,JU(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZU(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.timestampData,n=e.denyData,a=e.showLegend,r={labels:t,datasets:[{label:"Rate limited",data:n,borderWidth:1,fill:"origin",lineTension:0,pointRadius:0,backgroundColor:"#ffd2dd",borderColor:"#ffd2dd",type:"line"}]},o={legend:{display:!0===(void 0!==a&&a),fontSize:12,fontStyle:"ibm-plex-sans, 'Helvetica Neue', Arial, sans-serif",fontColor:"#1D364D"},tooltips:{intersect:!1},maintainAspectRatio:!1,animation:{duration:0},scales:{xAxes:[{type:"time",time:{tooltipFormat:"ll HH:mm:ss Z",displayFormats:{hour:"HH",minute:"HH:mm",second:"HH:mm:ss",millisecond:"HH:mm:ss.SSS"}}}],yAxes:[{ticks:{reverse:!1,min:0,suggestedMax:10}}]}};return de.a.createElement(CU.a,{data:r,width:600,height:180,options:o})}}])&&YU(n.prototype,a),r&&YU(n,r),t}(ue.Component);function eM(e){return(eM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function nM(e,t){return!t||"object"!==eM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aM(e){return(aM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rM(e,t){return(rM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oM=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nM(this,aM(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rM(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.state,t=e.ccm429History,n=e.stopAutoUpdateReason;return de.a.createElement("div",{className:"c-ccmsection"},de.a.createElement("div",null,de.a.createElement(sM,{deny429History:t,errorMessage:n})))}}])&&tM(n.prototype,a),r&&tM(n,r),t}(VU),iM=function(e){var t=e.usageItem,n=e.currentValue,a=e.history,r=null;if(a){var o=a.map((function(e){return e.ts})),i=[];"Reads"===t?i=a.map((function(e){return e.lookup})):"Writes"===t?i=a.map((function(e){return e.write})):"Global Queries"===t&&(i=a.map((function(e){return e.query}))),r=de.a.createElement($U,{timestampData:o,denyData:i})}return de.a.createElement("div",{className:"c-requestrate__graph-row"},de.a.createElement("div",{className:"c-requestrate__graph-legend"},de.a.createElement("div",null,de.a.createElement("span",{className:"c-requestrate__graph-legend--mainlabel"},t),de.a.createElement("br",null),"(per second)")),de.a.createElement("div",{style:{padding:4}},r),de.a.createElement("div",{className:"c-requestrate__current-reserved-wrapper"},de.a.createElement("div",{className:"c-requestrate__current-reserved-box"},de.a.createElement("div",{className:"c-requestrate__current-rate-box"},"Limited",de.a.createElement("br",null),de.a.createElement("span",{className:"c-requestrate__current-rate-value"},n," ",de.a.createElement("span",{className:"c-requestrate__current-rate-unit"},"requests/s"))))))},sM=function(e){var t=e.deny429History,n=e.errorMessage,a=t[t.length-1],r=a.write,o=a.query,i=a.lookup,s=n?de.a.createElement("div",{className:"alert alert-error"},"Something went wrong while retrieving your service usage. Try refreshing the page.",de.a.createElement("br",null),n):null;return de.a.createElement("div",{className:"c-requestratesection"},s,de.a.createElement("div",{className:"c-ccmheading"},"Rate Limited Requests (429 status code)"),de.a.createElement("br",null),de.a.createElement("div",{className:"c-ccmsection"},de.a.createElement(iM,{usageItem:"Reads",currentValue:i,history:t}),de.a.createElement(iM,{usageItem:"Writes",currentValue:r,history:t}),de.a.createElement(iM,{usageItem:"Global Queries",currentValue:o,history:t}),de.a.createElement("div",null)))};sM.propTypes={deny429History:tt.a.array.isRequired};var cM=function(e){var t=e.limit,n=e.current,a=e.text,r=e.className,o="c-requestrate__barcontent--inlimit";n>=t&&(o="c-requestrate__barcontent--abovelimit");var i=200/t*Math.min(t,n),s={height:"".concat(i,"px"),width:"".concat(200/1.62,"px")},c=null,l=null;if(Number.isNaN(i)&&(i=0),i>25){l=de.a.createElement("div",{style:{color:"#fff",marginTop:"1px"},className:"c-requestrate__currentvalue"},n)}else{var u={color:"#000",bottom:"".concat(i+2,"px"),zIndex:5};c=de.a.createElement("div",{style:u,className:"c-requestrate__currentvalue"},n)}return de.a.createElement("div",{style:{width:"".concat(200/1.62,"px")},className:"flex-fill c-requestrate__wrapper ".concat(r)},de.a.createElement("div",{className:"c-requestrate__limit"},t,"/s"),de.a.createElement("div",{style:{height:"".concat(200,"px")},className:"c-requestrate__bar"},c,de.a.createElement("div",{className:"c-requestrate__barcontent "+o,style:s},l)),de.a.createElement("div",{className:"c-requestrate__text"},a))};function lM(e){return(lM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function dM(e,t){return!t||"object"!==lM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pM(e){return(pM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fM(e,t){return(fM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}cM.propTypes={limit:tt.a.number.isRequired,current:tt.a.number.isRequired,text:tt.a.string.isRequired},cM.defaultProps={className:""};var hM=nU.ccmMonitoringStore,mM=hy.accountStore,gM=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=dM(this,pM(t).call(this,e))).state=n.getStoreState(),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fM(e,t)}(t,e),n=t,(a=[{key:"getStoreState",value:function(){var e=mM.fetchingAccountUsageData();return void 0===e&&(e=!0),{dataVolumeData:mM.getDataVolumeData(),isFetchingAccountUsageData:e,stopAutoUpdate:hM.getStopAutoUpdateStatus()}}},{key:"componentDidMount",value:function(){hM.on("change",this.onChange,this),mM.on("change",this.onChange,this),Qx(),this.interval=window.setInterval((function(){Qx()}),3e3)}},{key:"componentWillUnmount",value:function(){hM.off("change",this.onChange),mM.off("change",this.onChange),window.clearInterval(this.interval)}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"UNSAFE_componentWillUpdate",value:function(e,t){t.stopAutoUpdate&&window.clearInterval(this.interval)}},{key:"shouldComponentUpdate",value:function(e,t){return!_.isEqual(t.dataVolumeData.sort(),this.state.dataVolumeData.sort())}},{key:"render",value:function(){var e=this.state,t=e.isFetchingAccountUsageData,n=e.dataVolumeData.map((function(e){return"geo"===e.name&&(e.name="Geospatial Indexes"),"search"===e.name&&(e.name="Search Indexes"),"views"===e.name&&(e.name="Views"),"dbs"===e.name&&(e.name="Databases"),e})),a=ly.a.format(".0f");return de.a.createElement("div",{className:"c-datavolumesection"},de.a.createElement("div",{className:"c-ccmsection"},de.a.createElement("div",{className:"c-datavolumesection__desc"},"Stored data includes your JSON documents, indexes, and attachments. Storage assessments occur once every 24 hours.",de.a.createElement("br",null),de.a.createElement("br",null),"Lite accounts that contain over 1 GB of data during storage-assessment will be locked. To unlock a locked account, upgrade to a paid plan, or delete data to return storage to under the 1 GB limit, and then wait for daily storage assessment to complete."),de.a.createElement("br",null),de.a.createElement("div",{className:"c-datavolumesection__chart"},de.a.createElement(N_,{yFormat:function(e){if(0===e)return"";var t=py(e);return"".concat(a(e/t.pow2)," ").concat(t.unit)},fetching:t,data:n,fudgeUnits:!1,shouldUpdate:function(){return!0}}))))}}])&&uM(n.prototype,a),r&&uM(n,r),t}(ue.Component);function bM(e){return(bM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yM(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _M(e,t,n){return t&&EM(e.prototype,t),n&&EM(e,n),e}function vM(e,t){return!t||"object"!==bM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SM(e){return(SM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NM(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DM(e,t)}function DM(e,t){return(DM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var OM=Jr.TabElementWrapper,wM=Jr.TabElement,TM=nU.monitoringStore,CM=nU.ccmMonitoringStore,AM=function(e){function t(e){return yM(this,t),vM(this,SM(t).call(this,e))}return NM(t,e),_M(t,[{key:"checked",value:function(e){return this.props.selectedTab===e}},{key:"render",value:function(){var e=this.props,t=e.onTabClick,n=e.showAdminTabs,a=e.showStorageTab,r=e.showRateLimitedOperationsTabs,o=null,i=null,s=null;n&&(o=de.a.createElement(wM,{selected:this.checked("metrics"),text:"Metrics",onChange:function(e){return t(e.target.value.toLowerCase())}}),i=de.a.createElement(wM,{selected:this.checked("cluster"),text:"Cluster",onChange:function(e){return t(e.target.value.toLowerCase())}})),a&&(s=de.a.createElement(wM,{selected:this.checked("storage"),text:"Storage",onChange:function(){return t("storage")}}));var c=r?de.a.createElement(wM,{selected:this.checked("current_operations"),text:"Current Operations",onChange:function(){return t("current_operations")}}):null,l=r?de.a.createElement(wM,{selected:this.checked("denied_requests"),text:"Denied Requests",onChange:function(){return t("denied_requests")}}):null;return de.a.createElement("div",{className:"monitoring__tabs-wrapper"},de.a.createElement(OM,null,c,l,s,o,i))}}]),t}(de.a.Component),IM=function(e){function t(e){var n;return yM(this,t),(n=vM(this,SM(t).call(this,e))).state=n.getStoreState(),n.adminTabs=["cluster","metrics"],n}return NM(t,e),_M(t,[{key:"getStoreState",value:function(){return{selectedTab:TM.getSelectedTab(),selectedCluster:TM.getSelectedCluster(),clusters:TM.getClusterNames(),nodes:TM.getSeletedClusterNodesStatus(),isLoadingMonitoringData:TM.isLoading(),httpMetrics:TM.getHttpMetrics(),httpStatusMetrics:TM.getHttpStatusMetrics(),docsProcessedMetrics:TM.getDocsProcessedMetrics(),viewEmitsMetrics:TM.getViewEmitsMetrics(),dataVolumeMetrics:TM.getDataVolumeMetrics(),duration:TM.getMonitoringRange(),graphRefresh:TM.getGraphRefresh(),pollingFreq:TM.getPollingFreq(),monitoringRange:TM.getMonitoringRange(),refreshControlsVisible:TM.refreshControlsVisible(),rangeVisible:TM.rangeVisible(),clusterNodes:TM.getSelectedClusterNodes(),chartState:TM.getToggleChartState(),isUserInformationLoaded:TM.isUserInformationLoaded(),isUserAdmin:TM.isUserAdmin(),isCcmPlan:CM.isAccountOnCcmPlan()}}},{key:"onChange",value:function(){this.setState(this.getStoreState())}},{key:"componentDidMount",value:function(){TM.on("change",this.onChange,this),this.updatePollingFreq(this.state.pollingFreq),this.state.isUserAdmin&&-1!==this.adminTabs.indexOf(this.state.selectedTab)&&Fx(this.state.monitoringRange,this.state.chartState)}},{key:"componentWillUnmount",value:function(){TM.off("change",this.onChange),Hx()}},{key:"componentDidUpdate",value:function(e,t){this.state.isUserAdmin&&-1!==this.adminTabs.indexOf(this.state.selectedTab)&&-1===this.adminTabs.indexOf(t.selectedTab)&&Fx(this.state.monitoringRange,this.state.chartState),this.state.isUserAdmin&&-1===this.adminTabs.indexOf(this.state.selectedTab)&&-1!==this.adminTabs.indexOf(t.selectedTab)&&Hx()}},{key:"showselectedTab",value:function(){return"cluster"===this.state.selectedTab?de.a.createElement(TU,{cluster:this.state.selectedCluster,nodes:this.state.nodes}):"current_operations"===this.state.selectedTab?de.a.createElement(VU,{isCcmPlan:this.state.isCcmPlan}):"denied_requests"===this.state.selectedTab?de.a.createElement(oM,null):"storage"===this.state.selectedTab?de.a.createElement(gM,null):de.a.createElement(bU,{loading:this.state.isLoadingMonitoringData,httpMetrics:this.state.httpMetrics,httpStatusMetrics:this.state.httpStatusMetrics,docsProcessedMetrics:this.state.docsProcessedMetrics,viewEmitsMetrics:this.state.viewEmitsMetrics,dataVolumeMetrics:this.state.dataVolumeMetrics,range:this.state.monitoringRange,toggleChartState:zx})}},{key:"refreshMonitoring",value:function(){this.state.isUserAdmin&&Mx(this.state.monitoringRange,this.state.selectedCluster,this.state.clusterNodes,this.state.chartState)}},{key:"changeCluster",value:function(e){!function(e,t,n,a){se.dispatch({type:ix,data:e}),Mx(t,e,n,a)}(e,this.state.monitoringRange,TM.getClusterNodes(e),this.state.chartState)}},{key:"changeMonitoringRange",value:function(e){!function(e,t,n){se.dispatch({type:lx,data:e}),Kx(),Wx(e,t,n)}(e,this.state.selectedCluster,this.state.chartState)}},{key:"updatePollingFreq",value:function(e){jx(e,this.refreshMonitoring.bind(this))}},{key:"monitoringHeaderTitle",value:function(){return de.a.createElement("div",{className:"monitoring__left-header"},de.a.createElement("label",{className:"monitoring__left-header-label"},"Monitoring"))}},{key:"leftHeader",value:function(){var e=this.state.selectedTab,t=this.monitoringHeaderTitle();if(-1!==["metrics","cluster"].indexOf(e)){var n=this.state,a=n.selectedCluster,r=n.clusters;t=de.a.createElement("div",{className:"flex-body"},de.a.createElement(iU,{onClusterChange:this.changeCluster.bind(this),clusters:r,clusterName:a}))}return de.a.createElement("div",{className:"flex-body"},t)}},{key:"render",value:function(){var e=this.state,t=e.selectedCluster,n=e.isLoadingMonitoringData,a=e.refreshControlsVisible,r=e.rangeVisible,o=e.pollingFreq,i=e.graphRefresh,s=e.monitoringRange,c=e.isUserInformationLoaded,l=e.isUserAdmin,u=e.isCcmPlan,d=e.selectedTab;if(!c)return de.a.createElement("div",{id:"dashboard",className:"template-with-sidebar flex-layout flex-col"},de.a.createElement("header",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-layout flex-row",style:{boxShadow:"none"}},de.a.createElement("div",{className:"flex-body"},this.monitoringHeaderTitle()))),de.a.createElement("div",{style:{paddingTop:60}},de.a.createElement(Jr.LoadLines,null)));var p=null;a&&(p=de.a.createElement("div",{id:"right-header",className:"flex-fill"},de.a.createElement(rU,{changeMonitoringRange:this.changeMonitoringRange.bind(this),clusterName:t,rangeVisible:r,pollingFreq:o,graphRefresh:i,monitoringRange:s,pollingAction:this.refreshMonitoring.bind(this),updatePollingFreq:this.updatePollingFreq.bind(this)})));var f=n?de.a.createElement(Jr.LoadLines,null):this.showselectedTab();return de.a.createElement("div",{id:"dashboard",className:"template-with-sidebar flex-layout flex-col"},de.a.createElement("header",{className:"flex-layout flex-row"},de.a.createElement("div",{className:"flex-layout flex-row",style:{boxShadow:"none"}},this.leftHeader(),p,de.a.createElement("div",{id:"api-navbar",className:"flex-fill"}),de.a.createElement("div",{id:"notification-center-btn",className:"flex-fill"}))),de.a.createElement("div",{className:"template-content flex-body flex-layout flex-col"},de.a.createElement(AM,{selectedTab:d,onTabClick:Bx,showAdminTabs:l,showStorageTab:u,showRateLimitedOperationsTabs:u}),de.a.createElement("div",{id:"dashboard-content",className:"flex-body"},f)))}}]),t}(de.a.Component),PM={RouteObjects:[se.RouteObject.extend({routes:{monitoring:"redirect","monitoring/overview":"overviewPage","monitoring/cluster":"clusterPage","monitoring/usage":"showUsage","monitoring/denied":"showDenied","monitoring/storage":"showStorage"},selectedHeader:"Monitoring",roles:["_admin"],initialize:function(){this.user=se.cloudantUser},redirect:function(){pS.userPromise.then((function(){var e=r_.isCcmPlan(pS.user.get("plan"))?"#monitoring/usage":"#monitoring/overview";se.navigate(e,{redirect:!0})}))},overviewPage:function(){return qx(),se.dispatch({type:dx}),Bx("metrics"),de.a.createElement(IM,null)},clusterPage:function(){return qx(),se.dispatch({type:ux}),Bx("cluster"),de.a.createElement(IM,null)},showUsage:function(){return Vx(),Bx("current_operations"),de.a.createElement(IM,null)},showDenied:function(){return Vx(),Bx("denied_requests"),de.a.createElement(IM,null)},showStorage:function(){return GE.initUsageGraph(),Vx(),Bx("storage"),de.a.createElement(IM,null)}})]},RM=(n(844),pS.userPromise);PM.initialize=function(){RM.then((function(){var e=pS.user,t=!0;e.isGlobalAdmin()||!_.isNull(e.adminCluster())?Gx(!0):(Gx(!1),r_.isCcmPlan(e.get("plan"))||(t=!1)),t&&se.addHeaderLink({title:"Monitoring",href:"#monitoring",icon:"fonticon-dashboard",top:!0})}))};var kM=[Re,{initialize:function(){}},ri,ob,gS,rN,SN,sD,WD,DC,nI,ry,iy,OP,YR,pS,$R,Lk,ML,zL,rx,PM];function LM(e){return(LM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function UM(e){return(UM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jM(e,t){return(jM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function HM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var BM=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=UM(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==LM(r)&&"function"!=typeof r?MM(a):r,HM(MM(n),"hide",(function(e){e&&e.preventDefault(),n.props.onStartHide(n.props.notificationId)})),HM(MM(n),"getMsg",(function(){return{__html:n.props.escape?_.escape(n.props.msg):n.props.msg}})),HM(MM(n),"onAnimationComplete",(function(){n.props.isHiding&&window.setTimeout((function(){return n.props.onHideComplete(n.props.notificationId)}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jM(e,t)}(t,e),n=t,(a=[{key:"componentWillUnmount",value:function(){this.timeout&&window.clearTimeout(this.timeout)}},{key:"componentDidMount",value:function(){this.timeout=setTimeout(this.hide,this.props.visibleTime)}},{key:"render",value:function(){var e=this,t=this.props,n=t.style,a=t.notificationId;return 0===n.opacity&&this.props.isHiding&&this.onAnimationComplete(),de.a.createElement("div",{key:a.toString(),className:"notification-wrapper",style:{opacity:n.opacity,minHeight:n.minHeight+"px"}},de.a.createElement("div",{style:{opacity:n.opacity,minHeight:n.minHeight+"px"},className:"global-notification alert alert-"+this.props.type,ref:function(t){return e.notification=t}},de.a.createElement("a",{"data-bypass":!0,href:"#",onClick:this.hide},de.a.createElement("i",{className:"pull-right fonticon-cancel"})),de.a.createElement("i",{className:"notification-icon "+{error:"fonticon-attention-circled",info:"fonticon-info-circled",success:"fonticon-ok-circled"}[this.props.type]}),de.a.createElement("span",{dangerouslySetInnerHTML:this.getMsg()})))}}])&&xM(n.prototype,a),r&&xM(n,r),t}(de.a.Component);function GM(e){return(GM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function VM(e){return(VM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KM(e,t){return(KM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}HM(BM,"propTypes",{notificationId:tt.a.number.isRequired,msg:tt.a.string.isRequired,onStartHide:tt.a.func.isRequired,onHideComplete:tt.a.func.isRequired,type:tt.a.oneOf(["error","info","success"]),escape:tt.a.bool,isHiding:tt.a.bool.isRequired,visibleTime:tt.a.number}),HM(BM,"defaultProps",{type:"info",visibleTime:8e3,escape:!0});var XM=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=VM(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==GM(r)&&"function"!=typeof r?FM(a):r,WM(FM(n),"onKeyDown",(function(e){27===(e.keyCode||e.which)&&n.props.hideAllVisibleNotifications()})),WM(FM(n),"getNotifications",(function(){return n.props.notifications.length?n.props.notifications.map((function(e,t){if(e.visible)return de.a.createElement(BM,{notificationId:e.notificationId,isHiding:e.isHiding,key:t,msg:e.msg,type:e.type,escape:e.escape,visibleTime:e.visibleTime,onStartHide:n.props.startHidingNotification,onHideComplete:n.props.hideNotification})})):null})),WM(FM(n),"getchildren",(function(e){var t=e.map((function(e){var t=e.key,a=e.data,r=e.style,o=a;return de.a.createElement(BM,{key:t,style:r,notificationId:o.notificationId,isHiding:o.isHiding,msg:o.msg,type:o.type,escape:o.escape,visibleTime:o.visibleTime,onStartHide:n.props.startHidingNotification,onHideComplete:n.props.hideNotification})}));return de.a.createElement("div",null,t)})),WM(FM(n),"getStyles",(function(e){return e||(e=[]),n.props.notifications.filter((function(e){return e.visible})).map((function(t){var n=!e.find((function(e){return e.key===t.notificationId.toString()}))&&{opacity:.5,minHeight:50};return n||t.isHiding?!n&&t.isHiding&&(n={opacity:Object(Wa.spring)(0,Wa.presets.stiff),minHeight:Object(Wa.spring)(0,Wa.presets.stiff)}):n={opacity:Object(Wa.spring)(1,Wa.presets.stiff),minHeight:Object(Wa.spring)(64)},{key:t.notificationId.toString(),style:n,data:t}}))})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KM(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown)}},{key:"render",value:function(){return de.a.createElement("div",{id:"global-notifications",role:"alert"},de.a.createElement(Wa.TransitionMotion,{styles:this.getStyles},this.getchildren))}}])&&qM(n.prototype,a),r&&qM(n,r),t}(de.a.Component);WM(XM,"propTypes",{notifications:tt.a.array.isRequired,hideAllVisibleNotifications:tt.a.func.isRequired,startHidingNotification:tt.a.func.isRequired,hideNotification:tt.a.func.isRequired});var zM=Object(nt.b)((function(e){return{notifications:e.notifications.notifications}}),(function(e){return{startHidingNotification:function(t){e(function(e){return function(t){t({type:Ee.START_HIDING_NOTIFICATION,options:{notificationId:e}})}}(t))},hideNotification:function(t){e(function(e){return function(t){t({type:Ee.HIDE_NOTIFICATION,options:{notificationId:e}})}}(t))},hideAllVisibleNotifications:function(){e((function(e){e({type:Ee.HIDE_ALL_NOTIFICATIONS})}))}}}))(XM);function YM(e){return(YM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QM(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function JM(e){return(JM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZM(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $M(e,t){return($M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ej(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tj=Jr.Copy,nj=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=JM(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==YM(r)&&"function"!=typeof r?ZM(a):r,ej(ZM(n),"clearNotification",(function(){var e=n.props.item.notificationId;n.props.clearSingleNotification(e)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$M(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this.props.item.time.fromNow(),t="fonticon "+{success:"fonticon-ok-circled",error:"fonticon-attention-circled",info:"fonticon-info-circled"}[this.props.item.type],n="all"!==this.props.filter&&this.props.filter!==this.props.item.type,a=this.props.style,r=a.opacity,o=a.height;return 0===r&&0===o?null:de.a.createElement("li",{style:{opactiy:r,height:o+"px",borderBottomColor:"rgba(34, 34, 34, ".concat(r,")")},"aria-hidden":n},de.a.createElement("div",{className:"flex-layout flex-row"},de.a.createElement("span",{className:t}),de.a.createElement("div",{className:"flex-body"},de.a.createElement("p",null,this.props.item.cleanMsg),de.a.createElement("div",{className:"notification-actions"},de.a.createElement("span",{className:"time-elapsed"},e),de.a.createElement("span",{className:"divider"},"|"),de.a.createElement(tj,{uniqueKey:Ec.a.v4(),text:this.props.item.cleanMsg,displayType:"text"}))),de.a.createElement("button",{type:"button",onClick:this.clearNotification},"×")))}}])&&QM(n.prototype,a),r&&QM(n,r),t}(de.a.Component);function aj(e){return(aj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rj(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function oj(e){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ij(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sj(e,t){return(sj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ej(nj,"propTypes",{item:tt.a.object.isRequired,filter:tt.a.string.isRequired,clearSingleNotification:tt.a.func.isRequired});var lj=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=oj(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==aj(r)&&"function"!=typeof r?ij(a):r,cj(ij(n),"getNotifications",(function(e){var t;return t=e.length||n.props.notifications.length?e.map((function(e){var t=e.key,a=e.data,r=e.style;return de.a.createElement(nj,{item:a,filter:n.props.filter,clearSingleNotification:n.props.clearSingleNotification,key:t,style:r})})):de.a.createElement("li",{className:"no-notifications"},"No notifications."),de.a.createElement("ul",{className:"notification-list"},t)})),cj(ij(n),"getStyles",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=n.props.notifications.map((function(t){var a=!e.find((function(e){return e.key===t.notificationId.toString()}))&&{opacity:0,height:0};return a||t.type!==n.props.filter&&"all"!==n.props.filter?t.type!==n.props.filter&&(a={opacity:Object(Wa.spring)(0,Wa.presets.stiff),height:Object(Wa.spring)(0,Wa.presets.stiff)}):a={opacity:Object(Wa.spring)(1,Wa.presets.stiff),height:Object(Wa.spring)(61,Wa.presets.stiff)},{key:t.notificationId.toString(),style:a,data:t}}));return t})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sj(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){var e=this;if(!this.props.isVisible&&0===this.props.style.x)return null;var t={all:"flex-body",success:"flex-body",error:"flex-body",info:"flex-body"};t[this.props.filter]+=" selected";var n="notification-page-mask ".concat(this.props.isVisible?" visible":"");return de.a.createElement("div",{id:"notification-center"},de.a.createElement("div",{className:"notification-center-panel flex-layout flex-col visible",style:{transform:"translate(".concat(this.props.style.x,"px)")}},de.a.createElement("header",{className:"flex-layout flex-row"},de.a.createElement("span",{className:"fonticon fonticon-bell"}),de.a.createElement("h1",{className:"flex-body"},"Notifications"),de.a.createElement("button",{"aria-label":"Hide Notifications Center",type:"button",onClick:this.props.hideNotificationCenter},"×")),de.a.createElement("ul",{"aria-label":"Filters",className:"notification-filter flex-layout flex-row"},de.a.createElement("li",{className:t.all,title:"All notifications","data-filter":"all",onClick:function(){return e.props.selectNotificationFilter("all")}},"All"),de.a.createElement("li",{className:t.success,title:"Success notifications","data-filter":"success",onClick:function(){return e.props.selectNotificationFilter("success")}},de.a.createElement("span",{className:"fonticon fonticon-ok-circled"})),de.a.createElement("li",{className:t.error,title:"Error notifications","data-filter":"error",onClick:function(){return e.props.selectNotificationFilter("error")}},de.a.createElement("span",{className:"fonticon fonticon-attention-circled"})),de.a.createElement("li",{className:t.info,title:"Info notifications","data-filter":"info",onClick:function(){return e.props.selectNotificationFilter("info")}},de.a.createElement("span",{className:"fonticon fonticon-info-circled"}))),de.a.createElement("div",{className:"flex-body"},de.a.createElement(Wa.TransitionMotion,{styles:this.getStyles},this.getNotifications)),de.a.createElement("footer",null,de.a.createElement("input",{type:"button",value:"Clear All",className:"btn btn-small btn-secondary",onClick:this.props.clearAllNotifications}))),de.a.createElement("div",{className:n,onClick:this.props.hideNotificationCenter}))}}])&&rj(n.prototype,a),r&&rj(n,r),t}(de.a.Component);function uj(e){return(uj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dj(){return(dj=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function pj(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function fj(e){return(fj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mj(e,t){return(mj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}cj(lj,"propTypes",{isVisible:tt.a.bool.isRequired,filter:tt.a.string.isRequired,notifications:tt.a.array.isRequired,hideNotificationCenter:tt.a.func.isRequired,selectNotificationFilter:tt.a.func.isRequired,clearAllNotifications:tt.a.func.isRequired,clearSingleNotification:tt.a.func.isRequired});var bj=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return a=this,r=(e=fj(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==uj(r)&&"function"!=typeof r?hj(a):r,gj(hj(n),"getStyles",(function(){var e={key:"1",style:{x:320}};return n.props.isVisible?e.style={x:Object(Wa.spring)(0)}:e.style={x:Object(Wa.spring)(320)},[e]})),gj(hj(n),"getNotificationCenterPanel",(function(e){var t=e.map((function(e){var t=e.style;return de.a.createElement(lj,dj({key:"1",style:t},n.props))}));return de.a.createElement("aside",{"aria-label":"Notifications"},t)})),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mj(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return de.a.createElement(Wa.TransitionMotion,{styles:this.getStyles},this.getNotificationCenterPanel)}}])&&pj(n.prototype,a),r&&pj(n,r),t}(de.a.Component),yj=Object(nt.b)((function(e){var t=e.notifications;return{isVisible:t.notificationCenterVisible,filter:t.selectedNotificationFilter,notifications:t.notifications}}),(function(e){return{hideNotificationCenter:function(){e((function(e){e({type:Ee.HIDE_NOTIFICATION_CENTER})}))},selectNotificationFilter:function(t){e(function(e){return function(t){t({type:Ee.SELECT_NOTIFICATION_FILTER,options:{filter:e}})}}(t))},clearAllNotifications:function(){e((function(e){e({type:Ee.CLEAR_ALL_NOTIFICATIONS})}))},clearSingleNotification:function(t){e(function(e){return function(t){t({type:Ee.CLEAR_SINGLE_NOTIFICATION,options:{notificationId:e}})}}(t))}}}))(bj);function Ej(e){return(Ej="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _j(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function vj(e,t){return!t||"object"!==Ej(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sj(e){return(Sj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nj(e,t){return(Nj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dj(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Oj=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vj(this,Sj(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nj(e,t)}(t,e),n=t,(a=[{key:"getMsg",value:function(){return{__html:this.props.message}}},{key:"getContent",value:function(){return this.props.visible&&this.props.message?de.a.createElement("p",{className:"perma-warning__content",dangerouslySetInnerHTML:this.getMsg()}):null}},{key:"render",value:function(){return de.a.createElement("div",{id:"perma-warning"},this.getContent())}}])&&_j(n.prototype,a),r&&_j(n,r),t}(de.a.Component);Dj(Oj,"defaultProps",{visible:!1}),Dj(Oj,"propTypes",{visible:tt.a.bool.isRequired,message:tt.a.string});var wj=Object(nt.b)((function(e){var t=e.notifications;return{visible:t.permanentNotificationVisible,message:t.permanentNotificationMessage}}))(Oj),Tj=function(e){var t=e.version;return t?de.a.createElement("div",{className:"faux-navbar__version-footer"},"Fauxton on  ",de.a.createElement("a",{href:"http://couchdb.apache.org/"},"Apache CouchDB"),de.a.createElement("div",null,"v. ",t)):null};Tj.propTypes={version:tt.a.string};var Cj=Tj,Aj=function(e){var t=e.toggleMenu,n=e.isMinimized,a=Tt()("faux-navbar__burger",{"faux-navbar--wide":!n},{"faux-navbar--narrow":n}),r=n?"icon-resize-horizontal":"icon-signin faux-navbar__burger__icon--flipped";return de.a.createElement("div",{"aria-expanded":!n,"aria-label":"Toggle Navigation Menu",className:a,onClick:t,role:"button",tabIndex:"0"},de.a.createElement("i",{"aria-hidden":"true",className:"faux-navbar__burger__icon "+r}))};Aj.propTypes={toggleMenu:tt.a.func.isRequired,isMinimized:tt.a.bool.isRequired};var Ij=Aj,Pj=function(e){var t=e.link,n=e.active,a=e.isMinimized,r=n===t.title,o=Tt()("faux-navbar__link",{"faux-navbar__link--active":r},{"faux-navbar__link--inactive":!r},{"faux-navbar--wide":!a},{"faux-navbar--narrow":a}),i=a?null:de.a.createElement("span",{className:"faux-navbar__text"},t.title),s=null;return t.icon&&(s=de.a.createElement("i",{"aria-hidden":"true",className:Tt()(t.icon,"fonticon faux-navbar__icon",{"faux-navbar__icon-badge":t.badge})})),de.a.createElement("a",{"aria-current":r?"page":null,"aria-label":t.title,className:o,href:t.href,target:t.target?"_blank":null,"data-bypass":t.target?"true":null},de.a.createElement("div",{"data-nav-name":t.title,className:"faux-navbar__itemarea"},s,i))};Pj.propTypes={link:tt.a.object.isRequired,active:tt.a.string,isMinimized:tt.a.bool.isRequired};var Rj=Pj,kj=function(e){var t=e.isMinimized,n=Tt()("faux-navbar__brand-logo",{"faux-navbar__brand-logo--wide":!t},{"faux-navbar__brand-logo--narrow":t});return de.a.createElement("div",{className:"faux-navbar__brand"},de.a.createElement("div",{className:n}))};kj.propTypes={isMinimized:tt.a.bool.isRequired};var Lj=kj,xj=function(e){var t=e.username,n=e.isMinimized,a=Tt()("faux-navbar__logout__textcontainer",{"faux-navbar__logout__textcontainer--narrow":n},{"faux-navbar__logout__textcontainer--wide":!n});return de.a.createElement("a",{className:"faux-logout__link",href:"#/logout"},de.a.createElement("div",{className:a},de.a.createElement("span",{className:"faux-navbar__logout__text"},"Log Out")," ",n?null:de.a.createElement("span",{className:"faux-navbar__logout__username"},s.a.escape(t))))};xj.propTypes={username:tt.a.string,isMinimized:tt.a.bool.isRequired};var Uj=xj,Mj=function(e){var t=e.isMinimized,n=Tt()("faux-navbar__login__textcontainer",{"faux-navbar__login__textcontainer--narrow":t},{"faux-navbar__login__textcontainer--wide":!t});return de.a.createElement("a",{className:"faux-login__link",href:"#/login"},de.a.createElement("div",{className:n},de.a.createElement("span",{className:"faux-navbar__logout__text"},"Login")))};Mj.propTypes={isMinimized:tt.a.bool.isRequired};var jj=Mj;function Hj(e){return(Hj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bj(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gj(e,t){return!t||"object"!==Hj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qj(e){return(qj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vj(e,t){return(Vj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fj=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Gj(this,qj(t).call(this,e))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vj(e,t)}(t,e),n=t,(a=[{key:"createLinks",value:function(e){var t=this.props,n=t.activeLink,a=t.isMinimized;return e.map((function(e,t){return de.a.createElement(Rj,{key:t,link:e,active:n,isMinimized:a})}))}},{key:"render",value:function(){var e=this.props,t=e.isMinimized,n=e.version,a=e.isLoginSectionVisible,r=e.isLoginVisibleInsteadOfLogout,o=e.activeLink,i=e.username,s=e.isNavBarVisible,c=e.toggleNavbarMenu;if(!s)return null;var l=this.createLinks(this.props.navLinks),u=this.createLinks(this.props.bottomNavLinks),d=this.createLinks(this.props.footerNavLinks),p=Tt()("faux-navbar",{"faux-navbar--wide":!t},{"faux-navbar--narrow":t}),f=r?de.a.createElement(jj,{active:o,isMinimized:t}):de.a.createElement(Uj,{username:i,isMinimized:t});return de.a.createElement("div",{className:p},de.a.createElement("nav",null,de.a.createElement("div",{className:"faux-navbar__linkcontainer"},de.a.createElement(Ij,{isMinimized:t,toggleMenu:c}),de.a.createElement("div",{className:"faux-navbar__links"},l,u),de.a.createElement("div",{className:"faux-navbar__footer"},de.a.createElement(Lj,{isMinimized:t}),de.a.createElement("div",null,d),de.a.createElement(Cj,{version:n}),a?f:null))))}}])&&Bj(n.prototype,a),r&&Bj(n,r),t}(ue.Component);Fj.propTypes={activeLink:tt.a.string,isMinimized:tt.a.bool.isRequired,version:tt.a.string,username:tt.a.string,navLinks:tt.a.array,bottomNavLinks:tt.a.array,footerNavLinks:tt.a.array,isNavBarVisible:tt.a.bool,isLoginSectionVisible:tt.a.bool.isRequired,isLoginVisibleInsteadOfLogout:tt.a.bool.isRequired,toggleNavbarMenu:tt.a.func.isRequired};var Kj=Fj,Wj=Object(nt.b)((function(e){var t=e.navigation,n=se.session.user();return{navLinks:t.navLinks,bottomNavLinks:t.bottomNavLinks,footerNavLinks:t.footerNavLinks,activeLink:t.activeLink,version:t.version,isMinimized:t.isMinimized,isNavBarVisible:t.navBarVisible,isLoginSectionVisible:t.loginSectionVisible,isLoginVisibleInsteadOfLogout:t.loginVisibleInsteadOfLogout,username:n&&n.name?n.name:""}}),(function(e){return{toggleNavbarMenu:function(){e((function(e){e({type:pe.TOGGLE_NAVBAR_MENU})}))}}}))(Kj);function Xj(e){return(Xj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yj(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qj(e,t,n){return t&&Yj(e.prototype,t),n&&Yj(e,n),e}function Jj(e,t){return!t||"object"!==Xj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zj(e){return(Zj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eH(e,t)}function eH(e,t){return(eH=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tH=function(e){function t(e){var n;return zj(this,t),(n=Jj(this,Zj(t).call(this,e))).state={routerOptions:e.router.currentRouteOptions},e.router.currentRouteOptions&&e.router.currentRouteOptions.selectedHeader&&n.props.setNavbarActiveLink(n.state.routerOptions.selectedHeader),n}return $j(t,e),Qj(t,[{key:"componentDidMount",value:function(){var e=this;this.props.router.on("new-component",(function(t){e.setState({routerOptions:t}),e.props.setNavbarActiveLink(e.state.routerOptions.selectedHeader)})),this.props.router.on("trigger-update",(function(){e.forceUpdate()}))}},{key:"render",value:function(){if(!this.state.routerOptions)return null;var e=this.state.routerOptions.component;return e||null}}]),t}(de.a.Component),nH=function(e){function t(e){return zj(this,t),Jj(this,Zj(t).call(this,e))}return $j(t,e),Qj(t,[{key:"render",value:function(){var e=Tt()({closeMenu:this.props.isPrimaryNavMinimized});return de.a.createElement("div",null,de.a.createElement(wj,null),de.a.createElement("div",{id:"notifications"},de.a.createElement(zM,null),de.a.createElement(yj,null)),de.a.createElement("div",{id:"main",className:e},de.a.createElement("div",{id:"app-container"},de.a.createElement("div",{className:"wrapper"},de.a.createElement("div",{role:"main",className:"pusher"},de.a.createElement(tH,{router:this.props.router,setNavbarActiveLink:this.props.setNavbarActiveLink})),de.a.createElement("div",{id:"primary-navbar"},de.a.createElement(Wj,null))))))}}]),t}(de.a.Component),aH=Object(nt.b)((function(e){return{isPrimaryNavMinimized:e.navigation.isMinimized}}),(function(e){return{setNavbarActiveLink:function(t){var n;e((n=t,function(e){e({type:pe.NAVBAR_ACTIVE_LINK,name:n})}))}}}))(nH),rH=n(110),oH=n(411),iH=n.n(oH);se.addMiddleware(iH.a);var sH,cH=Object(rH.d)(Object(rH.c)(se.reducers),rH.a.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(sH=se.middlewares)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(sH)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()));se.reduxDispatch=function(e){cH.dispatch(e)},se.reduxState=function(){return cH.getState()},le.addons=kM,se.router=le.router=new se.Router(le.addons),P.a.history.start({pushState:!1,root:le.root}),"ActiveXObject"in window&&r.a.ajaxSetup({cache:!1});document.addEventListener("click",(function(e){var t=function e(t){return t?"A"===t.tagName?t:e(t.parentNode):null}(e.target);if(t&&!t.getAttribute("data-bypass")){var n={prop:t.href,attr:t.getAttribute("href")};if(n.prop){var a=location.protocol+"//"+location.host;n.prop&&n.prop.slice(0,a.length)===a&&(e.preventDefault(),le.router.navigate(n.attr,!0))}}})),z.a.render(de.a.createElement(nt.a,{store:cH},de.a.createElement(aH,{router:le.router})),document.getElementById("app"))}},[[413,1,2]]]);